{"version":3,"sources":["src/components/Themed.tsx","src/constants/Colors.ts","src/hooks/useModalsContext.tsx","src/hooks/useResizeContext.tsx","src/components/CommonButton.tsx","src/lib/react-native-paper/Avatar.tsx","src/components/Avatar.tsx","src/components/CommonSection.tsx","src/components/ModalSection.tsx","src/hooks/lists/useMessengerChannelList.ts","src/hooks/useWebsocketContext.tsx","src/components/TextButton.tsx","src/navigation/index.tsx","src/hooks/lists/useMessengerMemberList.ts","src/modals/ChannelEditModal.tsx","src/components/HeaderRight.tsx","src/hooks/lists/useUserMembershipList.ts","src/components/TabView.tsx","src/components/CommonItem.tsx","src/hooks/lists/useMessengerContentList.ts","src/modals/GuestLogoutModal.tsx","src/components/CommonTextInput.tsx","src/components/MemberItem.tsx","src/modals/MessageModal.tsx","src/modals/ProfileModal.tsx","src/components/Profile.tsx","src/hooks/useFirebaseContext.tsx","src/components/ContractFooter.tsx","src/screens/main/LoginScreen.tsx","src/components/LinkPreview.tsx","src/lib/react-native-webrtc/useWebsocketContext.tsx","src/lib/react-native-webrtc/webrtc/p2p.tsx","src/lib/react-native-webrtc/webrtc/index.ts","src/lib/react-native-webrtc/LocalCam.tsx","src/lib/react-native-webrtc/RemoteCam.tsx","src/screens/main/ChatScreen/VideoCallSection.tsx","src/components/FilePreview.tsx","src/screens/main/ChatScreen/TimerTags.tsx","src/hooks/lists/useTimerMessageContent.ts","src/screens/main/ChatScreen/index.tsx","src/screens/main/HomeScreen/ConfigSections.tsx","src/screens/main/HomeScreen/index.tsx","src/screens/main/InviteeScreen.tsx","src/screens/index.ts","src/hooks/useLocalSearch.ts","src/modals/InviteModal.tsx","src/hooks/lists/useExternalMembershipList.ts","src/components/Calendar.tsx","src/modals/DateTimePickerModal.tsx","src/components/RowField.tsx","src/components/TextField.tsx","src/navigation/LinkingConfiguration.ts","node_modules/moment/locale sync /^/.*$","web/firebase-config.js","src/screens/NotFoundScreen.tsx","src/navigation/DrawerNavigator.tsx","src/modals/index.ts","src/navigation/RootNavigator.tsx"],"names":["useThemeColor","props","colorName","theme","useColorScheme","colorFromProps","Colors","Text","style","lightColor","darkColor","otherProps","_objectWithoutProperties","_excluded","color","light","dark","React","DefaultText","_extends","View","_excluded2","backgroundColor","DefaultView","text","background","tint","tabIconDefault","tabIconSelected","header","buttonColor","buttonBackgroundColor","buttonBorderColor","iconColor","borderColor","focus","ModalsContext","createContext","setModal","ModalsProvider","_ref","children","allModals","modals","_useState","useState","_useState2","_slicedToArray","setModals","windowType","useResizeContext","_useState3","_useState4","animationType","setAnimationType","useEffect","filter","v","visible","length","map","Component","createElement","Provider","value","newModals","m","_objectSpread","modal","index","Modal","key","transparent","useContext","getWindowType","window","height","width","ResizeContextContext","Dimensions","get","ResizeContextProvider","detectMobile","useMobileDetect","_useWindowDimensions","useWindowDimensions","setWindowType","isMobile","DefaultButton","hover","setHover","Pressable","onPress","onHoverIn","onHoverOut","disabled","paddingVertical","paddingHorizontal","selectable","fontSize","textStyle","title","_props","styles","StyleSheet","create","borderRadius","borderWidth","textAlign","fontWeight","normalizeHash","hash","min","max","Math","floor","str","initHash","i","charCodeAt","abs","stringToHSL","name","userId","Avatar","size","label","split","join","toUpperCase","avatarFromChannel","item","user","avatar","member_count","id","subowner","owner","CommonSection","outerContainer","outerContainerStyle","container","containerStyle","withSeparator","separator","undefined","titleView","titleStyle","subtitle","bodyView","bodyStyle","maxWidth","alignItems","marginHorizontal","marginVertical","flexDirection","marginBottom","flex","marginTop","padding","justifyContent","alignSelf","flexShrink","margin","BottomSheet","useMessengerChannelList","auth","queryClient","useQueryClient","lastJsonMessage","useWebsocketContext","data","useQuery","_auth$user","_regeneratorRuntime","async","_context","prev","next","awrap","getMessengerChannelList","t0","sent","abrupt","stop","Promise","setQueryData","_data","find","concat","_toConsumableArray","sort","a","b","_data2$message_set$","channel","last_message","content","message_set","created","useMessengerChannelSorted","channelList","_a$last_message","_b$last_message","useMessengerChannelMutation","useMutation","postChannel","onSuccess","invalidateQueries","update","putChannel","direct","postDirectChannel","mutateAsync","defaultContext","sendJsonMessage","WebSocketContext","WebSocketInternalProvider","path","Context","useBackground","token","setToken","AppState","currentState","isActive","setIsActive","_useWebSocket","useWebSocket","websockerURL","shouldReconnect","closeEvent","protocols","onOpen","e","console","log","onClose","AsyncStorage","getItem","then","onChange","nextState","addEventListener","removeEventListener","WebSocketProvider","_ref2","disable","Fragment","CommonButton","navigationRef","navigate","params","_navigationRef$curren","_navigationRef$curren2","current","Navigation","defaultColorScheme","useDefaultColorScheme","userColorScheme","colorScheme","NavigationContainer","ref","documentTitle","formatter","options","route","linking","process","versions","LinkingConfiguration","DarkTheme","DefaultTheme","RootNavigator","l","search","decoded","slice","s","replace","history","replaceState","pathname","location","ignoreWarnings","_console","_","clone","warn","message","Object","forEach","indexOf","useMessengerMemberList","channel_id","getMessengerMemberList","useMessengerMemberMutation","invite","postBulkMessengerMember","leave","deleteMessengerMember","ChannelEditModal","member_id","type","lang","useLangContext","useAuthContext","useModalsContext","channelMutation","messengerMemberMutation","setName","description","setDescription","back","_name","ModalSection","TextField","setValue","multiline","groupId","_auth$user2","newChannel","group","screen","field","_useAuthContext","dispatch","defaultButtonProps","username","endsWith","GuestLogoutModal","buttonProps","extra","k","TextButton","useUserMembershipList","getUserMembershipList","_React$useState","_React$useState2","setIndex","entries","tabs","onTab","icons","assign","apply","_defineProperty","icon","TabView","renderTabBar","TabBar","indicatorStyle","activeColor","inactiveColor","renderIcon","scene","onTabPress","findIndex","_ref4","_ref5","navigationState","routes","_ref6","_ref7","onIndexChange","renderScene","SceneMap","_ref8","_ref9","component","tabBarPosition","CommonItem","_React$useState3","_React$useState4","press","setPress","onPressIn","onPressOut","minHeight","borderBottomWidth","useMessengerContentList","_useInfiniteQuery","useInfiniteQuery","pageParam","getMessengerContentList","select","pages","getNextPageParam","lastPage","refetchOnReconnect","refetchOnWindowFocus","fetchNextPage","pageParams","page","len","newCurrent","useMessengerContentMutation","postMessage","_delete","deleteMessengerContent","d","variables","mutate","delete","contentHeight","setContentHeight","TextInput","editable","onChangeText","onContentSizeChange","nativeEvent","contentSize","onBlur","onEndEditing","member","marginRight","MessageModal","contentMutation","TouchableOpacity","Ionicons","Clipboard","setString","ProfileModal","userList","isSelf","Profile","_auth$user3","patchUser","finally","CommonTextInput","firebaseConfig","require","messagingSenderId","apiKeyEncrypted","FCM_API_KEY","toString","padStart","app","firebase","initializeApp","apiKey","messaging","onMessage","payload","Notification","permission","JSON","parse","channel_name","body","alert","noti","requestToken","serviceWorkerRegistration","currentToken","_context2","requestPermission","navigator","serviceWorker","register","scope","getToken","vapidKey","FCM_PUBLIC_VAPID_KEY","catch","event","preventDefault","unregister","notiListener","enable","setEnable","callback","_context4","push","getNotification","postNotification","_context3","putNotification","c","_noti","_noti2","_enable","_noti3","_context5","changeEnable","openURL","Platform","OS","url","href","Linking","Styles","footer_buttons","footer_button","AntDesign","paddingBottom","paddingRight","login_container","login_header","paddingTop","login_header_logo","resizeMode","login_header_text","login_header_text_bold","login_wrapper","borderTopRightRadius","borderTopLeftRadius","form","form_error","form_error_text","textAlignVertical","form_input","button","button_label","login_social","login_social_separator","login_social_separator_line","login_social_separator_text","login_social_buttons","login_social_button","login_social_icon","login_social_facebook","login_footer_text","guest_footer_text","login_footer_link","link","image","Image","source","uri","maxHeight","TURN_SERVER","peerConstraints","iceServers","urls","sessionConstraints","mandatory","OfferToReceiveAudio","OfferToReceiveVideo","VoiceActivityDetection","mediaConstraints","audio","video","framerate","onICEcandidate","pc","_message","rtcMessage","candidate","RTCIceCandidate","addIceCandidate","sendICEcandidate","sendMessage","receiver","target","optimizeSdp","offerDescription","arr","sdp","test","RTCSessionDescription","createOffer","pcRefCurrent","stream","addStream","t1","setLocalDescription","camStyle","cam","bottonContainer","position","bottom","buttonBar","_props$user","_useWebsocketContext","_useLocalCam","pcRef","useRef","sender","setSender","_stream","setStream","isPlay","useMemo","CustomRTCView","useCallback","memo","RTCView","videoProps","start","mode","newStream","mediaDevices","getUserMedia","getDisplayMedia","_ref3","error","getTracks","track","websocketOnMessage","response","peerConnection","_peerConnection","answerDescription","_peerConnection2","RTCPeerConnection","setRemoteDescription","useLocalCam","Button","setReceiver","_useRemoteCam","_useState5","_useState6","setUser","_useState7","_useState8","close","clearInterval","statsInterval","_pcRef$current","_pcRef$current2","_pcRef$current3","_pcRef$current4","streams","_peerConnection3","_answerDescription","_streams","iceConnectionState","activeStream","setInterval","stats","statsOutput","framePerSecond","getStats","report","kind","keys","statName","framesPerSecond","Date","toTimeString","addTransceiver","direction","getRemoteStreams","createAnswer","localDescription","useRemoteCam","VideoView","scale","flexGrow","focusGuest","setFocusGuest","VideoCallContainer","setDisable","useIsMobile","videoMode","setVideoMode","guests","setGuests","_useRtcContext","useRtcContext","ceil","sqrt","toggleVideoMode","ThemedView","aspectRatio","borderLeftWidth","flexWrap","RemoteCam","LocalCam","RtcProvider","file","showBorder","FontAwesome","filename","pow","toFixed","humanFileSize","filesize","_timerFormat","now","year","format","month","day","timerToString","timer","dayjs","TimerTag","end","ratio","diff","setExpand","isExpand","overflow","Hyperlink","linkDefault","wordBreak","linkStyle","timerMessages","getTimerMessageContentList","toISOString","sorted","_sorted$","ms","Number","MAX_VALUE","timeout","setTimeout","clearTimeout","useTimerMessageContentList","setNow","expand","MessengerContentPageItem","_nextPage2","nextPage","_nextPage","nextContent","index2","date","isSystem","isFirst","ownerId","dayChanged","marginLeft","onLongPress","file_set","fileIndex","FilePreview","link_set","linkIndex","LinkPreview","ConfigSection","_useLangContext","locale","setLocale","configTheme","useConfigColorScheme","_useFirebaseContext","useFirebaseContext","setNoti","n","textDecorationLine","setColorScheme","MemberTabView","memberItem","MemberItem","ScrollView","MessengerTabView","today","_item$last_message","_item$last_message2","_item$last_message3","_avatarFromChannel","opacity","paddingLeft","unread_count","ConfigTabView","ConfigSections","getBottomTabs","OneTab","MaterialCommunityIcons","TwoTab","FourTab","SimpleLineIcons","InviteeScreen","_route$params","navigation","enterGuest","setEnterGuest","useLayoutEffect","setOptions","headerRight","user_ids","main","HomeScreen","_route$params2","home","setHome","HeaderRight","tab","StyledText","ContractFooter","parseInt","setParams","ChatScreen","_useMessengerChannelL","inputRef","channelAvatar","_useMessengerContentL","memberList","_memberList$find","setTimer","autoFocus","setAutoFocus","_useState9","_useState10","bottomTab","setBottomTab","postValue","InviteModal","datetime","renderItem","canGoBack","goBack","_auth$user4","minWidth","VideoCallSection","FlatList","contentContainerStyle","onScroll","contentOffset","y","onLayout","p","layout","TimerTags","borderBottomRightRadius","top","Entypo","DateTimePickerModal","onSubmitEditing","blurOnSubmit","onFocus","borderBottomLeftRadius","resolve","reject","input","document","onchange","files","onabort","onerror","click","f","_auth$user5","login","LoginScreen","setUsername","password","setPassword","_login","placeholder","autoCapitalize","keyboardType","secureTextEntry","localSearchReducer","initialState","action","keyword","active","Error","InviteItem","selectedRef","has","selected","setSelected","add","GroupTabView","_useLocalSearch","compare","_useReducer","useReducer","_useReducer2","searchState","useLocalSearch","memberSet","Set","includes","dispatchKeyword","ExternalMembershipTabView","setKeyword","copied","setCopied","timeoutRef","externalMemberList","getExternalMembershipList","useExternalMembershipList","inviteLink","drawerTabs","external","Calendar","intl","LocaleConfig","defaultLocale","currentLocale","locales","BaseCalendar","markingType","markedDates","renderArrow","monthFormat","initialDate","disableAllTouchEventsForDisabledDays","onMonthChange","onDayPress","setDate","dateString","dayComponent","extend","localeData","monthNames","months","monthNamesShort","monthsShort","dayNames","weekdays","dayNamesShort","weekdaysShort","dayTypes","hours","Array","minutes","getDisableDays","startDate","startOf","endDate","endOf","result","_dayjs","restMinute","defaultDayjs","dayType","setDayType","hour","setHour","minute","setMinute","disableDays","setDisableDays","reduce","Picker","itemStyle","selectedValue","onValueChange","Item","RowField","rowStyle","values","ROOTPATH","prefixes","config","screens","Main","NotFound","webpackContext","req","webpackContextResolve","__webpack_require__","o","code","module","exports","NotFoundScreen","linkText","DrawerTabView","MessengerTab","colors","useTheme","onAddList","tabBar","card","borderTopColor","border","pointerEvents","accessibilityRole","borderTopWidth","drawerTab","Tab","elevation","borderRightWidth","Root","createStackNavigator","Navigator","headerMode","screenOptions","cardStyle","animationEnabled","cardStyleInterpolator","CardStyleInterpolators","forVerticalIOS","Screen","MainNavigator","headerShown","gestureDirection","modalValues","DrawerNavigator","headerStyle","headerTitleStyle","headerLeft","canGOBackScreen","headerLeftContainerStyle","forHorizontalIOS"],"mappings":"+WAWO,SAASA,EACdC,EACAC,GAEA,IAAMC,EAAQC,oBACRC,EAAiBJ,EAAME,GAE7B,OAAIE,GAGKC,UAAOH,GAAOD,GAYlB,SAASK,EAAKN,GACnB,IAAQO,EAAgDP,EAAhDO,MAAOC,EAAyCR,EAAzCQ,WAAYC,EAA6BT,EAA7BS,UAAcC,EAAUC,IAAKX,EAAKY,GACvDC,EAAQd,EAAc,CAAEe,MAAON,EAAYO,KAAMN,GAAa,QAEpE,OAAOO,gBAACC,UAAWC,IAAA,CAACX,MAAO,CAAC,CAAEM,SAASN,IAAYG,IAG9C,SAASS,EAAKnB,GACnB,IAAQO,EAAgDP,EAAhDO,MAAOC,EAAyCR,EAAzCQ,WAAYC,EAA6BT,EAA7BS,UAAcC,EAAUC,IAAKX,EAAKoB,GACvDC,EAAkBtB,EAAc,CAAEe,MAAON,EAAYO,KAAMN,GAAa,cAE9E,OAAOO,gBAACM,UAAWJ,IAAA,CAACX,MAAO,CAAC,CAAEc,mBAAmBd,IAAYG,M,iCC5C/D,OAGe,WACbI,MAAO,CACLS,KAAM,OACNC,WAAY,OACZC,KAPmB,UAQnBC,eAAgB,OAChBC,gBATmB,UAUnBC,OAAO,UACPC,YAAY,mBACZC,sBAAuB,UACvBC,kBAAkB,sBAClBC,UAAW,SAEbjB,KAAM,CACJQ,KAAM,OACNC,WAAY,OACZC,KAlBkB,OAmBlBC,eAAgB,OAChBC,gBApBkB,OAqBlBC,OAAO,UACPC,YAAY,aACZC,sBAAuB,UACvBC,kBAAkB,yBAClBC,UAAW,SAEbC,YAAY,UAEZC,MAAM,Y,guBCjBR,IAAMC,EAAgBC,wBAAoC,CACtDC,SAAU,eAGDC,EAAiB,SAAHC,GAA2G,IAAtGC,EAAQD,EAARC,SAAiBC,EAASF,EAAhBG,OACtCC,EAA4BC,mBAAuB,IAAGC,EAAAC,IAAAH,EAAA,GAA/CD,EAAMG,EAAA,GAAEE,EAASF,EAAA,GAClBG,EAAaC,oBACnBC,EAA0CN,mBAAS,QAAOO,EAAAL,IAAAI,EAAA,GAAnDE,EAAaD,EAAA,GAAEE,EAAgBF,EAAA,GA2BtC,OAPAG,qBAAU,WACoC,GAAtCZ,EAAOa,QAAO,SAAAC,GAAC,OAAEA,EAAEC,WAASC,QAC5BL,EAA+B,aAAdL,EAA0B,OAAO,WACvD,CAACA,IACJM,qBAAU,WACNP,EAAUN,EAAUkB,KAAI,SAACC,GAAS,MAAI,CAACA,YAAW5D,MAAM,KAAMyD,SAAQ,SACvE,CAAChB,IACGzB,IAAA6C,cAAC1B,EAAc2B,SAAQ,CAACC,MAAO,CAAC1B,SA1Bb,SAACuB,EAAW5D,GAClC,IAAMgE,EAAYtB,EAAOiB,KAAI,SAAAM,GACzB,OAAc,MAAXL,EACCM,IAAA,GACOD,GAAC,IACJR,SAAQ,IAGRQ,EAAEL,WAAaA,EACZ,CACHA,YACA5D,MAAc,OAARA,EAAaA,EAAMiE,EAAEjE,MAC3ByD,QAAgB,OAARzD,GAGTiE,KAEXlB,EAAUiB,MAUTxB,EACAE,EAAOiB,KAAI,SAACQ,EAAOC,GAChB,IAAQR,EAA8BO,EAA9BP,UAAW5D,EAAmBmE,EAAnBnE,MAAOyD,EAAYU,EAAZV,QAC1B,OAAOzC,IAAA6C,cAACQ,UAAK,CAACC,IAAKF,EAAOhB,cAAeA,EAAsBK,QAASA,EAASc,aAAW,GACxFvD,IAAA6C,cAACD,EAAc5D,SAMhB,qBAEX,OADsBwE,qBAAWrC,K,8MCpD/BsC,EAAgB,SAACC,GAAoC,OAAIA,EAAOC,QAAUD,EAAOE,MAAM,WAAW,aAElGC,EAAuBzC,wBAA0BqC,EAAcK,UAAWC,IAAI,YAEvEC,EAAwB,SAAHzC,GAA6C,IAAxCC,EAAQD,EAARC,SAC/ByC,EAAeC,MACrBC,EAAwBC,oBAAjBR,EAAKO,EAALP,MAAOD,EAAMQ,EAANR,OACdhC,EAAoCC,mBAAS6B,EAAc,CAACG,QAAOD,YAAS9B,EAAAC,IAAAH,EAAA,GAArEK,EAAUH,EAAA,GAAEwC,EAAaxC,EAAA,GAIhC,OAHAS,qBAAU,WACR+B,EAAcZ,EAAc,CAACG,QAAOD,cACnC,CAACC,EAAOD,IACJ3D,IAAA6C,cAACgB,EAAqBf,SAAQ,CAACC,MAAOkB,EAAaK,WAAW,WAAWtC,GAC7ER,IAIU,SAASS,IAEtB,OADmBuB,qBAAWK,K,2sBClBhC,IAAMU,EAAgB,SAACvF,GACnB,IAAA2C,EAA0BC,oBAAS,GAAMC,EAAAC,IAAAH,EAAA,GAAlC6C,EAAK3C,EAAA,GAAE4C,EAAQ5C,EAAA,GACtB,OAAO7B,IAAA6C,cAAC6B,UAAS,CACbC,QAAS,kBAAI3F,EAAM2F,WAEnBC,UAAW,kBAAIH,GAAS,IACxBI,WAAY,kBAAIJ,GAAS,IACzBK,SAAU9F,EAAM8F,SAChBvF,MAAO,CACH,CACIwF,gBAAgB,EAChBC,kBAAkB,IAEtBhG,EAAMO,MACLiF,GAASxF,EAAM8F,SAAU,CAACzE,gBAAgBrB,EAAMa,OAAO,KAEvDb,EAAMwC,SAASxC,EAAMwC,SACtBxB,IAAA6C,cAACvD,UAAI,CAAC2F,YAAY,EAAO1F,MAAO,CAAC,CAAC2F,SAAS,IAAKlG,EAAMmG,YAAanG,EAAMoG,SAItE,mBAACpG,GACZ,IAAME,EAAQC,oBACRkG,EAAMnC,IAAA,CACRrD,MAAMR,UAAOH,GAAO2B,aACjB7B,GAAK,IACRO,MAAM,CACF+F,EAAO/F,MACP,CACIc,gBAAgBhB,UAAOH,GAAO4B,sBAC9BG,YAAY5B,UAAOH,GAAO6B,mBAE9B/B,EAAMO,OAEV4F,UAAU,CACNG,EAAO/E,KACP,CAACV,MAAMR,UAAOH,GAAOqB,MACrBvB,EAAMmG,aAGd,OAAOnF,IAAA6C,cAAC0B,EAAkBc,IAG9B,IAAMC,EAASC,UAAWC,OAAO,CAC7BjG,MAAM,CACFkG,aAAa,EACbC,YAAY,GAEhBnF,KAAK,CACDoF,UAAU,SACVC,WAAW,U,uHCpDbC,EAAgB,SAACC,EAAcC,EAAaC,GAC9C,OAAOC,KAAKC,MAAOJ,GAAQE,EAAMD,GAAQA,IAY9B,WAAC/G,GACZ,IAAMqB,EAVU,SAAC8F,EAAaC,GAE9B,IADA,IAAIN,EAAOM,GAAY,EACdC,EAAI,EAAGA,EAAIF,EAAIzD,OAAQ2D,IAC9BP,EAAOK,EAAIG,WAAWD,KAAOP,GAAQ,GAAKA,GAG5C,OADAA,EAAOG,KAAKM,IAAIT,GACV,OAAQD,EAAcC,EAAM,EAAG,KAAI,KAAKD,EAAcC,EAAM,EAAG,KAAI,MAAMD,EAAcC,EAAM,GAAI,IAAG,KAIlFU,CAAYxH,EAAMyH,KAAMzH,EAAM0H,QACtD,OAAO1G,gBAAC2G,SAAOrH,KAAI,CAACC,MAAO,CAACc,mBAAkBuG,KAAM5H,EAAM4H,KAAMC,MAAO7H,EAAMyH,KAAKK,MAAM,KAAKnE,KAAI,SAAAH,GAAC,OAAEA,EAAE,MAAIuE,OAAOC,iBCd9G,SAASC,EAAkBC,EAAuBC,GACrD,IAAIC,EACAX,EAAOS,EAAKT,KAKhB,OAJIS,EAAKG,aAAa,IAClBD,EAA6B,GAAnBF,EAAKG,eAAuB,MAAJF,OAAI,EAAJA,EAAMG,KAAMJ,EAAKK,SAASD,GAAIJ,EAAKM,MAAMN,EAAKK,SAChFd,EAAOA,EAAK/D,OAAO,EAAE+D,EAAKW,EAAOX,MAE9B,CAACW,SAAQX,QAGL,mBAACzH,GAEZ,OAAOgB,IAAA6C,cAAC8D,EAAW3H,K,iCCjBvB,oFAgBe,SAASyI,EAAczI,GACpC,OACEgB,gBAACG,OAAI,CAACZ,MAAO,CAAC+F,EAAOoC,eAAgB1I,EAAM2I,sBACvC3H,gBAACG,OAAI,CAACZ,MAAO,CAAC+F,EAAOsC,UAAW5I,EAAM6I,iBACjC7I,EAAM8I,cAAc9H,gBAACG,OAAI,CAACZ,MAAO+F,EAAOyC,UAAWvI,WAAW,OAAOC,UAAU,gCAA4BuI,EAC3GhJ,EAAMoG,MAAMpF,gBAACG,OAAI,CAACZ,MAAO+F,EAAO2C,WAC/BjI,gBAACV,OAAI,CAACC,MAAO,CAAC+F,EAAOF,MAAOpG,EAAMkJ,aAAclJ,EAAMoG,OACtDpF,gBAACV,OAAI,CAACC,MAAO+F,EAAO6C,UAAWnJ,EAAMmJ,gBAC/BH,EACRhI,gBAACG,OAAI,CAACZ,MAAO,CAAC+F,EAAO8C,SAAUpJ,EAAMqJ,YACpCrJ,EAAMwC,YAOnB,IAAM8D,EAASC,UAAWC,OAAO,CAC/BkC,eAAe,CACb9D,MAAM,OACN0E,SAAS,KACTC,WAAW,UACXlI,gBAAgB,eAElBuH,UAAW,CACPY,iBAAiB,GACjBC,eAAgB,GAChBpI,gBAAgB,eAElB4H,UAAU,CACRrE,MAAO,OACP8E,cAAc,MACdrI,gBAAgB,cAChBsI,aAAa,GAEfvD,MAAO,CACLwD,KAAK,EACL1D,SAAU,IAEZiD,SAAU,CACRS,KAAK,EACL1D,SAAU,GACVS,UAAW,QACXkD,UAAU,GAEZd,UAAW,CACTY,aAAc,GACdhF,OAAQ,EACRC,MAAO,QAETwE,SAAS,CACPxE,MAAO,OACPkF,QAAS,GACTP,WAAY,SACZQ,eAAgB,SAChBrD,YAAY,EACZzE,YAAY5B,UAAO4B,YACnBwE,aAAa,M,iCCzEnB,yFAIe,mBAACzG,GACZ,IAAMgD,EAAaC,oBACnB,OAAOjC,IAAA6C,cAAC4E,UAAa,CACjBE,oBAAqB,CAACiB,KAAK,EAAGI,UAAU,SAAU3I,gBAAgB,QAASiI,cAASN,EAAWiB,WAAW,GAC1GpB,eAAgB,CAACe,KAAK,EAAGM,OAAO,EAAGH,eAAe,SAAUR,WAAW,UACvEF,UAAuB,aAAZrG,EAAwB,CAAC4B,MAAM,MAAOD,OAAO,MAAOmF,QAAQ,MAAM,CAAClF,MAAM,OAAQD,OAAO,OAAQ2E,SAAS,OAEnHtJ,EAAMwC,WAIR,IAAM2H,EAAc,SAACnK,GAAkC,OAAGgB,IAAA6C,cAAC4E,UAAa,CAC3EE,oBAAqB,CAACiB,KAAK,EAAGI,UAAU,SAAU3I,gBAAgB,QAASiI,cAASN,GACpFH,eAAgB,CAACe,KAAK,EAAGM,OAAO,EAAGH,eAAe,aAEjD/J,EAAMwC,Y,81BCZI,SAAS4H,EAAwBC,GAC9C,IAAMC,EAAcC,2BACbC,EAAmBC,oBAAnBD,gBACCE,EAASC,mBAAS,wBAAyB,eAAAC,EAAA,OAAAC,IAAAC,OAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,UAAa,MAAJZ,GAAU,OAANO,EAAJP,EAAMlC,QAANyC,EAAYtC,GAAE,CAAAyC,EAAAE,KAAA,eAAAF,EAAAE,KAAA,EAAAJ,IAAAK,MAAQC,kCAAwBd,EAAKlC,KAAKG,KAAG,OAAAyC,EAAAK,GAAAL,EAAAM,KAAAN,EAAAE,KAAA,eAAAF,EAAAK,GAAE,GAAE,cAAAL,EAAAO,OAAA,SAAAP,EAAAK,IAAA,wBAAAL,EAAAQ,UAAA,eAAAC,YAAnHd,KAuBR,OArBApH,qBAAU,WACR,GAAqB,MAAlBkH,IAC2B,SAAzBA,EAAsB,MACvBF,EAAYmB,aAAiC,wBAAwB,SAACC,GACpE,OAAa,MAALA,KAAOC,MAAK,SAAAnI,GAAC,OAAEA,EAAE8E,IAAIkC,EAAsB,KAAM,MAAGkB,EAAM,CAAClB,EAAsB,MAACoB,OAAAC,IAAOH,GAAQ,MAAMI,MAAK,SAACC,EAAGC,GAAC,OAAGD,EAAEzD,GAAK0D,EAAE1D,SAG5G,gBAAzBkC,EAAsB,MAAkB,CAC1C,IAAME,EAAwBF,EAAsB,KACpDF,EAAYmB,aAAiC,wBAAwB,SAACC,GAAK,OAAIA,GAAS,IAAI/H,KAAI,SAAAH,GACpE,IAADyI,EAAzB,OAAIzI,EAAE8E,IAAMoC,EAAKwB,QACfhI,IAAA,GAAWV,GAAC,IAAE2I,aAAa,CAACC,QAA2B,OAApBH,EAACvB,EAAK2B,YAAY,SAAE,EAAnBJ,EAAqBG,QAASE,QAAQ5B,EAAK4B,WAE1E9I,WAOZ,CAACgH,IACGE,EAGF,SAAS6B,EAA0BlC,GACxC,IAAMmC,EAAcpC,EAAwBC,GAC5C,OAAkB,MAAXmC,OAAW,EAAXA,EAAaV,MAAK,SAACC,EAAGC,GAAC,IAAAS,EAAAC,EAAA,QAAkB,OAAdD,EAAAV,EAAEI,mBAAY,EAAdM,EAAgBH,UAAW,MAAqB,OAAdI,EAAAV,EAAEG,mBAAY,EAAdO,EAAgBJ,UAAW,IAAI,GAAG,KAEjG,SAASK,IACd,IAAMrC,EAAcC,2BAEd/D,EAASoG,sBAAYC,cAAa,CACtCC,UAAW,kBAAIxC,EAAYyC,kBAAkB,2BAGzCC,EAASJ,sBAAYK,aAAY,CACrCH,UAAW,kBAAMxC,EAAYyC,kBAAkB,2BAG3CG,EAASN,sBAAYO,oBAAmB,CAC5CL,UAAW,kBAAMxC,EAAYyC,kBAAkB,2BAGjD,MAAO,CAAEvG,OAAOA,EAAO4G,YAAaJ,OAAOA,EAAOI,YAAaF,OAAOA,EAAOE,e,oOC/CzEC,EAAiB,CAAC7C,qBAAgBxB,EAAWsE,gBAAgB,cAC7DC,EAAmBnL,wBAAoCiL,GAEhDG,EAA4B,SAAHjL,GAAuJ,IAAlJC,EAAQD,EAARC,SAAUiL,EAAIlL,EAAJkL,KAAMC,EAAOnL,EAAPmL,QAASC,EAAapL,EAAboL,cAClEhL,EAA0BC,mBAAsB,MAAKC,EAAAC,IAAAH,EAAA,GAA9CiL,EAAK/K,EAAA,GAAEgL,EAAQhL,EAAA,GACtBK,EAAgCN,mBAAkB+K,GAA0C,UAAzBG,UAASC,cAAyB5K,EAAAL,IAAAI,EAAA,GAA9F8K,EAAQ7K,EAAA,GAAE8K,EAAW9K,EAAA,GAC5B+K,EAA6CC,IAAgBC,eAAY,IAAIX,EAAO,CAClFY,gBAAiB,SAACC,GAAU,OAAK,GACjCC,UAAWX,EAAM,CAAC,gBAAkBA,QAAO5E,EAC3CwF,OAAQ,SAACC,GAAKC,QAAQC,IAAI,gCAAgClB,EAAI,MAC9DmB,QAAS,SAACH,GAAMC,QAAQC,IAAI,+BAA+BlB,EAAI,OAC9DO,GAAmB,MAAPJ,GALPpD,EAAe0D,EAAf1D,gBAAiB8C,EAAeY,EAAfZ,gBAYzB,OANAhK,qBAAU,WACRuL,UAAaC,QAAQ,iBAAiBC,KAAKlB,GAC3C,IAAMmB,EAAW,SAACC,GAAwB,OAAGhB,EAAYN,GAA8B,UAAbsB,IAE1E,OADAnB,UAASoB,iBAAiB,SAAUF,GAC7B,kBAAIlB,UAASqB,oBAAoB,SAAUH,MACjD,IACIhO,IAAA6C,cAAC6J,EAAQ5J,SAAQ,CAACC,MAAc,MAAP6J,EAAY,CAACpD,kBAAiB8C,mBAAiBD,GAC1E7K,IAIM4M,EAAoB,SAAHC,GAAwE,IAAnEC,EAAOD,EAAPC,QAAS9M,EAAQ6M,EAAR7M,SAC1C,OAAO8M,EAAQtO,IAAA6C,cAAA7C,IAAAuO,SAAA,KAAG/M,GAAaxB,IAAA6C,cAAC2J,EAAyB,CAACC,KAAM,gBAAiBC,QAASH,GACvF/K,IAIU,qBAEb,OADyBgC,qBAAW+I,K,8FCjCvB,mBAACvN,GACZ,OAAOgB,IAAA6C,cAAC2L,UAAYtO,IAAA,GAAKlB,EAAK,CAAEO,MAAO,CAAC+F,EAAO/F,MAAOP,EAAMO,WAGhE,IAAM+F,EAASC,UAAWC,OAAO,CAC7BjG,MAAM,CACFkG,aAAa,EACbpF,gBAAiB,cACjBqF,YAAY,M,iCCRpB,uLAWM+I,EAAgBzO,cAEf,SAAS0O,EAASjI,EAAakI,GAAc,IAADC,EAAAC,EAC7CF,IACmB,OAArBC,EAAAH,EAAcK,UAAdF,EAAuBF,SAASjI,EAAMkI,IACnB,OAArBE,EAAAJ,EAAcK,UAAdD,EAAuBH,SAASjI,GAGnB,SAASsI,IACtB,IAAMC,EAAqBC,oBACrBC,EAAkB/P,2BAClBgQ,EAAgC,iBAAlBD,EAAkCF,EAAmBE,EACzE,OAAOlP,gBAACoP,UAAmB,CACzBC,IAAKZ,EACLa,cAAe,CAACC,UAAW,SAACC,EAASC,GAAW,MAAM,cACtDC,QAAUC,EAAQC,UAAYD,EAAQC,SAAmB,cAAG5H,EAAU6H,UACtE3Q,MAAuB,SAAhBiQ,EAAyBW,UAAYC,WACxC/P,gBAACgE,wBAAqB,KACpBhE,gBAACgQ,UAAa,SAKvB,SAASC,GACN,QAAUjI,IAANiI,GAAmC,MAAhBA,EAAEC,OAAO,GAAa,CACzC,IAAIC,EAAUF,EAAEC,OAAOE,MAAM,GAAGtJ,MAAM,KAAKnE,KAAI,SAAS0N,GACxD,OAAOA,EAAEC,QAAQ,SAAU,QACxBvJ,KAAK,KACRrD,OAAO6M,QAAQC,aAAa,KAAM,GAC9BP,EAAEQ,SAASL,MAAM,GAAI,GAAKD,EAAUF,EAAEnK,OANjD,CASCpC,OAAOgN,UAET,IAAMC,EAAiB,CAAC,iCACpBC,EAAe,aACnB,kCAAiB7C,MAAK,SAAA8C,GACpBD,EAAWC,EAAEC,MAAMpD,YAErBA,QAAQqD,KAAO,SAACC,GACZ,IAAID,GAAO,EACPC,aAAmBC,OACvBF,GAAO,EAEPJ,EAAeO,SAAQ,SAACnO,GAChBiO,EAAQG,SAAWH,EAAQG,QAAQpO,KAAW,IAC9CgO,GAAO,MAIXA,GACAH,EAASG,KAAKC,K,mMChEP,SAASI,EAAuBC,GAE7C,OADiB1H,mBAAS,CAAC,sBAAuB0H,IAAc,kBAAAxH,IAAAC,OAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,cAAAF,EAAAE,KAAA,EAAAJ,IAAAK,MAAeoH,iCAAuBD,IAAW,cAAAtH,EAAAO,OAAA,SAAAP,EAAAM,MAAA,wBAAAN,EAAAQ,UAAA,eAAAC,YAAzGd,KAKH,SAAS6H,IACd,IAAMjI,EAAcC,2BACdiI,EAAS5F,sBAAY6F,0BAAyB,CAClD3F,UAAW,WACTxC,EAAYyC,kBAAkB,0BAI5B2F,EAAQ9F,sBAAY+F,wBAAuB,CAC/C7F,UAAW,WACTxC,EAAYyC,kBAAkB,wBAC9BzC,EAAYyC,kBAAkB,0BAGlC,MAAO,CAACyF,OAAOA,EAAOpF,YAAasF,MAAMA,EAAMtF,e,gOCPlC,SAASwF,EAAgBrQ,GAAuE,IAArE+F,EAAE/F,EAAF+F,GAAIuK,EAAStQ,EAATsQ,UAAWC,EAAIvQ,EAAJuQ,KAC/CC,EAASC,oBAATD,KACD1I,EAAQ4I,oBAAR5I,KACChI,EAAa6Q,oBAAb7Q,SACFmK,EAAcpC,kBAAwBC,GACtC8I,EAAkBxG,wCAClByG,EAA0Bb,uCAC1BrG,EAAqB,MAAXM,OAAW,EAAXA,EAAab,MAAK,SAAAnI,GAAC,OAAEA,EAAE8E,IAAIA,KAC3C3F,EAAwBC,mBAAS,IAAGC,EAAAC,IAAAH,EAAA,GAA7B8E,EAAI5E,EAAA,GAAEwQ,EAAOxQ,EAAA,GACpBK,EAAsCN,mBAAS,IAAGO,EAAAL,IAAAI,EAAA,GAA3CoQ,EAAWnQ,EAAA,GAAEoQ,EAAcpQ,EAAA,GAC5BqQ,EAAO,WACXnR,EAASuQ,EAAkB,OAU7B,OAPAtP,qBAAU,WACR,GAAI4I,EAAQ,CACV,IAAYuH,EAASxL,4BAAkBiE,EAAS7B,EAAKlC,MAA9CV,KACP4L,EAAQI,GACRF,GAAsB,MAAPrH,OAAO,EAAPA,EAASoH,cAAe,OAExC,CAACpH,IACGlL,IAAA6C,cAAC6P,UAAY,KAClB1S,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO,CAACwJ,eAAe,gBAAiBH,KAAK,EAAGhF,MAAM,SAC1D5D,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO,CAACqE,MAAM,SAClB5D,IAAA6C,cAACvD,OAAI,CAACC,MAAO,CAAC2F,SAAS,KAAS6M,EAAHzK,EAAQ,eAAqB,aAC1DtH,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO+F,EAAOyC,UAAWvI,WAAW,OAAOC,UAAU,2BAC3DO,IAAA6C,cAAC8P,UAAS,CAAClM,KAAMsL,EAAK,gBAAiBhP,MAAO0D,EAAMmM,SAAUP,EAASzO,MAAO,QAC9E5D,IAAA6C,cAAC8P,UAAS,CAAClM,KAAMsL,EAAK,eAAgBhP,MAAOuP,EAAaM,SAAUL,EAAgBM,WAAS,EAACjP,MAAO,SAEvG5D,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO,CAACqE,MAAM,OAAQ8E,cAAc,QACvCmJ,GAAY7R,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO,CAACmJ,cAAc,MAAOK,eAAe,eAC7D/I,IAAA6C,cAAC2L,UAAY,CAACpJ,MAAO2M,EAAK,SAAUxS,MAAO,CAACiJ,iBAAiB,GAAI7D,QAAS,kBAAIyN,EAAwBV,MAAMG,GAAW9D,KAAKyE,OAE9HxS,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO,CAACqJ,KAAK,EAAGF,cAAc,MAAOK,eAAe,aACxD/I,IAAA6C,cAAC2L,UAAY,CAACpJ,MAAO2M,EAAK,QAASpN,QAAS,WAAK,IAADiF,EAC9C,GAAO,MAAJP,GAAU,OAANO,EAAJP,EAAMlC,OAANyC,EAAYtC,IAAM+B,EAAKyJ,QAAQ,CAAC,IAADC,EAC1BC,EAAqB,CAAC1L,KAAIb,OAAM6L,cAAaR,OAAMtK,MAAU,MAAJ6B,GAAU,OAAN0J,EAAJ1J,EAAMlC,WAAF,EAAJ4L,EAAYzL,GAAI2L,MAAM5J,EAAKyJ,UACzFxL,EAAG6K,EAAgBnG,OAAOgH,GAAYb,EAAgB3M,OAAOwN,IAAajF,MAAK,SAAAvL,GAAC,OAAEkM,mBAAS,OAAQ,CAClGwE,OAAiB,aAAV1Q,EAAEsP,KAAoB,aAAa,cAC1CnD,OAAO,CAACrH,GAAG9E,EAAE8E,aAInBtH,IAAA6C,cAAC2L,UAAY,CAACpJ,MAAO2M,EAAK,UAAWxS,MAAO,CAACiJ,iBAAiB,GAAI7D,QAAS6N,QAOrF,IAAMlN,EAASC,UAAWC,OAAO,CAC/B2N,MAAM,CACJvP,MAAM,MACN8E,cAAc,MACdI,QAAQ,IAEVf,UAAW,CACTY,aAAc,GACdhF,OAAQ,EACRC,MAAO,W,4JChEI,mBAAC5E,GACZ,IAAQ+S,EAASC,oBAATD,KACRqB,EAAyBnB,oBAAlB5I,EAAI+J,EAAJ/J,KAAMgK,EAAQD,EAARC,SACLhS,EAAa6Q,oBAAb7Q,SACFW,EAAaC,oBACbqR,EAAmC,CAAC,CAAClO,MAAM2M,EAAK,YAAapN,QAAQ,WAAK,IAADiF,EACnE,MAAJP,GAAU,OAANO,EAAJP,EAAMlC,OAANyC,EAAY2J,SAASC,SAAS,UAC9BnS,EAASoS,UAAkB,IAG3BJ,EAAS,CAACvB,KAAK,sBAGjB4B,GAAe1U,EAAM2U,MAAM,GAAD/I,OAAAC,IAAK7L,EAAM2U,OAAUL,GAAoBA,GAAoB/Q,QAAO,SAAAC,GAAC,OAAEA,EAAER,YAAYA,QAA8BgG,GAAhBxF,EAAER,cACrI,OAAMhC,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAACmJ,cAAc,QAC7BgL,EAAY/Q,KAAI,SAACH,EAAEoR,GAAC,OAAG5T,IAAA6C,cAACgR,UAAU3T,IAAA,CAACoD,IAAKsQ,GAAOpR,EAAC,CAAE2C,UAAW,CAACtF,MAAM,SAAUA,MAAM,iB,qHCtB9E,SAASiU,EAAsBzK,GAE5C,OADiBM,mBAAS,CAAC,qBAA0B,MAAJN,OAAI,EAAJA,EAAMyJ,UAAW,kBAAAjJ,IAAAC,OAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,UAAa,MAAJZ,MAAMyJ,QAAO,CAAA/I,EAAAE,KAAA,eAAAF,EAAAE,KAAA,EAAAJ,IAAAK,MAAQ6J,gCAA0B,MAAJ1K,OAAI,EAAJA,EAAMyJ,UAAQ,OAAA/I,EAAAK,GAAAL,EAAAM,KAAAN,EAAAE,KAAA,eAAAF,EAAAK,GAAE,GAAE,cAAAL,EAAAO,OAAA,SAAAP,EAAAK,IAAA,wBAAAL,EAAAQ,UAAA,eAAAC,YAAhId,O,oKCGK,mBAAC1K,GACd,IAAQ+S,EAASC,oBAATD,KACRiC,EAA0BhU,IAAM4B,SAAS5C,EAAMoE,OAAS,GAAE6Q,EAAAnS,IAAAkS,EAAA,GAAnD5Q,EAAK6Q,EAAA,GAAEC,EAAQD,EAAA,GAChB/U,EAAQC,oBACRgV,EAAUlD,OAAOkD,QAAQnV,EAAMoV,MAC/BC,EAAQrV,EAAMqV,MACdC,EAAQrD,OAAOsD,OAAMC,MAAbvD,OAAM,CAAQ,IAAErG,OAAAC,IAAKsJ,EAAQxR,KAAI,SAAApB,GAAA,IAAA8M,EAAAvM,IAAAP,EAAA,GAAEqS,EAACvF,EAAA,GAAE7L,EAAC6L,EAAA,UAAAoG,IAAA,GAAOb,EAAGpR,EAAEkS,YACjE,OAAO1U,IAAA6C,cAAC8R,UAAO,CACbC,aAAc,SAAC5V,GACb,OAAOgB,IAAA6C,cAACgS,SAAM3U,IAAA,GACRlB,EAAK,CACT8V,eAAgB,CAAEzU,gBAAiB,WACnCd,MAAO,CAAEc,gBAAgBhB,UAAOH,GAAOsB,YACvCuU,YAAa1V,UAAOH,GAAOqB,KAC3ByU,cAAe3V,UAAOH,GAAOqB,KAC7B0U,WAAY,SAACC,GAAK,OAAGZ,EAAMY,EAAMzF,MAAMnM,MACvC6R,WAAY,SAACD,GAAK,OAAQ,MAALb,OAAK,EAALA,EAAQF,EAAQiB,WAAU,SAAAC,GAAA,IAAAC,EAAAxT,IAAAuT,EAAA,GAAEzB,EAAC0B,EAAA,GAAGA,EAAA,UAAI1B,GAAKsB,EAAMzF,MAAMnM,aAG9EiS,gBAAiB,CAAEnS,QAAOoS,OAAQrB,EAAQxR,KAAI,SAAA8S,GAAA,IAAAC,EAAA5T,IAAA2T,EAAA,GAAE7B,EAAC8B,EAAA,GAAElT,EAACkT,EAAA,SAAK,CAACpS,IAAIsQ,EAAGxO,MAAM2M,EAAKvP,EAAE4C,YAC9EuQ,cAAezB,EACf0B,YAAaC,mBAAS5E,OAAOsD,OAAMC,MAAbvD,OAAM,CAAQ,IAAErG,OAAAC,IAAKsJ,EAAQxR,KAAI,SAAAmT,GAAA,IAAAC,EAAAjU,IAAAgU,EAAA,GAAElC,EAACmC,EAAA,GAAEvT,EAACuT,EAAA,UAAAtB,IAAA,GAAOb,EAAGpR,EAAEwT,kBACzEC,eAAgBjX,EAAMiX,mB,+ICjBX,SAASC,EAAWlX,GACjC,IAAAgV,EAA0BhU,YAAe,GAAMiU,EAAAnS,IAAAkS,EAAA,GAAjCvP,GAAFwP,EAAA,GAAUA,EAAA,IACtBkC,EAA0BnW,YAAe,GAAMoW,EAAAtU,IAAAqU,EAAA,GAAxCE,EAAKD,EAAA,GAAEE,EAAQF,EAAA,GACtB,OACEpW,gBAAC0E,UAAS,CACRnF,MAAO,CAAC+F,EAAOoC,eAAgB1I,EAAM2I,oBAAsB0O,EAAO,CAAChW,gBAAgB,oBAAoB,IACvGkW,UAAW,WAAKD,GAAS,IACzBE,WAAY,WAAKF,GAAS,GAAoB,MAAbtX,EAAM2F,SAAN3F,EAAM2F,WAEtCC,UAAW,kBAAIH,GAAS,IACxBI,WAAY,kBAAIJ,GAAS,KAExBzE,gBAACG,OAAI,CAACZ,MAAO,CAAC+F,EAAOsC,UAAW5I,EAAM6I,iBAClC7H,gBAACG,OAAI,CAACZ,MAAO,CAAC+F,EAAO8C,SAAUpJ,EAAMqJ,YACjCrI,2BAAA,KAAGhB,EAAMwC,aAOzB,IAAM8D,EAASC,UAAWC,OAAO,CAC/BkC,eAAe,CACb9D,MAAM,OACN0E,SAAS,KACTC,WAAW,WAEbX,UAAW,CACPY,iBAAiB,GACjBnI,gBAAgB,eAElB+H,SAAS,CACPxE,MAAO,OACPkF,QAAS,GACT2N,UAAW,GACXlO,WAAY,SACZQ,eAAgB,SAChB2N,kBAAkB,EAClBzV,YAAY5B,UAAO4B,YACnBZ,gBAAgB,kB,oyBCzCP,SAASsW,EAAwBtF,GAC9C,IAAM/H,EAAcC,2BACpBqN,EAAgCC,2BAC9B,CAAC,uBAAwBxF,IACzB,SAAA9P,GAAA,IAAAuV,EAAA,OAAAjN,IAAAC,OAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,OAAgB,OAAT6M,EAASvV,EAATuV,UAAS/M,EAAAO,OAAA,SAAIyM,kCAAwB1F,EAAYyF,GAAW/I,MAAK,SAAAe,GAAO,MAAG,CAACA,eAAU,wBAAA/E,EAAAQ,UAAA,eAAAC,WAC7F,CACEwM,OAAO,SAAAtN,GAGL,OAFGA,EAAKuN,MAAMvU,OAAS,IACrBgH,EAAKuN,MAAMvN,EAAKuN,MAAMvU,OAAS,GAAGuH,KAAOP,EAAKuN,MAAMvN,EAAKuN,MAAMvU,OAAS,IACnEgH,GAETwN,iBAAiB,SAACC,GAAQ,OAAW,MAARA,KAAUrI,QAAQpM,OAAOyU,EAASrI,QAAQqI,EAASrI,QAAQpM,OAAS,GAAG4E,QAAGU,GACvGoP,oBAAmB,EACnBC,sBAAqB,IAXjB3N,EAAIkN,EAAJlN,KAAM4N,EAAaV,EAAbU,cAcN9N,EAAoBC,oBAApBD,gBA0BR,OAzBAlH,qBAAU,WACa,MAAlBkH,GAA0BA,EAAsB,KAAW,SAAK6H,IACrC,gBAAzB7H,EAAsB,MACvBF,EAAYmB,aAAiD,CAAC,uBAAwB4G,IAAa,SAAC3G,GAGlG,OAFQ,MAALA,KAAOuM,MAAM,GAAGnI,UAAgB,MAALpE,OAAK,EAALA,EAAOuM,MAAM,GAAGnI,QAAQ,GAAGxH,KAAMkC,EAAsB,KAAElC,KACrFoD,EAAMuM,MAAM,GAAGnI,QAAO,CAAItF,EAAsB,MAACoB,OAAAC,IAAU,MAALH,OAAK,EAALA,EAAOuM,MAAM,GAAGnI,WACxE5L,EAAA,GAAYwH,GAAS,CAACuM,MAAM,GAAIM,WAAW,QAGnB,kBAAzB/N,EAAsB,MACvBF,EAAYmB,aAAiD,CAAC,uBAAwB4G,IAAa,SAAC3G,GAUlG,OATAgD,QAAQC,IAAS,MAALjD,OAAK,EAALA,EAAOuM,OACd,MAALvM,KAAOuM,MAAM/F,SAAQ,SAAAsG,GACnB,IAAMC,EAAMD,EAAK1I,QAAQpM,OACnBgV,EAAaF,EAAK1I,QAAQvM,QAAO,SAAAC,GAAC,OAAEA,EAAE8E,IAAIkC,EAAsB,KAAElC,MACxEoG,QAAQC,IAAI8J,EAAKC,GACbD,GAAOC,EAAWhV,SACpB8U,EAAK1I,QAAU4I,MAGnBxU,EAAA,GAAYwH,GAAS,CAACuM,MAAM,GAAIM,WAAW,WAIhD,CAAC/N,IACG,CAAEE,OAAM4N,iBAGV,SAASK,IAEd,IAAMnS,EAASoG,sBAAYgM,cAAa,CACtC9L,UAAW,eAQP+L,EAAUjM,sBAAYkM,yBAAwB,CAClDhM,UAAW,SAACiM,EAAGC,OAOjB,MAAO,CAAExS,OAAOA,EAAOyS,OAAQC,OAAOL,EAAQI,U,iCC3EhD,yHAQe,SAASxE,EAAgBlS,GAAIA,EAAF+F,GAAkB,IAClDyK,EAASC,oBAATD,KACA1Q,EAAa6Q,oBAAb7Q,SACDgS,EAAYpB,oBAAZoB,SAIP,OAAOrT,IAAA6C,cAACsG,cAAW,KACjBnJ,IAAA6C,cAACvD,OAAI,KAAEyS,EAAK,wFACZ/R,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO,CAACqE,MAAM,OAAQ8E,cAAc,MAAOK,eAAe,aAC9D/I,IAAA6C,cAAC2L,UAAY,CAACpJ,MAAO2M,EAAK,YAAapN,QAAS,kBAAI0O,EAAS,CAACvB,KAAK,sBACnE9R,IAAA6C,cAAC2L,UAAY,CAACpJ,MAAO2M,EAAK,UAAWpN,QAAS,WANhDtD,EAASoS,EAAkB,a,wGCPhB,mBAACzU,GACZ,IAAA2C,EAA0CC,qBAAkBC,EAAAC,IAAAH,EAAA,GAArDwW,EAAatW,EAAA,GAAEuW,EAAgBvW,EAAA,GAChC4U,EAAYzX,EAAMyX,WAAa,GAC/BvX,EAAQC,oBACd,OAAOa,IAAA6C,cAACwV,UAAS,CAAC9Y,MAAO,CAAC,CAClB0B,YAAY,UACZiE,SAAS,GACTQ,YAAY,EACZD,aAAa,EACbT,kBAAkB,GAClBD,gBAAgB,EAChB1E,gBAAgBhB,UAAOH,GAAOsB,WAC9BX,MAAMR,UAAOH,GAAOqB,KACpBoD,OAAO3E,EAAM6T,UAAUsF,EAAc1B,GACtCzX,EAAMO,OACT+Y,UAAWtZ,EAAM8F,SACjB/B,MAAO/D,EAAM+D,MACbwV,aAAcvZ,EAAM4T,SACpB4F,oBAAqBxZ,EAAM6T,UAAU,SAACpF,GAAC,OAAK2K,EAAiBnS,KAAKD,IAAIyH,EAAEgL,YAAYC,YAAY/U,OAAQ8S,GAAa,SAAGzO,EACxH2Q,OAAQ,kBAAgB,MAAZ3Z,EAAM2Z,YAAM,EAAZ3Z,EAAM2Z,OAAS3Z,EAAM+D,QACjC6V,aAAc,kBAAsB,MAAlB5Z,EAAM4Z,kBAAY,EAAlB5Z,EAAM4Z,aAAe5Z,EAAM+D,QAC7C8P,UAAW7T,EAAM6T,c,iCC3BzB,sDAMe,mBAAAtR,GAAuE,IAA9D2F,EAAI3F,EAAXsX,OAAalU,EAAOpD,EAAPoD,QAC1B,OAAO3E,IAAA6C,cAACqT,UAAU,CAAC5S,IAAK4D,EAAKI,GAAIe,UAAW,CAACK,cAAc,MAAOK,eAAe,cAAepE,QAASA,GACrG3E,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO,CAACsJ,UAAU,EAAGiQ,YAAY,KAAK9Y,IAAA6C,cAAC8D,UAAM,CAACF,KAAMS,EAAKT,KAAMC,OAAQQ,EAAKI,GAAIV,KAAM,MAC5F5G,IAAA6C,cAACvD,OAAI,CAACC,MAAO,CAAC2F,SAAS,GAAIU,WAAW,QAASsB,EAAKT,S,iCCT5D,+KAae,SAASsS,EAAYxX,GAA6C,IAA3C+F,EAAE/F,EAAF+F,GAAI8D,EAAO7J,EAAP6J,QAChC2G,EAASC,oBAATD,KACA1Q,EAAa6Q,oBAAb7Q,SACFnC,EAAQC,oBACR6Z,EAAkBrB,wCAClBnF,EAAO,WACXnR,EAAS0X,EAAc,OAEzB,OAAO/Y,IAAA6C,cAACsG,cAAW,KACjBnJ,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO,CAACmJ,cAAc,MAAO9E,MAAM,SACvC5D,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO,CAACqJ,KAAK,EAAGF,cAAc,QAClC1I,IAAA6C,cAACoW,mBAAgB,CAACtU,QAAS6N,GACzBxS,IAAA6C,cAACqW,UAAQ,CAACtS,KAAM,GAAIH,KAAK,aAAa5G,MAAOR,UAAOH,GAAOqB,SAG/DP,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO,CAACqJ,KAAK,IACjB5I,IAAA6C,cAACvD,OAAI,CAACC,MAAO,CAAC2F,SAAS,GAAIS,UAAU,WAAYoM,EAAK,aAExD/R,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO,CAACqJ,KAAK,MAErB5I,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO,CAACoJ,aAAc,GAAIhF,OAAQ,EAAGC,MAAO,QAASpE,WAAW,OAAOC,UAAU,2BACrFO,IAAA6C,cAAC2L,UAAY,CAACjP,MAAO,CAACoE,OAAO,GAAIC,MAAM,OAAQ0E,SAAS,IAAKS,eAAe,UAAW3D,MAAO2M,EAAK,QAASpN,QAAS,WAAKwU,IAAUC,UAAUhO,GAASoH,OACvJxS,IAAA6C,cAAC2L,UAAY,CAACjP,MAAO,CAACoE,OAAO,GAAIC,MAAM,OAAQ0E,SAAS,IAAKS,eAAe,UAAW5D,UAAW,CAACtF,MAAM,OAAQuF,MAAO2M,EAAK,UAAWpN,QAAS,WAAKqU,EAAgBd,OAAO5Q,GAAIkL,U,iCCnCvL,iMAiBe,SAAS6G,EAAY9X,GAAoB,IAADqI,EAAjBtC,EAAE/F,EAAF+F,GAC5ByK,EAASC,oBAATD,KACF7S,EAAQC,oBACPkK,EAAQ4I,oBAAR5I,KACChI,EAAa6Q,oBAAb7Q,SACFiY,EAAWxF,kBAAsBzK,GACjClC,EAAe,MAARmS,OAAQ,EAARA,EAAU3O,MAAK,SAAAnI,GAAC,OAAEA,EAAE8E,IAAIA,KAC/BiS,EAASlQ,EAAKlC,MAAQA,IAAkB,OAATyC,EAAAP,EAAKlC,WAAI,EAATyC,EAAWtC,MAAQ,MAAJH,OAAI,EAAJA,EAAMG,IACpD6K,EAAkBxG,wCAClB6G,EAAO,WACXnR,EAASgY,EAAc,OAMzB,OAJA/W,qBAAU,WACFgF,GAAMH,IAASmS,GACnB9G,MACD,CAAC8G,IACGnS,EAAKnH,IAAA6C,cAACsG,cAAW,KACtBnJ,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO,CAACmJ,cAAc,MAAO9E,MAAM,SACvC5D,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO,CAACqJ,KAAK,EAAGF,cAAc,QAClC1I,IAAA6C,cAACoW,mBAAgB,CAACtU,QAAS6N,GACzBxS,IAAA6C,cAACqW,UAAQ,CAACtS,KAAM,GAAIH,KAAK,aAAa5G,MAAOR,UAAOH,GAAOqB,SAG/DP,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO,CAACqJ,KAAK,IACjB5I,IAAA6C,cAACvD,OAAI,CAACC,MAAO,CAAC2F,SAAS,GAAIS,UAAU,WAAYoM,EAAK,aAExD/R,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO,CAACqJ,KAAK,MAErB5I,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO,CAACoJ,aAAc,GAAIhF,OAAQ,EAAGC,MAAO,QAASpE,WAAW,OAAOC,UAAU,2BAEvFO,IAAA6C,cAAC2W,UAAO,CAACjG,SAAUpM,EAAKoM,SAAU9M,KAAMU,EAAKV,KAAMC,OAAQS,EAAKG,KAChEtH,IAAA6C,cAAC2L,UAAY,CAACpJ,MAAO2M,EAAKwH,EAAO,eAAe,YAAa5U,QAAS,WAAK,IAADoO,EACxE,GAAO,MAAJ1J,GAAU,OAAN0J,EAAJ1J,EAAMlC,OAAN4L,EAAYzL,IAAM+B,EAAKyJ,QAAQ,CAAC,IAAD2G,EAC1BzG,EAAqB,CAACvM,KAAK,GAAIqL,KAAK,YAAatK,MAAU,MAAJ6B,GAAU,OAANoQ,EAAJpQ,EAAMlC,WAAF,EAAJsS,EAAYnS,GAAI2L,MAAM5J,EAAKyJ,QAASvL,SAASgS,OAAOvR,EAAUb,EAAKG,IAChI6K,EAAgBjG,OAAO8G,GAAYjF,MAAK,SAAAvL,GAAC,OAAEkM,mBAAS,OAAQ,CAACwE,OAAO,aAAcvE,OAAQ,CAACrH,GAAG9E,EAAE8E,cAGvFtH,IAAA6C,cAAA7C,IAAAuO,SAAA,Q,2JC5CF,mBAACvP,GAAsB,IAAD4K,EACjCoK,EAAwBhU,IAAM4B,WAAkBqS,EAAAnS,IAAAkS,EAAA,GAAzCvN,EAAIwN,EAAA,GAAE5B,EAAO4B,EAAA,GACpBb,EAA2BnB,oBAAnB5I,EAAI+J,EAAJ/J,KAAMgK,EAAQD,EAARC,SACRkG,GAAkB,OAAT3P,EAAAP,EAAKlC,WAAI,EAATyC,EAAWtC,KAAMtI,EAAM0H,OAChCsH,EAAW,WACbuL,GAAUG,oBAAU,CAACpS,GAAGtI,EAAM0H,OAAQD,KAAKA,GAAQ,KAAKkT,SAAQ,WAC5DtH,OAAQrK,GACRqL,EAAS,CAACvB,KAAK,gBAGvB,OAAO9R,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAACqE,MAAM,OAAQD,OAAO,IAAKoF,eAAe,eAAgBR,WAAW,WACrFvI,IAAA6C,cAAC8D,UAAMzG,IAAA,GAAKlB,EAAK,CAAE4H,KAAM,WACjBoB,IAAPvB,EACGzG,IAAA6C,cAACgR,UAAU,CAAC1O,UAAW,CAACS,WAAW,OAAQV,SAAS,IAAKP,QAAS,kBAAI4U,GAAUlH,EAAQrT,EAAMyH,OAAOrB,MAAOpG,EAAMyH,KAAM3B,UAAWyU,IACnIvZ,IAAA6C,cAAC+W,UAAe,CAAC7W,MAAO0D,EAAMlH,MAAO,CAACoG,UAAU,UAAWiN,SAAUP,EAASsG,OAAQ3K,EAAU4K,aAAc5K,IAClHhO,IAAA6C,cAACvD,OAAI,CAACC,MAAO,CAACqG,WAAW,SAAUV,SAAS,KAAMlG,EAAMuU,a,ysBClBhE,IAAMsG,EAAiBC,EAAQ,KAEzBxW,EAAMuW,EAAeE,kBACrBC,EAAmBC,cAAuBnT,MAAM,IAAInE,KAAI,SAACH,EAAG6D,GAAC,OAAK7D,EAAE8D,WAAW,GAAKhD,EAAIgD,WAAWD,IAAI6T,SAAS,IAAIC,SAAS,EAAG,QAAMpT,KAAK,IAC3IqT,EAAMC,UAASC,cAAapX,IAAC,GAAI2W,GAAc,IAAEU,OAAON,iBAExDO,EAAYH,UAASG,UAAUJ,GAErCI,EAAUC,WAAU,SAACC,GACnB,GAAM,iBAAkBhX,QAGnB,GAAgC,YAA5BiX,aAAaC,WAA0B,CAC9C,IAAMvP,EAAcwP,KAAKC,MAAMJ,EAAQhR,KAAkB,aAAG,GAC5D,IAAIiR,aAAaD,EAAQhR,KAAKqR,aAAc,CAAEC,KAASN,EAAQhR,KAAKjD,KAAI,KAAK4E,EAAYD,gBAJzF6P,MAAM,yDAQV,IAmBIC,EAnBEC,EAAe,WAAH,IAAAC,EAAAC,EAAA,OAAAxR,IAAAC,OAAA,SAAAwR,GAAA,cAAAA,EAAAtR,KAAAsR,EAAArR,MAAA,cAAAqR,EAAArR,KAAA,EAAAJ,IAAAK,MACSyQ,aAAaY,qBAAmB,OAAzC,GACG,YADHD,EAAAjR,KACY,CAAAiR,EAAArR,KAAA,gBAAAqR,EAAArR,KAAA,EAAAJ,IAAAK,MACcsR,UAAUC,cAAcC,SAAY/L,uCAAmDqK,IAAkB,OACnF,OADxDoB,EAAyBE,EAAAjR,KAC/BqD,QAAQC,IAAI,gBAAiByN,EAA0BO,OAAOL,EAAArR,KAAA,GAAAJ,IAAAK,MACnCsQ,EAAUoB,SAAS,CAACR,4BAA2BS,SAAUC,yBAAwBC,OAC1G,kBAAAlS,IAAAC,OAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,cAAAF,EAAAE,KAAA,EAAAJ,IAAAK,MAAesQ,EAAUoB,SAAS,CAACR,4BAA2BS,SAAUC,0BAAuB,cAAA/R,EAAAO,OAAA,SAAAP,EAAAM,MAAA,wBAAAN,EAAAQ,UAAA,eAAAC,aAChG,QAIE,GANG6Q,EAAYC,EAAAjR,KAGlB3G,OAAOwK,iBAAiB,gBAAgB,SAAC8N,GACvCA,EAAMC,iBACNb,EAA0Bc,iBAExBb,EAAa,CAADC,EAAArR,KAAA,gBAAAqR,EAAAhR,OAAA,SACP+Q,GAAY,eAAAC,EAAAhR,OAAA,cAEhBtC,GAAS,yBAAAsT,EAAA/Q,UAAA,eAAAC,UAKd2R,EAA0C,GAiC/B,mBAAC9S,GACd,IAAA1H,EAA4BC,mBAAuB,MAAKC,EAAAC,IAAAH,EAAA,GAAjDya,EAAMva,EAAA,GAAEwa,EAASxa,EAAA,GAcxB,OAbAS,qBAAU,WAjCO,IAAM6E,EAAqBmV,EAkCtCjT,EAAKlC,UACKa,IAATkT,GAnCgB/T,EAoCNkC,EAAKlC,KApCsBmV,EAoChBD,EApC+CxS,IAAAC,OAAA,SAAAyS,GAAA,cAAAA,EAAAvS,KAAAuS,EAAAtS,MAAA,OAChD,GAA3BkS,EAAaK,KAAKF,GACS,GAAvBH,EAAazZ,OAAW,CAAA6Z,EAAAtS,KAAA,gBAAAsS,EAAAtS,KAAA,EAAAJ,IAAAK,MACbuS,0BAAgBtV,EAAKG,KAAG,OAAjC,QACSU,KADbkT,EAAIqB,EAAAlS,MACkB,CAAAkS,EAAAtS,KAAA,gBAAAsS,EAAAtS,KAAA,EAAAJ,IAAAK,MACPwS,2BAAiB,CAACvV,KAAKA,EAAKG,GAAIwK,KAAK,MAAOlF,MAAM,QAAM,OAArEsO,EAAIqB,EAAAlS,KAAAkS,EAAAtS,KAAA,iBAEEiR,EAAKtO,OACXuO,IAAepN,MAAK,SAAMnB,GAAK,OAAA/C,IAAAC,OAAA,SAAA6S,GAAA,cAAAA,EAAA3S,KAAA2S,EAAA1S,MAAA,WAC1BiR,EAAK,CAADyB,EAAA1S,KAAA,eAAA0S,EAAA1S,KAAA,EAAAJ,IAAAK,MACQ0S,0BAAe1Z,IAAC,GAAIgY,GAAI,IAAEtO,MAAOA,GAAO,SAAO,OAA5DsO,EAAIyB,EAAAtS,KAAA,OACN8R,EAAaxZ,KAAI,SAAAka,GAAC,IAAAC,EAAA,OAAED,IAAM,OAAJC,EAAA5B,KAAA4B,EAAMlQ,WAAkB,wBAAA+P,EAAApS,UAAA,eAAAC,YAEjD,QACD2R,EAAaxZ,KAAI,SAAAka,GAAC,IAAAE,EAAA,OAAEF,IAAM,OAAJE,EAAA7B,KAAA6B,EAAMnQ,WAAkB,yBAAA2P,EAAAhS,UAAA,eAAAC,WAwB1C6R,IAAUnB,EAAKtO,OACfsO,OAAOlT,EACPmU,EAAe,IAGjBE,GAAU,KAEX,CAAChT,EAAKlC,OACF,CACLiV,SACAC,UAAU,SAACW,GAAe,OA9BT,SAAMZ,GAAc,IAAAa,EAAArQ,EAAA,OAAA/C,IAAAC,OAAA,SAAAoT,GAAA,cAAAA,EAAAlT,KAAAkT,EAAAjT,MAAA,WACnCiR,EAAK,CAADgC,EAAAjT,KAAA,aACHmS,EAAO,CAADc,EAAAjT,KAAA,gBAAAiT,EAAAjT,KAAA,EAAAJ,IAAAK,MACaiR,KAAc,UAAA+B,EAAA9S,GAAA8S,EAAA7S,KAAA6S,EAAA9S,GAAA,CAAA8S,EAAAjT,KAAA,QAAAiT,EAAA9S,GAAI,KAAI,OAA/B,OAALwC,EAAKsQ,EAAA9S,GAAA8S,EAAAjT,KAAA,GAAAJ,IAAAK,MACE0S,0BAAe1Z,IAAC,GAAIgY,GAAI,IAAEtO,YAAO,QAA9CsO,EAAIgC,EAAA7S,KAAA6S,EAAAjT,KAAA,wBAAAiT,EAAAjT,KAAA,GAAAJ,IAAAK,MAGS0S,0BAAe1Z,IAAC,GAAIgY,GAAI,IAAEtO,MAAM,SAAM,QAAnDsO,EAAIgC,EAAA7S,KAAA,eAAA6S,EAAA5S,OAAA,WAGG,OAAJ2S,EAAA/B,KAAA+B,EAAMrQ,QAAgB,yBAAAsQ,EAAA3S,UAAA,eAAAC,SAoBE2S,CAAaH,GAASjP,KAAKsO,O,mTCxFtDe,EAAuB,OAAbC,UAASC,GAAU,SAACC,GAAc7M,SAAS8M,KAAKD,GAAKE,UAAQL,QAE9D,aACX,IAAMle,EAAQC,oBACd,OAAMa,IAAA6C,cAAC1C,UAAI,CAACZ,MAAOme,EAAOC,gBACtB3d,IAAA6C,cAACoW,mBAAgB,CAAC1Z,MAAOme,EAAOE,cAAejZ,QAAS,kBAAIyY,EAAQ,6CAChEpd,IAAA6C,cAACgb,UAAS,CAACpX,KAAK,SAASG,KAAM,GAAI/G,MAAOR,UAAOH,GAAO8B,aAE5DhB,IAAA6C,cAACoW,mBAAgB,CAAC1Z,MAAOme,EAAOE,cAAejZ,QAAS,kBAAI8Y,UAAQL,QAAQ,gCACxEpd,IAAA6C,cAACgb,UAAS,CAACpX,KAAK,OAAOG,KAAM,GAAI/G,MAAOR,UAAOH,GAAO8B,eAK5D0c,EAASnY,UAAWC,OAAO,CAC3BmY,eAAgB,CACd/Z,MAAO,OACP8E,cAAe,MACfK,eAAgB,WAChB+U,cAAe,GACfC,aAAc,IAEhBH,cAAe,CACbrV,WAAY,SACZQ,eAAgB,SAChBnF,MAAO,GACPD,OAAQ,GACR6E,iBAAkB,GAClB9C,YAAa,EACbzE,YAAa,UACbwE,aAAc,MC8CtB,IAAMiY,EAASnY,UAAWC,OAAO,CAC7BwY,gBAAiB,CACfpV,KAAM,EACNvI,gBAAiB,QAEnB4d,aAAc,CACZ1V,WAAY,SACZ2V,WAAY,GACZJ,cAAe,GACfzd,gBAAiB,WAEnB8d,kBAAmB,CACjBva,MAAO,IACPwa,WAAY,WAEdC,kBAAmB,CACjBxV,UAAW,GACXhJ,MAAO,UACPqF,SAAU,IAEZoZ,uBAAwB,CACtBze,MAAO,OACP+F,WAAY,QAEd2Y,cAAe,CACb3V,KAAM,EACNG,eAAgB,gBAChBmV,WAAY,GACZM,qBAAsB,GACtBC,oBAAqB,GACrBpe,gBAAiB,OACjBkI,WAAY,UAEdmW,KAAM,CACJ9a,MAAO,OACP0E,SAAU,KAEZqW,WAAY,CACVhb,OAAQ,GACRC,MAAM,QAERgb,gBAAgB,CACdC,kBAAkB,SAClBhf,MAAM,MACNqF,SAAS,IAEX4Z,WAAY,CACVnb,OAAQ,GACRqB,kBAAmB,GACnB2D,aAAc,GACdtI,gBAAiB,UACjBoF,aAAc,IAEhBsZ,OAAQ,CACNxW,WAAY,SACZQ,eAAgB,SAChBpF,OAAQ,GACRtD,gBAAiB,UACjBoF,aAAc,IAEhBuZ,aAAc,CACZnf,MAAO,OACPqF,SAAU,IAEZ+Z,aAAc,CACZrb,MAAO,OACP0E,SAAU,IACVO,UAAW,IAEbqW,uBAAwB,CACtBxW,cAAe,MACfH,WAAY,UAEd4W,4BAA6B,CAC3BvW,KAAM,EACNhF,MAAO,OACPD,OAAQ,EACRtD,gBAAiB,WAEnB+e,4BAA6B,CAC3B5W,iBAAkB,GAClB3I,MAAO,UACPqF,SAAU,IAEZma,qBAAsB,CACpB3W,cAAe,MACfK,eAAgB,SAChBF,UAAW,IAEbyW,oBAAqB,CACnB/W,WAAY,SACZQ,eAAgB,SAChBnF,MAAO,GACPD,OAAQ,GACR6E,iBAAkB,GAClB9C,YAAa,EACbzE,YAAa,UACbwE,aAAc,IAEhB8Z,kBAAmB,CACjB3b,MAAO,GACPD,OAAQ,GACRya,WAAY,WAEdoB,sBAAuB,CACrBnf,gBAAiB,UACjBY,YAAa,WAEfwe,kBAAmB,CACjB/W,cAAe,MACfH,WAAY,SACZ1I,MAAO,UACPqF,SAAU,IAEZwa,kBAAmB,CACjBhX,cAAe,MACfM,UAAW,SACXnJ,MAAO,UACPqF,SAAU,GACVgE,OAAQ,IAEVyW,kBAAmB,CACjB9f,MAAO,UACPqF,SAAU,GACVU,WAAY,U,2GCtMH,WAAArE,GAAmD,IAAjDqe,EAAIre,EAAJqe,KAAMtb,EAAQ/C,EAAR+C,SACnB,OAAOtE,IAAA6C,cAAC4E,UAAa,CAACI,eAAgB,CAACW,iBAAiB,GAAIH,UAAW,CAACS,QAAQ,IAChF9I,IAAA6C,cAACoW,mBAAgB,CAACtU,QAAS,kBAAI8Y,UAAQL,QAAQwC,EAAKrC,MAAMhe,MAAO,CAACmJ,cAAc,OAAQb,eAAgB,CAACjE,MAAM,SAC1Ggc,EAAKC,OAAS7f,IAAA6C,cAACid,UAAK,CAACC,OAAQ,CAACC,IAAIJ,EAAKC,OAAQzB,WAAW,QAAQ7e,MAAO,CAAEqE,MAAM,OAAQ0E,SAAShE,EAAS,IAAI,IAAK2b,UAAU3b,EAAS,IAAI,IAAKoB,YAAY,KAC7J1F,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO,CAACqJ,KAAK,EAAGJ,iBAAiB,KACvCxI,IAAA6C,cAACvD,OAAI,CAACC,MAAO,CAAC2F,SAAS,KAAM0a,EAAKxa,OAClCpF,IAAA6C,cAACvD,OAAI,CAACC,MAAO,CAAC2F,SAAS,KAAM0a,EAAKtN,aAClCtS,IAAA6C,cAACvD,OAAI,CAACC,MAAO,CAAC2F,SAAS,KAAM0a,EAAKrC,S,mCCZpChR,EAAmBnL,wBAAuE,CAACoI,qBAAgBxB,EAAWsE,gBAAgB,eAE/H8B,EAAoB,SAAH7M,GAAwE,IAAnE+M,EAAO/M,EAAP+M,QAAS9M,EAAQD,EAARC,SAC1C,OAAO8M,EAAQtO,IAAA6C,cAAA7C,IAAAuO,SAAA,MAAMvO,IAAA6C,cAAC2J,4BAAyB,CAACC,KAAM,oBAAqBC,QAASH,EAAkBI,eAAa,GAChHnL,IAIU,aAEb,OADyBgC,qBAAW+I,I,0CCPtCmB,QAAQC,IAAIuS,cAAY,kBAAmB,mBAEpC,IAAMC,EAAkB,CAC9BC,WAAY,CAACF,cAAYrF,KAAKC,MAAMoF,eAAa,CAACG,KAAM,kCAG5CC,EAAqB,CACjCC,UAAW,CACVC,qBAAqB,EACrBC,qBAAqB,EACrBC,wBAAwB,IAIpBC,EAAmB,CAACC,OAAM,EAAMC,MAAM,CAACC,UAAU,KAKjDC,EAAiB,SAACC,EAA6BhQ,GACpD,IAAMiQ,EAAWjQ,EAAQtH,KAAKwX,WACvBC,EAAY,IAAIC,kBAAgBH,GAClCD,IACHtT,QAAQC,IAAI,uBACZqT,EAAGK,gBAAgBF,KAIhBG,EAAmB,SAACtF,EAAWuF,EAA8BC,EAAiBC,GAG7EzF,EAAMmF,WAGZI,EAAY,CAACzP,KAAK,eAAgB0P,WAAU9X,KAAK,CAAC+X,SAAQP,WAAWlF,EAAMmF,cAKtEO,GAAc,SAACC,GACpB,IAAIC,EAAMD,EAAiBE,IAAI/a,MAAM,QAQnC,OAPF8a,EAAI1Q,SAAQ,SAAC/K,EAAYE,GACpB,cAAcyb,KAAK3b,GACtByb,EAAIvb,GAAKF,EAAG,mFACF,mBAAmB2b,KAAK3b,KAClCyb,EAAIvb,IAAE,oBAGC,IAAI0b,wBAAsB,CAC/BjQ,KAAM6P,EAAiB7P,KACvB+P,IAAKD,EAAI7a,KAAK,WAIbib,GAAc,SAAMC,EAA8DV,EAA8BW,EAA2BT,EAAeta,GAAmB,IAAAwa,EAAA,OAAA9X,IAAAC,OAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,OAE9I,OADpCiY,GAAUD,EAAajB,GAAGmB,UAAWD,GAASnY,EAAAK,GACrBsX,GAAW3X,EAAAE,KAAA,EAAAJ,IAAAK,MAAQ+X,EAAajB,GAAGgB,YAAa1B,IAAoB,OAAvE,OAAuEvW,EAAAqY,GAAArY,EAAAM,KAAvFsX,GAAgB,EAAA5X,EAAAK,IAAAL,EAAAqY,IAAArY,EAAAE,KAAA,EAAAJ,IAAAK,MAChB+X,EAAajB,GAAGqB,oBAAqBV,IAAkB,OAC7DJ,EAAY,CAACzP,KAAK,OAAQ0P,SAASS,EAAaT,SAAU9X,KAAK,CAAC+X,SAAQhb,KAAS,MAAJU,OAAI,EAAJA,EAAMV,KAAMya,WAAWS,KAAmB,wBAAA5X,EAAAQ,UAAA,eAAAC,UC7D3G8X,GAAW/c,UAAWC,OAAO,CACzCoC,UAAU,CAAEgB,KAAM,GAClB2Z,IAAI,CAAE3Z,KAAM,EAAGjF,OAAO,QACtB6e,gBAAiB,CAACC,SAAS,WAAYC,OAAO,EAAG3Z,eAAe,YAChE4Z,UAAW,CAAEja,cAAe,MAAOK,eAAgB,gBACnDlC,MAAO,CAACxG,gBAAgB,QAASR,MAAM,QAASmF,kBAAkB,KCFpD,YAAChG,GAAmE,IAAD4jB,EAChFC,EAA2CpZ,IAApCD,EAAeqZ,EAAfrZ,gBACPsZ,EF2DyB,SAACvB,GAC3B,IAAMwB,EAAQC,iBAAsE,IACpFrhB,EAA4BC,qBAAkBC,EAAAC,IAAAH,EAAA,GAAvCshB,EAAMphB,EAAA,GAAEqhB,EAASrhB,EAAA,GACxBK,EAA6BN,qBAAuBO,EAAAL,IAAAI,EAAA,GAA7CihB,EAAOhhB,EAAA,GAAEihB,EAASjhB,EAAA,GACnBkhB,EAASC,mBAAQ,mBAAIH,IAAoB,CAACA,IAC1CI,EAAgBC,sBAAYxjB,IAAMyjB,MAAK,SAAAliB,GAAA,IAAEhC,EAAKgC,EAALhC,MAAK,OAAiB4jB,EAAQnjB,IAAA6C,cAAC6gB,UAAO,CAACxB,OAAQiB,EAAS5jB,MAAOA,EAAOokB,WAAY,CAAChgB,OAAO,UAAY3D,IAAA6C,cAAA7C,IAAAuO,SAAA,SAAU,CAAC4U,IA+BhK,MAAO,CACNS,MA/BaJ,uBAAY,SAAMrc,EAAoB+a,EAA4B2B,GAAwB,IAAAC,EAAA,OAAAja,IAAAC,OAAA,SAAAwR,GAAA,cAAAA,EAAAtR,KAAAsR,EAAArR,MAAA,OAClF,GAArByD,QAAQC,IAAI,SACPwV,QAAkBnb,IAAP6b,EAAgB,CAAAvI,EAAArR,KAAA,YAAAqR,EAAAtR,KAAA,EAGnB,UAAR6Z,EAAgB,CAAAvI,EAAArR,KAAA,eAAAqR,EAAArR,KAAA,EAAAJ,IAAAK,MACA6Z,eAAaC,aAAarD,IAAiB,OAA7DmD,EAASxI,EAAAjR,KAAAiR,EAAArR,KAAA,mBAEO,WAAR4Z,EAAiB,CAAAvI,EAAArR,KAAA,gBAAAqR,EAAArR,KAAA,GAAAJ,IAAAK,MACP6Z,eAAaE,gBAAgBtD,IAAiB,QAAhEmD,EAASxI,EAAAjR,KAAAiR,EAAArR,KAAA,iBAGS,GAHTqR,EAAAlR,GAGG8X,EAAM5G,EAAAlR,GAAA,CAAAkR,EAAArR,KAAA,gBAAAqR,EAAArR,KAAA,GAAAJ,IAAAK,MAAU6Z,eAAaC,aAAarD,GAAkB5E,OAAM,SAACtO,GAAK,OAAGsW,eAAaE,gBAAgBtD,OAAkB,QAAArF,EAAAlR,GAAAkR,EAAAjR,KAAC,KAAD,GAAtIyZ,EAASxI,EAAAlR,GAAA,QAEVgZ,EAAUU,GACV7S,OAAOkD,QAAQ4O,EAAMjU,SAASnM,KAAI,SAAA0L,GAAW,IAAD6V,EAAApiB,IAAAuM,EAAA,GAAL7L,GAAF0hB,EAAA,GAAGA,EAAA,IACvClC,GAAYxf,EAAG+e,EAAauC,EAAW,QAAS3c,MAC/CmU,EAAArR,KAAA,iBAAAqR,EAAAtR,KAAA,GAAAsR,EAAA8G,GAAA9G,EAAA,SAEF5N,QAAQyW,MAAK7I,EAAA8G,IAAI,yBAAA9G,EAAA/Q,UAAA,mBAAAC,WAGjB,CAAC2Y,IAUH5Y,KATYiZ,uBAAY,WACxB9V,QAAQC,IAAI,QACTwV,IACFA,EAAQiB,YAAYzhB,KAAI,SAAC0hB,GAAS,OAAKA,EAAM9Z,UAC7C6Y,OAAUpb,MAET,CAACmb,IAIHmB,mBAAoB,SAAMC,EAAcpd,GAAkB,IAAA2K,EAAA0S,EAAAC,EAAAC,EAAAC,EAAA,OAAA9a,IAAAC,OAAA,SAAA6S,GAAA,cAAAA,EAAA3S,KAAA2S,EAAA1S,MAAA,OAWxD,GATW,eADR6H,EAAOyS,EAASzS,OAEnBoR,EAAUqB,EAAS7a,KAAKqR,cAEb,SAARjJ,GAAyC,QAAtByS,EAAS7a,KAAK+X,SACnC/T,QAAQC,IAAI,YACN6W,EAAiB,IAAII,oBAAmBzE,IAC/BjS,iBAAkB,gBAAgB,SAAC8N,GAAS,OAAKsF,EAAiBtF,EAAOuF,EAAagD,EAAStB,OAAQ,YACtHF,EAAMjU,QAAQyV,EAAStB,QAAU,CAACjC,GAAGwD,EAAgBhD,SAAU+C,EAAStB,QACxEjB,GAAYe,EAAMjU,QAAQyV,EAAStB,QAAS1B,EAAa4B,EAAS,QAAShc,IAGjE,UAAR2K,GAA4C,QAAxByS,EAAS7a,KAAK+X,OAAgB,CAAA9E,EAAA1S,KAAA,QAGyB,OAF7EyD,QAAQC,IAAI,YACN6W,EAAiBzB,EAAMjU,QAAQyV,EAAStB,QAAQjC,GAChD0D,EAAoB,IAAI3C,wBAAsBwC,EAAS7a,KAAKwX,YAAWvE,EAAA1S,KAAA,EAAAJ,IAAAK,MACvEsa,EAAeK,qBAAsBH,IAAmB,OAIpD,gBAAR5S,GAAgD,QAAtByS,EAAS7a,KAAK+X,SACrC+C,EAAiBzB,EAAMjU,QAAQyV,EAAStB,QAAQjC,GACtDD,EAAeyD,EAAgBD,IAC/B,yBAAA5H,EAAApS,UAAA,eAAAC,UAEF+Y,gBACAF,SACAJ,UE9HiE6B,CAD1BjC,EAAfvW,iBACjBsX,EAAKd,EAALc,MAAOrZ,EAAIuY,EAAJvY,KAAM+Z,EAAkBxB,EAAlBwB,mBAAoBf,EAAaT,EAAbS,cAAeF,EAAMP,EAANO,OAavD,OAZA/gB,qBAAU,WACRtD,EAAMmI,MAAQqC,GAAmB8a,EAAmB9a,EAAiBxK,EAAMmI,QAC1E,CAACqC,EAAiBxK,EAAMmI,OAC3B7E,qBAAU,WAOR,OANGtD,EAAM6kB,OAASR,EAChBrkB,EAAMmI,MAAQyc,EAAM5kB,EAAMmI,UAAMa,EAAWhJ,EAAM6kB,MAE9B,OAAb7kB,EAAM6kB,MAAeR,GAC3B9Y,IAEK,WAAK8Y,GAAU9Y,OACrB,CAAC8Y,EAAQrkB,EAAMmI,KAAMnI,EAAM6kB,OAE5B7jB,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO+iB,GAAS1a,WACpB5H,IAAA6C,cAAC0gB,EAAa,CAAChkB,MAAO+iB,GAASC,MAC/BviB,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO+iB,GAASE,iBACpBxiB,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO+iB,GAASK,YAEtB3iB,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAACmJ,cAAc,QAAQ1I,IAAA6C,cAACvD,UAAI,CAACC,MAAO+iB,GAASzb,OAAkB,OAAZ+b,EAAE5jB,EAAMmI,WAAI,EAAVyb,EAAYnc,OAC9EzG,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO+iB,GAASK,gBACJ3a,IAAfhJ,EAAM6kB,OAAuBR,GAAUrjB,IAAA6C,cAACkiB,UAAM,CAAC3f,MAAM,QAAQT,QAAS,kBAAI3F,EAAMmI,MAAQyc,EAAM5kB,EAAMmI,cACrFa,IAAfhJ,EAAM6kB,MAAsBR,GAAUrjB,IAAA6C,cAACkiB,UAAM,CAAC3f,MAAM,OAAOT,QAAS4F,QCzBhE,YAACvL,GACd,IAAA2C,EAAgCC,mBAAS,IAAGC,EAAAC,IAAAH,EAAA,GAArC6f,EAAQ3f,EAAA,GAAEmjB,EAAWnjB,EAAA,GAC5BghB,EAA2CpZ,IAApCD,EAAeqZ,EAAfrZ,gBACPyb,EHmI0B,SAAC1D,GAC5B,IAAMwB,EAAQC,iBAAsE,IACpFkC,EAAwBtjB,qBAAyBujB,EAAArjB,IAAAojB,EAAA,GAA1C/d,EAAIge,EAAA,GAAEC,EAAOD,EAAA,GACpBE,EAA6BzjB,qBAAuB0jB,EAAAxjB,IAAAujB,EAAA,GAA7ClC,EAAOmC,EAAA,GAAElC,EAASkC,EAAA,GACnB/B,EAAgBC,sBAAYxjB,IAAMyjB,MAAK,SAAClkB,GAAS,OAAG4jB,EAAQnjB,IAAA6C,cAAC6gB,UAAO,CAACxB,OAAQiB,EAAS5jB,MAAOA,EAAOokB,WAAY,CAAChgB,OAAO,UAAY3D,IAAA6C,cAAA7C,IAAAuO,SAAA,SAAQ,CAAC4U,IAC7IE,EAASC,mBAAQ,mBAAIH,IAAoB,CAACA,IAC1CS,EAAQJ,uBAAY,SAAChC,GAC1B9T,QAAQC,IAAI,SACPoV,EAAMjU,QAAQkS,KACjB+B,EAAMjU,QAAQkS,GAAK,IAAI4D,oBAAmBzE,GAC1C4C,EAAMjU,QAAQ0S,SAAWA,GAEtB2B,GACJ5B,EAAY,CAACzP,KAAK,QAAS0P,WAAU9X,KAAK,CAAC,OAAU,YAEpD,CAACyZ,IACE5Y,EAAO,WACZmD,QAAQC,IAAI,QACRoV,EAAMjU,QAAQkS,KAEhBoC,OAAUpb,GACV+a,EAAMjU,QAAQkS,GAAGuE,QACjBxC,EAAMjU,QAAQkS,QAAKhZ,EACnB+a,EAAMjU,QAAQ0S,cAAWxZ,EACzBwd,cAAczC,EAAMjU,QAAQ2W,iBAG/B,MAAO,CACN7B,QACArZ,OACA+Z,mBAAoB,SAAMC,GAAY,IAAAmB,EAAAC,EAAAC,EAAAC,EAAA/T,EAAA0S,EAAAE,EAAAoB,EAAAC,EAAApE,EAAAqE,EAAAC,EAAA,OAAApc,IAAAC,OAAA,SAAAoT,GAAA,cAAAA,EAAAlT,KAAAkT,EAAAjT,MAAA,OACZ,GACb,UADR6H,EAAOyS,EAASzS,OACyB,SAAtByS,EAAS7a,KAAK+X,QAAmB8C,EAAStB,SAAuB,OAAjByC,EAAI3C,EAAMjU,cAAO,EAAb4W,EAAelE,UAAQ,CAAAtE,EAAAjT,KAAA,SAuC9F,OAtCHyD,QAAQC,IAAI,mBACN6W,EAAiBzB,EAAMjU,QAAQkS,GACrCoE,EAAQ,CAAC3e,KAAM8d,EAAS7a,KAAKjD,OAC7B+d,EAAetW,iBAAiB,gBAAgB,SAAC8N,GAAS,OAAKsF,EAAiBtF,EAAOuF,EAAagD,EAAStB,OAAQ,WACrHuB,EAAetW,iBAAiB,4BAA4B,SAACT,GAC5D,GAA2C,aAAvCsV,EAAMjU,QAAQkS,GAAGkF,mBAAkC,CACtD,IAAIC,GAAe,EACnBpD,EAAMjU,QAAQ2W,cAAgBW,aAAY,eAAAC,EAAAC,EAAAC,EAAA,OAAA1c,IAAAC,OAAA,SAAAyS,GAAA,cAAAA,EAAAvS,KAAAuS,EAAAtS,MAAA,cAAAsS,EAAAtS,KAAA,EAAAJ,IAAAK,MACrB6Y,EAAMjU,QAAQkS,GAAGwF,SAAS,OAAK,OAA7CH,EAAK9J,EAAAlS,KACPic,EAAc,GACdC,OAAiBve,EACrBqe,EAAMnV,SAAQ,SAACuV,GACM,gBAAhBA,EAAO3U,MAA0C,UAAhB2U,EAAOC,OAC3CzV,OAAO0V,KAAKF,GAAQvV,SAAQ,SAAC0V,GAC5BN,GAAkBM,EAAQ,KAAKH,EAAOG,GAAS,QAEhDL,EAAiBE,EAAOI,oBAG1BnZ,QAAQC,IAAIwY,EAAcI,QACJve,GAAlBue,EACHJ,GAAe,EAEPA,GACR5b,IAEDmD,QAAQC,KAAI,IAAImZ,MAAOC,eAAejgB,MAAM,KAAK,GAAIwf,GAAY,wBAAA/J,EAAAhS,UAAA,eAAAC,WAC/D,SAE4C,UAAvCuY,EAAMjU,QAAQkS,GAAGkF,oBACzB3b,OAMFia,EAAewC,eAAe,QAAS,CACtCC,UAAW,aACT/J,EAAAjT,KAAA,GAAAJ,IAAAK,MACG8X,GAAY,CAAChB,GAAG+B,EAAMjU,QAAQkS,GAAIQ,SAAS+C,EAAStB,QAAS1B,EAAa4B,EAAS,OAAQhc,IAAK,WAE3F,UAAR2K,GAA0C,SAAtByS,EAAS7a,KAAK+X,QAAmB8C,EAAStB,SAAuB,OAAjB0C,EAAI5C,EAAMjU,cAAO,EAAb6W,EAAenE,UAAQ,CAAAtE,EAAAjT,KAAA,SAErB,OAD7EyD,QAAQC,IAAI,oBACN+W,EAAoB,IAAI3C,wBAAsBwC,EAAS7a,KAAKwX,YAAWhE,EAAAjT,KAAA,GAAAJ,IAAAK,MACvE6Y,EAAMjU,QAAQkS,GAAG6D,qBAAsBH,IAAmB,QAC1DoB,EAAU/C,EAAMjU,QAAQkS,GAAGkG,mBACjC9D,EAAU0C,EAAQA,EAAQpjB,OAAS,IACnC6e,EAAY,CAACzP,KAAK,MAAO0P,SAASuB,EAAMjU,QAAQ0S,SAAU9X,KAAK,KAAI,WAExD,QAARoI,GAAkByS,EAAStB,SAAuB,OAAjB2C,EAAI7C,EAAMjU,cAAO,EAAb8W,EAAepE,UAAQ,CAAAtE,EAAAjT,KAAA,SAG5B,GAFlCyD,QAAQC,IAAI,UACN6W,EAAiBzB,EAAMjU,QAAQkS,GACrCoE,EAAQ,CAAC3e,KAAK8d,EAAS7a,KAAKjD,OACvB+d,EAAe,CAADtH,EAAAjT,KAAA,gBAAAiT,EAAA5S,OAAA,kBAGyD,OAD5Eka,EAAetW,iBAAkB,gBAAgB,SAAC8N,GAAS,OAAKsF,EAAiBtF,EAAOuF,EAAagD,EAAStB,OAAQ,WAChHtB,EAAmB,IAAII,wBAAsBwC,EAAS7a,KAAKwX,YAAWhE,EAAAjT,KAAA,GAAAJ,IAAAK,MACtEsa,EAAeK,qBAAsBlD,IAAkB,eAAAzE,EAAAjT,KAAA,GAAAJ,IAAAK,MAC7Bsa,EAAe2C,aAAc7G,IAAoB,QAA1D,OAAjBoE,EAAiBxH,EAAA7S,KAAA6S,EAAAjT,KAAA,GAAAJ,IAAAK,MACjBsa,EAAenC,oBAAqBqC,IAAmB,QAC7DnD,EAAY,CAACzP,KAAK,SAAU0P,SAASuB,EAAMjU,QAAQ0S,SAAU9X,KAAK,CAAC+X,OAAO,OAAQP,WAAWsD,EAAe4C,oBAEtGtB,EAAU/C,EAAMjU,QAAQkS,GAAGkG,mBACjC9D,EAAU0C,EAAQA,EAAQpjB,OAAS,IAAG,QAE5B,gBAARoP,GAAgD,SAAtByS,EAAS7a,KAAK+X,QAAmB8C,EAAStB,SAAuB,OAAjB4C,EAAI9C,EAAMjU,cAAO,EAAb+W,EAAerE,WAC/FT,EAAegC,EAAMjU,QAAQkS,GAAIuD,GAAS,yBAAArH,EAAA3S,UAAA,eAAAC,UAE7C+Y,gBACApc,OACAkc,UG1OuEgE,CADhCxE,EAAfvW,iBACjBsX,EAAKqB,EAALrB,MAAOrZ,EAAI0a,EAAJ1a,KAAM+Z,EAAkBW,EAAlBX,mBAAoBf,EAAa0B,EAAb1B,cAAeF,EAAM4B,EAAN5B,OAAQlc,EAAI8d,EAAJ9d,KAU/D,OATA7E,qBAAU,WACRkH,GAAmB8a,EAAmB9a,KACrC,CAACA,IACJlH,qBAAU,WAIR,OAHGtD,EAAMwiB,UACPoC,EAAM5kB,EAAMwiB,UAEP,kBAAIjX,OACV,CAACvL,EAAMwiB,WAERxhB,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO+iB,GAAS1a,WACpB5H,IAAA6C,cAAC0gB,EAAa,CAAChkB,MAAO+iB,GAASC,MAC/BviB,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO+iB,GAASE,iBACpBxiB,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO+iB,GAASK,YAEtB3iB,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAACmJ,cAAc,QACzB1J,EAAMwiB,UAAY6B,EACnBrjB,IAAA6C,cAACvD,UAAI,CAACC,MAAO+iB,GAASzb,QAAY,MAAJM,OAAI,EAAJA,EAAMV,OAAQ,cAC5CzG,IAAA6C,cAAA7C,IAAAuO,SAAA,KACEvO,IAAA6C,cAACvD,UAAI,CAACC,MAAO,CAACmG,YAAY,IAAI,iBAC9B1F,IAAA6C,cAACwV,UAAS,CAAC9Y,MAAO,CAACmG,YAAY,EAAGkD,KAAK,GAAI7F,MAAOye,EAAUjJ,aAAcyM,MAG9EhlB,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO+iB,GAASK,gBACA3a,IAAnBhJ,EAAMwiB,WAA2B6B,GAAUrjB,IAAA6C,cAACkiB,UAAM,CAAC3f,MAAM,QAAQT,QAAS,kBAAIif,EAAMpC,WACjExZ,IAAnBhJ,EAAMwiB,UAA0B6B,GAAUrjB,IAAA6C,cAACkiB,UAAM,CAAC3f,MAAM,OAAOT,QAAS4F,Q,oBChB7E+c,GAAY,SAACtoB,GAOjB,OAAOgB,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAAC,CAAC+I,SAAStJ,EAAMuoB,MAAOtH,UAAUjhB,EAAMuoB,MAAO7hB,YAAY,EAAGzE,YAAY5B,UAAO4B,YAAaZ,gBAAgB,OAAQqI,cAAc,MAAO8e,SAAS,QAAyBxf,GAApBhJ,EAAMyoB,YAA2BzoB,EAAMyoB,YAAczoB,EAAMwiB,SAAU,CAAC7d,OAAO,QAAQ,CAAC2E,SAAS,EAAG3E,OAAO,KACpR3D,IAAA6C,cAACoW,mBAAgB,CAAC1Z,MAAO,CAACqJ,KAAK,GAAIf,eAAgB,CAACe,KAAK,EAAGG,eAAe,UAAWpE,QAAS,kBAAI3F,EAAM0oB,cAAc1oB,EAAMyoB,gBAAWzf,EAAUhJ,EAAMwiB,YACvJxiB,EAAMwC,YAOLmmB,GAAqB,SAAHpmB,GAAwD,IAADqI,EAAlDyH,EAAU9P,EAAV8P,WAAY/C,EAAO/M,EAAP+M,QAASsZ,EAAUrmB,EAAVqmB,WACzCve,EAAQ4I,oBAAR5I,KACD/E,EAAWujB,oBACjBlmB,EAAkCC,mBAAoB,MAAKC,EAAAC,IAAAH,EAAA,GAApDmmB,EAASjmB,EAAA,GAAEkmB,EAAYlmB,EAAA,GAC9BK,EAA4BN,mBAAmB,IAAGO,EAAAL,IAAAI,EAAA,GAA3C8lB,EAAM7lB,EAAA,GAAE8lB,EAAS9lB,EAAA,GACxB+iB,EAAoCtjB,qBAAkBujB,EAAArjB,IAAAojB,EAAA,GAA/CuC,EAAUtC,EAAA,GAAEuC,EAAavC,EAAA,GAC1BnjB,EAAaC,qBACnBimB,EAA6CC,IAArC3e,EAAe0e,EAAf1e,gBAAiB8C,EAAe4b,EAAf5b,gBACzBhK,qBAAU,WACR,GAAqB,MAAlBkH,IAC2B,cAAzBA,EAAsB,MACvB8C,EAAgB,CAAC,KAAO,YAAa,KAAO,CAAC,WAAa+E,KAEhC,mBAAzB7H,EAAsB,MAAiD,kBAAzBA,EAAsB,MACrEye,EAAU,GAADrd,OAAAC,IAAKmd,GAAM,CAAExe,EAAwB,UAEpB,wBAAzBA,EAAsB,MAA0B,CACjD,IAAMuR,EAAevR,EAAwB,OAC/Bwe,EAAOrd,MAAK,SAAAnI,GAAC,OAAEA,GAAKuY,MACzBkN,EAAUD,EAAOzlB,QAAO,SAAAC,GAAC,OAAEA,GAAKuY,SAG5C,CAACvR,IACJ,IAAM+d,EAAQE,EAAW,OAAU,IAAMxhB,KAAKD,IAAI,EAAGC,KAAKmiB,KAAKniB,KAAKoiB,KAAKL,EAAOtlB,OAAS,KAAI,IACvF4lB,EAAkB,SAACzE,GACvBkE,EAAaD,GAAWjE,EAAKA,EAAK,OAEpC,YAA0B7b,IAAnBwB,EACLxJ,IAAA6C,cAAC0lB,OAAU,CAAChpB,MAAO,CACjB,CAACipB,YAAala,EAAa,EAAL,GAAG,EAAKrN,YAAY5B,UAAO4B,YAAawE,aAAa,IAC/D,aAAZzD,EAAwB,CAACiH,WAAW,EAAGue,SAAS,EAAG7jB,OAAO,OAAQ8kB,gBAAgB,EAAG3K,cAAc,IAAI,CAACmC,UAAU,MAAOrc,MAAM,OAAQ8S,kBAAkB,KAEzJ1W,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAACipB,YAAYf,OAAWzf,EAAU,GAAG,EAAG3H,gBAAgB,QAASqoB,SAAS,OAAQhgB,cAAc,MAAO9E,MAAM,OAAQD,OAAO,SACtIqkB,EAAOrlB,KAAI,SAAC6e,EAAUnb,GAAC,OAAGrG,IAAA6C,cAACykB,GAAS,CAACC,MAAOA,EAAOE,WAAYA,EAAYC,cAAeA,EAAelG,SAAUA,GAClHxhB,IAAA6C,cAAC8lB,GAAS,CAACnH,SAAUA,QAGvBxhB,IAAA6C,cAACykB,GAAS,CAACC,MAAOA,EAAOE,WAAYA,EAAYC,cAAeA,EAAelG,SAAmB,OAAX5X,EAAEP,EAAKlC,WAAI,EAATyC,EAAWnD,MAClGzG,IAAA6C,cAAC+lB,GAAQ,CAACzhB,KAAMkC,EAAKlC,KAAM0c,KAAMiE,MAGrC9nB,IAAA6C,cAAC0lB,OAAU,CAAChpB,MAAO,CACf,CAACkjB,SAAS,WAAYla,WAAW,SAAUQ,eAAe,WAAYnF,MAAM,OAAO8E,cAAc,OACrF,aAAZ1G,EAAwB,CAAC0gB,OAAO,EAAGxE,WAAW,GAAIJ,cAAc,GAAI9Y,kBAAkB,IAAI,CAAC3E,gBAAgB,iBAE7GL,IAAA6C,cAAC2L,UAAY,CAACpJ,MAAO,eAAM7F,MAAO,CAACoE,OAAO,GAAIua,WAAW,GAAIvZ,QAAS,kBAAI2jB,EAAgB,cACxFhkB,GAAYtE,IAAA6C,cAAC2L,UAAY,CAACpJ,MAAO,qBAAO7F,MAAO,CAACoE,OAAO,GAAIua,WAAW,GAAIvZ,QAAS,kBAAI2jB,EAAgB,cACzGtoB,IAAA6C,cAAC2L,UAAY,CAACpJ,MAAO,GAAI7F,MAAO,CAACoE,OAAO,GAAIua,WAAW,GAAIvZ,QAAS,kBAAIijB,GAAW,KACjF5nB,IAAA6C,cAACqW,WAAQ,CAACtS,KAAM,GAAIH,KAAK,aAAa5G,MAAO,mBAIrDG,IAAA6C,cAAA7C,IAAAuO,SAAA,OAGavO,OAAMyjB,MAAK,SAAApV,GAAqD,IAAnDgD,EAAUhD,EAAVgD,WAAY/C,EAAOD,EAAPC,QAASsZ,EAAUvZ,EAAVuZ,WAC/C,OAAO5nB,IAAA6C,cAACgmB,EAAW,CAACva,QAASA,GAC3BtO,IAAA6C,cAAC8kB,GAAkB,CAACtW,WAAYA,EAAY/C,QAASA,EAASsZ,WAAYA,Q,UC3E/D,gBAAArmB,GAAmF,IAAjFunB,EAAIvnB,EAAJunB,KAAgBC,GAAFxnB,EAAR+C,SAAoB/C,EAAVwnB,YACvB7pB,EAAQC,oBACd,OAAOa,IAAA6C,cAAC4E,UAAa,CAACI,eAAgB,CAACW,iBAAiB,GAAIH,UAAW0gB,EAAW,CAACjgB,QAAQ,IAAI,CAACpD,YAAY,EAAGoD,QAAQ,IACvH9I,IAAA6C,cAACoW,mBAAgB,CAACtU,QAAS,kBAAI8Y,UAAQL,QAAQ0L,EAAKA,OAAOvpB,MAAO,CAACmJ,cAAc,MAAOH,WAAW,cAAeV,eAAgB,CAACjE,MAAM,SACrI5D,IAAA6C,cAACmmB,WAAW,CAACviB,KAAK,SAASG,KAAM,GAAI/G,MAAOR,UAAOH,GAAO8B,YAC1DhB,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO,CAACqJ,KAAK,EAAGJ,iBAAiB,KACnCxI,IAAA6C,cAACvD,OAAI,CAACC,MAAO,CAAC2F,SAAS,KAAM4jB,EAAKG,UAClCjpB,IAAA6C,cAACvD,OAAI,CAACC,MAAO,CAAC2F,SAAS,KAbnC,SAAuB0B,GACnB,IAAIP,EAAY,GAARO,EAAY,EAAIX,KAAKC,MAAMD,KAAK0H,IAAI/G,GAAQX,KAAK0H,IAAI,OAC7D,OAAQ/G,EAAOX,KAAKijB,IAAI,KAAM7iB,IAAI8iB,QAAQ,GAAK,IAAM,CAAC,IAAK,KAAM,KAAM,KAAM,MAAM9iB,GAW9C+iB,CAAcN,EAAKO,e,gFCV5D,SAASC,GAAarmB,EAAesmB,GACjC,OAAItmB,EAAEumB,QAAUD,EAAIC,OACTvmB,EAAEwmB,OAAO,WAEjBxmB,EAAEymB,SAAUH,EAAIG,SAAWzmB,EAAE0mB,OAASJ,EAAII,MAClC1mB,EAAEwmB,OAAO,SAEbxmB,EAAEwmB,OAAO,SAGb,SAASG,GAAcC,GAC1B,OAAOC,KAAMD,GAAOJ,OAAO,oBAG/B,IAAMM,GAAW,SAAC/qB,GACd,IAAM4kB,EAAQkG,KAAM9qB,EAAM0K,KAAK4B,SACzB0e,EAAMF,KAAM9qB,EAAM0K,KAAKmgB,OACvBI,EAASrG,EAAMsG,KAAKlrB,EAAMuqB,KAAK3F,EAAMsG,KAAKF,GAChD,OAAOhqB,IAAA6C,cAACoW,UAAgB,CAACtU,QAAS,kBAAI3F,EAAMmrB,UAAUnrB,EAAMorB,cAASpiB,EAAUhJ,EAAM0K,KAAKpC,MACtFtH,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAACc,gBAAgB,YAAaoF,aAAa,GAAI4kB,SAAS,SAAUnhB,OAAO,IAClFlJ,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAACc,gBAAgB,WAAYoiB,SAAS,WAAY7e,MAAe,IAANqmB,EAAS,IAAKtmB,OAAO,UAC5F3E,EAAMorB,SACPpqB,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAACwF,gBAAgB,EAAGC,kBAAkB,EAAGsD,SAAS,MAC3DtI,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAACmJ,cAAc,QACxB1I,IAAA6C,cAAC8D,UAAM,CAACF,KAAMzH,EAAM0K,KAAKjD,KAAMC,OAAQ1H,EAAM0K,KAAKvC,KAAMP,KAAM,KAC9D5G,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAACyF,kBAAkB,IAAIhF,IAAA6C,cAACvD,OAAI,KAAEN,EAAM0K,KAAKjD,QAE1DzG,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAACmJ,cAAc,MAAOH,WAAW,YAC1CvI,IAAA6C,cAACvD,OAAI,KAAC,UACNU,IAAA6C,cAACvD,OAAI,CAAC2F,YAAU,GAAE2kB,GAAc5qB,EAAM0K,KAAKmgB,SAG/C7pB,IAAA6C,cAACynB,UAAS,CAACC,aAAc,EAAOhrB,MAAO,CAACirB,UAAU,cAAeC,UAAW,CAAC5qB,MAAO,YAChFG,IAAA6C,cAACvD,OAAI,CAAC2F,YAAU,GAAEjG,EAAM0K,KAAK2B,YAAY,GAAGD,WAGpDpL,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAACwF,gBAAgB,EAAGC,kBAAkB,EAAG0D,cAAc,QAChE1I,IAAA6C,cAAC8D,UAAM,CAACF,KAAMzH,EAAM0K,KAAKjD,KAAMC,OAAQ1H,EAAM0K,KAAKvC,KAAMP,KAAM,KAC9D5G,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAACyF,kBAAkB,IAAIhF,IAAA6C,cAACvD,OAAI,KAAEgqB,GAAaU,EAAKhrB,EAAMuqB,WAOpE,YAACvqB,GACZ,IAAM0rB,ECpDK,SAAoCrZ,GACjD,IAAM/H,EAAcC,4BACZG,EAASC,oBACf,CAAC,0BAA2B0H,IAC5B,kBAAAxH,IAAAC,OAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,cAAAF,EAAAE,KAAA,EAAAJ,IAAAK,MAAeygB,sCAA2BtZ,EAAYyY,OAAQc,gBAAc,cAAA7gB,EAAAO,OAAA,SAAAP,EAAAM,MAAA,wBAAAN,EAAAQ,UAAA,eAAAC,YAFtEd,KAIAF,EAAoBC,oBAApBD,gBACRlH,qBAAU,WACa,MAAlBkH,GAA0BA,EAAsB,KAAW,SAAK6H,IACrC,gBAAzB7H,EAAsB,MACpBA,EAAsB,KAAS,OAAKsgB,OAAUA,KAAMtgB,EAAsB,KAAS,QACpFF,EAAYmB,aAAiC,CAAC,0BAA2B4G,IAAa,SAAC3G,GACrF,MAAM,GAANE,OAAAC,IAAYH,GAAS,IAAI,CAAClB,EAAsB,UAG1B,kBAAzBA,EAAsB,MACvBF,EAAYmB,aAAiC,CAAC,0BAA2B4G,IAAa,SAAC3G,GACrF,OAAAG,KAAiB,MAALH,OAAK,EAALA,EAAOnI,QAAO,SAAAC,GAAC,OAAEA,EAAE8E,IAAIkC,EAAsB,KAAElC,QAAO,UAIvE,CAACkC,IACJ,IAAMqhB,EAASvH,mBAAQ,kBAAQ,MAAJ5Z,OAAI,EAAJA,EAAMoB,MAAK,SAACC,EAAGC,GAAC,OAAID,EAAE8e,OAAS,KAAO7e,EAAE6e,OAAS,IAAI,GAAG,OAAI,CAACngB,IAaxF,OAZApH,qBAAU,WAAK,IAADwoB,EACZ,GAAU,MAAND,GAAW,OAALC,EAAND,EAAS,KAATC,EAAajB,MAAM,CACrB,IAAMviB,EAAKujB,EAAO,GAAGvjB,GACfyjB,EAAK9kB,KAAKF,IAAI+jB,KAAMe,EAAO,GAAGhB,OAAOK,KAAKJ,QAAUkB,OAAOC,WAC7DC,EAAUC,YAAW,WACvB7hB,EAAYmB,aAAiC,CAAC,0BAA2B4G,IAAa,SAAC3G,GACrF,OAAQA,GAAS,IAAInI,QAAO,SAAAC,GAAC,OAAEA,EAAE8E,IAAIA,GAAMwiB,KAAMtnB,EAAEqnB,OAAOK,KAAKJ,QAAW,UAE3EiB,GACH,OAAO,kBAAIK,aAAaF,OAE1B,CAACL,IACIA,EDiBiBQ,CAA2BrsB,EAAMqS,YACvD1P,EAAsBC,mBAASkoB,QAAQjoB,EAAAC,IAAAH,EAAA,GAAhC4nB,EAAG1nB,EAAA,GAAEypB,EAAMzpB,EAAA,GAClBK,EAA4BN,qBAAkBO,EAAAL,IAAAI,EAAA,GAAvCqpB,EAAMppB,EAAA,GAAEgoB,EAAShoB,EAAA,GAOxB,OANAG,qBAAU,WACN,IAAM4oB,EAAUC,YAAW,WACvBG,EAAOxB,UACR,KACH,OAAO,kBAAIsB,aAAaF,MACzB,CAAC3B,IACGvpB,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAACmJ,cAAc,MAAOwV,WAAW,EAAGlZ,kBAAkB,KACxD,MAAb0lB,OAAa,EAAbA,EAAe/nB,KAAI,SAACH,EAAE6D,GAAC,OAAGrG,IAAA6C,cAACknB,GAAQ,CAACzmB,IAAK+C,EAAGqD,KAAMlH,EAAG+mB,IAAKA,EAAKa,SAAU5nB,EAAE8E,IAAIikB,EAAQpB,UAAWA,S,oBErB3G,IAAMqB,GAA2BxrB,IAAMyjB,MAAK,SAACzkB,GAIzC,IAJ2F,IAADysB,EACtFnnB,EAAWujB,oBACTxmB,EAAa6Q,qBAAb7Q,SACJqqB,EAAW1sB,EAAMiL,KACL,OAAR0hB,EAAAD,IAAAC,EAAU1hB,MAAiC,GAAzByhB,EAAS5c,QAAQpM,QAAU,CAAC,IAADipB,EACjDD,EAAWA,EAASzhB,KAEtB,IAAM2hB,EAAsB,OAAXH,EAAGC,QAAQ,EAARD,EAAU3c,QAAQ,GACtC,OAAO9O,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAACmJ,cAAe,mBAEjC1J,EAAM8P,QAAQnM,KAAI,SAACyI,EAASygB,GAC3B,IAAM5hB,EAAO4hB,EAAS,EAAI7sB,EAAM8P,QAAQpM,OAAO1D,EAAM8P,QAAQ+c,EAAO,GAAGD,EACjEtgB,EAAiBF,EAAQE,QAAQ8E,MAAM,EAAG,IAC1C0b,EAAOxgB,EAAQ8E,MAAM,EAAG,IACxB2b,EAA2B,MAAhB3gB,EAAQjE,KACnB6kB,OAAgBhkB,GAANiC,GAAoBmB,EAAQjE,MAAQ8C,EAAK9C,MAAQmE,GAAWrB,EAAKqB,QAAQ8E,MAAM,EAAG,IAC5FmJ,EAASva,EAAMitB,SAAW7gB,EAAQjE,KAClC+kB,OAAmBlkB,GAANiC,GAAmB6hB,GAAQ7hB,EAAKqB,QAAQ8E,MAAM,EAAG,IAC9DY,EAAU5F,EAAQC,YAAY,GAEpC,OAAI0gB,EACK/rB,IAAA6C,cAAC1C,UAAI,CAACmD,IAAK8H,EAAQ9D,GAAI/H,MAAO,CAACmJ,cAAc,MAAOK,eAAe,SAAUnF,MAAM,OAAQ6E,eAAe,IAC/GzI,IAAA6C,cAACvD,OAAI,KAAE0R,EAAQ5F,UAEZpL,IAAA6C,cAAC1C,UAAI,CAACmD,IAAK8H,EAAQ9D,IACvB4kB,EAAWlsB,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAACmJ,cAAc,MAAOK,eAAe,SAAUnF,MAAM,SAAS5D,IAAA6C,cAACvD,OAAI,KAAEwsB,SAAoB9jB,EAClHhI,IAAA6C,cAAC1C,UAAI,CAACmD,IAAK8H,EAAQ9D,GAAI/H,MAAO,CAACmJ,cAAc,MAAOK,eAAewQ,EAAO,gBAAgB,aAAc3V,MAAM,SAC3GooB,IAAYzS,EAAQvZ,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAACsJ,UAAU,EAAGsjB,WAAW,KAAKnsB,IAAA6C,cAAC8D,UAAM,CAACF,KAAM2E,EAAQ3E,KAAMC,OAAQ0E,EAAQjE,KAAMP,KAAM,MAAa5G,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAACqE,MAAM,MACzJ5D,IAAA6C,cAAC4E,UAAa,CAACE,oBAAqB,CAAC/D,WAAMoE,EAAWM,SAAS,OAAQlD,MAAO4mB,EAAQ5gB,EAAQ3E,UAAKuB,EAAWE,WAAY,CAACU,UAAKZ,GAAYK,UAAW,CAACS,QAAQ,IAAKX,SAAQ,GAAKmD,EAAQ8E,MAAM,KAC9LpQ,IAAA6C,cAACoW,UAAgB,CAACmT,YAVN,WAAH,OAAO/qB,EAAS0X,WAAc,CAACzR,GAAG8D,EAAQ9D,GAAI8D,QAAQ4F,EAAQ5F,YAWpEA,EAAQye,OAAS7pB,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAACmJ,cAAc,MAAOH,WAAW,YAC9DvI,IAAA6C,cAACvD,OAAI,CAACC,MAAO,CAAC2F,SAAS,KAAK,UAC5BlF,IAAA6C,cAACvD,OAAI,CAACC,MAAO,CAAC2F,SAAS,IAAKD,YAAaX,GAAWslB,GAAcxe,EAAQye,SAE5E7pB,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAACqE,MAAM,SAElB5D,IAAA6C,cAACynB,UAAS,CAACC,aAAc,EAAOhrB,MAAO,CAACirB,UAAU,cAAeC,UAAW,CAAC5qB,MAAO,YAClFG,IAAA6C,cAACvD,OAAI,CAAC2F,YAAaX,EAAU/E,MAAO,CAACoG,UAAU4T,EAAO,QAAQ,SAAUvI,EAAQ5F,WAGrFA,EAAQihB,SAAS1pB,KAAI,SAACmmB,EAAMwD,GAAS,OAAGtsB,IAAA6C,cAAC0pB,GAAW,CAACjpB,IAAKgpB,EAAWxD,KAAMA,EAAMxkB,SAAUA,EAAUykB,WAAY3d,EAAQihB,SAAS3pB,OAAO,GAAKsO,EAAQ5F,QAAQ1I,OAAO,OACrK0I,EAAQohB,SAAS7pB,KAAI,SAACid,EAAM6M,GAAS,OAAGzsB,IAAA6C,cAAC6pB,EAAW,CAACppB,IAAKmpB,EAAW7M,KAAMA,EAAMtb,SAAUA,kB,4HC7EpGqoB,GAAgB,SAAHprB,GAAoE,IAA/D6D,EAAK7D,EAAL6D,MAAO5D,EAAQD,EAARC,SACvBtC,EAAQC,oBACRU,EAAQR,UAAOH,GAAOqB,KAC5B,OAAOP,IAAA6C,cAAC4E,UAAa,CAACY,UAAW,CAACE,WAAW,aAAclI,gBAAuB,SAAPnB,EAAe,cAAc,UACtGc,IAAA6C,cAACvD,UAAI,CAACC,MAAO,CAAC2F,SAAS,GAAIrF,QAAO+F,WAAW,QAASR,GACrD5D,IAIU,cACb,IAAAorB,EAAoC5a,oBAA5BD,EAAI6a,EAAJ7a,KAAM8a,EAAMD,EAANC,OAAQC,EAASF,EAATE,UAChB5tB,EAAQC,oBACR4tB,EAAcC,4BACZ3jB,EAAS4I,oBAAT5I,KACR4jB,EAAyCC,mBAAmB7jB,GAA9C6R,EAAI+R,EAAX7Q,OAAuB+Q,EAAOF,EAAjB5Q,UACdxc,EAAQR,UAAOH,GAAOqB,KAC5B,OAAOP,IAAA6C,cAAA7C,IAAAuO,SAAA,KACLvO,IAAA6C,cAAC8pB,GAAa,CAACvnB,MAAO2M,EAAK,4BACzB/R,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAACmJ,cAAc,QACzB,CAAC,CAACqJ,EAAK,OAAO,GAAO,CAACA,EAAK,QAAQ,IAAQpP,KAAI,SAAA0L,GAAA,IAAA6V,EAAApiB,IAAAuM,EAAA,GAAEjJ,EAAK8e,EAAA,GAAEkJ,EAAClJ,EAAA,UAAIlkB,IAAA6C,cAACgR,WAAU,CACvEvQ,IAAK8B,EAAOA,MAAOA,GAAS,GAAID,UAAW,CAACD,SAAS,GAAIrF,QAAOwtB,mBAAmBnS,GAAMkS,EAAE,YAAY,QAAS7tB,MAAO,CAACkG,aAAa,IAAKd,QAAS,WAAKwoB,EAAQC,WAGtKptB,IAAA6C,cAAC8pB,GAAa,CAACvnB,MAAO2M,EAAK,wBAC3B/R,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAACmJ,cAAc,QACvB,CAAC,CAACqJ,EAAK,QAAS,QAAS,CAAC,qBAAO,MAAO,CAAC,UAAW,OAAOpP,KAAI,SAAA0S,GAAA,IAAAC,EAAAxT,IAAAuT,EAAA,GAAEjQ,EAAKkQ,EAAA,GAAErF,EAACqF,EAAA,UAAItV,IAAA6C,cAACgR,WAAU,CACvFvQ,IAAK8B,EAAOA,MAAOA,GAAS,GAAID,UAAW,CAACD,SAAS,GAAIrF,QAAOwtB,mBAAmBR,GAAQ5c,EAAE,YAAY,QAAS1Q,MAAO,CAACkG,aAAa,IAAKd,QAAS,kBAAImoB,EAAU7c,WAGzKjQ,IAAA6C,cAAC8pB,GAAa,CAACvnB,MAAO2M,EAAK,oBACzB/R,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAACmJ,cAAc,QACzB,CAAC,CAACqJ,EAAK,QAAS,iBAAkB,CAACA,EAAK,SAAU,SAAU,CAACA,EAAK,QAAS,SAASpP,KAAI,SAAA8S,GAAA,IAAAC,EAAA5T,IAAA2T,EAAA,GAAErQ,EAAKsQ,EAAA,GAAEvG,EAAWuG,EAAA,UAAI1V,IAAA6C,cAACgR,WAAU,CAC1HvQ,IAAK8B,EAAOA,MAAOA,EAAOD,UAAW,CAACD,SAAS,GAAIrF,QAAOwtB,mBAAmBN,GAAa5d,EAAY,YAAY,QAAS5P,MAAO,CAACkG,aAAa,IAAKd,QAAS,kBACzJ2oB,yBAAene,aChBxBoe,GAAgB,WACpB,IAAOlkB,EAAQ4I,oBAAR5I,KACDnK,EAAQC,oBACNkC,EAAa6Q,qBAAb7Q,SACFiY,EAAWxF,mBAAsBzK,GACjCmkB,EAAaxtB,IAAMsjB,SACrB,kBAAIhK,GAAYA,EAAS3W,KAAI,SAACuE,EAAM9D,GAAK,OAAGpD,IAAA6C,cAAC4qB,WAAU,CAACnqB,IAAKF,EAAOyV,OAAQ3R,EAAMvC,QAAS,kBAAItD,EAASgY,WAAc,CAAC/R,GAAGJ,EAAKI,aAAU,CAACgS,IAC9I,OAAOtZ,IAAA6C,cAAC6qB,aAAU,CAACnuB,MAAO,CAACqJ,KAAK,EAAGvI,gBAAgBhB,UAAOH,GAAOsB,aAC5DgtB,IAIDG,GAAmB,WACvB,IAAOtkB,EAAQ4I,oBAAR5I,KACDmC,EAAcD,oCAA0BlC,GACxCnK,EAAQC,oBAERyuB,GAAS,IAAI9G,MAAQ8D,cAAcxa,MAAM,EAAG,IAClD,OAAOpQ,IAAA6C,cAAC6qB,aAAU,CAACnuB,MAAO,CAACqJ,KAAK,EAAGvI,gBAAgBhB,UAAOH,GAAOsB,aACjD,MAAXgL,OAAW,EAAXA,EAAa7I,KAAI,SAACuE,EAAM9D,GAAS,IAADyqB,EAAAC,EAAAC,EAC7BC,EAAuB/mB,4BAAkBC,EAAMmC,EAAKlC,MAA7CC,EAAM4mB,EAAN5mB,OAAQX,EAAIunB,EAAJvnB,KACTqlB,EAAwB,OAApB+B,EAAG3mB,EAAKiE,mBAAY,EAAjB0iB,EAAmBviB,QAAQ8E,MAAM,EAAE,IAChD,OAAOpQ,IAAA6C,cAACqT,WAAU,CAAC5S,IAAKF,EAAOiF,UAAW,CAACK,cAAc,MAAOK,eAAe,iBAAkBpE,QAAS,kBAAI+J,oBAAS,aAAc,CAACpH,GAAGJ,EAAKI,OAC1ItH,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAACmJ,cAAc,QACvBtB,EACCpH,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAAEuZ,YAAY,KACzB9Y,IAAA6C,cAAC8D,UAAM,CAACF,KAAMW,EAAOX,KAAMG,KAAM,GAAIF,OAAQU,EAAOE,MAEtDtH,IAAA6C,cAACmmB,WAAW,CAACpiB,KAAM,GAAI/G,MAAOR,UAAOH,GAAO8B,UAAWzB,MAAO,CAAEoJ,cAAe,EAAGmQ,YAAY,IAAMrS,KAAK,UAC3GzG,IAAA6C,cAAC1C,UAAI,KACDH,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAACmJ,cAAc,QACxB1I,IAAA6C,cAACvD,OAAI,CAACC,MAAO,CAAC2F,SAAS,KAAMuB,GAC7BzG,IAAA6C,cAACvD,OAAI,CAACC,MAAO,CAAC2F,SAAS,GAAI+oB,QAAS,GAAKC,YAAY,IAAKhnB,EAAKG,eAEnErH,IAAA6C,cAACvD,OAAI,CAACC,MAAO,CAAC2F,SAAS,GAAI+oB,QAAS,KAAwB,OAAnBH,EAAE5mB,EAAKiE,mBAAY,EAAjB2iB,EAAmB1iB,WAGtEpL,IAAA6C,cAAC1C,UAAI,KACDH,IAAA6C,cAACvD,OAAI,CAACC,MAAO,CAAC2F,SAAS,GAAI+oB,QAAS,GAAKtoB,UAAU,UAAWmmB,GAAM8B,EAAuB,OAAlBG,EAAC7mB,EAAKiE,mBAAY,EAAjB4iB,EAAmBziB,QAAQ8E,MAAM,GAAG,IAAI0b,GAClH9rB,IAAA6C,cAACvD,OAAI,CAACC,MAAO,CAAC2F,SAAS,GAAIS,UAAU,UAAWuB,EAAKinB,aAAajnB,EAAKinB,aAAa,YAQhGC,GAAgB,WACpB,IAAMlvB,EAAQC,oBACd,OAAOa,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAACqJ,KAAK,EAAGvI,gBAAgBhB,UAAOH,GAAOsB,aACzDR,IAAA6C,cAACwrB,GAAc,QAIbC,GAAgB,SAACpvB,GACrB,IAAMW,EAAQR,UAAOH,GAAO8B,UAC5B,MAAO,CACLutB,OAAO,CACHnpB,MAAM,SACN4Q,UAAUuX,GACV7Y,KAAK1U,IAAA6C,cAAC2rB,WAAsB,CAAC5nB,KAAM,GAAI/G,MAAOA,EAAON,MAAO,CAAEoJ,cAAe,GAAKlC,KAAK,aAE3FgoB,OAAO,CACHrpB,MAAM,OACN4Q,UAAU2X,GACVjZ,KAAK1U,IAAA6C,cAACqW,WAAQ,CAACtS,KAAM,GAAI/G,MAAOA,EAAON,MAAO,CAAEoJ,cAAe,GAAKlC,KAAK,aAO7EioB,QAAQ,CACJtpB,MAAM,SACN4Q,UAAUoY,GACV1Z,KAAK1U,IAAA6C,cAAC8rB,WAAe,CAAC/nB,KAAM,GAAI/G,MAAOA,EAAON,MAAO,CAAEoJ,cAAe,GAAKlC,KAAK,eChGzE,SAASmoB,GAAartB,GAAyD,IAADstB,EAAtDC,EAAUvtB,EAAVutB,WAAYrf,EAAKlO,EAALkO,MACzCnI,EAAU,MAALmI,GAAa,OAARof,EAALpf,EAAOd,aAAF,EAALkgB,EAAevnB,GAC1B8L,EAAyBnB,oBAAlB5I,EAAI+J,EAAJ/J,KAAMgK,EAAQD,EAARC,SACb1R,EAAoCC,oBAAS,GAAMC,EAAAC,IAAAH,EAAA,GAA5CotB,EAAUltB,EAAA,GAAEmtB,EAAantB,EAAA,GAC1B2J,EAAcpC,kBAAwBC,GACtC+I,EAA0Bb,uCAuBlC,OAtBE0d,2BAAgB,WACZH,EAAWI,WAAW,CAACC,iBAAannB,MACrC,IACH1F,qBAAU,WACQ,MAAX+G,EAAKlC,MAA0B,GAAZ4nB,GAClB1b,EAAS,CAACvB,KAAK,gBACfkd,GAAc,IAEV3lB,EAAKlC,WAAsBa,IAAdwD,SACoBxD,IAAlCwD,EAAYb,MAAK,SAAAnI,GAAC,OAAEA,EAAE8E,IAAIA,MACzBoG,QAAQC,IAAI,8BAA8BrG,EAAE,KAC5C8K,EAAwBZ,OAAO,CAC3BH,WAAW/J,EACX8nB,SAAS,CAAC/lB,EAAKlC,KAAKG,MACrByG,MAAK,kBAAI+gB,EAAWxe,QAAQ,aAAc,CAAChJ,YAG9CoG,QAAQC,IAAI,kBACZmhB,EAAWxe,QAAQ,aAAc,CAAChJ,WAG3C,CAAC+B,EAAMmC,EAAaujB,IAClB/uB,IAAA6C,cAACvD,OAAI,KAAE,sBC3BT,IAAM+vB,GAAO,CAChBC,WAAW,CACPlqB,MAAM,OACN4Q,UFkGO,SAAmBzU,GAAsD,IAADguB,EAAnDT,EAAUvtB,EAAVutB,WAAYrf,EAAKlO,EAALkO,MAC9Cmd,EAAyB5a,oBAAjBD,EAAI6a,EAAJ7a,KAAM8a,EAAMD,EAANC,OACR7qB,EAAaC,qBACb/C,EAAQC,oBACNkC,EAAa6Q,qBAAb7Q,SACRM,EAA0BC,mBAAuB,aAAdI,GAA0BH,EAAAC,IAAAH,EAAA,GAArD6tB,EAAI3tB,EAAA,GAAE4tB,EAAO5tB,EAAA,GACfhC,EAAQR,UAAOH,GAAOqB,KACtBiP,EAAU,CACd,CAACpK,MAAM2M,EAAK,UAAWod,YAAY,kBAAInvB,IAAA6C,cAAC6sB,UAAW,QACnD,CAACtqB,MAAM2M,EAAK,QAASod,YAAY,kBAAInvB,IAAA6C,cAAC6sB,UAAW,CAAC/b,MAAO,CAAC,CAACvO,MAAM2M,EAAK,UAAWpN,QAAQ,kBAAItD,EAASuQ,WAAkB,CAACE,KAAK,qBAE9H,CAAC1M,MAAM2M,EAAK,UAAWod,YAAY,kBAAInvB,IAAA6C,cAAC6sB,UAAW,SAarD,OAVAT,2BAAgB,WAAO,IAADJ,EACdzrB,EAA6B,GAAhB,MAALqM,GAAa,OAARof,EAALpf,EAAOd,aAAF,EAALkgB,EAAec,KAC7Bb,EAAWI,WAAyB,YAAdltB,EAAyBwN,EAAQpM,GAAO,CAC5DgC,MAAO2M,EAAK,QACZod,YAAa,kBAAInvB,IAAA6C,cAAC6sB,UAAW,WAE9B,CAACZ,EAAYrf,EAAOzN,EAAY6qB,IACnCvqB,qBAAU,WACRmtB,EAAsB,aAAdztB,KACP,CAACA,IACGwtB,EACLxvB,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAACqJ,KAAK,EAAGG,eAAe,SAAUR,WAAW,WACxDvI,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAACqE,MAAM,MAAOgF,KAAK,EAAGC,UAAU,KAC3C7I,IAAA6C,cAAC+sB,WAAU,CAACrwB,MAAO,CAAC2F,SAAS,GAAIrF,UAAQ,aACzCG,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAACc,gBAAgBhB,UAAO4B,YAAa0C,OAAO,EAAGC,MAAM,UAElE5D,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAACoE,OAAO,MACrB3D,IAAA6C,cAAC4E,UAAa,CAACY,UAAW,CAACE,WAAW,aAAclI,gBAAgB,gBAClEL,IAAA6C,cAACgR,WAAU,CAACzO,MAAO2M,EAAK,cAAe5M,UAAW,CAACD,SAAS,GAAIrF,SAAQN,MAAO,CAAC2uB,YAAY,EAAGzoB,aAAa,IAAKd,QAAS,kBAAItD,EAASuQ,WAAkB,CAACE,KAAK,kBAEjK9R,IAAA6C,cAACwrB,GAAc,OAEjBruB,IAAA6C,cAACgtB,EAAc,OAEjB7vB,IAAA6C,cAAC8R,WAAO,CAACP,KAAMka,GAAcpvB,GAAQ+W,eAAe,SAAS7S,MAAO0sB,UAAqB,OAAZP,EAAA9f,EAAMd,aAAM,EAAZ4gB,EAAoB,MAAK,GAAIlb,MAAO,SAACjR,GAAS0rB,EAAWiB,UAAU,CAACJ,IAAIvsB,QEvIjJqJ,KAAK,QAETujB,WAAW,CACP5qB,MAAM,OACN4Q,UJkFO,SAAmBzU,GAAsD,IAADstB,EAAAoB,EAAnDnB,EAAUvtB,EAAVutB,WAAYrf,EAAKlO,EAALkO,MAC9Cmd,EAAyB5a,oBAAjBD,EAAI6a,EAAJ7a,KAAM8a,EAAMD,EAANC,OACRvoB,EAAWujB,oBACXxW,EAAkB,MAAL5B,GAAa,OAARof,EAALpf,EAAOd,aAAF,EAALkgB,EAAevnB,GAC5B3D,EAASqf,iBAAO,GAChBkN,EAAWlN,iBAAkB,MAC5B3Z,EAAQ4I,oBAAR5I,KACChI,EAAa6Q,qBAAb7Q,SACF6J,EAAuC,OAAhC+kB,EAAG7mB,kBAAwBC,SAAK,EAA7B4mB,EAA+BtlB,MAAK,SAAAnI,GAAC,OAAEA,EAAE8E,IAAIwoB,SAASze,MAChE8e,EAAgBjlB,EAAQjE,4BAAkBiE,EAAS7B,EAAKlC,WAAMa,EACpEooB,EAA+BzZ,kBAAwBtF,GAAhD3H,EAAI0mB,EAAJ1mB,KAAM4N,EAAa8Y,EAAb9Y,cACP+Y,EAAajf,kBAAuBC,GACpCQ,EAAYyR,mBAAQ,eAAAgN,EAAA,OAAc,MAAVD,GAA4C,OAAlCC,EAAVD,EAAY1lB,MAAK,SAAAnI,GAAC,IAAAoH,EAAA,OAAEpH,EAAE2E,OAAiB,OAAbyC,EAAIP,EAAKlC,WAAI,EAATyC,EAAWtC,aAA/B,EAAVgpB,EAA8ChpB,KAAI,CAAC+B,EAAMgnB,IACjFruB,EAAaC,qBACnBN,EAA0BC,mBAAS,IAAGC,EAAAC,IAAAH,EAAA,GAA/BoB,EAAKlB,EAAA,GAAE+Q,EAAQ/Q,EAAA,GACtBK,EAA0BN,qBAAkBO,EAAAL,IAAAI,EAAA,GAArC2nB,EAAK1nB,EAAA,GAAEouB,EAAQpuB,EAAA,GACtB+iB,EAAkCtjB,mBAAuB,MAAKujB,EAAArjB,IAAAojB,EAAA,GAAvDsL,EAASrL,EAAA,GAAEsL,EAAYtL,EAAA,GAC9BE,EAAkCzjB,oBAAkB,GAAM0jB,GAAAxjB,IAAAujB,EAAA,GAAnDyC,GAASxC,GAAA,GAAEyC,GAAYzC,GAAA,GAC9BoL,GAAkC9uB,oBAAkB,GAAM+uB,GAAA7uB,IAAA4uB,GAAA,GAAnDE,GAASD,GAAA,GAAEE,GAAYF,GAAA,GAExBzxB,GAAQC,oBACR2xB,GAAY,WACI,IAAD/d,EAAfhQ,EAAML,OAAO,IACfsW,GAAgBxT,OAAO,CAAC0F,QAAQmG,EAAYlK,KAAc,OAAV4L,EAAC1J,EAAKlC,WAAI,EAAT4L,EAAWzL,GAAI8D,QAAQrI,EAAO8mB,UAC/EjX,EAAS,IACT2d,OAASvoB,GACT6oB,IAAa,GACbJ,GAAa,KAGXzX,GAAkBrB,wCAExBsX,2BAAgB,WACdH,EAAWI,WAAW,CACpBC,YAAa,kBAAKnvB,IAAA6C,cAAC6sB,UAAW,CAAC/b,MAAO,CACpC,CAACvO,MAAM2M,EAAK,UAAWpN,QAAQ,kBAAItD,EAAS0vB,WAAa,CAACzpB,GAAG+J,MAC7D,CAACjM,MAAM2M,EAAK,WAAYpN,QAAQ,kBAAItD,EAASuQ,WAAkB,CAACtK,GAAG+J,EAAYS,KAAK,YAAaD,oBAEnGzM,MAAoB,MAAb+qB,OAAa,EAAbA,EAAe1pB,SAEvB,CAACqoB,EAAYrf,EAAOoC,EAAWgb,IAElC,IFpI0BmE,GEoIpBC,GAAazN,uBAAY,SAAAnV,GAAA,IAAAoL,EAAEvS,EAAImH,EAAJnH,KAAWmH,EAALjL,MAAK,OAA8CpD,IAAA6C,cAAC2oB,GAAwBtrB,IAAA,GAAKgH,EAAI,CAAE+kB,QAAkB,OAAXxS,EAAEpQ,EAAKlC,WAAI,EAATsS,EAAWnS,QAAO,CAAC+B,IAEpJmJ,GAAO,WACRsc,EAAWoC,YACVpC,EAAWqC,SAEXrC,EAAWpgB,SAAS,aAAc,CAACihB,IAAI,KAwB7C,OArBArtB,qBAAU,WACRjB,EAAS,KAAM,MACVgQ,GACHmB,OACD,CAAC/C,IACJnN,qBAAU,YACS,OAAb+tB,QAAkCroB,GAAZqoB,QAAoEroB,GAA3CqoB,EAAW1lB,MAAK,SAAAnI,GAAC,IAAA4uB,EAAA,OAAE5uB,EAAE2E,OAAe,OAAXiqB,EAAE/nB,EAAKlC,WAAI,EAATiqB,EAAW9pB,SACvFkL,OACD,CAAC6d,IACJ/tB,qBAAU,WACLkuB,IACAN,EAASphB,QAAgB5N,QAC1BuvB,GAAa,MAEd,CAACD,IACJluB,qBAAU,WACR,GAAe,MAAXkuB,IAAoBlsB,EAAS,CAC/B,IAAM4mB,EAAUC,YAAW,kBAAIsF,GAAa,KAAO,KACnD,OAAO,kBAAIrF,aAAaF,QAGrBlrB,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAClB,CAACqJ,KAAK,EAAGL,WAAW,UACR,aAAZvG,EAAwB,CAAC0G,cAAc,cAAe2oB,SAAS,KAAK,CAAC3oB,cAAc,YAEnF1I,IAAA6C,cAACyuB,GAAgB,CAACjgB,WAAYA,EAAYuW,WAAY,SAAC7P,GAAC,OAAGgQ,IAAchQ,IAAIzJ,SAAUwZ,KACvF9nB,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAAC,CAACqJ,KAAKkf,QAAU9f,EAAU,EAAGiB,WAAW,GAAgB,aAAZjH,EAAwB,CAACqvB,SAAS,IAAK1tB,OAAO,QAAQ,CAACC,MAAM,UACrH5D,IAAA6C,cAAC0uB,WAAQ,CACPhyB,MAAO,CAACmJ,cAAe,kBACvB8oB,sBAAuB,CAAC1oB,QAAQ,GAAI0e,SAAS,EAAG9e,cAAe,kBAC/DgB,KAAU,MAAJA,OAAI,EAAJA,EAAMuN,MACZga,WAAYA,GACZQ,SAAU,SAAChkB,GACLA,EAAEgL,YAAYiZ,cAAcC,EAAIlkB,EAAEgL,YAAYC,YAAY/U,OAASA,EAAOmL,QAAU,GACtFwI,KAEJsa,SAAU,SAACC,GAAKluB,EAAOmL,QAAU+iB,EAAEpZ,YAAYqZ,OAAOnuB,UAExD3D,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAACkjB,SAAS,aACrBziB,IAAA6C,cAACkvB,GAAS,CAAC1gB,WAAYA,KAEzBrR,IAAA6C,cAAC0lB,OAAU,CAAChpB,MAAO,CAACmjB,OAAO,EAAG9e,MAAM,OAAQsa,WAAW,GAAIJ,cAAc,GAAI9Y,kBAAkB,KAC7FhF,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAACgJ,WAAW,SAAU3E,MAAM,OAAO8E,cAAc,QAC5D1I,IAAA6C,cAAC2L,UAAY,CAACpJ,MAAO,GAAI7F,MAAO,CAACoE,OAAO,GAAIua,WAAW,EAAGM,qBAAqB,EAAGwT,wBAAwB,GAAIrtB,QAAS,kBAAIksB,IAAcD,MACvI5wB,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAAC0yB,KAAK,IACjBjyB,IAAA6C,cAACqvB,WAAM,CAACzrB,KAAMmqB,GAAU,QAAQ,OAAQhqB,KAAM,GAAI/G,MAAOR,UAAOH,IAAOqB,SAG1EspB,GAAS7pB,IAAA6C,cAAC2L,UAAY,CAACjP,MAAO,CAACoE,OAAO,GAAIua,WAAW,EAAGzY,aAAa,GAAIL,MAAK,UF7L7D4rB,GE6L+EnH,EF5LhGP,GAAaQ,KAAMkH,IAAWlH,SE4L4EnlB,QAAS,WAAKtD,EAAS8wB,WAAqB,CAACnB,SAASnH,EAAOvN,SAAS,SAAC0U,GAAe,OAAGT,EAASS,MAAYH,IAAa,MACtO7wB,IAAA6C,cAACwV,YAAS,CAAChJ,IAAK6gB,EAAUntB,MAAOA,EAAOwV,aAAc3F,EAAUrT,MAAO,CACrEqJ,KAAK,EAAGlD,YAAY,EAAG/B,OAAO,GAAI1C,YAAY5B,UAAO4B,YAAaZ,gBAAgBhB,UAAOH,IAAOsB,WAAYX,MAAMR,UAAOH,IAAOqB,MAC/H6xB,gBAAiBtB,GAAWuB,cAAc,EAAMC,QAAS,kBAAIzB,IAAa,MAC7E7wB,IAAA6C,cAAC2L,UAAY,CAACjP,MAAO,CAACoE,OAAO,GAAIua,WAAW,EAAGO,oBAAoB,EAAG8T,uBAAuB,GAAIntB,MAAO,eAAMT,QAASmsB,MAGxHF,IAAa5wB,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAACgJ,WAAW,SAAU3E,MAAM,OAAQ8E,cAAc,MAAOwV,WAAW,GAAIJ,cAAc,IAC/G9d,IAAA6C,cAAC2L,UAAY,CAACjP,MAAO,CAACoE,OAAO,GAAIiF,KAAK,EAAGG,eAAe,SAAU+P,YAAY,IAAK1T,MAAK,kBAAU2M,EAAK,eAAkBpN,QAAS,kBA9KnI,IAAI6F,SAAwB,SAACgoB,EAASC,GAC3C,GAAmB,OAAfpV,UAASC,GAAY,CACvB,IAAIoV,EAAQC,SAAS9vB,cAAc,SACnC6vB,EAAM5gB,KAAO,OACb4gB,EAAME,SAAW,SAAAnlB,GACf+kB,EAAS/kB,EAAEgU,OAAeoR,MAAM,KAElCH,EAAMI,QAAUL,EAChBC,EAAMK,QAAUN,EAChBC,EAAMM,aAGNR,OAAQxqB,MAkK+I+F,MAAK,SAAAklB,GAAI,IAADC,EAACla,GAAgBxT,OAAO,CAAC0F,QAAQmG,EAAYlK,KAAc,OAAV+rB,EAAC7pB,EAAKlC,WAAI,EAAT+rB,EAAW5rB,GAAI8D,QAAQ,GAAI0d,KAAKmK,IAAIpC,IAAa,SAC9P7wB,IAAA6C,cAAC2L,UAAY,CAACjP,MAAO,CAACoE,OAAO,GAAIiF,KAAK,EAAGG,eAAe,SAAU+P,YAAY,IAAK1T,MAAK,YAAS2M,EAAK,iBAAoBpN,QAAS,WAAKtD,EAAS8wB,WAAqB,CAACnB,SAASnH,EAAOvN,SAAS,SAAC0U,GAAe,OAAGT,EAASS,MAAYH,IAAa,MACrP7wB,IAAA6C,cAAC2L,UAAY,CAACjP,MAAO,CAACoE,OAAO,GAAIiF,KAAK,EAAGG,eAAe,UAAW3D,MAAK,kBAAU2M,EAAK,cAAiBpN,QAAS,WAAKojB,IAAcD,IAAW+I,IAAa,IAAS/rB,SAAUgjB,UI9LjLrb,KAAK,QAYTmiB,cAAc,CACVxpB,MAAO,GACP4Q,UAAU4Y,GACVniB,KAAK,YAIA0mB,GAAQ,CACjBC,YAAY,CACR3mB,KAAM,QACNrH,MAAO,UACP4Q,Uf5BO,SAAoBzU,GAEC,IADlCutB,EAAUvtB,EAAVutB,WAAYrf,EAAKlO,EAALkO,MAEJsC,EAASC,oBAATD,KACRpQ,EAAgCC,mBAAS,IAAGC,EAAAC,IAAAH,EAAA,GAArC4R,EAAQ1R,EAAA,GAAEwxB,EAAWxxB,EAAA,GAC5BK,EAAgCN,mBAAS,IAAGO,EAAAL,IAAAI,EAAA,GAArCoxB,EAAQnxB,EAAA,GAAEoxB,EAAWpxB,EAAA,GAC5BiR,EAA0BnB,oBAAnBkS,EAAK/Q,EAAL+Q,MAAO9Q,EAAQD,EAARC,SACRmgB,EAAS,WAAH,OAAOngB,EAAS,CAACvB,KAAK,gBAAiByB,WAAU+f,cAO7D,OANArE,2BAAgB,WACdH,EAAWI,WAAW,CACpBC,iBAAannB,MAEd,CAAC8mB,EAAYrf,IAERzP,IAAA6C,cAAC1C,UAAI,CAACZ,MAAOme,EAAOM,iBAC1Bhe,IAAA6C,cAAC1C,UAAI,CAACZ,MAAOme,EAAOa,eAClBve,IAAA6C,cAAC1C,UAAI,CAACZ,MAAOme,EAAOgB,MACjByF,GAASnkB,IAAA6C,cAAC1C,UAAI,CAACZ,MAAOme,EAAOiB,YAC5B3e,IAAA6C,cAACvD,UAAI,CAACC,MAAOme,EAAOkB,iBAAkB7M,EAAKoS,KAE7CnkB,IAAA6C,cAACwV,UAAS,CACR9Y,MAAOme,EAAOoB,WACd/b,MAAOwQ,EACPkgB,YAAa1hB,EAAK,YAClBwG,aAAc,SAAChY,GAAI,OAAK8yB,EAAY9yB,IACpCmzB,eAAgB,OAChBC,aAAc,gBACdvB,gBAAiBoB,IAEnBxzB,IAAA6C,cAACwV,UAAS,CACR9Y,MAAOme,EAAOoB,WACd/b,MAAOuwB,EACPG,YAAa1hB,EAAK,YAClB6hB,iBAAe,EACfrb,aAAc,SAAChY,GAAI,OAAKgzB,EAAYhzB,IACpC6xB,gBAAiBoB,IAEnBxzB,IAAA6C,cAACoW,UAAgB,CAACtU,QAAS6uB,GACzBxzB,IAAA6C,cAAC1C,UAAI,CAACZ,MAAOme,EAAOqB,QAClB/e,IAAA6C,cAACvD,UAAI,CAACC,MAAOme,EAAOsB,cAAejN,EAAK,cAG5C/R,IAAA6C,cAACoW,UAAgB,CAACtU,QAAS,kBAAM0O,EAAS,CAACvB,KAAK,kBAC9C9R,IAAA6C,cAACvD,UAAI,CAACC,MAAOme,EAAOgC,mBACjB3N,EAAK,uBAIZ/R,IAAA6C,cAAC1C,UAAI,CAACZ,MAAOme,EAAOuB,cAClBjf,IAAA6C,cAAC1C,UAAI,CAACZ,MAAOme,EAAOwB,wBAClBlf,IAAA6C,cAAC1C,UAAI,CAACZ,MAAOme,EAAOyB,8BACpBnf,IAAA6C,cAACvD,UAAI,CAACC,MAAOme,EAAO0B,6BAA8B,KAClDpf,IAAA6C,cAAC1C,UAAI,CAACZ,MAAOme,EAAOyB,+BAEtBnf,IAAA6C,cAAC1C,UAAI,CAACZ,MAAOme,EAAO2B,yBAYxBrf,IAAA6C,cAACgtB,EAAc,SepCfjB,cAAc,CACVniB,KAAK,UACLrH,MAAO,GACP4Q,UAAU4Y,KAILzrB,GAAQ,I,80BC1CrB,IAAM0wB,EAAoB,SAACC,EAA+BC,GACtD,OAAQA,EAAOjiB,MACX,IAAK,SACH,OAAA5O,IAAA,GACK4wB,GAAY,IACfE,QAASD,EAAOC,UAEpB,IAAK,gBACH,OAAA9wB,IAAA,GACK4wB,GAAY,IACfG,QAAO,IAEX,IAAK,iBACD,OAAA/wB,IAAA,GACO4wB,GAAY,IACfG,QAAO,EACPD,QAAS,KAEjB,QACI,MAAM,IAAIE,MAAM,0BAA2BH,EAAOjiB,Q,iDCTxDqiB,EAAa,SAACn1B,GAClB,IAAA2C,EAAgCC,mBAAS5C,EAAMo1B,YAAYtlB,QAAQulB,IAAIr1B,EAAMkI,KAAKI,KAAIzF,EAAAC,IAAAH,EAAA,GAA/E2yB,EAAQzyB,EAAA,GAAE0yB,EAAW1yB,EAAA,GAC5B,OAAO7B,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO+0B,EAAS,CAAC5uB,YAAY,EAAGzE,YAAY,QAAQ,IAC/DjB,IAAA6C,cAAC4qB,UAAU,CAAC5U,OAAQ7Z,EAAMkI,KAAMvC,QAAS,WACnC2vB,GACFC,GAAY,GACZv1B,EAAMo1B,YAAYtlB,QAAQoJ,OAAOlZ,EAAMkI,KAAKI,MAG5CitB,GAAY,GACZv1B,EAAMo1B,YAAYtlB,QAAQ0lB,IAAIx1B,EAAMkI,KAAKI,UAW3CmtB,EAAe,SAAHlzB,GAA4C,IAAvC+F,EAAE/F,EAAF+F,GAAI8sB,EAAW7yB,EAAX6yB,YACjBriB,EAASC,oBAATD,KACD1I,EAAQ4I,oBAAR5I,KACChI,EAAa6Q,oBAAb7Q,SACFiY,EAAWxF,kBAAsBzK,GACjCgnB,EAAajf,kBAAuB9J,GACpC8K,EAA0Bb,uCAKhCmjB,EDlBa,SAA2BjT,EAAYkT,GACpD,IAAAC,EAAgCC,qBAAWhB,EAAoB,CAACI,QAAO,EAAOD,QAAQ,KAAIc,EAAAhzB,IAAA8yB,EAAA,GAAnFG,EAAWD,EAAA,GAAEzhB,EAAQyhB,EAAA,GACtBprB,EAAO4Z,mBAAQ,kBAAIyR,EAAYd,OAAOxS,EAAOlf,QAAO,SAAAC,GAAC,OAAEmyB,EAAQnyB,EAAGuyB,EAAYf,YAAUvS,IAAQ,CAACsT,EAAatT,IACpH,MAAO,CAACsT,cAAa1hB,WAAU3J,QCeuBsrB,CAJtC1R,mBAAQ,WACtB,IAAM2R,EAAY,IAAIC,IAAc,MAAV7E,OAAU,EAAVA,EAAY1tB,KAAI,SAAAH,GAAC,OAAEA,EAAE2E,SAC/C,OAAe,MAARmS,OAAQ,EAARA,EAAU/W,QAAO,SAAAC,GAAC,OAAGyyB,EAAUZ,IAAI7xB,EAAE8E,SAAQ,KACnD,CAACgS,EAAU+W,KACgE,SAAC7tB,EAAGwxB,GAAO,OAAIxxB,EAAE+Q,SAAS4hB,SAASnB,IAAYxxB,EAAEiE,KAAK0uB,SAASnB,MAAtItqB,EAAIgrB,EAAJhrB,KAAe0rB,EAAeV,EAAxBrhB,SAA0B0hB,EAAWL,EAAXK,YAUjCviB,EAAO,WACXnR,EAAS0vB,EAAa,OAExB,OAAO/wB,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO,CAACgJ,WAAW,SAAUK,KAAK,IAC7C5I,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO,CAAC,MAAS,OAAQqJ,KAAK,IAClC5I,IAAA6C,cAAC8P,UAAS,CAAClM,KAASsL,EAAK,YAAW,MAAMA,EAAK,QAAWhP,MAAOgyB,EAAYf,QAASphB,SAd3E,SAACgB,IACT,MAADA,OAAC,EAADA,EAAGlR,QAAO,GACZ0yB,EAAgB,CAACtjB,KAAK,kBACtBsjB,EAAgB,CAACtjB,KAAK,SAAUkiB,QAAQpgB,KAGxCwhB,EAAgB,CAACtjB,KAAK,oBAQkFlO,MAAO,QAC9G0D,GAAMoC,GAAQ1J,IAAA6C,cAAC0uB,WAAQ,CAACC,sBAAuB,CAAChK,SAAS,GAAI9d,KAAMA,EAAMunB,WAAY,SAAA5iB,GAAA,IAAEnH,EAAImH,EAAJnH,KAAI,OAAIlH,IAAA6C,cAACsxB,EAAU,CAACjtB,KAAMA,EAAMktB,YAAaA,QAEvIp0B,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO,CAAC,CAACqE,MAAM,OAAQ8E,cAAc,MAAOI,QAAQ,IAAM,CAACC,eAAe,cAC9E/I,IAAA6C,cAAC2L,UAAY,CAACpJ,MAAO2M,EAAK,UAAWpN,QAAS,WAC5CyN,EAAwBZ,OAAO,CAC7BH,WAAW/J,EACX8nB,SAAQvkB,IAAKupB,EAAYtlB,WACxBf,KAAKyE,MAEVxS,IAAA6C,cAAC2L,UAAY,CAACpJ,MAAO2M,EAAK,UAAWpN,QAAS6N,OAO9C6iB,EAA4B,SAAHnR,GAA4C,IAAvC5c,EAAE4c,EAAF5c,GAAI8sB,EAAWlQ,EAAXkQ,YAC9BriB,EAASC,oBAATD,KACR7P,EAA0BN,mBAAS,IAAGO,EAAAL,IAAAI,EAAA,GAA/Ba,EAAKZ,EAAA,GAAEyQ,EAAQzQ,EAAA,GACtB+iB,EAA8BtjB,mBAAS,IAAGujB,EAAArjB,IAAAojB,EAAA,GAAnC8O,EAAO7O,EAAA,GAAEmQ,EAAUnQ,EAAA,GAC1BE,EAA4BzjB,oBAAS,GAAM0jB,EAAAxjB,IAAAujB,EAAA,GAApCkQ,EAAMjQ,EAAA,GAAEkQ,EAASlQ,EAAA,GAClBmQ,EAAazS,mBACX3hB,EAAa6Q,oBAAb7Q,SACFgvB,EAAajf,kBAAuB9J,GACpCouB,ECvFO,SAAmC1B,GAEhD,OADiBrqB,mBAAS,CAAC,qBAAsBqqB,IAAW,kBAAAnqB,IAAAC,OAAA,SAAAC,GAAA,cAAAA,EAAAC,KAAAD,EAAAE,MAAA,WAAS+pB,EAAO,CAAAjqB,EAAAE,KAAA,eAAAF,EAAAE,KAAA,EAAAJ,IAAAK,MAAQyrB,oCAA0B3B,IAAQ,OAAAjqB,EAAAK,GAAAL,EAAAM,KAAAN,EAAAE,KAAA,eAAAF,EAAAK,GAAE,GAAE,cAAAL,EAAAO,OAAA,SAAAP,EAAAK,IAAA,wBAAAL,EAAAQ,UAAA,eAAAC,YAAlHd,KDsFmBksB,CAA0B5B,GAC/CtqB,EAAO4Z,mBAAQ,WACnB,IAAM2R,EAAY,IAAIC,IAAc,MAAV7E,OAAU,EAAVA,EAAY1tB,KAAI,SAAAH,GAAC,OAAEA,EAAE2E,SAC/C,OAAyB,MAAlBuuB,OAAkB,EAAlBA,EAAoBnzB,QAAO,SAAAC,GAAC,OAAGyyB,EAAUZ,IAAI7xB,EAAE8E,SAAQ,KAC7D,CAACouB,EAAoBrF,IAClBje,EAA0Bb,uCAChCjP,qBAAU,WAIR,OAHAmzB,EAAW3mB,QAAUqc,YAAW,WAC9BmK,EAAWvyB,KAlBH,KAoBH,WAAK0yB,EAAW3mB,SAAWsc,aAAaqK,EAAW3mB,YACzD,CAAC/L,IACJ,IAAMyP,EAAO,WACXnR,EAAS0vB,EAAa,OAElB8E,EAAanlB,SAAS8M,KAAKlN,QAAQ,OAAQ,WACjD,OAAOtQ,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO,CAACgJ,WAAW,SAAUK,KAAK,IAC/C5I,IAAA6C,cAACoW,mBAAgB,CAAC1Z,MAAO,CAACwF,gBAAgB,GAAI2D,cAAc,OAAQ/D,QAAS,WAAKwU,IAAUC,UAAUyc,GAAYL,GAAU,KAC1Hx1B,IAAA6C,cAACvD,OAAI,CAACC,MAAO,CAAC2F,SAAS,KAAM6M,EAAK,eAAgB,MAClD/R,IAAA6C,cAACvD,OAAI,CAACC,MAAO,CAAC2F,SAAS,GAAIrF,MAAM,YAAag2B,EAAY,KACzDN,GAAUv1B,IAAA6C,cAACvD,OAAI,CAACC,MAAO,CAAC2F,SAAS,GAAIrF,MAAM,QAASkS,EAAK,YAE5D/R,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO,CAAC,MAAS,OAAQqJ,KAAK,IAClC5I,IAAA6C,cAAC8P,UAAS,CAAClM,KAAMsL,EAAK,YAAahP,MAAOA,EAAO6P,SAAUA,EAAUhP,MAAO,QAC3E0D,GAAMoC,GAAQ1J,IAAA6C,cAAC0uB,WAAQ,CAACC,sBAAuB,CAAChK,SAAS,GAAI9d,KAAMA,EAAMunB,WAAY,SAAA5b,GAAA,IAAEnO,EAAImO,EAAJnO,KAAI,OAAIlH,IAAA6C,cAACsxB,EAAU,CAACjtB,KAAMA,EAAMktB,YAAaA,QAEvIp0B,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO,CAAC,CAACqE,MAAM,OAAQ8E,cAAc,MAAOI,QAAQ,IAAM,CAACC,eAAe,cAC9E/I,IAAA6C,cAAC2L,UAAY,CAACpJ,MAAO2M,EAAK,UAAWpN,QAAS,WAC5CyN,EAAwBZ,OAAO,CAC7BH,WAAW/J,EACX8nB,SAAQvkB,IAAKupB,EAAYtlB,WACxBf,KAAKyE,MAEVxS,IAAA6C,cAAC2L,UAAY,CAACpJ,MAAO2M,EAAK,UAAWpN,QAAS6N,OAKnC,SAASue,EAAWzb,GAAoB,IAAlBhO,EAAEgO,EAAFhO,GAC3ByK,EAASC,oBAATD,KACFqiB,EAAcpR,iBAAoB,IAAIkS,KACtCY,EAA2B,CAC/B7iB,MAAM,CACJ7N,MAAO,QACP4Q,UAAW,kBAAIhW,IAAA6C,cAAC4xB,EAAY,CAACntB,GAAIA,EAAI8sB,YAAaA,KAClD1f,KAAM1U,IAAA6C,cAAA7C,IAAAuO,SAAA,OAERwnB,SAAS,CACP3wB,MAAO,mBACP4Q,UAAW,kBAAIhW,IAAA6C,cAACwyB,EAAyB,CAAC/tB,GAAIA,EAAI8sB,YAAaA,KAC/D1f,KAAM1U,IAAA6C,cAAA7C,IAAAuO,SAAA,QAGV,OAAOvO,IAAA6C,cAAC6P,UAAY,KAClB1S,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO,CAACqJ,KAAK,EAAGhF,MAAM,SAC1B5D,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO,CAACqE,MAAM,SAClB5D,IAAA6C,cAACvD,OAAI,CAACC,MAAO,CAAC2F,SAAS,KAAM6M,EAAK,WAClC/R,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO,CAACoJ,aAAc,GAAIhF,OAAQ,EAAGC,MAAO,QAASpE,WAAW,OAAOC,UAAU,4BAEzFO,IAAA6C,cAAC8R,UAAO,CAACP,KAAM0hB,EAAY7f,eAAgB,Y,iUEtGlC,SAAS+f,EAASh3B,GAC/B,IAAM6tB,OAA0B7kB,GAAhBhJ,EAAM6tB,QAAsC,QAAf7tB,EAAM6tB,OAAiB7tB,EAAM6tB,OAAOoJ,UAAKpJ,OACtFqJ,eAAaC,cAAgBtJ,EAC7B,IAAMuJ,EAAgBF,eAAaG,QAAQxJ,GAC3C,OACE7sB,IAAA6C,cAAC1C,UAAI,KACHH,IAAA6C,cAACyzB,WAAY,CACXC,YAAav3B,EAAMu3B,YACnBC,YAAax3B,EAAMw3B,YACnBC,YAAa,SAAAxP,GAAS,OAAIjnB,IAAA6C,cAACvD,UAAI,KAAe,QAAb2nB,EAAoBmP,EAAoB,KAAEA,EAAoB,OAC/FM,YAAaN,EAA2B,YACxCO,YAAa33B,EAAM8sB,KACnB8K,qCAAsC53B,EAAM43B,qCAC5CC,cAAe73B,EAAM63B,cACrBC,WAAY,SAAChL,GAAI,OAAiB,MAAb9sB,EAAM+3B,aAAO,EAAb/3B,EAAM+3B,QAAUjL,EAAKkL,aAC1CloB,QAAS9P,EAAM8sB,KACfvsB,MAAO,CAAC,CAACqE,MAAM,KAAO5E,EAAMO,OAC5B03B,aAAcj4B,EAAMi4B,gB,ikBAvD5BnN,IAAMoN,OAAOC,KAAYA,aACzBrN,IAAM+C,OAAO,MACbqJ,eAAaG,QAAY,GAAI,CAC3Be,WAAYtN,IAAMuN,SAClBC,gBAAiBxN,IAAMyN,cACvBC,SAAU1N,IAAM2N,WAChBC,cAAe5N,IAAM6N,gBACrB/J,MAAO,QACP5jB,KAAM,OACNC,KAAM,OACNysB,iBAAa1uB,GAGf8hB,IAAM+C,OAAO,MAEbqJ,eAAaG,QAAY,GAAI,CAC3Be,WAAYtN,IAAMuN,SAClBC,gBAAiBxN,IAAMyN,cACvBC,SAAU1N,IAAM2N,WAChBC,cAAe5N,IAAM6N,gBACrB/J,MAAO,eACP5jB,KAAM,eACNC,KAAM,eACNysB,YAAa,uBClBf,IAAMkB,EAAW,CAAC,KAAM,MAAMj1B,KAAI,SAAAI,GAAK,MAAG,CAAC8D,MAAM9D,EAAOA,YAClD80B,EAAQhtB,IAAIitB,MAAM,IAAInR,QAAQhkB,KAAI,SAACI,EAAOK,GAAK,OAAIA,EAAQ,GAAG8W,WAAWC,SAAS,EAAG,QAAMxX,KAAI,SAAAI,GAAK,MAAG,CAAC8D,MAAM9D,EAAOA,YACrHg1B,EAAUltB,IAAIitB,MAAM,IAAInR,QAAQhkB,KAAI,SAACI,EAAOK,GAAK,OAAY,EAARA,GAAW8W,WAAWC,SAAS,EAAG,QAAMxX,KAAI,SAAAI,GAAK,MAAG,CAAC8D,MAAM9D,EAAOA,YAGvHi1B,EAAe,SAAClM,GAKpB,IAJA,IAAImM,EAAYnM,EAAKhb,QAAQonB,QAAQ,SAAS1D,KAAK,EAAG,SAChD2D,EAAUrM,EAAKhb,QAAQsnB,MAAM,SAAS5D,IAAI,EAAG,SAC7C5G,EAAQ9D,MAAQoO,QAAQ,OACxBG,EAAS,GACTJ,GAAWE,GAAWF,EAAUrK,GACpCyK,EAAO7b,KAAKyb,EAAUxO,OAAO,eAC7BwO,EAAYA,EAAUzD,IAAI,EAAG,OAE/B,OAAO6D,GASM,SAASlG,EAAmB5wB,GAA8E,IAA5EyvB,EAAQzvB,EAARyvB,SAAU1U,EAAQ/a,EAAR+a,SAC/Cgc,EAAStH,EAASlH,IAAMkH,GAPX,WACnB,IAAM/tB,EAAI6mB,MACJyO,EAAazI,SAAS7sB,EAAEwmB,OAAO,OAAS,EAC9C,OAAOxmB,EAAEuxB,IAAI,EAAE+D,EAAY,UAIaC,GACxC5L,EAAyB5a,oBAAjBD,EAAI6a,EAAJ7a,KAAM8a,EAAMD,EAANC,OACR3tB,EAAQC,oBACdwC,EAAwBC,mBAAS02B,EAAO7O,OAAO,eAAc5nB,EAAAC,IAAAH,EAAA,GAAtDmqB,EAAIjqB,EAAA,GAAEk1B,EAAOl1B,EAAA,GACpBK,EAA8BN,mBAAS02B,EAAOzL,OAAO,MAAMpD,OAAO,MAAKtnB,EAAAL,IAAAI,EAAA,GAAhEu2B,EAAOt2B,EAAA,GAAEu2B,EAAUv2B,EAAA,GAC1B+iB,EAAwBtjB,mBAAS02B,EAAO7O,OAAO,OAAMtE,EAAArjB,IAAAojB,EAAA,GAA9CyT,EAAIxT,EAAA,GAAEyT,EAAOzT,EAAA,GACpBE,EAA4BzjB,mBAAS02B,EAAO7O,OAAO,OAAMnE,EAAAxjB,IAAAujB,EAAA,GAAlDwT,EAAMvT,EAAA,GAAEwT,EAASxT,EAAA,GACxBoL,EAAsC9uB,mBAAmBo2B,EAAeM,IAAQ3H,EAAA7uB,IAAA4uB,EAAA,GAAzEqI,EAAWpI,EAAA,GAAEqI,EAAcrI,EAAA,GAC1BtvB,EAAa6Q,oBAAb7Q,SACFmR,EAAO,WACXnR,EAAS8wB,EAAqB,OAEhC,OAAOnyB,IAAA6C,cAACsG,cAAW,KACjBnJ,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO,CAACmJ,cAAc,MAAO9E,MAAM,SACvC5D,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO,CAACqJ,KAAK,EAAGF,cAAc,QAClC1I,IAAA6C,cAACoW,mBAAgB,CAACtU,QAAS6N,GACzBxS,IAAA6C,cAACqW,UAAQ,CAACtS,KAAM,GAAIH,KAAK,aAAa5G,MAAOR,UAAOH,GAAOqB,SAG/DP,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO,CAACqJ,KAAK,IACjB5I,IAAA6C,cAACvD,OAAI,CAACC,MAAO,CAAC2F,SAAS,GAAIS,UAAU,WAAYoM,EAAK,iBAExD/R,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO,CAACqJ,KAAK,MAErB5I,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO,CAACoJ,aAAc,GAAIhF,OAAQ,EAAGC,MAAO,QAASpE,WAAW,OAAOC,UAAU,2BACvFO,IAAA6C,cAACmzB,EAAQ,CACPnJ,OAAQA,EACRttB,WAAOyI,EACP+uB,QAASA,EACTH,sCAAsC,EACtCC,cAAe,SAACr0B,GAAC,OAAGw2B,EAAehB,EAAelO,IAAMtnB,EAAEw0B,eAC1DR,YAAWtzB,IAAA,GACN61B,EAAYE,QAAO,SAACpH,EAAGhV,GAA0B,OAArBgV,EAAEhV,GAAG,CAAC/X,UAAS,GAAa+sB,IAAI,MAC3D/F,EAAK,CAACA,GAAM,IAAImN,QAAO,SAACpH,EAAGhV,GAA0B,OAArBgV,EAAEhV,GAAG,CAACyX,UAAS,GAAazC,IAAI,OAIxE7xB,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO,CAACmJ,cAAc,MAAO3D,gBAAgB,GAAInB,MAAM,IAAKD,OAAO,KACvE3D,IAAA6C,cAACq2B,SAAM,CACL35B,MAAO,CAACqJ,KAAK,GACbuwB,UAAW,CAACj0B,SAAS,IACrBk0B,cAAeX,EACfY,cAAeX,GACdd,EAASj1B,KAAI,SAAAH,GAAC,OAAExC,IAAA6C,cAACq2B,SAAOI,KAAI,CAACh2B,IAAKd,EAAEO,MAAO8D,MAAOrE,EAAEqE,MAAO9D,MAAOP,EAAEO,YAEvE/C,IAAA6C,cAACvD,OAAI,CAACC,MAAO,CAAC2F,SAAS,KAAK,KAC5BlF,IAAA6C,cAACq2B,SAAM,CACL35B,MAAO,CAACqJ,KAAK,GACbuwB,UAAW,CAACj0B,SAAS,IACrBk0B,cAAeT,EACfU,cAAeT,GACdf,EAAMl1B,KAAI,SAAAH,GAAC,OAAExC,IAAA6C,cAACq2B,SAAOI,KAAI,CAACh2B,IAAKd,EAAEO,MAAO8D,MAAOrE,EAAEqE,MAAO9D,MAAOP,EAAEO,YAEpE/C,IAAA6C,cAACvD,OAAI,CAACC,MAAO,CAAC2F,SAAS,KAAK,OAC5BlF,IAAA6C,cAACq2B,SAAM,CACL35B,MAAO,CAACqJ,KAAK,GACbuwB,UAAW,CAACj0B,SAAS,IACrBk0B,cAAeP,EACfQ,cAAeP,GACdf,EAAQp1B,KAAI,SAAAH,GAAC,OAAExC,IAAA6C,cAACq2B,SAAOI,KAAI,CAACh2B,IAAKd,EAAEO,MAAO8D,MAAOrE,EAAEqE,MAAO9D,MAAOP,EAAEO,aAGxE/C,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO,CAACmJ,cAAc,QAC1B1I,IAAA6C,cAAC2L,UAAY,CAACpJ,MAAO2M,EAAK,QAASpN,QAAS,WAClC,MAAR2X,KAAWwN,IAASgC,EAAI,IAAI6M,EAAI,IAAIE,EAAM,IAAIJ,GAAW7N,eACzDpY,OAEFxS,IAAA6C,cAAC2L,UAAY,CAACpJ,MAAO2M,EAAK,UAAWpN,QAAS,WACpC,MAAR2X,UAAWtU,GACXwK,W,+HC9FO,SAAS+mB,EAASv6B,GAC/B,IAAMgD,EAAaC,oBACbu3B,EAAWlW,mBAAQ,iBAAgB,aAAZthB,EAC3B,CAAC0G,cAAc,MAAOH,WAAY,SAAUQ,eAAe,iBAC3D,CAACL,cAAc,SAAUH,WAAW,gBACpC,CAACvG,IACH,OACEhC,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO,CAAC,CAACwF,gBAAgB,EAAGnB,MAAM,QAAS41B,IAC7Cx5B,IAAA6C,cAACvD,OAAI,CAACC,MAAO,CAAa,aAAZyC,EAAwB,CAAC4G,KAAK,GAAG,CAAChF,MAAM,QAAQ,CAACoB,kBAAmB,GAAIE,SAAS,IAAKlG,EAAMmG,YAAanG,EAAMyH,MAC7HzG,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO,CAAa,aAAZyC,EAAwB,CAAC4G,KAAK,GAAG,CAAChF,MAAM,QAAQ,CAACoB,kBAAmB,MAChFhF,IAAA6C,cAAC1C,OAAI,CAACZ,MAAO,CAACqE,MAAM5E,EAAM4E,QACvB5E,EAAMwC,YClBJ,SAASmR,EAAU3T,GAChC,OACEgB,IAAA6C,cAAC02B,EAAQ,CAAC9yB,KAAMzH,EAAMyH,KAAM7C,MAAO5E,EAAM4E,MAAOuB,UAAWnG,EAAMmG,WAC/DnF,IAAA6C,cAAC+W,UAAoB5a,M,gpBCG3BiS,OAAOwoB,OAAOt2B,SAAO+N,SAAQ,SAAA1O,GAAC,OAAEA,EAAEiK,KAAOitB,aAAiBl3B,EAAEiK,QAE5C,WACdktB,SAAU,CAAClc,UAAgB,MAC3Bmc,OAAQ,CACNC,QAAO32B,EAAA,CACL42B,KAAM,CACJD,QAAO32B,MAAA,GACFmsB,QACA8D,SAAK,IACR4G,SAAU,MAEZttB,KAdS,cAgBRtJ,Y,wCC1BT,IAAIR,EAAM,CACT,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,aAAc,IACd,UAAW,IACX,aAAc,IACd,UAAW,IACX,aAAc,IACd,UAAW,IACX,aAAc,IACd,UAAW,IACX,aAAc,IACd,UAAW,IACX,aAAc,IACd,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,aAAc,IACd,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,aAAc,IACd,UAAW,IACX,aAAc,IACd,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,UAAW,IACX,aAAc,IACd,UAAW,IACX,aAAc,IACd,UAAW,IACX,aAAc,IACd,UAAW,IACX,aAAc,IACd,UAAW,IACX,aAAc,IACd,UAAW,IACX,aAAc,IACd,UAAW,IACX,aAAc,IACd,UAAW,IACX,aAAc,IACd,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,aAAc,IACd,UAAW,IACX,aAAc,IACd,UAAW,IACX,aAAc,IACd,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,QAAS,IACT,WAAY,IACZ,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,aAAc,IACd,UAAW,IACX,aAAc,IACd,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,aAAc,IACd,gBAAiB,IACjB,aAAc,IACd,gBAAiB,IACjB,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,UAAW,IACX,aAAc,IACd,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,aAAc,IACd,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,aAAc,IACd,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,aAAc,IACd,UAAW,IACX,OAAQ,IACR,UAAW,IACX,WAAY,IACZ,cAAe,IACf,UAAW,IACX,aAAc,IACd,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,aAAc,IACd,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,YAAa,IACb,eAAgB,IAChB,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,QAAS,IACT,WAAY,IACZ,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,UAAW,IACX,aAAc,IACd,QAAS,IACT,WAAY,IACZ,OAAQ,IACR,UAAW,IACX,QAAS,IACT,WAAY,IACZ,QAAS,IACT,aAAc,IACd,gBAAiB,IACjB,WAAY,IACZ,UAAW,IACX,aAAc,IACd,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,UAAW,IACX,OAAQ,IACR,YAAa,IACb,eAAgB,IAChB,UAAW,IACX,OAAQ,IACR,UAAW,IACX,aAAc,IACd,gBAAiB,IACjB,OAAQ,IACR,UAAW,IACX,UAAW,IACX,aAAc,IACd,UAAW,IACX,aAAc,IACd,UAAW,IACX,aAAc,IACd,UAAW,IACX,aAAc,KAIf,SAASq3B,EAAeC,GACvB,IAAI3yB,EAAK4yB,EAAsBD,GAC/B,OAAOE,EAAoB7yB,GAE5B,SAAS4yB,EAAsBD,GAC9B,IAAIE,EAAoBC,EAAEz3B,EAAKs3B,GAAM,CACpC,IAAIxsB,EAAI,IAAIymB,MAAM,uBAAyB+F,EAAM,KAEjD,MADAxsB,EAAE4sB,KAAO,mBACH5sB,EAEP,OAAO9K,EAAIs3B,GAEZD,EAAerT,KAAO,WACrB,OAAO1V,OAAO0V,KAAKhkB,IAEpBq3B,EAAexH,QAAU0H,EACzBI,EAAOC,QAAUP,EACjBA,EAAe1yB,GAAK,K,oBCnSpBuS,eAAiB,CACb,WAAc,yCACd,UAAa,yBACb,cAAiB,qCACjB,kBAAqB,cACrB,MAAS,2CACT,cAAiB,gBAGjBygB,EAAOC,QAAU1gB,gB,oMCJN,SAAS2gB,EAAcj5B,GAEC,IADrCutB,EAAUvtB,EAAVutB,WAEQ/c,EAASC,oBAATD,KACR,OACE/R,gBAACG,UAAI,CAACZ,MAAO+F,EAAOsC,WAClB5H,gBAACV,UAAI,CAACC,MAAO+F,EAAOF,OAAQ2M,EAAK,+BACjC/R,gBAACiZ,UAAgB,CAACtU,QAAS,kBAAMmqB,EAAWxe,QAAQ,eAAe/Q,MAAO+F,EAAOsa,MAC/E5f,gBAACV,UAAI,CAACC,MAAO+F,EAAOm1B,UAAW1oB,EAAK,yBAM5C,IAAMzM,EAASC,UAAWC,OAAO,CAC/BoC,UAAW,CACTgB,KAAM,EACNvI,gBAAiB,OACjBkI,WAAY,SACZQ,eAAgB,SAChBD,QAAS,IAEX1D,MAAO,CACLF,SAAU,GACVU,WAAY,QAEdga,KAAM,CACJ/W,UAAW,GACX9D,gBAAiB,IAEnB01B,SAAU,CACRv1B,SAAU,GACVrF,MAAO,a,gtBCnBX,IAAM66B,EAAgB,SAAC17B,GAAkE,OAAGgB,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAACqJ,KAAK,IAC1G5J,EAAM0K,KAAK/G,KAAI,SAACuE,EAAM9D,GACrB,IAAOqD,EAAQQ,4BAAkBC,EAAMlI,EAAMqK,KAAKlC,MAA3CV,KACP,OAAOzG,IAAA6C,cAACqT,UAAU,CAAC5S,IAAKF,EAAOyE,eAAgB,CAACW,iBAAiB,GAAIH,UAAW,CAACE,WAAW,cAAe5D,QAASuC,EAAKvC,SACvH3E,IAAA6C,cAACvD,OAAI,CAACC,MAAO,CAAC4sB,WAAW,KAAM1lB,SAWjCqvB,EAA2B,CAC/B6E,aAAa,CACTv1B,MAAM,YACN4Q,UATmB,WACvB,IAAO3M,EAAQ4I,oBAAR5I,KACDmC,EAAcD,oCAA0BlC,GAC9C,OAAOrJ,IAAA6C,cAAC63B,EAAa,CAACrxB,KAAMA,EAAMK,MAAO8B,GAAe,IAAI7I,KAAI,SAAAuE,GAAI,OAAAhE,IAAA,GAAOgE,GAAI,IAAEvC,QAAQ,kBAAI+J,mBAAS,aAAc,CAACpH,GAAGJ,EAAKI,cAOzHoN,KAAK1U,IAAA6C,cAAA7C,IAAAuO,SAAA,QAII,WAAAhN,GAAkC,IAAhC4F,EAAI5F,EAAJ4F,KACPyzB,EAAWC,oBAAXD,OACF54B,EAAaC,oBACnBN,EAA0BC,mBAAS,GAAEC,EAAAC,IAAAH,EAAA,GAA9ByB,EAAKvB,EAAA,GAAEqS,EAAQrS,EAAA,GACdR,EAAa6Q,oBAAb7Q,SACFy5B,EAAY,CAChB,kBAAIz5B,EAASuQ,UAAkB,CAACE,KAAK,eACrC,kBAAIzQ,EAASuQ,UAAkB,CAACE,KAAK,YAEvC,OAAO9R,IAAA6C,cAAC1C,UAAI,CAACZ,MAAmB,aAAZyC,EAAwB,CACxCsD,EAAOy1B,OACP,CACE16B,gBAAiBu6B,EAAOI,KACxBC,eAAgBL,EAAOM,SAGzB,CAACt3B,MAAM,GACTu3B,cAAgC,QAEhCn7B,IAAA6C,cAAC2W,UAAO,CAAC9S,OAAQS,EAAKG,GAAIiM,SAAUpM,EAAKoM,SAAU9M,KAAMU,EAAKV,OACjD,aAAZzE,GAA2BhC,IAAA6C,cAAA7C,IAAAuO,SAAA,KAC1BvO,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAACmJ,cAAc,gBACxB1I,IAAA6C,cAACgR,UAAU,CAACzO,MAAM,IAAID,UAAW,CAACD,SAAS,IAAK3F,MAAO,CAACkG,aAAa,IAAKd,QAASm2B,EAAU13B,MAEjGpD,IAAA6C,cAAC1C,UAAI,CAACi7B,kBAAkB,UAAU77B,MAAO+F,EAAO8F,SAC7C6F,OAAO0V,KAAKmP,GAAYpzB,OAAO,EAC9B1C,IAAA6C,cAAC8R,UAAO,CAACP,KAAM0hB,EAAY7f,eAAgB,MAAO5B,MAAOH,IACzDlU,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAAC87B,eAAe,EAAGzyB,KAAK,EAAG3H,YAAY25B,EAAOM,SACxDjqB,OAAOwoB,OAAO3D,GAAYnzB,KAAI,SAAA24B,GAAY,IAAMC,EAAMD,EAAUtlB,UAAW,OAAOhW,IAAA6C,cAAC04B,EAAG,CAACj4B,IAAKg4B,EAAUl2B,gBAU7GE,EAASC,UAAWC,OAAO,CAC7Bu1B,OAAQ,CACNn3B,MAAM,IACN43B,UAAW,EACXC,iBAAiB,EACjBx6B,YAAY5B,UAAO4B,aAErBmK,QAAS,CACPxC,KAAM,EACNF,cAAe,OAEjBinB,IAAK,CACD/mB,KAAM,EACNL,WAAY,UAEhB1B,MAAO,CACHlB,UAAW,SACXtF,gBAAiB,iB,mGCzFV,GACX0wB,UACA1X,UACAzH,UACA6B,UACA0e,UACApZ,WCOE2iB,EAAOC,oBAEE,SAAS3rB,IACpB,IAAMhO,EAAaC,oBACnB,OAAOjC,IAAA6C,cAAC64B,EAAKE,UAAS,CAClB/X,KAAM,QACNgY,WAAY,SACZC,cAAe,CACXC,UAAU,CAAC17B,gBAAgB,SAC3B27B,kBAAkB,EAClBC,sBAAuBC,yBAAuBC,iBAGlDn8B,IAAA6C,cAAC64B,EAAKU,OAAM,CAAC31B,KAAK,OAAOuP,UAAWqmB,GAAe7sB,QAAS,CAAC8sB,aAAY,KACxErrB,OAAOkD,QAAQhR,SAAOR,KAAI,SAAApB,GAAA,IAAA8M,EAAAvM,IAAAP,EAAA,GAAE+B,EAAG+K,EAAA,GAAE6E,EAAM7E,EAAA,UAAIrO,IAAA6C,cAAC64B,EAAKU,OAAM,CAAC94B,IAAKA,EAAKmD,KAAMnD,EAAK0S,UAAW9C,EAAO8C,UAAWxG,QAAS,CAChHpK,MAAO8N,EAAO9N,MACdm3B,iBAAgC,aAAdv6B,EAA0B,oBAAoB,kBAK5E,IAAM83B,GAAO6B,oBAeb,IAAMU,GAAgB,WAClB,IAAMr6B,EAAaC,oBACbqC,EAAWujB,oBACVxe,EAAQ4I,oBAAR5I,KACDnK,EAAQC,oBACdytB,EAAuB5a,oBAAhBD,EAAI6a,EAAJ7a,KAAM8a,EAAMD,EAANC,OACP1Y,EAAUmP,mBAAQ,WACpB,YAAkBtb,IAAdqB,EAAKlC,KACE,IACXuG,QAAQC,IAAI,iBAAkBtE,EAAKlC,MAC5B8J,OAAOkD,QAAsB,OAAd9K,EAAKlC,KAAcgsB,QAAM9D,WAChD,CAAChmB,EAAMwjB,IACJ2P,EAAclZ,mBAAQ,WACxB,YAAkBtb,IAAdqB,EAAKlC,MAEY,OAAdkC,EAAKlC,KADD,GACkBzF,IAC9B,CAAC2H,IAEU6R,EAAQgS,kBAAmB7jB,GAAlC+S,OAEP,YAAoBpU,IAAZqB,EAAKlC,MAA0B,MAAN+T,EAAWlb,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAACmJ,cAAc,MAAOE,KAAK,IAChF5I,IAAA6C,cAACvB,iBAAc,CAACI,OAAQ86B,GACnBnzB,EAAKlC,KAAKnH,IAAA6C,cAAC45B,EAAe,CAACt1B,KAAMkC,EAAKlC,YAAQa,EAC/ChI,IAAA6C,cAAC1C,UAAI,CAACZ,MAAO,CAACqJ,KAAK,IACf5I,IAAA6C,cAACuL,oBAAiB,CAACE,QAAuB,OAAdjF,EAAKlC,WAA+Ba,IAAdqB,EAAKlC,MAC/CnH,IAAA6C,cAACi3B,GAAK8B,UAAS,CACXE,cAAe,SAAA5X,GAAA,IAAE4K,EAAU5K,EAAV4K,WAAYrf,EAAKyU,EAALzU,MAAK,MAAK,CACnCitB,YAAY,CAACr8B,gBAAgBhB,UAAOH,GAAO0B,OAAQ+C,OAAOW,EAAS,QAAG0D,GACtE20B,iBAAiB,CAAC98B,MAAM,SACxB+8B,WAAW,kBA1C3C,SAAoB9N,EAAgBrf,EAAWzN,EAAmBsC,GAC9D,IAAMu4B,GAAkF,GAAhE,CAAC,aAAc,eAAeznB,WAAU,SAAA5S,GAAC,OAAEA,GAAKiN,EAAMhJ,QAO9E,MAAgB,YAAZzE,GAA0B66B,EACnB78B,IAAA6C,cAACoW,mBAAgB,CAACtU,QAPd,WACPmqB,EAAWoC,YACXpC,EAAWqC,SACN0L,GACL/N,EAAWxe,QAAQ,gBAGmBtQ,IAAA6C,cAACqW,UAAQ,CAACtS,KAAMtC,EAAS,GAAG,GAAI/E,MAAO,CAACiJ,iBAAiBlE,EAAS,GAAG,IAAMmC,KAAK,gBACvH,KAgCoCm2B,CAAW9N,EAAYrf,EAAOzN,EAAYsC,IACzD6qB,YAAY,kBAAInvB,IAAA6C,cAAC6sB,UAAW,OAC5BoN,yBAAyB,CAACz8B,gBAZ9B,QAY+DqW,kBAAkB,EAAGzV,YAZpF,SAaI86B,UAAU,CAAC9yB,WAAW,GACtB+yB,iBAA6B,YAAZh6B,EACjBi6B,sBAAuBC,yBAAuBa,oBAGjD5oB,EAAQxR,KAAI,SAAA0S,GAAA,IAAAC,EAAAxT,IAAAuT,EAAA,GAAE/R,EAAGgS,EAAA,GAAEpC,EAAMoC,EAAA,UAAItV,IAAA6C,cAACi3B,GAAKsC,OAAM,CAAC94B,IAAKA,EAAKmD,KAAMnD,EAAK0S,UAAW9C,EAAO8C,UAAWxG,QAAS,CAAEpK,MAAO2M,EAAKmB,EAAO9N,aAC3HpF,IAAA6C,cAACi3B,GAAKsC,OAAM,CAAC31B,KAAK,WAAWuP,UAAWwkB,EAAgBhrB,QAAS,CAAEpK,MAAO,gBAK1FpF,IAAA6C,cAAA7C,IAAAuO,SAAA","file":"static/js/4.ff14eaef.chunk.js","sourcesContent":["/**\r\n * Learn more about Light and Dark modes:\r\n * https://docs.expo.io/guides/color-schemes/\r\n */\r\n\r\nimport * as React from 'react';\r\nimport { Text as DefaultText, View as DefaultView } from 'react-native';\r\n\r\nimport Colors from '../constants/Colors'\r\nimport useColorScheme from '../hooks/useColorScheme';\r\n\r\nexport function useThemeColor(\r\n  props: { light?: string; dark?: string },\r\n  colorName: keyof typeof Colors.light & keyof typeof Colors.dark\r\n) {\r\n  const theme = useColorScheme();\r\n  const colorFromProps = props[theme];\r\n\r\n  if (colorFromProps) {\r\n    return colorFromProps;\r\n  } else {\r\n    return Colors[theme][colorName];\r\n  }\r\n}\r\n\r\ntype ThemeProps = {\r\n  lightColor?: string;\r\n  darkColor?: string;\r\n};\r\n\r\nexport type TextProps = ThemeProps & DefaultText['props'];\r\nexport type ViewProps = ThemeProps & DefaultView['props'];\r\n\r\nexport function Text(props: TextProps) {\r\n  const { style, lightColor, darkColor, ...otherProps } = props;\r\n  const color = useThemeColor({ light: lightColor, dark: darkColor }, 'text');\r\n\r\n  return <DefaultText style={[{ color }, style]} {...otherProps} />;\r\n}\r\n\r\nexport function View(props: ViewProps) {\r\n  const { style, lightColor, darkColor, ...otherProps } = props;\r\n  const backgroundColor = useThemeColor({ light: lightColor, dark: darkColor }, 'background');\r\n\r\n  return <DefaultView style={[{ backgroundColor }, style]} {...otherProps} />;\r\n}\r\n","const tintColorLight = '#2f95dc';\r\nconst tintColorDark = '#fff';\r\n\r\nexport default {\r\n  light: {\r\n    text: '#000',\r\n    background: '#fff',\r\n    tint: tintColorLight,\r\n    tabIconDefault: '#ccc',\r\n    tabIconSelected: tintColorLight,\r\n    header:'#24292f',\r\n    buttonColor:'rgb(242,242,242)',\r\n    buttonBackgroundColor: '#f6f8fa', //'rgba(9,30,66,0.08)',//rgb(242,242,242)\\\r\n    buttonBorderColor:'rgba(27,31,36,0.15)',\r\n    iconColor: 'black'\r\n  },\r\n  dark: {\r\n    text: '#fff',\r\n    background: '#000',\r\n    tint: tintColorDark,\r\n    tabIconDefault: '#ccc',\r\n    tabIconSelected: tintColorDark,\r\n    header:'#161b22',\r\n    buttonColor:'rgb(1,4,9)',\r\n    buttonBackgroundColor: '#282624',\r\n    buttonBorderColor:'rgba(229,225,220,0.15)',\r\n    iconColor: 'white'\r\n  },\r\n  borderColor:'#d0d7de',\r\n  \r\n  focus:'#0065A4',\r\n};\r\n","import React, { useState, createContext, useContext, useEffect } from \"react\";\r\nimport { Modal } from \"react-native\";\r\nimport useResizeContext from \"./useResizeContext\";\r\n\r\ntype ModalProps = any\r\n\r\ntype ModalState = {\r\n  Component:React.ComponentType<ModalProps>,\r\n  props:any\r\n  visible:boolean\r\n}\r\ntype SetModal = (Component:ModalState[\"Component\"]|null, props:ModalProps|null)=>void\r\n\r\nconst ModalsContext = createContext<{setModal: SetModal}>({\r\n    setModal: () => {}\r\n});\r\n\r\nexport const ModalsProvider = ({children, modals:allModals}:{children:React.ReactNode, modals:React.ComponentType<ModalProps>[]}) => {\r\n    const [modals, setModals] = useState<ModalState[]>([]);\r\n    const windowType = useResizeContext();\r\n    const [animationType, setAnimationType] = useState('none')\r\n    const setModal:SetModal = (Component, props) => {\r\n        const newModals = modals.map(m=>{\r\n            if(Component==null){\r\n                return {\r\n                    ...m,\r\n                    visible:false\r\n                }\r\n            }\r\n            else if(m.Component == Component){\r\n                return {\r\n                    Component, \r\n                    props:props!==null?props:m.props,\r\n                    visible:props!==null\r\n                }\r\n            }\r\n            return m        \r\n        })\r\n        setModals(newModals);\r\n    }\r\n    useEffect(()=>{\r\n        if (modals.filter(v=>v.visible).length == 0)\r\n            setAnimationType(windowType == 'landscape'?'fade':'slide')\r\n    }, [windowType])\r\n    useEffect(()=>{\r\n        setModals(allModals.map((Component)=>({Component, props:null, visible:false})))\r\n    }, [allModals])\r\n    return <ModalsContext.Provider value={{setModal}}>\r\n        {children}\r\n        {modals.map((modal, index)=>{\r\n            const { Component, props, visible } = modal;\r\n            return <Modal key={index} animationType={animationType as any} visible={visible} transparent>\r\n                <Component {...props}/>\r\n            </Modal>\r\n        })}\r\n    </ModalsContext.Provider>\r\n}\r\n\r\nexport default ()=>{\r\n    const modalsContext = useContext(ModalsContext)\r\n    return modalsContext\r\n}\r\n\r\n","import React, { useState, useEffect, createContext, useContext, useMemo } from 'react';\r\nimport { Dimensions, ScaledSize, useWindowDimensions } from 'react-native';\r\n//@ts-ignore\r\nimport useMobileDetect from 'use-mobile-detect-hook';\r\n\r\ntype WindowType = 'portrait' | 'landscape'\r\n\r\nconst getWindowType = (window:{width:number, height:number})=> window.height >= window.width?'portrait':'landscape' as WindowType;\r\n\r\nconst ResizeContextContext = createContext<WindowType>(getWindowType(Dimensions.get('window')));\r\n\r\nexport const ResizeContextProvider = ({children}:{children:React.ReactNode})=>{\r\n  const detectMobile = useMobileDetect();\r\n  const {width, height} = useWindowDimensions()\r\n  const [windowType, setWindowType] = useState(getWindowType({width, height}))\r\n  useEffect(()=>{\r\n    setWindowType(getWindowType({width, height}))\r\n  }, [width, height])\r\n  return <ResizeContextContext.Provider value={detectMobile.isMobile()?'portrait':windowType}>\r\n    {children}\r\n  </ResizeContextContext.Provider>\r\n}\r\n\r\nexport default function useResizeContext() {\r\n  const windowType = useContext(ResizeContextContext)\r\n  return windowType\r\n}","import React, { useState } from 'react';\r\nimport { Text, StyleSheet, Pressable, StyleProp, ViewStyle} from 'react-native';\r\nimport Colors from '../constants/Colors';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { CustomButtonProps } from '../types';\r\n\r\nconst DefaultButton = (props:CustomButtonProps)=>{\r\n    const [hover, setHover] = useState(false)\r\n    return <Pressable\r\n        onPress={()=>props.onPress()}\r\n        //@ts-ignore\r\n        onHoverIn={()=>setHover(true)}\r\n        onHoverOut={()=>setHover(false)}\r\n        disabled={props.disabled}\r\n        style={[\r\n            {\r\n                paddingVertical:5, \r\n                paddingHorizontal:16\r\n            },\r\n            props.style,\r\n            (hover || props.disabled)?{backgroundColor:props.color}:{}\r\n        ]}>\r\n            {props.children?props.children:\r\n            <Text selectable={false} style={[{fontSize:14}, props.textStyle]}>{props.title}</Text>}\r\n        </Pressable>\r\n}\r\n\r\nexport default (props:CustomButtonProps)=>{\r\n    const theme = useColorScheme()\r\n    const _props = {\r\n        color:Colors[theme].buttonColor,\r\n        ...props,\r\n        style:[\r\n            styles.style,\r\n            {\r\n                backgroundColor:Colors[theme].buttonBackgroundColor,\r\n                borderColor:Colors[theme].buttonBorderColor\r\n            },\r\n            props.style,\r\n        ] as StyleProp<ViewStyle>,\r\n        textStyle:[\r\n            styles.text, \r\n            {color:Colors[theme].text},\r\n            props.textStyle\r\n        ]\r\n    }\r\n    return <DefaultButton {..._props}/>\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n    style:{\r\n        borderRadius:6, \r\n        borderWidth:1, \r\n    },\r\n    text:{\r\n        textAlign:'center', \r\n        fontWeight:'600'\r\n    }\r\n});\r\n","import * as React from 'react';\r\nimport { Avatar } from 'react-native-paper';\r\nimport { AvatarProps } from '../../types';\r\n\r\nconst normalizeHash = (hash: number, min: number, max: number) => {\r\n    return Math.floor((hash % (max - min)) + min);\r\n};\r\n\r\nconst stringToHSL = (str: string, initHash?:number) => {\r\n    let hash = initHash || 0;\r\n    for (let i = 0; i < str.length; i++) {\r\n      hash = str.charCodeAt(i) + ((hash << 5) - hash);\r\n    }\r\n    hash = Math.abs(hash);\r\n    return `hsl(${normalizeHash(hash, 0, 360)}, ${normalizeHash(hash, 0, 100)}%, ${normalizeHash(hash, 25, 75)}%)`;\r\n};\r\n\r\nexport default (props:AvatarProps) => {\r\n    const backgroundColor = stringToHSL(props.name, props.userId)\r\n    return <Avatar.Text style={{backgroundColor}} size={props.size} label={props.name.split(' ').map(v=>v[0]).join().toUpperCase()} />\r\n};","import React from 'react';\r\n// import { MaterialIcons } from \"@expo/vector-icons\"\r\nimport Avatar from '../lib/react-native-paper/Avatar';\r\nimport { AvatarProps, MessengerChannel, User } from '../types';\r\n\r\nexport function avatarFromChannel(item:MessengerChannel, user?:User|null){\r\n    let avatar;\r\n    let name = item.name\r\n    if (item.member_count<3){\r\n        avatar = (item.member_count==1 || user?.id == item.subowner.id)?item.owner:item.subowner\r\n        name = name.length>0?name:avatar.name \r\n    }\r\n    return {avatar, name}\r\n}\r\n\r\nexport default (props:AvatarProps)=>{\r\n    // return <MaterialIcons size={38} style={{ marginBottom: -3, marginRight:10 }} name='account-circle'/>\r\n    return <Avatar {...props}/>\r\n}\r\n\r\n","import * as React from 'react';\r\nimport { View, Text } from './Themed';\r\nimport { StyleSheet, StyleProp, ViewStyle, TextStyle } from 'react-native';\r\nimport Colors from '../constants/Colors';\r\n\r\nexport type SectionParamList = {\r\n    title?: string,\r\n    titleStyle?:StyleProp<TextStyle>\r\n    outerContainerStyle?:StyleProp<TextStyle>\r\n    containerStyle?:StyleProp<ViewStyle>\r\n    bodyStyle?:StyleProp<ViewStyle>\r\n    subtitle?: string\r\n    withSeparator?: boolean\r\n    children?: React.ReactNode\r\n}\r\n\r\nexport default function CommonSection(props:SectionParamList){\r\n  return (\r\n    <View style={[styles.outerContainer, props.outerContainerStyle]}>\r\n        <View style={[styles.container, props.containerStyle]}>\r\n            {props.withSeparator?<View style={styles.separator} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />:undefined}\r\n            {props.title?<View style={styles.titleView}>\r\n              <Text style={[styles.title, props.titleStyle]}>{props.title}</Text>\r\n              <Text style={styles.subtitle}>{props.subtitle}</Text>\r\n            </View>:undefined}\r\n            <View style={[styles.bodyView, props.bodyStyle]}>\r\n            {props.children}\r\n            </View>\r\n          </View>\r\n        </View>\r\n    )\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  outerContainer:{\r\n    width:'100%',\r\n    maxWidth:1080,\r\n    alignItems:'stretch',\r\n    backgroundColor:'transparent'\r\n  },  \r\n  container: {\r\n      marginHorizontal:20,\r\n      marginVertical: 10,\r\n      backgroundColor:'transparent',\r\n    },\r\n    titleView:{\r\n      width: '100%',\r\n      flexDirection:'row',\r\n      backgroundColor:'transparent',\r\n      marginBottom:5,\r\n    },\r\n    title: {\r\n      flex:1,\r\n      fontSize: 16,\r\n    },\r\n    subtitle: {\r\n      flex:1,\r\n      fontSize: 12,\r\n      textAlign: 'right',\r\n      marginTop:4\r\n    },\r\n    separator: {\r\n      marginBottom: 20,\r\n      height: 1,\r\n      width: '100%',\r\n    },\r\n    bodyView:{\r\n      width: '100%',\r\n      padding: 20,\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      borderWidth:1,\r\n      borderColor:Colors.borderColor,\r\n      borderRadius:6\r\n    }\r\n  });\r\n  ","import React from 'react'\r\nimport CommonSection from \"./CommonSection\";\r\nimport useResizeContext from '../hooks/useResizeContext';\r\n\r\nexport default (props:{children?: React.ReactNode})=>{\r\n    const windowType = useResizeContext();\r\n    return <CommonSection\r\n        outerContainerStyle={{flex:1, alignSelf:'center', backgroundColor:'#8888', maxWidth:undefined, flexShrink:1}}\r\n        containerStyle={{flex:1, margin:0, justifyContent:'center', alignItems:'center'}}\r\n        bodyStyle={windowType=='landscape'?{width:'90%', height:'90%', padding:'5%'}:{width:'100%', height:'100%', maxWidth:1080}}\r\n    >\r\n        {props.children}\r\n    </CommonSection>\r\n}\r\n\r\nexport const BottomSheet = (props:{children?: React.ReactNode})=><CommonSection\r\n    outerContainerStyle={{flex:1, alignSelf:'center', backgroundColor:'#8888', maxWidth:undefined}}\r\n    containerStyle={{flex:1, margin:0, justifyContent:'flex-end'}}\r\n>\r\n    {props.children}\r\n</CommonSection>","import { useEffect } from \"react\";\r\nimport { useMutation, useQuery, useQueryClient } from \"react-query\";\r\nimport { getMessengerChannelList, postChannel, postDirectChannel, putChannel } from \"../../apis\";\r\nimport { MessengerChannel, MessengerContent } from \"../../types\";\r\nimport { Auth } from \"../useAuthContext\";\r\nimport useWebsocketContext from \"../useWebsocketContext\";\r\n\r\nexport default function useMessengerChannelList(auth?:Auth){\r\n  const queryClient = useQueryClient()\r\n  const {lastJsonMessage} = useWebsocketContext()\r\n  const { data } = useQuery(\"MessengerChannelList\" , async()=>auth?.user?.id?(await getMessengerChannelList(auth.user.id)):[])\r\n\r\n  useEffect(()=>{\r\n    if(lastJsonMessage !=null){\r\n      if(lastJsonMessage['type']=='enter'){\r\n        queryClient.setQueryData<MessengerChannel[]>(\"MessengerChannelList\", (_data)=>{\r\n          return (_data?.find(v=>v.id==lastJsonMessage['data']['id'])?_data:[lastJsonMessage['data'] , ...(_data|| [])]).sort((a, b)=>a.id - b.id)\r\n        })\r\n      }\r\n      if (lastJsonMessage['type']=='next_message'){\r\n        const data:MessengerContent = lastJsonMessage['data']\r\n        queryClient.setQueryData<MessengerChannel[]>(\"MessengerChannelList\", (_data)=>(_data || []).map(v=>{\r\n          if (v.id == data.channel){\r\n            return {...v, last_message:{content:data.message_set[0]?.content, created:data.created}}\r\n          }\r\n          return v\r\n        }))\r\n      }\r\n      // if(lastJsonMessage['type']=='leave'){\r\n      //   queryClient.setQueryData<Channel[]>(\"MessengerChannelList\", (_data)=>_data?.filter(v=>v.id!=lastJsonMessage['data']['channel_id']) || [])\r\n      // }\r\n    }\r\n  }, [lastJsonMessage])\r\n  return data\r\n}\r\n\r\nexport function useMessengerChannelSorted(auth?:Auth){\r\n  const channelList = useMessengerChannelList(auth);\r\n  return channelList?.sort((a, b)=>(a.last_message?.created || '') < (b.last_message?.created || '')?1:-1)\r\n}\r\nexport function useMessengerChannelMutation(){\r\n  const queryClient = useQueryClient()\r\n\r\n  const create = useMutation(postChannel, {\r\n    onSuccess: ()=>queryClient.invalidateQueries(\"MessengerChannelList\")\r\n  });\r\n\r\n  const update = useMutation(putChannel, {\r\n    onSuccess: () => queryClient.invalidateQueries(\"MessengerChannelList\")\r\n  })\r\n\r\n  const direct = useMutation(postDirectChannel, {\r\n    onSuccess: () => queryClient.invalidateQueries(\"MessengerChannelList\")\r\n  })\r\n\r\n  return { create:create.mutateAsync, update:update.mutateAsync, direct:direct.mutateAsync}\r\n}","import React, { Context, createContext,  useContext, useEffect, useState } from \"react\"\r\nimport useWebSocket from \"react-use-websocket\"\r\nimport { SendJsonMessage } from \"react-use-websocket/dist/lib/types\"\r\nimport {websockerURL } from \"../constants/Envs\"\r\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\r\nimport { AppState, AppStateStatus } from \"react-native\";\r\n\r\ntype WebsocketContextType = {lastJsonMessage:any, sendJsonMessage:SendJsonMessage }\r\nconst defaultContext = {lastJsonMessage:undefined, sendJsonMessage:()=>{}}\r\nconst WebSocketContext = createContext<WebsocketContextType>(defaultContext);\r\n\r\nexport const WebSocketInternalProvider = ({children, path, Context, useBackground}:{children:React.ReactNode, path:string, Context:Context<WebsocketContextType>, useBackground?:boolean})=>{\r\n  const [token, setToken] = useState<string|null>(null)\r\n  const [isActive, setIsActive] = useState<boolean>(useBackground || AppState.currentState == 'active')\r\n  const { lastJsonMessage, sendJsonMessage } = useWebSocket(`${websockerURL}/${path}`,{\r\n    shouldReconnect: (closeEvent) => true,\r\n    protocols: token?['Authorization',  token]:undefined,\r\n    onOpen: (e)=>{console.log(`success websocket connection(${path})`)},\r\n    onClose: (e)=> {console.log(`closed websocket connection(${path})`)},\r\n  }, isActive && token!=null)\r\n  useEffect(()=>{\r\n    AsyncStorage.getItem('Authorization').then(setToken)\r\n    const onChange = (nextState:AppStateStatus)=>setIsActive(useBackground || nextState == 'active')\r\n    AppState.addEventListener(\"change\", onChange)\r\n    return ()=>AppState.removeEventListener(\"change\", onChange)\r\n  }, [])\r\n  return <Context.Provider value={token!=null?{lastJsonMessage, sendJsonMessage}:defaultContext}>\r\n      {children}\r\n    </Context.Provider>\r\n}\r\n\r\nexport const WebSocketProvider = ({disable, children}:{disable?:boolean, children:React.ReactNode})=>{\r\n  return disable?<>{children}</>:<WebSocketInternalProvider path={'messenger/ws/'} Context={WebSocketContext}>\r\n    {children}\r\n  </WebSocketInternalProvider>\r\n}\r\n\r\nexport default ()=>{\r\n  const webSocketContext = useContext(WebSocketContext)\r\n  return webSocketContext\r\n}\r\n\r\n","import React, { useState } from 'react';\r\nimport { StyleSheet} from 'react-native';\r\nimport { CustomButtonProps } from '../types';\r\nimport CommonButton from './CommonButton';\r\n\r\nexport default (props:CustomButtonProps)=>{\r\n    return <CommonButton {...props} style={[styles.style, props.style]}/>\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n    style:{\r\n        borderRadius:6, \r\n        backgroundColor: 'transparent',\r\n        borderWidth:0\r\n    },\r\n});\r\n","/**\r\n * If you are not familiar with React Navigation, refer to the \"Fundamentals\" guide:\r\n * https://reactnavigation.org/docs/getting-started\r\n *\r\n */\r\nimport { NavigationContainer, DefaultTheme, DarkTheme, NavigationContainerRef } from '@react-navigation/native';\r\nimport * as React from 'react';\r\n\r\nimport LinkingConfiguration from './LinkingConfiguration';\r\nimport RootNavigator from './RootNavigator';\r\n\r\nimport { useColorScheme as useDefaultColorScheme } from 'react-native';\r\nimport { useColorScheme as useColorScheme } from 'react-native-appearance';\r\nimport { ResizeContextProvider } from '../hooks/useResizeContext';\r\n\r\n\r\nconst navigationRef = React.createRef<NavigationContainerRef>();\r\n\r\nexport function navigate(name:string, params?:any) {\r\n  if (params)\r\n    navigationRef.current?.navigate(name, params);\r\n  navigationRef.current?.navigate(name);\r\n}\r\n\r\nexport default function Navigation() {\r\n  const defaultColorScheme = useDefaultColorScheme()\r\n  const userColorScheme = useColorScheme()\r\n  const colorScheme = userColorScheme =='no-preference'?defaultColorScheme:userColorScheme\r\n  return <NavigationContainer\r\n    ref={navigationRef}\r\n    documentTitle={{formatter: (options, route) => {return `TOKKI TOK`}}}\r\n    linking={(process.versions && process.versions['electron'])?undefined:LinkingConfiguration}\r\n    theme={colorScheme === 'dark' ? DarkTheme : DefaultTheme}>\r\n        <ResizeContextProvider>\r\n          <RootNavigator />\r\n        </ResizeContextProvider>\r\n  </NavigationContainer>\r\n}\r\n\r\n(function(l) {  // for github-page\r\n    if (l !== undefined && l.search[1] === '/' ) {\r\n        var decoded = l.search.slice(1).split('&').map(function(s) { \r\n        return s.replace(/~and~/g, '&')\r\n        }).join('?');\r\n        window.history.replaceState(null, '',\r\n            l.pathname.slice(0, -1) + decoded + l.hash\r\n        );\r\n    }\r\n}(window.location))\r\n    \r\nconst ignoreWarnings = ['ReactNativeFiberHostComponent'];\r\nlet _console:any = ()=>{}\r\nimport('lodash').then(_=>{\r\n  _console = _.clone(console);\r\n})\r\nconsole.warn = (message: string|Object) => {\r\n    var warn = true;\r\n    if (message instanceof Object)\r\n    warn = false;\r\n    else{\r\n    ignoreWarnings.forEach((value)=>{\r\n        if (message.indexOf && message.indexOf(value) <= -1) {\r\n            warn = false;\r\n        }\r\n    })\r\n    };\r\n    if (warn){\r\n        _console.warn(message);\r\n    }\r\n    else{\r\n        // console.log(message)\r\n    }\r\n};\r\n","import { useMutation, useQuery, useQueryClient } from \"react-query\";\r\nimport { postBulkMessengerMember, deleteMessengerMember, getMessengerMemberList } from \"../../apis\";\r\n\r\nexport default function useMessengerMemberList(channel_id:number){\r\n  const { data } = useQuery([\"MessengerMemberList\", channel_id] , async()=>await getMessengerMemberList(channel_id))\r\n  return data\r\n}\r\n\r\n\r\nexport function useMessengerMemberMutation(){\r\n  const queryClient = useQueryClient()\r\n  const invite = useMutation(postBulkMessengerMember, {\r\n    onSuccess: ()=>{\r\n      queryClient.invalidateQueries(\"MessengerMemberList\")\r\n    }\r\n  })\r\n\r\n  const leave = useMutation(deleteMessengerMember, {\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries(\"MessengerChannelList\")\r\n      queryClient.invalidateQueries(\"MessengerMemberList\")\r\n    }\r\n  })\r\n  return {invite:invite.mutateAsync, leave:leave.mutateAsync}\r\n}","import React, {useState, useEffect } from 'react';\r\nimport { StyleSheet } from 'react-native';\r\nimport { View, Text } from '../components/Themed';\r\nimport CommonButton from '../components/CommonButton';\r\n// import useBoardChannelList, { useBoardChannelMutation } from '../hooks/lists/useBoardChannelList';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport { navigate } from '../navigation';\r\nimport { Channel } from '../types';\r\nimport useMessengerChannelList, { useMessengerChannelMutation } from '../hooks/lists/useMessengerChannelList';\r\nimport TextField from '../components/TextField';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport ModalSection from '../components/ModalSection';\r\nimport { useMessengerMemberMutation } from '../hooks/lists/useMessengerMemberList';\r\nimport { avatarFromChannel } from '../components/Avatar';\r\n\r\nexport default function ChannelEditModal({id, member_id, type}: {id?:number, member_id?:number, type:string}) {\r\n  const { lang } = useLangContext()\r\n  const {auth} = useAuthContext()\r\n  const { setModal } = useModalsContext()\r\n  const channelList = useMessengerChannelList(auth)\r\n  const channelMutation = useMessengerChannelMutation()\r\n  const messengerMemberMutation = useMessengerMemberMutation()\r\n  const channel = channelList?.find(v=>v.id==id)\r\n  const [name, setName] = useState('')\r\n  const [description, setDescription] = useState('')\r\n  const back = ()=>{\r\n    setModal(ChannelEditModal, null)\r\n  }\r\n\r\n  useEffect(()=>{\r\n    if (channel){\r\n      const {name:_name} = avatarFromChannel(channel, auth.user)\r\n      setName(_name)\r\n      setDescription(channel?.description || '')\r\n    }\r\n  }, [channel])\r\n  return <ModalSection>\r\n    <View style={{justifyContent:'space-between', flex:1, width:'100%'}}>\r\n      <View style={{width:'100%'}}>\r\n        <Text style={{fontSize:20}}>{id?lang('Chat Setting'):lang('New chat')}</Text>\r\n        <View style={styles.separator} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n        <TextField name={lang('Channel Name')} value={name} setValue={setName} width={'60%'}/>\r\n        <TextField name={lang('Description')} value={description} setValue={setDescription} multiline width={'60%'}/>\r\n      </View>\r\n      <View style={{width:'100%', flexDirection:'row'}}>\r\n        {member_id &&<View style={{flexDirection:'row', justifyContent:'flex-start'}}>\r\n          <CommonButton title={lang('leave')} style={{marginHorizontal:5}} onPress={()=>messengerMemberMutation.leave(member_id).then(back)}/>\r\n        </View>}\r\n        <View style={{flex:1, flexDirection:'row', justifyContent:'flex-end'}}>\r\n          <CommonButton title={lang('save')} onPress={()=>{\r\n            if(auth?.user?.id && auth.groupId){\r\n              const newChannel:Channel = {id, name, description, type, owner:auth?.user?.id, group:auth.groupId};\r\n              (id?channelMutation.update(newChannel):channelMutation.create(newChannel)).then(v=>navigate(\"Main\", {\r\n                screen:v.type == 'messenger'?'ChatScreen':'BoardScreen',\r\n                params:{id:v.id}\r\n              }))\r\n            }\r\n          }}/>\r\n          <CommonButton title={lang('cancel')} style={{marginHorizontal:5}} onPress={back}/>\r\n        </View>\r\n      </View>\r\n    </View>\r\n  </ModalSection>\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  field:{\r\n    width:'50%',\r\n    flexDirection:'row',\r\n    padding:10,\r\n  },\r\n  separator: {\r\n    marginBottom: 20,\r\n    height: 1,\r\n    width: '100%',\r\n  },\r\n})","import React from 'react'\r\nimport TextButton from \"./TextButton\"\r\nimport useAuthContext from \"../hooks/useAuthContext\"\r\nimport useResizeContext from '../hooks/useResizeContext'\r\nimport { View } from 'react-native'\r\nimport useModalsContext from '../hooks/useModalsContext'\r\nimport GuestLogoutModal from '../modals/GuestLogoutModal'\r\nimport useLangContext from '../hooks/useLangContext'\r\n\r\ntype ButtonProps = {title:string, onPress:()=>void, windowType?:'landscape'|'portrait'}\r\n\r\nexport default (props:{extra?:ButtonProps[]})=>{\r\n    const { lang } = useLangContext()\r\n    const {auth, dispatch} = useAuthContext()\r\n    const { setModal } = useModalsContext()\r\n    const windowType = useResizeContext()\r\n    const defaultButtonProps:ButtonProps[] = [{title:lang('sign out'), onPress:()=>{\r\n        if (auth?.user?.username.endsWith(\".guest\")){\r\n            setModal(GuestLogoutModal, {})\r\n        }\r\n        else{\r\n            dispatch({type:\"LOGOUT_REQUEST\"})\r\n        }\r\n    }}]\r\n    const buttonProps = (props.extra?[...props.extra, ...defaultButtonProps]:defaultButtonProps).filter(v=>v.windowType==windowType || v.windowType == undefined)\r\n    return<View style={{flexDirection:'row'}}>\r\n        {buttonProps.map((v,k)=><TextButton key={k} {...v} textStyle={{color:'white'}} color='#gray'/>)}\r\n    </View>\r\n}\r\n  ","import { useQuery } from \"react-query\";\r\nimport { getUserMembershipList } from \"../../apis\";\r\nimport { Auth } from \"../useAuthContext\";\r\n\r\nexport default function useUserMembershipList(auth?:Auth){\r\n  const { data } = useQuery([\"UserMembershipList\", auth?.groupId] , async()=>auth?.groupId?(await getUserMembershipList(auth?.groupId)):[])\r\n  return data\r\n}","import React from 'react';\r\nimport { TabView, SceneMap,NavigationState, SceneRendererProps, TabBar } from 'react-native-tab-view';\r\nimport Colors from '../constants/Colors';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport { TabViewRecord } from '../types';\r\n\r\n\r\nexport default (props:{tabs:TabViewRecord, tabBarPosition:\"top\"|\"bottom\", index?:number, onTab?:(index:number)=>void})=>{\r\n  const { lang } = useLangContext()\r\n  const [index, setIndex] = React.useState(props.index || 0);\r\n  const theme = useColorScheme()\r\n  const entries = Object.entries(props.tabs)\r\n  const onTab = props.onTab\r\n  const icons = Object.assign({}, ...entries.map(([k, v])=>({[k]:v.icon})))\r\n  return <TabView\r\n    renderTabBar={(props:SceneRendererProps & {navigationState: NavigationState<any>})=>{\r\n      return <TabBar\r\n        {...props}\r\n        indicatorStyle={{ backgroundColor: \"#2196F3\" }}\r\n        style={{ backgroundColor:Colors[theme].background }}\r\n        activeColor={Colors[theme].text}\r\n        inactiveColor={Colors[theme].text}\r\n        renderIcon={(scene)=>icons[scene.route.key]}\r\n        onTabPress={(scene)=>onTab?.(entries.findIndex(([k, v])=>k == scene.route.key))}\r\n      />\r\n    }}\r\n    navigationState={{ index, routes: entries.map(([k, v])=>({key:k, title:lang(v.title)}))}}\r\n    onIndexChange={setIndex}\r\n    renderScene={SceneMap(Object.assign({}, ...entries.map(([k, v])=>({[k]:v.component}))))}\r\n    tabBarPosition={props.tabBarPosition}\r\n  />\r\n}\r\n\r\n","import * as React from 'react';\r\nimport { View } from './Themed';\r\nimport { StyleSheet, StyleProp, ViewStyle, TextStyle, Pressable } from 'react-native';\r\nimport Colors from '../constants/Colors';\r\n\r\nexport type ItemParamList = {\r\n    outerContainerStyle?:StyleProp<TextStyle>\r\n    containerStyle?:StyleProp<ViewStyle>\r\n    bodyStyle?:StyleProp<ViewStyle>\r\n    children?: React.ReactNode\r\n    onPress?: ()=>void\r\n}\r\n\r\nexport default function CommonItem(props:ItemParamList){\r\n  const [hover, setHover] = React.useState(false)\r\n  const [press, setPress] = React.useState(false)\r\n  return (\r\n    <Pressable\r\n      style={[styles.outerContainer ,props.outerContainerStyle, (press)?{backgroundColor:'rgb(242,242,242)'}:{}]}\r\n      onPressIn={()=>{setPress(true)}}\r\n      onPressOut={()=>{setPress(false);props.onPress?.()}}\r\n       //@ts-ignore\r\n       onHoverIn={()=>setHover(true)}\r\n       onHoverOut={()=>setHover(false)}\r\n    >\r\n        <View style={[styles.container ,props.containerStyle]}>\r\n            <View style={[styles.bodyView, props.bodyStyle]}>\r\n                <>{props.children}</>\r\n            </View>\r\n      </View>\r\n    </Pressable>\r\n    )\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  outerContainer:{\r\n    width:'100%',\r\n    maxWidth:1080,\r\n    alignItems:'stretch',\r\n  },  \r\n  container: {\r\n      marginHorizontal:20,\r\n      backgroundColor:'transparent'\r\n    },\r\n    bodyView:{\r\n      width: '100%',\r\n      padding: 10,\r\n      minHeight: 40,\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      borderBottomWidth:1,\r\n      borderColor:Colors.borderColor,\r\n      backgroundColor:'transparent'\r\n    }\r\n  });\r\n  ","import { useCallback, useEffect, useState } from \"react\"\r\nimport { InfiniteData, useInfiniteQuery, useMutation, useQueryClient } from \"react-query\"\r\nimport { getMessengerContentList, postMessage, deleteMessengerContent } from \"../../apis\"\r\nimport { MessengerContent } from \"../../types\"\r\nimport useWebsocketContext from \"../useWebsocketContext\"\r\n\r\nexport type MessengerContentPage = {\r\n  next?:MessengerContentPage\r\n  current:MessengerContent[]\r\n}\r\n\r\nexport default function useMessengerContentList(channel_id:number){  \r\n  const queryClient = useQueryClient()\r\n  const { data, fetchNextPage } = useInfiniteQuery<MessengerContentPage>(\r\n    [\"MessengerContentList\", channel_id], \r\n    async({pageParam})=>getMessengerContentList(channel_id, pageParam).then(current=>({current})), \r\n    {\r\n      select:data=>{\r\n        if(data.pages.length > 1)\r\n          data.pages[data.pages.length - 2].next = data.pages[data.pages.length - 1]\r\n        return data;\r\n      },\r\n      getNextPageParam:(lastPage)=>lastPage?.current.length?lastPage.current[lastPage.current.length - 1].id:undefined,\r\n      refetchOnReconnect:false,\r\n      refetchOnWindowFocus:true\r\n    }\r\n  )\r\n  const { lastJsonMessage } = useWebsocketContext()\r\n  useEffect(()=>{\r\n    if(lastJsonMessage !=null && lastJsonMessage['data']['channel'] == channel_id){\r\n      if(lastJsonMessage['type']=='next_message'){\r\n        queryClient.setQueryData<InfiniteData<MessengerContentPage>>([\"MessengerContentList\", channel_id], (_data)=>{\r\n          if(_data?.pages[0].current && _data?.pages[0].current[0].id != lastJsonMessage['data'].id)\r\n            _data.pages[0].current = [lastJsonMessage['data'], ..._data?.pages[0].current]\r\n          return {...(_data || {pages:[], pageParams:[]})}\r\n        })\r\n      }\r\n      if(lastJsonMessage['type']=='delete_message'){\r\n        queryClient.setQueryData<InfiniteData<MessengerContentPage>>([\"MessengerContentList\", channel_id], (_data)=>{\r\n          console.log(_data?.pages)\r\n          _data?.pages.forEach(page=>{\r\n            const len = page.current.length\r\n            const newCurrent = page.current.filter(v=>v.id!=lastJsonMessage['data'].id)\r\n            console.log(len, newCurrent)\r\n            if (len != newCurrent.length){\r\n              page.current = newCurrent\r\n            }\r\n          })\r\n          return {...(_data || {pages:[], pageParams:[]})}\r\n        })\r\n      }\r\n    }\r\n  }, [lastJsonMessage])\r\n  return { data, fetchNextPage }\r\n}\r\n\r\nexport function useMessengerContentMutation(){\r\n  // const queryClient = useQueryClient()\r\n  const create = useMutation(postMessage, {\r\n    onSuccess: () => {\r\n      // queryClient.setQueryData(['MessengerContentList'], (data:any) => ({\r\n      //   pages: data.pages.slice(0, 1),\r\n      //   pageParams: data.pageParams.slice(0, 1),\r\n      // }))\r\n      // queryClient.invalidateQueries(\"MessengerContentList\")\r\n    }\r\n  });\r\n  const _delete = useMutation(deleteMessengerContent, {\r\n    onSuccess: (d, variables) => {\r\n      // queryClient.setQueryData(['MessengerContentList'], (data:any) => ({\r\n      //   pages: (data.pages as MessengerContent[][]).map(v=>v.filter(v2=>v2.id != variables)),\r\n      //   pageParams: data.pageParams,\r\n      // }))\r\n    }\r\n  })\r\n  return { create:create.mutate, delete:_delete.mutate }\r\n}","import React from 'react';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport CommonButton from '../components/CommonButton';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport { Text, View } from '../components/Themed';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport { BottomSheet } from '../components/ModalSection';\r\n\r\nexport default function GuestLogoutModal({id}:{id:number}) {\r\n  const { lang } = useLangContext()\r\n  const { setModal } = useModalsContext()\r\n  const {dispatch} = useAuthContext()\r\n  const back = ()=>{\r\n    setModal(GuestLogoutModal, null)\r\n  }\r\n  return <BottomSheet>\r\n    <Text>{lang('Guest users cannot reconnect after logging out. Please create an account or log in.')}</Text>\r\n    <View style={{width:'100%', flexDirection:'row', justifyContent:'flex-end'}}>\r\n      <CommonButton title={lang('sign out')} onPress={()=>dispatch({type:\"LOGOUT_REQUEST\"})}/>\r\n      <CommonButton title={lang('cancel')} onPress={()=>back()}/>\r\n    </View>\r\n  </BottomSheet>\r\n}\r\n","import React, { useState } from 'react';\r\nimport { TextInput } from 'react-native';\r\nimport Colors from '../constants/Colors';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { CustomTextInputProps } from '../types';\r\n\r\nexport default (props:CustomTextInputProps)=>{\r\n    const [contentHeight, setContentHeight] = useState<number>()\r\n    const minHeight = props.minHeight || 30\r\n    const theme = useColorScheme()\r\n    return <TextInput style={[{\r\n            borderColor:'#d0d7de', \r\n            fontSize:16, \r\n            borderWidth:1, \r\n            borderRadius:6, \r\n            paddingHorizontal:10, \r\n            paddingVertical:3, \r\n            backgroundColor:Colors[theme].background,\r\n            color:Colors[theme].text,\r\n            height:props.multiline?contentHeight:minHeight,\r\n        }, props.style]} \r\n        editable={!props.disabled} \r\n        value={props.value} \r\n        onChangeText={props.setValue}\r\n        onContentSizeChange={props.multiline?(e) => setContentHeight(Math.max(e.nativeEvent.contentSize.height, minHeight) + 2):undefined}\r\n        onBlur={()=>props.onBlur?.(props.value)}\r\n        onEndEditing={()=>props.onEndEditing?.(props.value)}\r\n        multiline={props.multiline}\r\n    />\r\n}","import React from \"react\"\r\nimport CommonItem from \"./CommonItem\"\r\nimport { UserMembership } from \"../types\"\r\nimport Avatar from \"./Avatar\"\r\nimport { Text, View } from \"./Themed\"\r\n\r\nexport default ({member:item, onPress}:{member:UserMembership, onPress?:()=>void})=> {\r\n    return <CommonItem key={item.id} bodyStyle={{flexDirection:'row', justifyContent:'flex-start'}} onPress={onPress}>\r\n        <View style={{marginTop:4, marginRight:12}}><Avatar name={item.name} userId={item.id} size={44}/></View>\r\n        <Text style={{fontSize:20, fontWeight:'400'}}>{item.name}</Text>\r\n    </CommonItem>\r\n}","import React from 'react';\r\nimport Clipboard from '@react-native-clipboard/clipboard/dist';\r\nimport CommonButton from '../components/CommonButton';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport { Text, View } from '../components/Themed';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport { BottomSheet } from '../components/ModalSection';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport Colors from '../constants/Colors';\r\nimport { Ionicons } from '@expo/vector-icons';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { useMessengerContentMutation } from '../hooks/lists/useMessengerContentList';\r\n\r\nexport default function MessageModal({id, content}:{id:number, content:string}) {\r\n  const { lang } = useLangContext()\r\n  const { setModal } = useModalsContext()\r\n  const theme = useColorScheme()\r\n  const contentMutation = useMessengerContentMutation()\r\n  const back = ()=>{\r\n    setModal(MessageModal, null)\r\n  }\r\n  return <BottomSheet>\r\n    <View style={{flexDirection:'row', width:'100%'}}>\r\n      <View style={{flex:1, flexDirection:'row'}}>\r\n        <TouchableOpacity onPress={back}>\r\n          <Ionicons size={20} name=\"arrow-back\" color={Colors[theme].text}/>\r\n        </TouchableOpacity>\r\n      </View>\r\n      <View style={{flex:1}}>\r\n        <Text style={{fontSize:20, textAlign:'center'}}>{lang('Message')}</Text>\r\n      </View>\r\n      <View style={{flex:1}}/>\r\n    </View>\r\n    <View style={{marginBottom: 20, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n      <CommonButton style={{height:40, width:'100%', maxWidth:320, justifyContent:'center'}} title={lang('copy')} onPress={()=>{Clipboard.setString(content);back()}}/>\r\n      <CommonButton style={{height:40, width:'100%', maxWidth:320, justifyContent:'center'}} textStyle={{color:'red'}} title={lang('delete')} onPress={()=>{contentMutation.delete(id);back()}}/>\r\n  </BottomSheet>\r\n}\r\n","import React, { useEffect } from 'react';\r\nimport Profile from '../components/Profile';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport useUserMembershipList from '../hooks/lists/useUserMembershipList';\r\nimport { useMessengerChannelMutation } from '../hooks/lists/useMessengerChannelList';\r\nimport CommonButton from '../components/CommonButton';\r\nimport { Channel } from '../types';\r\nimport { navigate } from '../navigation';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport { Text, View } from '../components/Themed';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport { Ionicons } from '@expo/vector-icons';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport Colors from '../constants/Colors';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { BottomSheet } from '../components/ModalSection';\r\n\r\nexport default function ProfileModal({id}:{id:number}) {\r\n  const { lang } = useLangContext()\r\n  const theme = useColorScheme()\r\n  const {auth} = useAuthContext()\r\n  const { setModal } = useModalsContext()\r\n  const userList = useUserMembershipList(auth)\r\n  const user = userList?.find(v=>v.id==id)\r\n  const isSelf = auth.user && user && (auth.user?.id==user?.id)\r\n  const channelMutation = useMessengerChannelMutation()\r\n  const back = ()=>{\r\n    setModal(ProfileModal, null)\r\n  }\r\n  useEffect(()=>{\r\n    if (!(id && user) && userList)\r\n      back()\r\n  }, [userList])\r\n  return user?<BottomSheet>\r\n    <View style={{flexDirection:'row', width:'100%'}}>\r\n      <View style={{flex:1, flexDirection:'row'}}>\r\n        <TouchableOpacity onPress={back}>\r\n          <Ionicons size={20} name=\"arrow-back\" color={Colors[theme].text}/>\r\n        </TouchableOpacity>\r\n      </View>\r\n      <View style={{flex:1}}>\r\n        <Text style={{fontSize:20, textAlign:'center'}}>{lang('profile')}</Text>\r\n      </View>\r\n      <View style={{flex:1}}/>\r\n    </View>\r\n    <View style={{marginBottom: 20, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n    \r\n    <Profile username={user.username} name={user.name} userId={user.id} />\r\n    <CommonButton title={lang(isSelf?'Chat with me':'1:1 Chat')} onPress={()=>{\r\n      if(auth?.user?.id && auth.groupId){\r\n        const newChannel:Channel = {name:\"\", type:'messenger', owner:auth?.user?.id, group:auth.groupId, subowner:isSelf?undefined:user.id};\r\n        channelMutation.direct(newChannel).then(v=>navigate(\"Main\", {screen:\"ChatScreen\", params: {id:v.id}}))\r\n      }\r\n    }}/>\r\n  </BottomSheet>:<></>\r\n}\r\n","import React from 'react';\r\nimport {View} from 'react-native'\r\nimport {Text} from './Themed';\r\nimport { ProfileProps } from '../types';\r\nimport Avatar from './Avatar';\r\nimport TextButton from './TextButton';\r\nimport CommonTextInput from './CommonTextInput';\r\nimport { patchUser } from '../apis';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\n\r\nexport default (props:ProfileProps)=>{\r\n    const [name, setName] = React.useState<string>()\r\n    const { auth, dispatch } = useAuthContext()\r\n    const isSelf = auth.user?.id == props.userId\r\n    const onChange = ()=>{\r\n        isSelf && patchUser({id:props.userId, name:name || ''}).finally(()=>{\r\n            setName(undefined)\r\n            dispatch({type:\"REFRESH\"})\r\n        })\r\n    }\r\n    return <View style={{width:'100%', height:135, justifyContent:'space-evenly', alignItems:'center'}}>\r\n        <Avatar {...props} size={75}/>\r\n        {name===undefined?\r\n            <TextButton textStyle={{fontWeight:'bold', fontSize:15}} onPress={()=>isSelf && setName(props.name)} title={props.name} disabled={!isSelf}/>:\r\n            <CommonTextInput value={name} style={{textAlign:'center'}} setValue={setName} onBlur={onChange} onEndEditing={onChange} />}\r\n        <Text style={{fontWeight:'normal', fontSize:14}}>{props.username}</Text>\r\n    </View>\r\n}","import { useState,  useEffect } from \"react\"\r\nimport firebase from \"firebase/app\";\r\nimport \"firebase/messaging\";\r\nimport {FCM_PUBLIC_VAPID_KEY, FCM_API_KEY} from \"../constants/Envs\"\r\nimport { Notification as NotificationType, UserMembership } from \"../types\";\r\nimport { getNotification, postNotification, putNotification } from \"../apis/notification\";\r\nimport { Auth } from \"./useAuthContext\";\r\nconst firebaseConfig = require(\"../../web/firebase-config.js\")\r\n// Initialize Firebase\r\nconst key = firebaseConfig.messagingSenderId\r\nconst apiKeyEncrypted = (FCM_API_KEY as string).split('').map((v, i)=> (v.charCodeAt(0) ^ key.charCodeAt(i)).toString(16).padStart(2, '0')).join('')\r\nconst app = firebase.initializeApp({...firebaseConfig, apiKey:FCM_API_KEY});\r\n// const analytics = getAnalytics(app);\r\nconst messaging = firebase.messaging(app);\r\n\r\nmessaging.onMessage((payload) => {\r\n  if (!(\"Notification\" in window)) {\r\n    alert(\"This browser does not support desktop notification\");\r\n  }\r\n  else if (Notification.permission === \"granted\") {\r\n    const message_set = JSON.parse(payload.data['message_set'])[0]\r\n    new Notification(payload.data.channel_name, { body: `${payload.data.name}: ${message_set.content}` });\r\n  }\r\n});\r\n\r\nconst requestToken = async()=>{\r\n  const permission = await Notification.requestPermission();\r\n  if (permission === 'granted') {\r\n    const serviceWorkerRegistration = await navigator.serviceWorker.register(`${process.env.PUBLIC_URL}/firebase-messaging-sw.js?${apiKeyEncrypted}`)\r\n    console.log('[SW]: SCOPE: ', serviceWorkerRegistration.scope);\r\n    const currentToken = await messaging.getToken({serviceWorkerRegistration, vapidKey: FCM_PUBLIC_VAPID_KEY }).catch(\r\n      async()=>await messaging.getToken({serviceWorkerRegistration, vapidKey: FCM_PUBLIC_VAPID_KEY })\r\n    )\r\n    window.addEventListener('beforeunload', (event:any) => {\r\n      event.preventDefault();\r\n      serviceWorkerRegistration.unregister()\r\n    });\r\n    if (currentToken)\r\n      return currentToken\r\n  }\r\n  return undefined\r\n}\r\n\r\n\r\nlet noti:NotificationType|undefined\r\nlet notiListener:((enable:boolean)=>void)[] = []\r\n\r\nconst initEnable = async(user:UserMembership, callback:(enable:boolean)=>void)=>{\r\n  notiListener.push(callback)\r\n  if (notiListener.length == 1){  \r\n    noti = await getNotification(user.id)\r\n    if (noti === undefined){\r\n      noti = await postNotification({user:user.id, type:'WEB', token:null})\r\n    }\r\n    else if(noti.token){\r\n      requestToken().then(async token=>{\r\n        if(noti)\r\n          noti = await putNotification({...noti, token:(token||null)})\r\n        notiListener.map(c=>c(noti?.token?true:false))\r\n      })\r\n    }\r\n    notiListener.map(c=>c(noti?.token?true:false))\r\n  }\r\n}\r\n\r\nconst changeEnable = async(enable:boolean)=>{\r\n  if (noti){\r\n    if(enable){\r\n      const token = await requestToken() || null\r\n      noti = await putNotification({...noti, token})\r\n    }\r\n    else{\r\n      noti = await putNotification({...noti, token:null})\r\n    }\r\n  }\r\n  return noti?.token?true:false\r\n}\r\n\r\nexport default (auth:Auth)=>{\r\n  const [enable, setEnable] = useState<boolean|null>(null)\r\n  useEffect(()=>{\r\n    if (auth.user){\r\n      if(noti === undefined)\r\n        initEnable(auth.user, setEnable)\r\n      else{\r\n        setEnable(noti.token?true:false)\r\n        noti = undefined\r\n        notiListener = []\r\n      }\r\n    }else{\r\n      setEnable(false)\r\n    }\r\n  }, [auth.user])\r\n  return {\r\n    enable,\r\n    setEnable:(_enable:boolean)=>changeEnable(_enable).then(setEnable)\r\n  }\r\n}\r\n","import React from 'react'\r\nimport { View, StyleSheet, Linking, Platform } from 'react-native'\r\nimport { TouchableOpacity } from 'react-native-gesture-handler'\r\nimport { AntDesign } from '@expo/vector-icons'; \r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport Colors from '../constants/Colors';\r\n\r\nconst openURL = Platform.OS=='web'?(url:string)=>{location.href=url}:Linking.openURL\r\n\r\nexport default ()=>{\r\n    const theme = useColorScheme()\r\n    return<View style={Styles.footer_buttons}>\r\n        <TouchableOpacity style={Styles.footer_button} onPress={()=>openURL(\"https://github.com/blacktokki/tokki-tok\")}>\r\n            <AntDesign name=\"github\" size={24} color={Colors[theme].iconColor} />\r\n        </TouchableOpacity>\r\n        <TouchableOpacity style={Styles.footer_button} onPress={()=>Linking.openURL(\"mailto:ydh051541@naver.com\")}>\r\n            <AntDesign name=\"mail\" size={24} color={Colors[theme].iconColor} />\r\n        </TouchableOpacity>\r\n    </View>\r\n}\r\n\r\nconst Styles = StyleSheet.create({\r\n      footer_buttons: {\r\n        width: '100%',\r\n        flexDirection: 'row',\r\n        justifyContent: 'flex-end',\r\n        paddingBottom: 20,\r\n        paddingRight: 20,\r\n      },\r\n      footer_button: {\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        width: 38,\r\n        height: 38,\r\n        marginHorizontal: 12,\r\n        borderWidth: 1,\r\n        borderColor: '#E7E7E7',\r\n        borderRadius: 60,\r\n      },\r\n})","import React, {useLayoutEffect, useState} from 'react';\r\nimport {\r\n  Text,\r\n  TextInput,\r\n  TouchableOpacity,\r\n  View,\r\n  StyleSheet,\r\n} from 'react-native';\r\nimport { StackScreenProps } from '@react-navigation/stack';\r\nimport useAuthContext from '../../hooks/useAuthContext';\r\nimport useLangContext from '../../hooks/useLangContext';\r\nimport ContractFooter from '../../components/ContractFooter';\r\n\r\nexport default function LoginScreen({\r\n  navigation, route\r\n}: StackScreenProps<any, 'Login'>) {\r\n  const { lang } = useLangContext()\r\n  const [username, setUsername] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const {error, dispatch} = useAuthContext()\r\n  const _login = ()=>dispatch({type:'LOGIN_REQUEST', username, password})\r\n  useLayoutEffect(() => {\r\n    navigation.setOptions({\r\n      headerRight: undefined\r\n    });\r\n  }, [navigation, route]);\r\n\r\n  return (<View style={Styles.login_container}>\r\n    <View style={Styles.login_wrapper}>\r\n      <View style={Styles.form}>\r\n        {error && <View style={Styles.form_error}>\r\n          <Text style={Styles.form_error_text}>{lang(error)}</Text>\r\n        </View>}\r\n        <TextInput\r\n          style={Styles.form_input}\r\n          value={username}\r\n          placeholder={lang('Username')}\r\n          onChangeText={(text) => setUsername(text)}\r\n          autoCapitalize={'none'}\r\n          keyboardType={'email-address'}\r\n          onSubmitEditing={_login}\r\n        />\r\n        <TextInput\r\n          style={Styles.form_input}\r\n          value={password}\r\n          placeholder={lang('Password')}\r\n          secureTextEntry\r\n          onChangeText={(text) => setPassword(text)}\r\n          onSubmitEditing={_login}\r\n        />\r\n        <TouchableOpacity onPress={_login}>\r\n          <View style={Styles.button}>\r\n            <Text style={Styles.button_label}>{lang('Sign in')}</Text>\r\n          </View>\r\n        </TouchableOpacity>\r\n        <TouchableOpacity onPress={() => dispatch({type:\"LOGIN_GUEST\"})}>\r\n          <Text style={Styles.guest_footer_text}>\r\n            {lang(\"Sign in as guest\")}\r\n          </Text>\r\n        </TouchableOpacity>\r\n      </View>\r\n      <View style={Styles.login_social}>\r\n        <View style={Styles.login_social_separator}>\r\n          <View style={Styles.login_social_separator_line} />\r\n          <Text style={Styles.login_social_separator_text}>{'*'}</Text>\r\n          <View style={Styles.login_social_separator_line} />\r\n        </View>\r\n        <View style={Styles.login_social_buttons}>\r\n        </View>\r\n      </View>\r\n      {/* <>\r\n        <TouchableOpacity onPress={() => navigate(\"RegistrationScreen\")}>\r\n          <Text style={Styles.login_footer_text}>\r\n            {\"Don't have an account? \"}\r\n            <Text style={Styles.login_footer_link}>{'Sign up'}</Text>\r\n          </Text>\r\n        </TouchableOpacity>\r\n      </> */}\r\n    </View>\r\n    <ContractFooter/>\r\n  </View>);\r\n};\r\n\r\nconst Styles = StyleSheet.create({\r\n    login_container: {\r\n      flex: 1,\r\n      backgroundColor: '#FFF',\r\n    },\r\n    login_header: {\r\n      alignItems: 'center',\r\n      paddingTop: 30,\r\n      paddingBottom: 50,\r\n      backgroundColor: '#208AEC',\r\n    },\r\n    login_header_logo: {\r\n      width: 220,\r\n      resizeMode: 'contain',\r\n    },\r\n    login_header_text: {\r\n      marginTop: 15,\r\n      color: '#f0f0f0',\r\n      fontSize: 16,\r\n    },\r\n    login_header_text_bold: {\r\n      color: '#fff',\r\n      fontWeight: 'bold',\r\n    },\r\n    login_wrapper: {\r\n      flex: 1,\r\n      justifyContent: 'space-between',\r\n      paddingTop: 40,\r\n      borderTopRightRadius: 12,\r\n      borderTopLeftRadius: 12,\r\n      backgroundColor: '#fff',\r\n      alignItems: 'center',\r\n    },\r\n    form: {\r\n      width: '100%',\r\n      maxWidth: 320,\r\n    },\r\n    form_error: {\r\n      height: 22,\r\n      width:'100%',\r\n    },\r\n    form_error_text:{\r\n      textAlignVertical:'center',\r\n      color:'red',\r\n      fontSize:13,\r\n    },\r\n    form_input: {\r\n      height: 44,\r\n      paddingHorizontal: 20,\r\n      marginBottom: 20,\r\n      backgroundColor: '#EDF0F7',\r\n      borderRadius: 50,\r\n    },\r\n    button: {\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      height: 44,\r\n      backgroundColor: '#0065A4',\r\n      borderRadius: 50,\r\n    },\r\n    button_label: {\r\n      color: '#fff',\r\n      fontSize: 16,\r\n    },\r\n    login_social: {\r\n      width: '100%',\r\n      maxWidth: 280,\r\n      marginTop: 20,\r\n    },\r\n    login_social_separator: {\r\n      flexDirection: 'row',\r\n      alignItems: 'center',\r\n    },\r\n    login_social_separator_line: {\r\n      flex: 1,\r\n      width: '100%',\r\n      height: 1,\r\n      backgroundColor: '#E0E0E0',\r\n    },\r\n    login_social_separator_text: {\r\n      marginHorizontal: 10,\r\n      color: '#808080',\r\n      fontSize: 16,\r\n    },\r\n    login_social_buttons: {\r\n      flexDirection: 'row',\r\n      justifyContent: 'center',\r\n      marginTop: 20,\r\n    },\r\n    login_social_button: {\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      width: 60,\r\n      height: 60,\r\n      marginHorizontal: 12,\r\n      borderWidth: 1,\r\n      borderColor: '#E7E7E7',\r\n      borderRadius: 60,\r\n    },\r\n    login_social_icon: {\r\n      width: 38,\r\n      height: 38,\r\n      resizeMode: 'contain',\r\n    },\r\n    login_social_facebook: {\r\n      backgroundColor: '#4267B2',\r\n      borderColor: '#4267B2',\r\n    },\r\n    login_footer_text: {\r\n      flexDirection: 'row',\r\n      alignItems: 'center',\r\n      color: '#808080',\r\n      fontSize: 14,\r\n    },\r\n    guest_footer_text: {\r\n      flexDirection: 'row',\r\n      alignSelf: 'center',\r\n      color: '#808080',\r\n      fontSize: 15,\r\n      margin: 15\r\n    },\r\n    login_footer_link: {\r\n      color: '#208AEC',\r\n      fontSize: 15,\r\n      fontWeight: 'bold',\r\n    },\r\n  });\r\n  ","import React from 'react'\r\nimport { TouchableOpacity } from \"react-native-gesture-handler\"\r\nimport CommonSection from \"./CommonSection\"\r\nimport { Image, Linking, TextStyle } from \"react-native\"\r\nimport { View, Text } from \"./Themed\"\r\nimport { Link } from \"../types\"\r\n\r\n\r\n\r\nexport default ({link, isMobile}:{link:Link, isMobile:boolean})=>{\r\n    return <CommonSection containerStyle={{marginHorizontal:0}} bodyStyle={{padding:0}}>\r\n    <TouchableOpacity onPress={()=>Linking.openURL(link.url)} style={{flexDirection:'row'}} containerStyle={{width:'100%'}}>\r\n        {link.image && <Image source={{uri:link.image}} resizeMode=\"cover\" style={{ width:'100%', maxWidth:isMobile?120:150, maxHeight:isMobile?120:150, borderWidth:1}}/>}\r\n        <View style={{flex:1, marginHorizontal:20}}>\r\n        <Text style={{fontSize:18}}>{link.title}</Text>\r\n        <Text style={{fontSize:14}}>{link.description}</Text>\r\n        <Text style={{fontSize:12}}>{link.url}</Text>\r\n        </View>\r\n    </TouchableOpacity>\r\n    </CommonSection>\r\n}","import React, { createContext, useContext } from \"react\"\r\nimport { SendJsonMessage } from \"react-use-websocket/dist/lib/types\";\r\nimport { WebSocketInternalProvider } from \"../../hooks/useWebsocketContext\";\r\n\r\nconst WebSocketContext = createContext<{lastJsonMessage:any, sendJsonMessage:SendJsonMessage }>({lastJsonMessage:undefined, sendJsonMessage:()=>{}});\r\n\r\nexport const WebSocketProvider = ({disable, children}:{disable?:boolean, children:React.ReactNode})=>{\r\n  return disable?<></>:<WebSocketInternalProvider path={'messenger/ws/rtc/'} Context={WebSocketContext} useBackground>\r\n    {children}\r\n  </WebSocketInternalProvider>\r\n}\r\n\r\nexport default ()=>{\r\n  const webSocketContext = useContext(WebSocketContext)\r\n  return webSocketContext\r\n}\r\n\r\n","import React, { useCallback, useRef, useState, useMemo } from \"react\";\r\n//@ts-ignore\r\nimport { RTCView, mediaDevices, RTCPeerConnection, MediaStream, RTCSessionDescription, RTCIceCandidate } from \"react-native-webrtc-web-shim\";\r\nimport {TURN_SERVER} from \"../../../constants/Envs\"\r\n\r\n\r\nconsole.log(TURN_SERVER?\"use turn server\": \"use stun server\")\r\n\r\nexport const peerConstraints = {\r\n\ticeServers: [TURN_SERVER?JSON.parse(TURN_SERVER):{urls: 'stun:stun.l.google.com:19302'}]\r\n};\r\n\r\nexport const sessionConstraints = {\r\n\tmandatory: {\r\n\t\tOfferToReceiveAudio: true,\r\n\t\tOfferToReceiveVideo: true,\r\n\t\tVoiceActivityDetection: true\r\n\t}\r\n};\r\n\r\nconst mediaConstraints = {audio:true, video:{framerate:30}}\r\n\r\n//@ts-ignore\r\nexport {MediaStream, RTCPeerConnection, RTCSessionDescription} from \"react-native-webrtc-web-shim\";\r\n\r\nconst onICEcandidate = (pc:typeof RTCPeerConnection, message:any)=>{\r\n\tconst _message = message.data.rtcMessage\r\n\t\tconst candidate = new RTCIceCandidate(_message);\r\n\t\tif (pc) {\r\n\t\t\tconsole.log(\"ICE candidate Added\");\r\n\t\t\tpc.addIceCandidate(candidate);\r\n\t\t}\r\n}\r\n\r\nconst sendICEcandidate = (event:any, sendMessage:(data:any)=>void, receiver:string, target:string) => {\r\n\t// When you find a null candidate then there are no more candidates.\r\n\t// Gathering of candidates has finished.\r\n\tif ( !event.candidate ) { return; };\r\n\t// Send the event.candidate onto the person you're calling.\r\n\t// Keeping to Trickle ICE Standards, you should send the candidates immediately.\r\n\tsendMessage({type:'ICEcandidate', receiver, data:{target, rtcMessage:event.candidate}})\r\n  }\r\n\r\nconst BAND_WIDTH = 8000\r\n\r\nconst optimizeSdp = (offerDescription:RTCSessionDescription)=>{\r\n\tvar arr = offerDescription.sdp.split('\\r\\n');\r\n\tarr.forEach((str:string, i:number) => {\r\n\t\tif (/^a=fmtp:\\d*/.test(str)) {\r\n\t\t\tarr[i] = str + `;x-google-max-bitrate=${BAND_WIDTH};x-google-min-bitrate=${BAND_WIDTH};x-google-start-bitrate=${BAND_WIDTH}`;\r\n\t\t} else if (/^a=mid:(0|video)/.test(str)) { // if with audio then 0=>1\r\n\t\t\tarr[i] += `\\r\\nb=AS:${BAND_WIDTH}`;\r\n\t\t}\r\n\t});\r\n  \treturn new RTCSessionDescription({\r\n    \ttype: offerDescription.type,\r\n    \tsdp: arr.join('\\r\\n'),\r\n  \t})\r\n}\r\n\r\nconst createOffer = async(pcRefCurrent:{pc?:typeof RTCPeerConnection, receiver:string}, sendMessage:(data:any)=>void, stream:typeof MediaStream, target:string, user?:{name:string})=>{\r\n\tstream && pcRefCurrent.pc.addStream( stream );\r\n\tconst offerDescription = optimizeSdp((await pcRefCurrent.pc.createOffer( sessionConstraints )));\r\n\tawait pcRefCurrent.pc.setLocalDescription( offerDescription );\r\n\tsendMessage({type:'call', receiver:pcRefCurrent.receiver, data:{target, name:user?.name, rtcMessage:offerDescription}})\r\n}\r\n\r\nexport const useLocalCam = (sendMessage:(data:any)=>void)=>{\r\n\tconst pcRef = useRef<Record<number,{pc:typeof RTCPeerConnection, receiver:string}>>({})\r\n\tconst [sender, setSender] = useState<string>()\r\n\tconst [_stream, setStream] = useState<MediaStream>()\r\n\tconst isPlay = useMemo(()=>_stream?true:false, [_stream])\r\n\tconst CustomRTCView = useCallback(React.memo(({style}:{style:any})=>(_stream?<RTCView stream={_stream} style={style} videoProps={{height:'100%'}} />:<></>)) , [_stream])\r\n\tconst start = useCallback(async(user:{name:string}, stream?:typeof MediaStream, mode?:'camera'|'display')=>{\r\n\t\tconsole.log(\"start\");\r\n\t\tif (!_stream || mode!==undefined) {\r\n\t\t\ttry {\r\n\t\t\t\tlet newStream:typeof MediaStream;\r\n\t\t\t\tif(mode == 'camera'){\r\n\t\t\t\t\tnewStream = await mediaDevices.getUserMedia(mediaConstraints)\r\n\t\t\t\t}\r\n\t\t\t\telse if (mode == 'display'){\r\n\t\t\t\t\tnewStream = await mediaDevices.getDisplayMedia(mediaConstraints)\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tnewStream = stream || await mediaDevices.getUserMedia(mediaConstraints).catch((e:any)=>mediaDevices.getDisplayMedia(mediaConstraints));\r\n\t\t\t\t}\r\n\t\t\t\tsetStream(newStream)\r\n\t\t\t\tObject.entries(pcRef.current).map(([k, v])=>{\r\n\t\t\t\t\tcreateOffer(v, sendMessage, newStream, 'guest', user)\r\n\t\t\t\t})\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.error(e);\r\n\t\t\t}\r\n\t\t}\r\n\t}, [_stream])\r\n\tconst stop = useCallback(()=>{\r\n\t\tconsole.log(\"stop\");\r\n\t\tif(_stream){\r\n\t\t\t_stream.getTracks().map((track:any) => track.stop());\r\n\t\t\tsetStream(undefined)\r\n\t\t}\r\n\t}, [_stream])\r\n\treturn {\r\n\t\tstart,\r\n\t\tstop,\r\n\t\twebsocketOnMessage: async(response:any, user:{name:string})=>{\r\n\t\t\tlet type = response.type;\r\n\t\t\tif (type == 'connection'){\r\n\t\t\t\tsetSender(response.data.channel_name)\r\n\t\t\t}\r\n\t\t\tif (type == 'start' && response.data.target=='host'){\r\n\t\t\t  console.log('1 start')\r\n\t\t\t  const peerConnection = new RTCPeerConnection( peerConstraints );\r\n\t\t\t  peerConnection.addEventListener( 'icecandidate', (event:any) => sendICEcandidate(event, sendMessage, response.sender, 'guest'));\r\n\t\t\t  pcRef.current[response.sender] = {pc:peerConnection, receiver: response.sender}\r\n\t\t\t  createOffer(pcRef.current[response.sender], sendMessage, _stream, 'guest', user)\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (type == \"answer\" && response.data.target == 'host'){\r\n\t\t\t  console.log('3 answer')\r\n\t\t\t  const peerConnection = pcRef.current[response.sender].pc\r\n\t\t\t  const answerDescription = new RTCSessionDescription(response.data.rtcMessage);\r\n\t\t\t  await peerConnection.setRemoteDescription( answerDescription );\r\n\t\t\t  // const streams = pcRef.current.pc.getRemoteStreams()\r\n\t\t\t  // setMirrorStream(streams[streams.length - 1])\r\n\t\t\t}\r\n\t\t\tif (type == \"ICEcandidate\" && response.data.target=='host'){\r\n\t\t\t\tconst peerConnection = pcRef.current[response.sender].pc\r\n\t\t\t\tonICEcandidate(peerConnection, response)\r\n\t\t\t}\r\n\t\t},\r\n\t\tCustomRTCView,\r\n\t\tisPlay,\r\n\t\tsender,\r\n\t\t// renderMirrorView,\r\n\t}\r\n}\r\n\r\nexport const useRemoteCam = (sendMessage:(data:any)=>void)=>{\r\n\tconst pcRef = useRef<{pc?:RTCPeerConnection, receiver?:string, statsInterval?:any}>({})\r\n\tconst [user, setUser] = useState<{name:string}>()\r\n\tconst [_stream, setStream] = useState<MediaStream>()\r\n\tconst CustomRTCView = useCallback(React.memo((style:any)=>_stream?<RTCView stream={_stream} style={style} videoProps={{height:'100%'}} />:<></>), [_stream])\r\n\tconst isPlay = useMemo(()=>_stream?true:false, [_stream])\r\n\tconst start = useCallback((receiver:string)=>{\r\n\t\tconsole.log(\"start\");\r\n\t\tif (!pcRef.current.pc) {\r\n\t\t  pcRef.current.pc = new RTCPeerConnection( peerConstraints );\r\n\t\t  pcRef.current.receiver = receiver\r\n\t\t}\r\n\t\tif (!_stream){\r\n\t\t\tsendMessage({type:'start', receiver, data:{'target': 'host'}})\r\n\t\t}\r\n\t}, [_stream])\r\n\tconst stop = () => {\r\n\t\tconsole.log(\"stop\");\r\n\t\tif (pcRef.current.pc) {\r\n\t\t  // peerConnection._unregisterEvents();\r\n\t\t  setStream(undefined)\r\n\t\t  pcRef.current.pc.close();\r\n\t\t  pcRef.current.pc = undefined\r\n\t\t  pcRef.current.receiver = undefined\r\n\t\t  clearInterval(pcRef.current.statsInterval)\r\n\t\t}\r\n\t}\r\n\treturn {\r\n\t\tstart,\r\n\t\tstop,\r\n\t\twebsocketOnMessage: async(response:any)=>{\r\n\t\t\tlet type = response.type;\r\n\t\t\tif (type == 'start' && response.data.target=='guest' && response.sender == pcRef.current?.receiver){\r\n\t\t\t\tconsole.log('(remote)1 start')\r\n\t\t\t\tconst peerConnection = pcRef.current.pc\r\n\t\t\t\tsetUser({name: response.data.name})\r\n\t\t\t\tpeerConnection.addEventListener('icecandidate', (event:any) => sendICEcandidate(event, sendMessage, response.sender, 'host'));\r\n\t\t\t\tpeerConnection.addEventListener('iceconnectionstatechange', (e:any)=>{\r\n\t\t\t\t\tif (pcRef.current.pc.iceConnectionState == 'connected'){\r\n\t\t\t\t\t\tlet activeStream = false\r\n\t\t\t\t\t\tpcRef.current.statsInterval = setInterval(async()=>{\r\n\t\t\t\t\t\t\tconst stats = await pcRef.current.pc.getStats(null)\r\n\t\t\t\t\t\t\tlet statsOutput = \"\";\r\n\t\t\t\t\t\t\tlet framePerSecond = undefined\r\n\t\t\t\t\t\t\tstats.forEach((report:any) => {\r\n\t\t\t\t\t\t\t\tif (report.type === \"inbound-rtp\" && report.kind === \"video\") {\r\n\t\t\t\t\t\t\t\t\tObject.keys(report).forEach((statName) => {\r\n\t\t\t\t\t\t\t\t\t\tstatsOutput += `${statName}: ${report[statName]}\\n`;\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\tframePerSecond = report.framesPerSecond\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tconsole.log(activeStream, framePerSecond)\r\n\t\t\t\t\t\t\tif (framePerSecond != undefined){\r\n\t\t\t\t\t\t\t\tactiveStream = true\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (activeStream){\r\n\t\t\t\t\t\t\t\tstop()\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tconsole.log(new Date().toTimeString().split(' ')[0], statsOutput)\r\n\t\t\t\t\t\t}, 1000);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (pcRef.current.pc.iceConnectionState == 'failed'){\r\n\t\t\t\t\t\tstop()\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t// peerConnection.addTransceiver('audio', {\r\n\t\t\t\t// \tdirection: 'recvonly'\r\n\t\t\t\t// });\r\n\t\t\t\tpeerConnection.addTransceiver('video', {\r\n\t\t\t\t\tdirection: 'recvonly'\r\n\t\t\t\t});\r\n\t\t\t\tawait createOffer({pc:pcRef.current.pc, receiver:response.sender}, sendMessage, _stream, 'host', user)\r\n\t\t\t}  \r\n\t\t\tif (type == \"answer\" && response.data.target=='guest' && response.sender == pcRef.current?.receiver){\r\n\t\t\t\tconsole.log('(remote)3 answer')\r\n\t\t\t\tconst answerDescription = new RTCSessionDescription(response.data.rtcMessage);\r\n\t\t\t\tawait pcRef.current.pc.setRemoteDescription( answerDescription );\r\n\t\t\t\tconst streams = pcRef.current.pc.getRemoteStreams()\r\n\t\t\t\tsetStream(streams[streams.length - 1])\r\n\t\t\t\tsendMessage({type:'end', receiver:pcRef.current.receiver, data:{}})\r\n\t\t\t}\r\n\t\t\tif (type == \"call\" && response.sender == pcRef.current?.receiver){\r\n\t\t\t  console.log('2 call')\r\n\t\t\t  const peerConnection = pcRef.current.pc\r\n\t\t\t  setUser({name:response.data.name})\r\n\t\t\t  if (!peerConnection)\r\n\t\t\t\treturn\r\n\t\t\t  peerConnection.addEventListener( 'icecandidate', (event:any) => sendICEcandidate(event, sendMessage, response.sender, 'host'));\r\n\t\t\t  const offerDescription = new RTCSessionDescription(response.data.rtcMessage);\r\n\t\t\t  await peerConnection.setRemoteDescription( offerDescription );\r\n\t\t\t  const answerDescription = await peerConnection.createAnswer( sessionConstraints );\r\n\t\t\t  await peerConnection.setLocalDescription( answerDescription );\r\n\t\t\t  sendMessage({type:'answer', receiver:pcRef.current.receiver, data:{target:'host', rtcMessage:peerConnection.localDescription}})\r\n\t\t\t  // Here is a good place to process candidates.\r\n\t\t\t  const streams = pcRef.current.pc.getRemoteStreams()\r\n\t\t\t  setStream(streams[streams.length - 1])\r\n\t\t\t}\r\n\t\t\tif (type == \"ICEcandidate\" && response.data.target=='guest' && response.sender == pcRef.current?.receiver)\r\n\t\t\t  onICEcandidate(pcRef.current.pc, response)\r\n\t\t},\r\n\t\tCustomRTCView,\r\n\t\tuser,\r\n\t\tisPlay\r\n\t}\r\n}","import {StyleSheet} from \"react-native\";\r\nexport {useLocalCam, useRemoteCam} from \"./p2p\"\r\n\r\nexport const camStyle = StyleSheet.create({\r\n\tcontainer:{ flex: 1},\r\n\tcam:{ flex: 1, height:'100%'},\r\n\tbottonContainer: {position:\"absolute\", bottom:0, justifyContent:'flex-end'},\r\n\tbuttonBar: { flexDirection: \"row\", justifyContent: \"space-around\" },\r\n\tlabel: {backgroundColor:'#0008', color:'white', paddingHorizontal:5},\r\n})","import React, { useEffect } from \"react\";\r\nimport {Button, View, Text} from \"react-native\";\r\nimport useWebsocketContext from \"./useWebsocketContext\";\r\nimport { useLocalCam, camStyle} from \"./webrtc\";\r\n\r\n\r\nexport default (props:{user?:{name:string}|null, mode?:'camera'|'display'|null})=>{\r\n  const {lastJsonMessage, sendJsonMessage} = useWebsocketContext()\r\n  const {start, stop, websocketOnMessage, CustomRTCView, isPlay} = useLocalCam(sendJsonMessage)\r\n  useEffect(()=>{\r\n    props.user && lastJsonMessage && websocketOnMessage(lastJsonMessage, props.user)\r\n  }, [lastJsonMessage, props.user])\r\n  useEffect(()=>{\r\n    if(props.mode && !isPlay){\r\n      props.user && start(props.user, undefined, props.mode)\r\n    }\r\n    else if(props.mode===null && isPlay){\r\n      stop()\r\n    }\r\n    return ()=>{isPlay && stop()}\r\n  }, [isPlay, props.user, props.mode])\r\n  return (\r\n    <View style={camStyle.container}>\r\n      <CustomRTCView style={camStyle.cam}/>\r\n      <View style={camStyle.bottonContainer}>\r\n        <View style={camStyle.buttonBar}>  \r\n        </View>\r\n        <View style={{flexDirection:'row'}}><Text style={camStyle.label}>{props.user?.name}</Text></View>\r\n        <View style={camStyle.buttonBar}>\r\n          {props.mode === undefined && !isPlay && <Button title=\"Start\" onPress={()=>props.user && start(props.user)} />}\r\n          {props.mode === undefined && isPlay && <Button title=\"Stop\" onPress={stop} />}\r\n        </View>\r\n      </View>\r\n    </View>\r\n  );\r\n}\r\n","import React, { useState, useEffect, } from \"react\";\r\nimport {Button,Text, TextInput, View} from \"react-native\";\r\nimport useWebsocketContext from \"./useWebsocketContext\";\r\nimport { useRemoteCam, camStyle} from \"./webrtc\";\r\n\r\nexport default (props:{receiver?:string})=>{\r\n  const [receiver, setReceiver] = useState('')\r\n  const {lastJsonMessage, sendJsonMessage} = useWebsocketContext()\r\n  const {start, stop, websocketOnMessage, CustomRTCView, isPlay, user} = useRemoteCam(sendJsonMessage)\r\n  useEffect(()=>{\r\n    lastJsonMessage && websocketOnMessage(lastJsonMessage)\r\n  }, [lastJsonMessage])\r\n  useEffect(()=>{\r\n    if(props.receiver){\r\n      start(props.receiver)\r\n    }\r\n    return ()=>stop()\r\n  }, [props.receiver])\r\n  return (\r\n    <View style={camStyle.container}>\r\n      <CustomRTCView style={camStyle.cam}/>\r\n      <View style={camStyle.bottonContainer}>\r\n        <View style={camStyle.buttonBar}>\r\n        </View>\r\n        <View style={{flexDirection:'row'}}>{\r\n          (props.receiver || isPlay)?\r\n          <Text style={camStyle.label}>{user?.name || 'loading...'}</Text>:\r\n          <>\r\n            <Text style={{borderWidth:1}}>Receiver:&nbsp;</Text>\r\n            <TextInput style={{borderWidth:1, flex:1}} value={receiver} onChangeText={setReceiver}/>\r\n          </> \r\n        }</View>\r\n        <View style={camStyle.buttonBar}>\r\n          {props.receiver === undefined && !isPlay && <Button title=\"Start\" onPress={()=>start(receiver)} />}\r\n          {props.receiver === undefined && isPlay && <Button title=\"Stop\" onPress={stop} />}\r\n        </View>\r\n      </View>\r\n    </View>\r\n  );\r\n}\r\n\r\n","import React, {useEffect, useState} from 'react';\r\nimport { StyleSheet, View } from 'react-native';\r\nimport { View as ThemedView } from '../../../components/Themed' \r\nimport Colors from '../../../constants/Colors';\r\nimport {default as useRtcContext, WebSocketProvider as RtcProvider} from \"../../../lib/react-native-webrtc/useWebsocketContext\";\r\nimport LocalCam from '../../../lib/react-native-webrtc/LocalCam';\r\nimport RemoteCam from '../../../lib/react-native-webrtc/RemoteCam';\r\nimport useResizeContext from '../../../hooks/useResizeContext';\r\nimport useAuthContext from '../../../hooks/useAuthContext';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport CommonButton from '../../../components/CommonButton';\r\nimport { Ionicons } from '@expo/vector-icons';\r\nimport useIsMobile from '../../../hooks/useIsMobile';\r\n\r\ntype VideoType = 'camera'|'display'|null\r\ntype VideoCallProps = {channel_id:number, setDisable:(disable:boolean)=>void, disable?:boolean}\r\n\r\n\r\nconst VideoView = (props:{\r\n  scale:string,\r\n  focusGuest?:string,\r\n  setFocusGuest:(focusGuest?:string)=>void\r\n  receiver?:string\r\n  children:React.ReactNode\r\n})=>{\r\n  return <View style={[{maxWidth:props.scale, maxHeight:props.scale, borderWidth:1, borderColor:Colors.borderColor, backgroundColor:'gray', flexDirection:'row', flexGrow:1}, (props.focusGuest == undefined || props.focusGuest == props.receiver)?{height:'100%'}:{maxWidth:0, height:0}]}>\r\n    <TouchableOpacity style={{flex:1}} containerStyle={{flex:1, justifyContent:'center'}} onPress={()=>props.setFocusGuest(props.focusGuest?undefined:props.receiver)}>\r\n    {props.children}\r\n    </TouchableOpacity>\r\n  </View>\r\n    \r\n  \r\n}\r\n\r\nconst VideoCallContainer = ({channel_id, disable, setDisable}:VideoCallProps)=>{\r\n  const {auth} = useAuthContext()\r\n  const isMobile = useIsMobile()\r\n  const [videoMode, setVideoMode] = useState<VideoType>(null)\r\n  const [guests, setGuests] = useState<string[]>([])\r\n  const [focusGuest, setFocusGuest] = useState<string>()\r\n  const windowType = useResizeContext()\r\n  const { lastJsonMessage, sendJsonMessage } = useRtcContext()\r\n  useEffect(()=>{\r\n    if(lastJsonMessage !=null){\r\n      if(lastJsonMessage['type']=='connection'){\r\n        sendJsonMessage({'type':'broadcast', 'data':{'channel_id':channel_id}})\r\n      }\r\n      if(lastJsonMessage['type']=='broadcast_guest' || lastJsonMessage['type']=='broadcast_host'){\r\n        setGuests([...guests, lastJsonMessage['sender']])\r\n      }\r\n      if(lastJsonMessage['type']=='broadcast_disconnect'){\r\n        const channel_name = lastJsonMessage['sender']\r\n        const exist = guests.find(v=>v == channel_name)\r\n        exist && setGuests(guests.filter(v=>v != channel_name))\r\n      }\r\n    }\r\n  }, [lastJsonMessage])\r\n  const scale = focusGuest?'100%':`${100 / Math.max(2, Math.ceil(Math.sqrt(guests.length + 1)))}%`\r\n  const toggleVideoMode = (mode:VideoType)=>{\r\n    setVideoMode(videoMode!=mode?mode:null)\r\n  }\r\n  return lastJsonMessage !==undefined ?\r\n    <ThemedView style={[\r\n      {aspectRatio:!disable?16/9:0, borderColor:Colors.borderColor, borderRadius:10},\r\n      windowType=='landscape'?{flexShrink:1, flexGrow:0, height:'100%', borderLeftWidth:1, paddingBottom:65}:{maxHeight:'36%', width:'100%', borderBottomWidth:1}\r\n    ]}>\r\n      <View style={{aspectRatio:focusGuest?undefined:16/9, backgroundColor:'white', flexWrap:'wrap', flexDirection:'row', width:'100%', height:'100%'}}>\r\n        {guests.map((receiver, i)=><VideoView scale={scale} focusGuest={focusGuest} setFocusGuest={setFocusGuest} receiver={receiver}>\r\n          <RemoteCam receiver={receiver}/>\r\n        </VideoView>\r\n        )}\r\n        <VideoView scale={scale} focusGuest={focusGuest} setFocusGuest={setFocusGuest} receiver={auth.user?.name}>\r\n          <LocalCam user={auth.user} mode={videoMode}/>\r\n        </VideoView>\r\n      </View>\r\n      <ThemedView style={[\r\n          {position:'absolute', alignItems:'center', justifyContent:'flex-end', width:'100%',flexDirection:'row'},\r\n          windowType=='landscape'?{bottom:0, paddingTop:15, paddingBottom:10, paddingHorizontal:19}:{backgroundColor:'transparent'}\r\n        ]}>\r\n        <CommonButton title={''} style={{height:40, paddingTop:8}} onPress={()=>toggleVideoMode('camera')}/>\r\n        {!isMobile && <CommonButton title={''} style={{height:40, paddingTop:8}} onPress={()=>toggleVideoMode('display')}/>}\r\n        <CommonButton title={''} style={{height:40, paddingTop:8}} onPress={()=>setDisable(true)}>\r\n          <Ionicons size={20} name=\"arrow-back\" color={'deepskyblue'}/>\r\n        </CommonButton>\r\n      </ThemedView>\r\n    </ThemedView>:\r\n  <></>\r\n  }\r\n  \r\nexport default React.memo(({channel_id, disable, setDisable}:VideoCallProps)=>{\r\n  return <RtcProvider disable={disable}>\r\n    <VideoCallContainer channel_id={channel_id} disable={disable} setDisable={setDisable}/>\r\n  </RtcProvider>\r\n})\r\n","import React from 'react'\r\nimport { TouchableOpacity } from \"react-native-gesture-handler\"\r\nimport CommonSection from \"./CommonSection\"\r\nimport { Linking, TextStyle } from \"react-native\"\r\nimport { FontAwesome } from '@expo/vector-icons'; \r\nimport { View, Text } from \"./Themed\"\r\nimport { File } from \"../types\"\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport Colors from '../constants/Colors';\r\n\r\nfunction humanFileSize(size:number) {\r\n    var i = size == 0 ? 0 : Math.floor(Math.log(size) / Math.log(1024));\r\n    return (size / Math.pow(1024, i)).toFixed(2) + ' ' + ['B', 'kB', 'MB', 'GB', 'TB'][i];\r\n  }\r\n  \r\n\r\nexport default ({file, isMobile, showBorder}:{file:File, isMobile:boolean, showBorder:boolean})=>{\r\n    const theme = useColorScheme()\r\n    return <CommonSection containerStyle={{marginHorizontal:0}} bodyStyle={showBorder?{padding:10}:{borderWidth:0, padding:0}}>\r\n    <TouchableOpacity onPress={()=>Linking.openURL(file.file)} style={{flexDirection:'row', alignItems:'flex-start'}} containerStyle={{width:'100%'}}>\r\n        <FontAwesome name=\"file-o\" size={20} color={Colors[theme].iconColor} />\r\n        <View style={{flex:1, marginHorizontal:10}}>\r\n            <Text style={{fontSize:18}}>{file.filename}</Text>\r\n            <Text style={{fontSize:14}}>{humanFileSize(file.filesize)}</Text>\r\n        </View>\r\n    </TouchableOpacity>\r\n    </CommonSection>\r\n}","import React, {useState, useEffect} from \"react\"\r\nimport dayjs from \"dayjs\";\r\nimport {View, TouchableOpacity} from 'react-native'\r\nimport { Text } from \"../../../components/Themed\";\r\nimport useTimerMessageContentList from \"../../../hooks/lists/useTimerMessageContent\";\r\nimport { MessengerContent } from \"../../../types\";\r\nimport Avatar from \"../../../components/Avatar\";\r\nimport Hyperlink from \"react-native-hyperlink\";\r\n\r\nexport function timerFormat(datetime:string){\r\n    return _timerFormat(dayjs(datetime), dayjs())\r\n}\r\n\r\nfunction _timerFormat(m:dayjs.Dayjs, now:dayjs.Dayjs){\r\n    if (m.year() != now.year()){\r\n        return m.format('YYYY.MM')\r\n    }\r\n    if(m.month()!= now.month() || m.day() != now.day()){\r\n        return m.format('MM.DD')\r\n    }\r\n    return m.format('HH:mm')\r\n  }\r\n\r\nexport function timerToString(timer:string){\r\n    return dayjs(timer).format('YYYY.MM.DD HH:mm')\r\n}\r\n\r\nconst TimerTag = (props:{data:MessengerContent, now:dayjs.Dayjs, isExpand:boolean, setExpand:(id?:number)=>void})=>{\r\n    const start = dayjs(props.data.created)\r\n    const end = dayjs(props.data.timer)\r\n    const ratio = (start.diff(props.now)/start.diff(end))\r\n    return <TouchableOpacity onPress={()=>props.setExpand(props.isExpand?undefined:props.data.id)}>\r\n        <View style={{backgroundColor:'lightgray', borderRadius:20, overflow:'hidden', margin:5}}>\r\n            <View style={{backgroundColor:'darkgray', position:'absolute', width:`${ratio*100}%`, height:'100%'}}/>\r\n            {props.isExpand?\r\n            <View style={{paddingVertical:5, paddingHorizontal:5, maxWidth:270}}>\r\n                <View style={{flexDirection:'row'}}>\r\n                    <Avatar name={props.data.name} userId={props.data.user} size={20}/>\r\n                    <View style={{paddingHorizontal:5}}><Text>{props.data.name}</Text></View>\r\n                </View>\r\n                <View style={{flexDirection:'row', alignItems:'stretch'}}>\r\n                    <Text></Text>\r\n                    <Text selectable>{timerToString(props.data.timer)}</Text>\r\n                </View>\r\n                {/* @ts-ignore */}\r\n                <Hyperlink linkDefault={ true } style={{wordBreak:\"break-word\"}} linkStyle={{color: '#12b886'}}>\r\n                    <Text selectable>{props.data.message_set[0].content}</Text>\r\n                </Hyperlink>\r\n            </View>:    \r\n            <View style={{paddingVertical:5, paddingHorizontal:5, flexDirection:'row'}}>\r\n                <Avatar name={props.data.name} userId={props.data.user} size={20}/>\r\n                <View style={{paddingHorizontal:5}}><Text>{_timerFormat(end, props.now)}</Text></View>\r\n            </View>}\r\n        </View>\r\n    </TouchableOpacity>\r\n}\r\n\r\n\r\nexport default (props:{channel_id:number})=>{\r\n    const timerMessages = useTimerMessageContentList(props.channel_id)\r\n    const [now, setNow] = useState(dayjs())\r\n    const [expand, setExpand] = useState<number>()\r\n    useEffect(()=>{\r\n        const timeout = setTimeout(()=>{\r\n            setNow(dayjs())\r\n        }, 2000)\r\n        return ()=>clearTimeout(timeout)\r\n    }, [now])\r\n    return <View style={{flexDirection:'row', paddingTop:5, paddingHorizontal:20}}>\r\n        {timerMessages?.map((v,i)=><TimerTag key={i} data={v} now={now} isExpand={v.id==expand} setExpand={setExpand}/>)}\r\n    </View>\r\n}","import { useEffect, useMemo } from \"react\"\r\nimport { useQuery, useQueryClient } from \"react-query\"\r\nimport { getTimerMessageContentList } from \"../../apis\"\r\nimport { MessengerContent } from \"../../types\"\r\nimport useWebsocketContext from \"../useWebsocketContext\"\r\nimport dayjs from \"dayjs\"\r\n\r\nexport default function useTimerMessageContentList(channel_id:number){  \r\n  const queryClient = useQueryClient()\r\n  const { data } = useQuery<MessengerContent[]>(\r\n    [\"TimerMessageContentList\", channel_id], \r\n    async()=>await getTimerMessageContentList(channel_id, dayjs().toISOString()), \r\n  )\r\n  const { lastJsonMessage } = useWebsocketContext()\r\n  useEffect(()=>{\r\n    if(lastJsonMessage !=null && lastJsonMessage['data']['channel'] == channel_id){\r\n      if(lastJsonMessage['type']=='next_message'){\r\n        if(lastJsonMessage['data']['timer'] && dayjs() < dayjs(lastJsonMessage['data']['timer']))\r\n          queryClient.setQueryData<MessengerContent[]>([\"TimerMessageContentList\", channel_id], (_data)=>{\r\n            return [...(_data || []), lastJsonMessage['data']]\r\n          })\r\n      }\r\n      if(lastJsonMessage['type']=='delete_message'){\r\n        queryClient.setQueryData<MessengerContent[]>([\"TimerMessageContentList\", channel_id], (_data)=>{\r\n          return [...(_data?.filter(v=>v.id!=lastJsonMessage['data'].id) || [])]\r\n        })\r\n      }\r\n    }\r\n  }, [lastJsonMessage])\r\n  const sorted = useMemo(()=>data?.sort((a, b)=>(a.timer || '') > (b.timer || '')?1:-1), [data])\r\n  useEffect(()=>{\r\n    if (sorted?.[0]?.timer){\r\n      const id = sorted[0].id\r\n      const ms = Math.min(dayjs(sorted[0].timer).diff(dayjs()), Number.MAX_VALUE)\r\n      let timeout = setTimeout(()=>{\r\n        queryClient.setQueryData<MessengerContent[]>([\"TimerMessageContentList\", channel_id], (_data)=>{\r\n          return (_data || []).filter(v=>v.id!=id || dayjs(v.timer).diff(dayjs()) > 0)\r\n        })\r\n      }, ms)\r\n      return ()=>clearTimeout(timeout)\r\n    }\r\n  },[sorted])\r\n  return sorted\r\n}\r\n","import React, {useCallback, useEffect, useLayoutEffect, useMemo, useRef, useState} from 'react';\r\nimport { StackScreenProps } from '@react-navigation/stack';\r\nimport { Platform, StyleSheet, View, TouchableOpacity } from 'react-native';\r\nimport CommonSection from '../../../components/CommonSection';\r\nimport { FlatList, TextInput } from 'react-native-gesture-handler';\r\nimport CommonButton from '../../../components/CommonButton';\r\nimport useMessengerContentList, { MessengerContentPage, useMessengerContentMutation } from '../../../hooks/lists/useMessengerContentList';\r\nimport useAuthContext from '../../../hooks/useAuthContext';\r\nimport HeaderRight from '../../../components/HeaderRight';\r\nimport useMessengerMemberList from '../../../hooks/lists/useMessengerMemberList';\r\nimport Colors from '../../../constants/Colors';\r\nimport useColorScheme from '../../../hooks/useColorScheme';\r\nimport { Text, View as ThemedView } from '../../../components/Themed' \r\nimport Hyperlink from 'react-native-hyperlink'\r\nimport useMessengerChannelList from '../../../hooks/lists/useMessengerChannelList';\r\nimport useIsMobile from '../../../hooks/useIsMobile';\r\nimport LinkPreview from '../../../components/LinkPreview';\r\nimport Avatar, { avatarFromChannel } from '../../../components/Avatar';\r\nimport VideoCallSection from './VideoCallSection';\r\nimport useResizeContext from '../../../hooks/useResizeContext';\r\nimport FilePreview from '../../../components/FilePreview';\r\nimport useModalsContext from '../../../hooks/useModalsContext';\r\nimport InviteModal from '../../../modals/InviteModal';\r\nimport DateTimePickerModal from '../../../modals/DateTimePickerModal'\r\nimport useLangContext from '../../../hooks/useLangContext';\r\nimport { Entypo } from '@expo/vector-icons';\r\nimport TimerTags, { timerFormat, timerToString } from './TimerTags';\r\nimport MessageModal from '../../../modals/MessageModal';\r\nimport ChannelEditModal from '../../../modals/ChannelEditModal';\r\n\r\n\r\nfunction uploadFile(){\r\n  return new Promise<Blob|undefined>((resolve, reject)=>{\r\n    if (Platform.OS == 'web'){\r\n      var input = document.createElement('input');\r\n      input.type = 'file';\r\n      input.onchange = e => { \r\n        resolve((e.target as any).files[0])\r\n      }\r\n      input.onabort = reject\r\n      input.onerror = reject\r\n      input.click();\r\n    }\r\n    else\r\n      resolve(undefined)\r\n  })\r\n}\r\n\r\nconst MessengerContentPageItem = React.memo((props:MessengerContentPage & {ownerId?:number})=>{\r\n  const isMobile = useIsMobile()\r\n  const { setModal } = useModalsContext()\r\n  let nextPage = props.next;\r\n    while(nextPage?.next && nextPage.current.length==0){\r\n      nextPage = nextPage.next\r\n    }\r\n    const nextContent = nextPage?.current[0]\r\n    return <View style={{flexDirection: 'column-reverse'}}>\r\n      \r\n      {props.current.map((content, index2)=>{\r\n        const next = index2 + 1 < props.current.length?props.current[index2+1]:nextContent\r\n        const created:string = content.created.slice(0, 16)\r\n        const date = created.slice(0, 10)\r\n        const isSystem = content.user == null\r\n        const isFirst = next==undefined || (content.user != next.user || created != next.created.slice(0, 16))\r\n        const isSelf = props.ownerId == content.user\r\n        const dayChanged = next==undefined || date != next.created.slice(0, 10)\r\n        const message = content.message_set[0]\r\n        const openModal = ()=>setModal(MessageModal, {id:content.id, content:message.content})\r\n        if (isSystem)\r\n          return <View key={content.id} style={{flexDirection:'row', justifyContent:'center', width:'100%', marginVertical:5}}>\r\n            <Text>{message.content}</Text>\r\n          </View>\r\n        return <View key={content.id}>\r\n          {dayChanged?<View style={{flexDirection:'row', justifyContent:'center', width:'100%'}}><Text>{date}</Text></View>:undefined}\r\n          <View key={content.id} style={{flexDirection:'row', justifyContent:isSelf?'space-between':'flex-start', width:'100%'}}>\r\n            {isFirst && !isSelf? <View style={{marginTop:3, marginLeft:12}}><Avatar name={content.name} userId={content.user} size={36}/></View>:<View style={{width:48}}/>}\r\n            <CommonSection outerContainerStyle={{width:undefined, maxWidth:'90%'}} title={isFirst?content.name:undefined} titleStyle={{flex:undefined}} bodyStyle={{padding:10}} subtitle={`${created.slice(11)}`}>\r\n              <TouchableOpacity onLongPress={openModal}>\r\n                {content.timer && <View style={{flexDirection:'row', alignItems:'stretch'}}>\r\n                  <Text style={{fontSize:12}}></Text>\r\n                  <Text style={{fontSize:12}} selectable={!isMobile}>{timerToString(content.timer)}</Text>\r\n                </View>}\r\n                <View style={{width:\"100%\"}}>\r\n                  {/* @ts-ignore */}\r\n                  <Hyperlink linkDefault={ true } style={{wordBreak:\"break-word\"}} linkStyle={{color: '#12b886'}}>\r\n                    <Text selectable={!isMobile} style={{textAlign:isSelf?'right':'left'}}>{message.content}</Text>\r\n                  </Hyperlink>\r\n                </View>\r\n              {content.file_set.map((file, fileIndex)=><FilePreview key={fileIndex} file={file} isMobile={isMobile} showBorder={content.file_set.length>1 || message.content.length>0}/>)}\r\n              {content.link_set.map((link, linkIndex)=><LinkPreview key={linkIndex} link={link} isMobile={isMobile}/>)}\r\n              </TouchableOpacity>        \r\n            </CommonSection>\r\n          </View>\r\n        </View>\r\n      })}\r\n    </View>\r\n\r\n})\r\n\r\nexport default function ChatScreen({navigation, route}: StackScreenProps<any, 'Chat'>) {\r\n  const { lang, locale } = useLangContext()\r\n  const isMobile = useIsMobile()\r\n  const channel_id = route?.params?.id\r\n  const height = useRef(0)\r\n  const inputRef = useRef<TextInput>(null)\r\n  const {auth} = useAuthContext()\r\n  const { setModal } = useModalsContext()\r\n  const channel = useMessengerChannelList(auth)?.find(v=>v.id==parseInt(channel_id))\r\n  const channelAvatar = channel?avatarFromChannel(channel, auth.user):undefined\r\n  const {data, fetchNextPage } = useMessengerContentList(channel_id)\r\n  const memberList = useMessengerMemberList(channel_id)\r\n  const member_id = useMemo(()=>memberList?.find(v=>v.user == auth.user?.id)?.id, [auth, memberList])\r\n  const windowType = useResizeContext()\r\n  const [value, setValue] = useState('')\r\n  const [timer, setTimer] = useState<string>()\r\n  const [autoFocus, setAutoFocus] = useState<boolean|null>(null)\r\n  const [videoMode, setVideoMode] = useState<boolean>(false)\r\n  const [bottomTab, setBottomTab] = useState<boolean>(false)\r\n\r\n  const theme = useColorScheme()\r\n  const postValue = ()=>{\r\n    if (value.length>0){\r\n      contentMutation.create({channel:channel_id, user:auth.user?.id, content:value, timer})\r\n      setValue('')\r\n      setTimer(undefined)\r\n      setBottomTab(false)\r\n      setAutoFocus(true)\r\n    }\r\n  }\r\n  const contentMutation = useMessengerContentMutation()\r\n\r\n  useLayoutEffect(() => {\r\n    navigation.setOptions({\r\n      headerRight: ()=> <HeaderRight extra={[\r\n        {title:lang('invite'), onPress:()=>setModal(InviteModal, {id:channel_id})},\r\n        {title:lang('setting'), onPress:()=>setModal(ChannelEditModal, {id:channel_id, type:'messenger', member_id})}\r\n      ]}/>,\r\n      title: channelAvatar?.name\r\n    });\r\n  }, [navigation, route, member_id, locale]);\r\n\r\n  const renderItem = useCallback(({item, index}:{item:MessengerContentPage, index:number})=><MessengerContentPageItem {...item} ownerId={auth.user?.id}/>, [auth])\r\n  \r\n  const back = ()=>{\r\n    if(navigation.canGoBack())\r\n        navigation.goBack()\r\n      else{\r\n        navigation.navigate('HomeScreen', {tab:2})\r\n      }\r\n  }\r\n  useEffect(()=>{\r\n    setModal(null, null)\r\n    if (!channel_id)\r\n      back()\r\n  }, [route])\r\n  useEffect(()=>{\r\n    if (memberList===null || (memberList!=undefined && memberList.find(v=>v.user==auth.user?.id)==undefined))\r\n      back()\r\n  }, [memberList])\r\n  useEffect(()=>{\r\n    if(autoFocus){\r\n      (inputRef.current as any).focus()\r\n      setAutoFocus(false)\r\n    }\r\n  }, [autoFocus])\r\n  useEffect(()=>{\r\n    if (autoFocus==null && !isMobile){\r\n      const timeout = setTimeout(()=>setAutoFocus(true), 500)\r\n      return ()=>clearTimeout(timeout)\r\n    }\r\n  })\r\n  return <View style={[\r\n    {flex:1, alignItems:'center'},\r\n    windowType=='landscape'?{flexDirection:'row-reverse', minWidth:480}:{flexDirection:'column'}\r\n  ]}>\r\n    <VideoCallSection channel_id={channel_id} setDisable={(d)=>setVideoMode(!d)} disable={!videoMode}/>\r\n    <View style={[{flex:videoMode?undefined:1, flexShrink:1}, windowType=='landscape'?{minWidth:320, height:'100%'}:{width:'100%'}]}>\r\n      <FlatList\r\n        style={{flexDirection: 'column-reverse'}}\r\n        contentContainerStyle={{padding:10, flexGrow:1, flexDirection: 'column-reverse'}}\r\n        data={data?.pages}\r\n        renderItem={renderItem}\r\n        onScroll={(e)=>{\r\n          if (e.nativeEvent.contentOffset.y + e.nativeEvent.contentSize.height - height.current < 1)\r\n            fetchNextPage()\r\n        }}\r\n        onLayout={(p)=>{height.current = p.nativeEvent.layout.height}}\r\n      />\r\n      <View style={{position:'absolute'}}>\r\n        <TimerTags channel_id={channel_id}/>\r\n      </View>\r\n      <ThemedView style={{bottom:0, width:'100%', paddingTop:15, paddingBottom:10, paddingHorizontal:19}}>\r\n        <View style={{alignItems:'center', width:'100%',flexDirection:'row'}}>\r\n          <CommonButton title={''} style={{height:40, paddingTop:8, borderTopRightRadius:0, borderBottomRightRadius:0}} onPress={()=>setBottomTab(!bottomTab)}>\r\n            <View style={{top:-2}}>\r\n              <Entypo name={bottomTab?\"cross\":\"plus\"} size={24} color={Colors[theme].text}/>\r\n            </View>\r\n          </CommonButton>\r\n          {timer && <CommonButton style={{height:40, paddingTop:8, borderRadius:0}} title={`${timerFormat(timer)}`} onPress={()=>{setModal(DateTimePickerModal, {datetime:timer, callback:(datetime:string)=>setTimer(datetime)});setBottomTab(false)}}/>}\r\n          <TextInput ref={inputRef} value={value} onChangeText={setValue} style={{\r\n            flex:1, borderWidth:1, height:40, borderColor:Colors.borderColor, backgroundColor:Colors[theme].background, color:Colors[theme].text\r\n          }} onSubmitEditing={postValue} blurOnSubmit={true} onFocus={()=>setBottomTab(false)}/>\r\n          <CommonButton style={{height:40, paddingTop:8, borderTopLeftRadius:0, borderBottomLeftRadius:0}} title={''} onPress={postValue}/>\r\n        </View>\r\n\r\n        {bottomTab && <View style={{alignItems:'center', width:'100%', flexDirection:'row', paddingTop:15, paddingBottom:5}}>\r\n          <CommonButton style={{height:80, flex:1, justifyContent:'center', marginRight:15}} title={`\\n ${lang('Upload File')}`} onPress={()=>uploadFile().then(f=>{contentMutation.create({channel:channel_id, user:auth.user?.id, content:'', file:f});setBottomTab(false)})}/>\r\n          <CommonButton style={{height:80, flex:1, justifyContent:'center', marginRight:15}} title={`\\n ${lang('Timer Message')}`} onPress={()=>{setModal(DateTimePickerModal, {datetime:timer, callback:(datetime:string)=>setTimer(datetime)});setBottomTab(false)}}/>\r\n          <CommonButton style={{height:80, flex:1, justifyContent:'center'}} title={`\\n ${lang('Video Call')}`} onPress={()=>{setVideoMode(!videoMode);setBottomTab(false)}} disabled={videoMode}/>\r\n        </View>}\r\n      </ThemedView>\r\n    </View>\r\n  </View>\r\n}","import React from \"react\"\r\nimport CommonSection from \"../../../components/CommonSection\"\r\nimport Colors from \"../../../constants/Colors\"\r\nimport useColorScheme, { setColorScheme } from \"../../../hooks/useColorScheme\"\r\nimport { StyleSheet, Text, View} from 'react-native';\r\nimport useLangContext from \"../../../hooks/useLangContext\";\r\nimport { useColorScheme as useConfigColorScheme} from 'react-native-appearance';\r\nimport useAuthContext from \"../../../hooks/useAuthContext\";\r\nimport useFirebaseContext from \"../../../hooks/useFirebaseContext\";\r\nimport TextButton from \"../../../components/TextButton\";\r\n\r\n\r\nconst ConfigSection = ({title, children}:{title:string, children?: React.ReactNode})=>{\r\n  const theme = useColorScheme()\r\n  const color = Colors[theme].text\r\n  return <CommonSection bodyStyle={{alignItems:'flex-start', backgroundColor:theme=='light'?'transparent':\"black\"}}>\r\n    <Text style={{fontSize:20, color, fontWeight:'600'}}>{title}</Text>\r\n    {children}\r\n  </CommonSection>\r\n}\r\n\r\nexport default ()=>{\r\n  const { lang, locale, setLocale } = useLangContext()\r\n  const theme = useColorScheme()\r\n  const configTheme = useConfigColorScheme()\r\n  const { auth } = useAuthContext()\r\n  const {enable:noti, setEnable:setNoti} = useFirebaseContext(auth)\r\n  const color = Colors[theme].text\r\n  return <>\r\n    <ConfigSection title={lang('* Notification Settings')}>\r\n      <View style={{flexDirection:'row'}}>\r\n        {[[lang('On'), true], [lang('Off'), false]].map(([title, n])=><TextButton\r\n          key={title} title={title || ''} textStyle={{fontSize:16, color, textDecorationLine:noti==n?'underline':'none'}} style={{borderRadius:20}} onPress={()=>{setNoti(n)}}/>)}\r\n      </View>\r\n    </ConfigSection>\r\n    <ConfigSection title={lang('* Language Settings')}>\r\n    <View style={{flexDirection:'row'}}>\r\n        {[[lang('Auto'), 'auto'], ['', 'ko'], ['English', 'en']].map(([title, l])=><TextButton \r\n          key={title} title={title || ''} textStyle={{fontSize:16, color, textDecorationLine:locale==l?'underline':'none'}} style={{borderRadius:20}} onPress={()=>setLocale(l)}/>)}\r\n      </View>\r\n    </ConfigSection>\r\n    <ConfigSection title={lang('* Skin Settings')}>\r\n      <View style={{flexDirection:'row'}}>\r\n        {[[lang('Auto'), 'no-preference'], [lang('Light'), 'light'], [lang('Dark'), 'dark']].map(([title, colorScheme])=><TextButton \r\n          key={title} title={title} textStyle={{fontSize:16, color, textDecorationLine:configTheme==colorScheme?'underline':'none'}} style={{borderRadius:20}} onPress={(\r\n            )=>setColorScheme(colorScheme)}/>)}\r\n      </View>\r\n    </ConfigSection>\r\n  </>\r\n}","import React, {useState, useEffect, useLayoutEffect, useMemo} from 'react';\r\nimport { StackScreenProps } from '@react-navigation/stack';\r\nimport { StyleSheet, View} from 'react-native';\r\nimport { Text as StyledText } from 'react-native-paper';\r\nimport { Text } from '../../../components/Themed'\r\nimport useResizeContext from '../../../hooks/useResizeContext';\r\nimport TabView from '../../../components/TabView';\r\nimport HeaderRight from '../../../components/HeaderRight';\r\nimport TextButton from '../../../components/TextButton';\r\nimport Colors from '../../../constants/Colors';\r\nimport useColorScheme  from '../../../hooks/useColorScheme';\r\nimport useModalsContext from '../../../hooks/useModalsContext';\r\nimport ChannelEditModal from '../../../modals/ChannelEditModal';\r\nimport useLangContext from '../../../hooks/useLangContext';\r\nimport ContractFooter from '../../../components/ContractFooter';\r\nimport { TabViewRecord } from '../../../types';\r\nimport useAuthContext from '../../../hooks/useAuthContext';\r\nimport useUserMembershipList from '../../../hooks/lists/useUserMembershipList';\r\nimport { FontAwesome, Ionicons, MaterialCommunityIcons, SimpleLineIcons } from '@expo/vector-icons';\r\nimport { useMessengerChannelSorted } from '../../../hooks/lists/useMessengerChannelList';\r\nimport { ScrollView } from 'react-native-gesture-handler';\r\nimport CommonItem from '../../../components/CommonItem';\r\nimport MemberItem from '../../../components/MemberItem';\r\nimport ProfileModal from '../../../modals/ProfileModal';\r\nimport { navigate } from '../../../navigation';\r\nimport CommonSection from '../../../components/CommonSection';\r\nimport ConfigSections from './ConfigSections';\r\nimport Avatar, { avatarFromChannel } from '../../../components/Avatar';\r\n\r\nconst MemberTabView = ()=>{\r\n  const {auth} = useAuthContext()\r\n  const theme = useColorScheme()\r\n  const { setModal } = useModalsContext()\r\n  const userList = useUserMembershipList(auth)\r\n  const memberItem = React.useMemo(\r\n      ()=>userList && userList.map((item, index)=><MemberItem key={index} member={item} onPress={()=>setModal(ProfileModal, {id:item.id})}/>), [userList])\r\n  return <ScrollView style={{flex:1, backgroundColor:Colors[theme].background}}>\r\n      {memberItem}\r\n  </ScrollView>\r\n}\r\n\r\nconst MessengerTabView = ()=>{\r\n  const {auth} = useAuthContext()\r\n  const channelList = useMessengerChannelSorted(auth)\r\n  const theme = useColorScheme()\r\n\r\n  const today = (new Date()).toISOString().slice(0, 10)\r\n  return <ScrollView style={{flex:1, backgroundColor:Colors[theme].background}}>\r\n      {channelList?.map((item, index)=>{\r\n          const {avatar, name} = avatarFromChannel(item, auth.user)\r\n          const date = item.last_message?.created.slice(0,10)\r\n          return <CommonItem key={index} bodyStyle={{flexDirection:'row', justifyContent:'space-between'}} onPress={()=>navigate(\"ChatScreen\", {id:item.id})}>\r\n              <View style={{flexDirection:'row'}}>\r\n                  {avatar?\r\n                    <View style={{ marginRight:20}}>\r\n                      <Avatar name={avatar.name} size={44} userId={avatar.id}/>\r\n                    </View>:\r\n                    <FontAwesome size={40} color={Colors[theme].iconColor} style={{ marginBottom: -3, marginRight:20 }} name='users'/>}\r\n                  <View>\r\n                      <View style={{flexDirection:'row'}}>\r\n                          <Text style={{fontSize:18}}>{name}</Text>\r\n                          <Text style={{fontSize:18, opacity: 0.4, paddingLeft:5}}>{item.member_count}</Text>\r\n                      </View>\r\n                      <Text style={{fontSize:16, opacity: 0.4}}>{item.last_message?.content}</Text>\r\n                  </View>\r\n              </View>\r\n              <View>\r\n                  <Text style={{fontSize:14, opacity: 0.4, textAlign:'right'}}>{date==today?item.last_message?.created.slice(11,16):date}</Text>\r\n                  <Text style={{fontSize:14, textAlign:'right'}}>{item.unread_count?item.unread_count:' '}</Text>\r\n              </View>\r\n          </CommonItem>\r\n      })}\r\n  </ScrollView>\r\n}\r\n\r\n\r\nconst ConfigTabView = ()=>{\r\n  const theme = useColorScheme()\r\n  return <View style={{flex:1, backgroundColor:Colors[theme].background}}>\r\n    <ConfigSections/>\r\n  </View>\r\n}\r\n\r\nconst getBottomTabs = (theme:'light'|'dark')=>{\r\n  const color = Colors[theme].iconColor\r\n  return {\r\n    OneTab:{\r\n        title:'member',\r\n        component:MemberTabView,\r\n        icon:<MaterialCommunityIcons size={32} color={color} style={{ marginBottom: -3 }} name='account'/>,\r\n    },\r\n    TwoTab:{\r\n        title:'chat',\r\n        component:MessengerTabView,\r\n        icon:<Ionicons size={30} color={color} style={{ marginBottom: -3 }} name='chatbox'/>\r\n    },\r\n    // ThreeTab:{\r\n    //     title:'board',\r\n    //     component:()=><></>,\r\n    //     icon:<></>\r\n    // },\r\n    FourTab:{\r\n        title:'config',\r\n        component:ConfigTabView,\r\n        icon:<SimpleLineIcons size={30} color={color} style={{ marginBottom: -3 }} name='options'/>\r\n    }\r\n  } as TabViewRecord\r\n}\r\n\r\n\r\nexport default function HomeScreen({navigation, route}: StackScreenProps<any, 'Home'>) {\r\n  const { lang, locale } = useLangContext()\r\n  const windowType = useResizeContext();\r\n  const theme = useColorScheme()\r\n  const { setModal } = useModalsContext()\r\n  const [ home, setHome ] = useState(windowType == 'landscape')\r\n  const color = Colors[theme].text\r\n  const options = [\r\n    {title:lang('member'), headerRight:()=><HeaderRight/>},\r\n    {title:lang('chat'), headerRight:()=><HeaderRight extra={[{title:lang('create'), onPress:()=>setModal(ChannelEditModal, {type:'messenger'})}]}/>},\r\n    // {title:'board', headerRight:()=><HeaderRight extra={[{title:'create', onPress:()=>setModal(ChannelEditModal, props:{type:'board'}}) }]}/>},\r\n    {title:lang('config'), headerRight:()=><HeaderRight/>}\r\n  ]\r\n  \r\n  useLayoutEffect(() => {\r\n    const index = route?.params?.tab | 0\r\n    navigation.setOptions(windowType == 'portrait'?options[index]:{\r\n      title: lang('home'),\r\n      headerRight: ()=><HeaderRight/>\r\n    });\r\n  }, [navigation, route, windowType, locale]);\r\n  useEffect(()=>{\r\n    setHome(windowType == 'landscape')\r\n  }, [windowType])\r\n  return home?\r\n    <View style={{flex:1, justifyContent:'center', alignItems:'center'}}>\r\n      <View style={{width:'80%', flex:1, marginTop:72}}>\r\n        <StyledText style={{fontSize:32, color}}>Tokki Tok</StyledText>\r\n        <View style={{backgroundColor:Colors.borderColor, height:1, width:'100%'}}/>\r\n        {/* <Text style={{fontSize:20, color:'gray'}}>Welcome! This is a messenger for teams.</Text>*/}\r\n        <View style={{height:24}}/>\r\n        <CommonSection bodyStyle={{alignItems:'flex-start', backgroundColor:'transparent'}}>\r\n          <TextButton title={lang('+ New chat')} textStyle={{fontSize:20, color}} style={{paddingLeft:0, borderRadius:20}} onPress={()=>setModal(ChannelEditModal, {type:'messenger'})}/>\r\n        </CommonSection>\r\n        <ConfigSections/>\r\n      </View>\r\n      <ContractFooter/>\r\n    </View>:\r\n    <TabView tabs={getBottomTabs(theme)} tabBarPosition=\"bottom\" index={parseInt(route.params?.['tab'] || 0)} onTab={(index)=>{navigation.setParams({tab:index})}}/>\r\n}\r\n\r\n","import React, {useEffect, useLayoutEffect, useState} from 'react';\r\n\r\nimport { StackScreenProps } from '@react-navigation/stack';\r\nimport useAuthContext from '../../hooks/useAuthContext';\r\nimport useMessengerChannelList from '../../hooks/lists/useMessengerChannelList';\r\nimport { Text } from '../../components/Themed';\r\nimport { useMessengerMemberMutation } from '../../hooks/lists/useMessengerMemberList';\r\n\r\nexport default function InviteeScreen({navigation, route}: StackScreenProps<any, 'Invitee'>) {\r\n    const id = route?.params?.id\r\n    const {auth, dispatch} = useAuthContext()\r\n    const [enterGuest, setEnterGuest] = useState(false)\r\n    const channelList = useMessengerChannelList(auth)\r\n    const messengerMemberMutation = useMessengerMemberMutation()\r\n    useLayoutEffect(() => {\r\n        navigation.setOptions({headerRight: undefined});\r\n    }, []);\r\n    useEffect(()=>{\r\n        if(auth.user==null && enterGuest==false){\r\n            dispatch({type:\"LOGIN_GUEST\"})\r\n            setEnterGuest(true)\r\n        }\r\n        else if(auth.user && channelList!==undefined){\r\n            if(channelList.find(v=>v.id==id) === undefined){\r\n                console.log(`invite processing (channel:${id})`)\r\n                messengerMemberMutation.invite({\r\n                    channel_id:id,\r\n                    user_ids:[auth.user.id]\r\n                }).then(()=>navigation.replace(\"ChatScreen\", {id}))\r\n            }\r\n            else{\r\n                console.log('already invite')\r\n                navigation.replace(\"ChatScreen\", {id})\r\n            }\r\n        }\r\n    }, [auth, channelList, enterGuest])\r\n  return <Text>{''}</Text>\r\n};\r\n","import LoginScreen from \"./main/LoginScreen\";\r\nimport ChatScreen from \"./main/ChatScreen\";\r\nimport HomeScreen from \"./main/HomeScreen\";\r\nimport TabOneScreen from \"./main/TabOneScreen\";\r\nimport InviteeScreen from \"./main/InviteeScreen\";\r\n// import BoardScreen from \"../lib/blacktokki-board/BoardScreen\";\r\n// import BoardEditScreen from \"../lib/blacktokki-board/BoardEditScreen\";\r\nimport { Screens } from \"../types\";\r\n\r\nexport const main = {\r\n    HomeScreen:{\r\n        title:'home',\r\n        component:HomeScreen,\r\n        path:'home',\r\n    },\r\n    ChatScreen:{\r\n        title:'chat',\r\n        component:ChatScreen,\r\n        path:'chat'\r\n    },\r\n    // BoardScreen:{\r\n    //     title:'board',\r\n    //     component:BoardScreen,\r\n    //     path:'board'\r\n    // },\r\n    // TabOneScreen:{\r\n    //     title:'tab one',\r\n    //     component:TabOneScreen,\r\n    //     path:'one'\r\n    // },\r\n    InviteeScreen:{\r\n        title: '',        \r\n        component:InviteeScreen,\r\n        path:'invitee'\r\n    }\r\n} as Screens\r\n\r\nexport const login = {\r\n    LoginScreen:{\r\n        path: 'login',\r\n        title: 'Sign in',\r\n        component:LoginScreen\r\n    },\r\n    InviteeScreen:{\r\n        path:'invitee',\r\n        title: '',\r\n        component:InviteeScreen\r\n    }\r\n} as Screens\r\n\r\nexport const modal = {\r\n    // BoardEditScreen:{\r\n    //     title:'board',\r\n    //     component:BoardEditScreen,\r\n    //     path:'modal/board'\r\n    // },\r\n} as Screens","import { useMemo, useReducer } from \"react\"\r\n\r\ntype LocalSearchAction = {type:string, keyword?:string}\r\n\r\ntype LocalSearchState ={active:boolean, keyword:string}\r\n\r\n\r\n\r\nconst localSearchReducer =(initialState:LocalSearchState, action:LocalSearchAction)=>{\r\n    switch (action.type){\r\n        case 'SEARCH':\r\n          return {\r\n            ...initialState,\r\n            keyword: action.keyword\r\n          } as LocalSearchState\r\n        case 'ENABLE_SEARCH':\r\n          return {\r\n            ...initialState,\r\n            active:true,\r\n          }\r\n        case 'DISABLE_SEARCH':\r\n            return{\r\n                ...initialState,\r\n                active:false,\r\n                keyword: ''\r\n            }\r\n        default:\r\n            throw new Error( `Unhandled action type: ${action.type}`)\r\n    }\r\n  }\r\n\r\n\r\nexport default function useLocalSearch<T>(target:T[], compare:(value:T, keyword:string)=>boolean) {\r\n  const [searchState, dispatch] = useReducer(localSearchReducer, {active:false, keyword:''})\r\n  const data = useMemo(()=>searchState.active?target.filter(v=>compare(v, searchState.keyword)):target, [searchState, target])\r\n  return {searchState, dispatch, data}\r\n}","import React, {useRef,MutableRefObject, useMemo, useState, useEffect } from 'react';\r\nimport Clipboard from '@react-native-clipboard/clipboard/dist';\r\nimport { View, Text } from '../components/Themed';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport useUserMembershipList from '../hooks/lists/useUserMembershipList';\r\nimport { TabViewRecord, UserMembership } from '../types';\r\nimport CommonButton from '../components/CommonButton';\r\nimport useMessengerMemberList, { useMessengerMemberMutation } from '../hooks/lists/useMessengerMemberList';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport useExternalMembershipList from '../hooks/lists/useExternalMembershipList';\r\nimport TextField from '../components/TextField';\r\nimport useLocalSearch from '../hooks/useLocalSearch';\r\nimport TabView from '../components/TabView';\r\nimport { FlatList, TouchableOpacity } from 'react-native-gesture-handler';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport MemberItem from '../components/MemberItem';\r\nimport ModalSection from '../components/ModalSection';\r\n\r\nconst InviteItem = (props:{item:UserMembership, selectedRef:MutableRefObject<Set<number>>})=>{\r\n  const [selected, setSelected] = useState(props.selectedRef.current.has(props.item.id))\r\n  return <View style={selected?{borderWidth:1, borderColor:'blue'}:{}}>\r\n    <MemberItem member={props.item} onPress={()=>{\r\n      if (selected){\r\n        setSelected(false)\r\n        props.selectedRef.current.delete(props.item.id)\r\n      }\r\n      else{\r\n        setSelected(true)\r\n        props.selectedRef.current.add(props.item.id)\r\n      }\r\n    }}/>\r\n  </View>\r\n\r\n}\r\ntype InviteTabViewProps = {\r\n  id:number,\r\n  selectedRef:MutableRefObject<Set<number>>\r\n}\r\n\r\nconst GroupTabView = ({id, selectedRef}:InviteTabViewProps)=>{\r\n  const { lang } = useLangContext()\r\n  const {auth} = useAuthContext()\r\n  const { setModal } = useModalsContext()\r\n  const userList = useUserMembershipList(auth)\r\n  const memberList = useMessengerMemberList(id)\r\n  const messengerMemberMutation = useMessengerMemberMutation()\r\n  const rawData = useMemo(()=>{\r\n    const memberSet = new Set(memberList?.map(v=>v.user))\r\n    return userList?.filter(v=>!memberSet.has(v.id)) || []\r\n  }, [userList, memberList])\r\n  const {data, dispatch:dispatchKeyword, searchState} = useLocalSearch(rawData, (v, keyword)=>(v.username.includes(keyword) || v.name.includes(keyword)))\r\n  const search = (k:string)=>{\r\n    if (k?.length>0){\r\n      dispatchKeyword({type:'ENABLE_SEARCH'})\r\n      dispatchKeyword({type:'SEARCH', keyword:k})\r\n    }\r\n    else{\r\n      dispatchKeyword({type:'DISABLE_SEARCH'})\r\n    }\r\n  }\r\n  const back = ()=>{\r\n    setModal(InviteModal, null)\r\n  }\r\n  return <View style={{alignItems:'center', flex:1}}>\r\n    <View style={{'width': '100%', flex:1}}>\r\n      <TextField name={`${lang('Username')} & ${lang('Name')}`} value={searchState.keyword} setValue={search} width={'80%'}/>\r\n      {id && data && <FlatList contentContainerStyle={{flexGrow:1}} data={data} renderItem={({item})=><InviteItem item={item} selectedRef={selectedRef}/>}/>}\r\n    </View>\r\n    <View style={[{width:'100%', flexDirection:'row', padding:10,}, {justifyContent:'flex-end'}]}>\r\n      <CommonButton title={lang('invite')} onPress={()=>{\r\n        messengerMemberMutation.invite({\r\n          channel_id:id,\r\n          user_ids:[...selectedRef.current]\r\n        }).then(back)\r\n      }}/>\r\n      <CommonButton title={lang('cancel')} onPress={back}/>\r\n    </View>\r\n  </View>\r\n}\r\n\r\nconst DELAY = 500\r\n\r\nconst ExternalMembershipTabView = ({id, selectedRef}:InviteTabViewProps)=>{\r\n  const { lang } = useLangContext()\r\n  const [value, setValue] = useState('')\r\n  const [keyword, setKeyword] = useState('')\r\n  const [copied, setCopied] = useState(false)\r\n  const timeoutRef = useRef<NodeJS.Timeout>()\r\n  const { setModal } = useModalsContext()\r\n  const memberList = useMessengerMemberList(id)\r\n  const externalMemberList = useExternalMembershipList(keyword)\r\n  const data = useMemo(()=>{\r\n    const memberSet = new Set(memberList?.map(v=>v.user))\r\n    return externalMemberList?.filter(v=>!memberSet.has(v.id)) || []\r\n  }, [externalMemberList, memberList])\r\n  const messengerMemberMutation = useMessengerMemberMutation()\r\n  useEffect(()=>{\r\n    timeoutRef.current = setTimeout(()=>{\r\n      setKeyword(value)\r\n    }, DELAY)\r\n    return ()=>{timeoutRef.current && clearTimeout(timeoutRef.current)}\r\n  }, [value])\r\n  const back = ()=>{\r\n    setModal(InviteModal, null)\r\n  }\r\n  const inviteLink = location.href.replace('chat', 'invitee')\r\n  return <View style={{alignItems:'center', flex:1}}>\r\n  <TouchableOpacity style={{paddingVertical:10, flexDirection:\"row\"}} onPress={()=>{Clipboard.setString(inviteLink);setCopied(true)}}>\r\n    <Text style={{fontSize:14}}>{lang('invite link')}{\": \"}</Text>\r\n    <Text style={{fontSize:14, color:'#12b886'}}>{inviteLink}{\" \"}</Text>\r\n    {copied && <Text style={{fontSize:12, color:'red'}}>{lang(\"copied\")}</Text>}\r\n  </TouchableOpacity>\r\n  <View style={{'width': '100%', flex:1}}>\r\n    <TextField name={lang('Username')} value={value} setValue={setValue} width={'80%'}/>\r\n    {id && data && <FlatList contentContainerStyle={{flexGrow:1}} data={data} renderItem={({item})=><InviteItem item={item} selectedRef={selectedRef}/>}/>}\r\n  </View>\r\n  <View style={[{width:'100%', flexDirection:'row', padding:10,}, {justifyContent:'flex-end'}]}>\r\n    <CommonButton title={lang('invite')} onPress={()=>{\r\n      messengerMemberMutation.invite({\r\n        channel_id:id,\r\n        user_ids:[...selectedRef.current]\r\n      }).then(back)\r\n    }}/>\r\n    <CommonButton title={lang('cancel')} onPress={back}/>\r\n  </View>\r\n</View>\r\n}\r\n\r\nexport default function InviteModal({id}:{id:number}) {\r\n  const { lang } = useLangContext()\r\n  const selectedRef = useRef<Set<number>>(new Set())\r\n  const drawerTabs:TabViewRecord = {\r\n    group:{\r\n      title: 'Group',\r\n      component: ()=><GroupTabView id={id} selectedRef={selectedRef}/>,\r\n      icon: <></>\r\n    },\r\n    external:{\r\n      title: 'External members',\r\n      component: ()=><ExternalMembershipTabView id={id} selectedRef={selectedRef}/>,\r\n      icon: <></>\r\n    }\r\n  }\r\n  return <ModalSection>\r\n    <View style={{flex:1, width:'100%'}}>\r\n      <View style={{width:'100%'}}>\r\n        <Text style={{fontSize:20}}>{lang('invite')}</Text>\r\n        <View style={{marginBottom: 20, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n      </View>\r\n      <TabView tabs={drawerTabs} tabBarPosition={\"top\"}/>\r\n    </View>\r\n  </ModalSection>\r\n}\r\n\r\n","import { useQuery } from \"react-query\";\r\nimport { getExternalMembershipList } from \"../../apis\";\r\n\r\nexport default function useExternalMembershipList(keyword?:string){\r\n  const { data } = useQuery([\"UserMembershipList\", keyword] , async()=>keyword?(await getExternalMembershipList(keyword)):[])\r\n  return data\r\n}","import React from 'react';\r\nimport dayjs from 'dayjs';\r\nimport localeData from 'dayjs/plugin/localeData';\r\nimport 'dayjs/locale/ko'\r\nimport intl from \"../lang\";\r\nimport { StyleSheet, Text, View,StyleProp, ViewStyle } from 'react-native';\r\nimport {LocaleConfig, Calendar as BaseCalendar} from 'react-native-calendars';\r\nimport { DateData, DayState, MarkedDates, MarkingTypes } from 'react-native-calendars/src/types';\r\n\r\ndayjs.extend(localeData).localeData()\r\ndayjs.locale('en')\r\nLocaleConfig.locales['en'] = {\r\n  monthNames: dayjs.months(),\r\n  monthNamesShort: dayjs.monthsShort(),\r\n  dayNames: dayjs.weekdays(),\r\n  dayNamesShort: dayjs.weekdaysShort(),\r\n  today: \"today\",\r\n  prev: 'prev',\r\n  next: 'next',\r\n  monthFormat: undefined\r\n};\r\n\r\ndayjs.locale('ko')\r\n\r\nLocaleConfig.locales['ko'] = {\r\n  monthNames: dayjs.months(),\r\n  monthNamesShort: dayjs.monthsShort(),\r\n  dayNames: dayjs.weekdays(),\r\n  dayNamesShort: dayjs.weekdaysShort(),\r\n  today: \"\",\r\n  prev: '',\r\n  next: '',\r\n  monthFormat: 'yyyy MM'\r\n};\r\n\r\nexport type CalendarProps = {\r\n  date?:string,\r\n  setDate?:(date:string)=>void,\r\n  style:StyleProp<ViewStyle>\r\n  markingType?:MarkingTypes\r\n  markedDates?:MarkedDates\r\n  onMonthChange?:(date:DateData)=>void\r\n  disableAllTouchEventsForDisabledDays?:boolean\r\n  locale?:string,\r\n  dayComponent?:React.ComponentType<{date:DateData, state:DayState}>\r\n}\r\n\r\nexport default function Calendar(props:CalendarProps) {\r\n  const locale = (props.locale != undefined && props.locale !='auto')?props.locale:intl.locale\r\n  LocaleConfig.defaultLocale = locale\r\n  const currentLocale = LocaleConfig.locales[locale]\r\n  return (\r\n    <View>\r\n      <BaseCalendar\r\n        markingType={props.markingType}\r\n        markedDates={props.markedDates}\r\n        renderArrow={direction => <Text>{direction == 'left'?currentLocale['prev']:currentLocale['next']}</Text>}\r\n        monthFormat={currentLocale['monthFormat']}\r\n        initialDate={props.date}\r\n        disableAllTouchEventsForDisabledDays={props.disableAllTouchEventsForDisabledDays}\r\n        onMonthChange={props.onMonthChange}\r\n        onDayPress={(date)=> props.setDate?.(date.dateString)}\r\n        current={props.date}\r\n        style={[{width:400 }, props.style]}\r\n        dayComponent={props.dayComponent as any}\r\n      />\r\n      {/* <Text style={styles.dateText}>: {props.date}</Text> */}\r\n    </View>\r\n  );\r\n}\r\n","import React, { useState } from 'react';\r\nimport CommonButton from '../components/CommonButton';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport {Picker} from '@react-native-picker/picker';\r\nimport { Text, View } from '../components/Themed';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport { Ionicons } from '@expo/vector-icons';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport Colors from '../constants/Colors';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { BottomSheet } from '../components/ModalSection';\r\nimport Calendar from '../components/Calendar';\r\nimport dayjs from 'dayjs';\r\n\r\nconst dayTypes = ['AM', 'PM'].map(value=>({label:value, value}))\r\nconst hours = [...Array(12).keys()].map((value, index)=>(index + 1).toString().padStart(2, '0')).map(value=>({label:value, value}))\r\nconst minutes = [...Array(12).keys()].map((value, index)=>(index * 5).toString().padStart(2, '0')).map(value=>({label:value, value}))\r\n\r\n\r\nconst getDisableDays=(date:dayjs.Dayjs)=>{\r\n  let startDate = date.clone().startOf('month').add(-1, 'month')\r\n  const endDate = date.clone().endOf('month').add(1, 'month')\r\n  const today = dayjs().startOf('day')\r\n  const result = []\r\n  while(startDate<=endDate && startDate<today){\r\n    result.push(startDate.format('YYYY-MM-DD'))\r\n    startDate = startDate.add(1, 'day')\r\n  }\r\n  return result\r\n}\r\n\r\nconst defaultDayjs = ()=>{\r\n  const m = dayjs()\r\n  const restMinute = parseInt(m.format('mm')) % 5\r\n  return m.add(5-restMinute, 'minute')\r\n}\r\n\r\nexport default function DateTimePickerModal({datetime, callback}:{datetime?:string, callback:(datetime?:string)=>void}) {\r\n  const _dayjs = datetime?dayjs(datetime):defaultDayjs()\r\n  const { lang, locale } = useLangContext()\r\n  const theme = useColorScheme()\r\n  const [date, setDate] = useState(_dayjs.format('YYYY-MM-DD'));\r\n  const [dayType, setDayType] = useState(_dayjs.locale('en').format('A'))\r\n  const [hour, setHour] = useState(_dayjs.format('hh'))\r\n  const [minute, setMinute] = useState(_dayjs.format('mm'))\r\n  const [disableDays, setDisableDays] = useState<string[]>(getDisableDays(_dayjs))\r\n  const { setModal } = useModalsContext()\r\n  const back = ()=>{\r\n    setModal(DateTimePickerModal, null)\r\n  }\r\n  return <BottomSheet>\r\n    <View style={{flexDirection:'row', width:'100%'}}>\r\n      <View style={{flex:1, flexDirection:'row'}}>\r\n        <TouchableOpacity onPress={back}>\r\n          <Ionicons size={20} name=\"arrow-back\" color={Colors[theme].text}/>\r\n        </TouchableOpacity>\r\n      </View>\r\n      <View style={{flex:1}}>\r\n        <Text style={{fontSize:20, textAlign:'center'}}>{lang('Date & Time')}</Text>\r\n      </View>\r\n      <View style={{flex:1}}/>\r\n    </View>\r\n    <View style={{marginBottom: 20, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n    <Calendar\r\n      locale={locale}\r\n      style={undefined} \r\n      setDate={setDate}\r\n      disableAllTouchEventsForDisabledDays={true}\r\n      onMonthChange={(v)=>setDisableDays(getDisableDays(dayjs(v.dateString)))}\r\n      markedDates={{\r\n        ...disableDays.reduce((p, c)=>{p[c]={disabled:true};return p}, {} as Record<string, any>),\r\n        ...(date?[date]:[]).reduce((p, c)=>{p[c]={selected:true};return p}, {} as Record<string, any>)\r\n      }}\r\n    \r\n    />\r\n    <View style={{flexDirection:'row', paddingVertical:10, width:400, height:50}}>\r\n      <Picker\r\n        style={{flex:1}}\r\n        itemStyle={{fontSize:20}}\r\n        selectedValue={dayType}\r\n        onValueChange={setDayType}>\r\n        {dayTypes.map(v=><Picker.Item key={v.value} label={v.label} value={v.value} />)}\r\n      </Picker>\r\n      <Text style={{fontSize:20}}> </Text>\r\n      <Picker\r\n        style={{flex:1}}\r\n        itemStyle={{fontSize:20}}\r\n        selectedValue={hour}\r\n        onValueChange={setHour}>\r\n        {hours.map(v=><Picker.Item key={v.value} label={v.label} value={v.value} />)}\r\n      </Picker>\r\n      <Text style={{fontSize:20}}> : </Text>\r\n      <Picker\r\n        style={{flex:1}}\r\n        itemStyle={{fontSize:20}}\r\n        selectedValue={minute}\r\n        onValueChange={setMinute}>\r\n        {minutes.map(v=><Picker.Item key={v.value} label={v.label} value={v.value} />)}\r\n      </Picker>\r\n    </View>\r\n    <View style={{flexDirection:'row'}}>\r\n      <CommonButton title={lang('save')} onPress={()=>{\r\n        callback?.(dayjs(`${date} ${hour}:${minute} ${dayType}`).toISOString())\r\n        back()\r\n      }}/>\r\n      <CommonButton title={lang('cancel')} onPress={()=>{\r\n        callback?.(undefined)\r\n        back()\r\n      }}/>\r\n      \r\n    </View>\r\n  </BottomSheet>\r\n}\r\n","import React, { useMemo } from 'react';\r\n\r\nimport { TextProps, StyleProp } from 'react-native';\r\nimport {View, Text } from './Themed'\r\nimport useResizeContext from '../hooks/useResizeContext';\r\n\r\ntype Props = {\r\n  name: string,\r\n  width?:number,\r\n  children: React.ReactNode\r\n  textStyle?: StyleProp<TextProps>\r\n}\r\n\r\nexport default function RowField(props:Props) {\r\n  const windowType = useResizeContext()\r\n  const rowStyle = useMemo(()=>windowType=='landscape'?\r\n    {flexDirection:'row', alignItems: 'center', justifyContent:'space-between'}:\r\n    {flexDirection:'column', alignItems:'flex-start'} as any\r\n  , [windowType])\r\n  return (\r\n    <View style={[{paddingVertical:5, width:'100%'}, rowStyle]}>\r\n        <Text style={[windowType=='landscape'?{flex:1}:{width:'100%'},{paddingHorizontal: 15, fontSize:16}, props.textStyle]}>{props.name}</Text>\r\n        <View style={[windowType=='landscape'?{flex:6}:{width:'100%'},{paddingHorizontal: 15}]}>\r\n          <View style={{width:props.width}}>\r\n            {props.children}\r\n          </View>\r\n        </View>\r\n    </View>\r\n  )\r\n}","import React from 'react';\r\nimport { StyleProp, TextStyle } from 'react-native';\r\nimport { CustomTextInputProps } from '../types';\r\nimport CommonTextInput from './CommonTextInput';\r\nimport RowField from './RowField';\r\n\r\nexport default function TextField(props:CustomTextInputProps & {name: string, width?:any, textStyle?:StyleProp<TextStyle>}) {\r\n  return (\r\n    <RowField name={props.name} width={props.width} textStyle={props.textStyle}>\r\n      <CommonTextInput {...props} />\r\n   </RowField>\r\n  )\r\n}","/**\r\n * Learn more about deep linking with React Navigation\r\n * https://reactnavigation.org/docs/deep-linking\r\n * https://reactnavigation.org/docs/configuring-links\r\n */\r\n\r\nimport { LinkingOptions } from '@react-navigation/native';\r\nimport * as Linking from 'expo-linking';\r\nimport {main, login, modal} from '../screens';\r\n\r\nconst ROOTPATH = 'tokki-tok'  // github repository name\r\n\r\nObject.values(modal).forEach(v=>v.path = ROOTPATH + '/' + v.path)\r\n\r\nexport default  {\r\n  prefixes: [Linking.makeUrl('/')],\r\n  config: {\r\n    screens: {\r\n      Main: {\r\n        screens:{\r\n          ...main,\r\n          ...login,\r\n          NotFound: '*',\r\n        },\r\n        path: ROOTPATH\r\n      },\r\n      ...modal\r\n    },\r\n  },\r\n} as LinkingOptions;\r\n","var map = {\n\t\"./af\": 510,\n\t\"./af.js\": 510,\n\t\"./ar\": 511,\n\t\"./ar-dz\": 512,\n\t\"./ar-dz.js\": 512,\n\t\"./ar-kw\": 513,\n\t\"./ar-kw.js\": 513,\n\t\"./ar-ly\": 514,\n\t\"./ar-ly.js\": 514,\n\t\"./ar-ma\": 515,\n\t\"./ar-ma.js\": 515,\n\t\"./ar-sa\": 516,\n\t\"./ar-sa.js\": 516,\n\t\"./ar-tn\": 517,\n\t\"./ar-tn.js\": 517,\n\t\"./ar.js\": 511,\n\t\"./az\": 518,\n\t\"./az.js\": 518,\n\t\"./be\": 519,\n\t\"./be.js\": 519,\n\t\"./bg\": 520,\n\t\"./bg.js\": 520,\n\t\"./bm\": 521,\n\t\"./bm.js\": 521,\n\t\"./bn\": 522,\n\t\"./bn-bd\": 523,\n\t\"./bn-bd.js\": 523,\n\t\"./bn.js\": 522,\n\t\"./bo\": 524,\n\t\"./bo.js\": 524,\n\t\"./br\": 525,\n\t\"./br.js\": 525,\n\t\"./bs\": 526,\n\t\"./bs.js\": 526,\n\t\"./ca\": 527,\n\t\"./ca.js\": 527,\n\t\"./cs\": 528,\n\t\"./cs.js\": 528,\n\t\"./cv\": 529,\n\t\"./cv.js\": 529,\n\t\"./cy\": 530,\n\t\"./cy.js\": 530,\n\t\"./da\": 531,\n\t\"./da.js\": 531,\n\t\"./de\": 532,\n\t\"./de-at\": 533,\n\t\"./de-at.js\": 533,\n\t\"./de-ch\": 534,\n\t\"./de-ch.js\": 534,\n\t\"./de.js\": 532,\n\t\"./dv\": 535,\n\t\"./dv.js\": 535,\n\t\"./el\": 536,\n\t\"./el.js\": 536,\n\t\"./en-au\": 537,\n\t\"./en-au.js\": 537,\n\t\"./en-ca\": 538,\n\t\"./en-ca.js\": 538,\n\t\"./en-gb\": 539,\n\t\"./en-gb.js\": 539,\n\t\"./en-ie\": 540,\n\t\"./en-ie.js\": 540,\n\t\"./en-il\": 541,\n\t\"./en-il.js\": 541,\n\t\"./en-in\": 542,\n\t\"./en-in.js\": 542,\n\t\"./en-nz\": 543,\n\t\"./en-nz.js\": 543,\n\t\"./en-sg\": 544,\n\t\"./en-sg.js\": 544,\n\t\"./eo\": 545,\n\t\"./eo.js\": 545,\n\t\"./es\": 546,\n\t\"./es-do\": 547,\n\t\"./es-do.js\": 547,\n\t\"./es-mx\": 548,\n\t\"./es-mx.js\": 548,\n\t\"./es-us\": 549,\n\t\"./es-us.js\": 549,\n\t\"./es.js\": 546,\n\t\"./et\": 550,\n\t\"./et.js\": 550,\n\t\"./eu\": 551,\n\t\"./eu.js\": 551,\n\t\"./fa\": 552,\n\t\"./fa.js\": 552,\n\t\"./fi\": 553,\n\t\"./fi.js\": 553,\n\t\"./fil\": 554,\n\t\"./fil.js\": 554,\n\t\"./fo\": 555,\n\t\"./fo.js\": 555,\n\t\"./fr\": 556,\n\t\"./fr-ca\": 557,\n\t\"./fr-ca.js\": 557,\n\t\"./fr-ch\": 558,\n\t\"./fr-ch.js\": 558,\n\t\"./fr.js\": 556,\n\t\"./fy\": 559,\n\t\"./fy.js\": 559,\n\t\"./ga\": 560,\n\t\"./ga.js\": 560,\n\t\"./gd\": 561,\n\t\"./gd.js\": 561,\n\t\"./gl\": 562,\n\t\"./gl.js\": 562,\n\t\"./gom-deva\": 563,\n\t\"./gom-deva.js\": 563,\n\t\"./gom-latn\": 564,\n\t\"./gom-latn.js\": 564,\n\t\"./gu\": 565,\n\t\"./gu.js\": 565,\n\t\"./he\": 566,\n\t\"./he.js\": 566,\n\t\"./hi\": 567,\n\t\"./hi.js\": 567,\n\t\"./hr\": 568,\n\t\"./hr.js\": 568,\n\t\"./hu\": 569,\n\t\"./hu.js\": 569,\n\t\"./hy-am\": 570,\n\t\"./hy-am.js\": 570,\n\t\"./id\": 571,\n\t\"./id.js\": 571,\n\t\"./is\": 572,\n\t\"./is.js\": 572,\n\t\"./it\": 573,\n\t\"./it-ch\": 574,\n\t\"./it-ch.js\": 574,\n\t\"./it.js\": 573,\n\t\"./ja\": 575,\n\t\"./ja.js\": 575,\n\t\"./jv\": 576,\n\t\"./jv.js\": 576,\n\t\"./ka\": 577,\n\t\"./ka.js\": 577,\n\t\"./kk\": 578,\n\t\"./kk.js\": 578,\n\t\"./km\": 579,\n\t\"./km.js\": 579,\n\t\"./kn\": 580,\n\t\"./kn.js\": 580,\n\t\"./ko\": 581,\n\t\"./ko.js\": 581,\n\t\"./ku\": 582,\n\t\"./ku.js\": 582,\n\t\"./ky\": 583,\n\t\"./ky.js\": 583,\n\t\"./lb\": 584,\n\t\"./lb.js\": 584,\n\t\"./lo\": 585,\n\t\"./lo.js\": 585,\n\t\"./lt\": 586,\n\t\"./lt.js\": 586,\n\t\"./lv\": 587,\n\t\"./lv.js\": 587,\n\t\"./me\": 588,\n\t\"./me.js\": 588,\n\t\"./mi\": 589,\n\t\"./mi.js\": 589,\n\t\"./mk\": 590,\n\t\"./mk.js\": 590,\n\t\"./ml\": 591,\n\t\"./ml.js\": 591,\n\t\"./mn\": 592,\n\t\"./mn.js\": 592,\n\t\"./mr\": 593,\n\t\"./mr.js\": 593,\n\t\"./ms\": 594,\n\t\"./ms-my\": 595,\n\t\"./ms-my.js\": 595,\n\t\"./ms.js\": 594,\n\t\"./mt\": 596,\n\t\"./mt.js\": 596,\n\t\"./my\": 597,\n\t\"./my.js\": 597,\n\t\"./nb\": 598,\n\t\"./nb.js\": 598,\n\t\"./ne\": 599,\n\t\"./ne.js\": 599,\n\t\"./nl\": 600,\n\t\"./nl-be\": 601,\n\t\"./nl-be.js\": 601,\n\t\"./nl.js\": 600,\n\t\"./nn\": 602,\n\t\"./nn.js\": 602,\n\t\"./oc-lnc\": 603,\n\t\"./oc-lnc.js\": 603,\n\t\"./pa-in\": 604,\n\t\"./pa-in.js\": 604,\n\t\"./pl\": 605,\n\t\"./pl.js\": 605,\n\t\"./pt\": 606,\n\t\"./pt-br\": 607,\n\t\"./pt-br.js\": 607,\n\t\"./pt.js\": 606,\n\t\"./ro\": 608,\n\t\"./ro.js\": 608,\n\t\"./ru\": 609,\n\t\"./ru.js\": 609,\n\t\"./sd\": 610,\n\t\"./sd.js\": 610,\n\t\"./se\": 611,\n\t\"./se.js\": 611,\n\t\"./si\": 612,\n\t\"./si.js\": 612,\n\t\"./sk\": 613,\n\t\"./sk.js\": 613,\n\t\"./sl\": 614,\n\t\"./sl.js\": 614,\n\t\"./sq\": 615,\n\t\"./sq.js\": 615,\n\t\"./sr\": 616,\n\t\"./sr-cyrl\": 617,\n\t\"./sr-cyrl.js\": 617,\n\t\"./sr.js\": 616,\n\t\"./ss\": 618,\n\t\"./ss.js\": 618,\n\t\"./sv\": 619,\n\t\"./sv.js\": 619,\n\t\"./sw\": 620,\n\t\"./sw.js\": 620,\n\t\"./ta\": 621,\n\t\"./ta.js\": 621,\n\t\"./te\": 622,\n\t\"./te.js\": 622,\n\t\"./tet\": 623,\n\t\"./tet.js\": 623,\n\t\"./tg\": 624,\n\t\"./tg.js\": 624,\n\t\"./th\": 625,\n\t\"./th.js\": 625,\n\t\"./tk\": 626,\n\t\"./tk.js\": 626,\n\t\"./tl-ph\": 627,\n\t\"./tl-ph.js\": 627,\n\t\"./tlh\": 628,\n\t\"./tlh.js\": 628,\n\t\"./tr\": 629,\n\t\"./tr.js\": 629,\n\t\"./tzl\": 630,\n\t\"./tzl.js\": 630,\n\t\"./tzm\": 631,\n\t\"./tzm-latn\": 632,\n\t\"./tzm-latn.js\": 632,\n\t\"./tzm.js\": 631,\n\t\"./ug-cn\": 633,\n\t\"./ug-cn.js\": 633,\n\t\"./uk\": 634,\n\t\"./uk.js\": 634,\n\t\"./ur\": 635,\n\t\"./ur.js\": 635,\n\t\"./uz\": 636,\n\t\"./uz-latn\": 637,\n\t\"./uz-latn.js\": 637,\n\t\"./uz.js\": 636,\n\t\"./vi\": 638,\n\t\"./vi.js\": 638,\n\t\"./x-pseudo\": 639,\n\t\"./x-pseudo.js\": 639,\n\t\"./yo\": 640,\n\t\"./yo.js\": 640,\n\t\"./zh-cn\": 641,\n\t\"./zh-cn.js\": 641,\n\t\"./zh-hk\": 642,\n\t\"./zh-hk.js\": 642,\n\t\"./zh-mo\": 643,\n\t\"./zh-mo.js\": 643,\n\t\"./zh-tw\": 644,\n\t\"./zh-tw.js\": 644\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 916;","firebaseConfig = {\n    \"authDomain\": \"virtual-metrics-355712.firebaseapp.com\",\n    \"projectId\": \"virtual-metrics-355712\",\n    \"storageBucket\": \"virtual-metrics-355712.appspot.com\",\n    \"messagingSenderId\": \"76003576924\",\n    \"appId\": \"1:76003576924:web:c8c8a006d07918bbc02a99\",\n    \"measurementId\": \"G-SEL35L4N5R\"\n}\nif (typeof module !== 'undefined') {\n    module.exports = firebaseConfig\n}\n","import { StackScreenProps } from '@react-navigation/stack';\r\nimport * as React from 'react';\r\nimport { StyleSheet, Text, TouchableOpacity, View } from 'react-native';\r\nimport useLangContext from '../hooks/useLangContext';\r\n\r\nexport default function NotFoundScreen({\r\n  navigation,\r\n}: StackScreenProps<any, 'NotFound'>) {\r\n  const { lang } = useLangContext()\r\n  return (\r\n    <View style={styles.container}>\r\n      <Text style={styles.title}>{lang(\"This screen doesn't exist.\")}</Text>\r\n      <TouchableOpacity onPress={() => navigation.replace('HomeScreen')} style={styles.link}>\r\n        <Text style={styles.linkText}>{lang(\"Go to home screen!\")}</Text>\r\n      </TouchableOpacity>\r\n    </View>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: '#fff',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    padding: 20,\r\n  },\r\n  title: {\r\n    fontSize: 20,\r\n    fontWeight: 'bold',\r\n  },\r\n  link: {\r\n    marginTop: 15,\r\n    paddingVertical: 15,\r\n  },\r\n  linkText: {\r\n    fontSize: 14,\r\n    color: '#2e78b7',\r\n  },\r\n});\r\n","import { useTheme } from '@react-navigation/native';\r\nimport React, { useState } from 'react';\r\nimport { View, StyleSheet } from 'react-native';\r\nimport Profile from '../components/Profile';\r\nimport TextButton from '../components/TextButton';\r\nimport Colors from '../constants/Colors';\r\nimport useResizeContext from '../hooks/useResizeContext';\r\nimport TabView from '../components/TabView';\r\nimport { MessengerChannel, TabViewRecord, User, UserMembership } from '../types';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport ChannelEditModal from '../modals/ChannelEditModal';\r\nimport CommonItem from '../components/CommonItem';\r\nimport { Text } from '../components/Themed';\r\nimport useAuthContext, { Auth } from '../hooks/useAuthContext';\r\nimport { useMessengerChannelSorted } from '../hooks/lists/useMessengerChannelList';\r\nimport { navigate } from '.'\r\nimport { avatarFromChannel } from '../components/Avatar';\r\n\r\nconst DrawerTabView = (props:{auth:Auth, data:(MessengerChannel & {onPress?:()=>void})[]})=><View style={{flex:1}}>\r\n    {props.data.map((item, index)=>{\r\n      const {name} = avatarFromChannel(item, props.auth.user)\r\n      return <CommonItem key={index} containerStyle={{marginHorizontal:0}} bodyStyle={{alignItems:'flex-start'}} onPress={item.onPress}>\r\n        <Text style={{marginLeft:20}}>{name}</Text>\r\n      </CommonItem>\r\n    })}\r\n</View>\r\n\r\nconst MessengerTabView = ()=>{\r\n  const {auth} = useAuthContext()\r\n  const channelList = useMessengerChannelSorted(auth);\r\n  return <DrawerTabView auth={auth} data={(channelList || []).map(item=>({...item, onPress:()=>navigate(\"ChatScreen\", {id:item.id})}))}/>\r\n}\r\n\r\nconst drawerTabs:TabViewRecord = {\r\n  MessengerTab:{\r\n      title:'messenger',\r\n      component:MessengerTabView,\r\n      icon:<></>\r\n  },\r\n}\r\n\r\nexport default ({user}:{user:UserMembership})=> {\r\n  const { colors } = useTheme();\r\n  const windowType = useResizeContext();\r\n  const [index, setIndex] = useState(0);\r\n  const { setModal } = useModalsContext()\r\n  const onAddList = [\r\n    ()=>setModal(ChannelEditModal, {type:'messenger'}),\r\n    ()=>setModal(ChannelEditModal, {type:'board'})\r\n  ]\r\n  return <View style={windowType=='landscape'?[\r\n      styles.tabBar,\r\n      {\r\n        backgroundColor: colors.card,\r\n        borderTopColor: colors.border,\r\n      },\r\n      // tabBarStyle,\r\n    ]:{width:0}}\r\n    pointerEvents={false ? 'none' : 'auto'}\r\n  >\r\n    <Profile userId={user.id} username={user.username} name={user.name}/>\r\n    {windowType=='landscape' && <>\r\n      <View style={{flexDirection:'row-reverse'}}>\r\n          <TextButton title='+' textStyle={{fontSize:20}} style={{borderRadius:20}} onPress={onAddList[index]}/>\r\n      </View>\r\n      <View accessibilityRole=\"tablist\" style={styles.content}>\r\n        {Object.keys(drawerTabs).length>1 ? \r\n          <TabView tabs={drawerTabs} tabBarPosition={\"top\"} onTab={setIndex}/>: \r\n          <View style={{borderTopWidth:1, flex:1, borderColor:colors.border}}>            \r\n            {Object.values(drawerTabs).map(drawerTab=>{const Tab = drawerTab.component; return <Tab key={drawerTab.title}/>})}\r\n          </View>\r\n        }\r\n      </View>\r\n    </>}\r\n  </View>\r\n}\r\n\r\n{/*<Text style={[styles.label, { color: d.isFocused ? colors.primary : '#222' }]}></Text> */}\r\n\r\nconst styles = StyleSheet.create({\r\n    tabBar: {\r\n      width:240,\r\n      elevation: 8,\r\n      borderRightWidth:1,\r\n      borderColor:Colors.borderColor\r\n    },\r\n    content: {\r\n      flex: 1,\r\n      flexDirection: 'row',\r\n    },\r\n    tab: {\r\n        flex: 1,\r\n        alignItems: 'center',\r\n    },\r\n    label: {\r\n        textAlign: 'center',\r\n        backgroundColor: 'transparent',\r\n      },\r\n  });","import InviteModal from \"./InviteModal\";\r\nimport ProfileModal from \"./ProfileModal\";\r\nimport ChannelEditModal from \"./ChannelEditModal\"\r\nimport GuestLogoutModal from \"./GuestLogoutModal\";\r\nimport DateTimePickerModal from \"./DateTimePickerModal\"\r\nimport MessageModal from \"./MessageModal\";\r\n\r\nexport default [\r\n    InviteModal,\r\n    ProfileModal,\r\n    ChannelEditModal,\r\n    GuestLogoutModal,\r\n    DateTimePickerModal,\r\n    MessageModal\r\n]","import { CardStyleInterpolators, createStackNavigator } from '@react-navigation/stack';\r\nimport React, {useMemo} from 'react';\r\nimport { View } from 'react-native';\r\nimport { Ionicons } from '@expo/vector-icons';\r\nimport useResizeContext from '../hooks/useResizeContext';\r\nimport NotFoundScreen from '../screens/NotFoundScreen';\r\nimport {main, login, modal} from '../screens';\r\nimport DrawerNavigator from './DrawerNavigator';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport { WebSocketProvider } from '../hooks/useWebsocketContext';\r\nimport HeaderRight from '../components/HeaderRight'\r\nimport Colors from '../constants/Colors';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport useFirebaseContext from '../hooks/useFirebaseContext';\r\nimport useIsMobile from '../hooks/useIsMobile';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { ModalsProvider } from '../hooks/useModalsContext';\r\nimport modals from '../modals';\r\nimport useLangContext from '../hooks/useLangContext';\r\n\r\nconst Root = createStackNavigator();\r\n\r\nexport default function RootNavigator() {\r\n    const windowType = useResizeContext();\r\n    return <Root.Navigator\r\n        mode= 'modal'\r\n        headerMode= 'screen'\r\n        screenOptions={{\r\n            cardStyle:{backgroundColor:\"white\"},\r\n            animationEnabled: true,\r\n            cardStyleInterpolator: CardStyleInterpolators.forVerticalIOS,\r\n        }}\r\n    >\r\n        <Root.Screen name=\"Main\" component={MainNavigator} options={{headerShown:false}}/>\r\n        {Object.entries(modal).map(([key, screen])=><Root.Screen key={key} name={key} component={screen.component} options={{\r\n            title: screen.title,\r\n            gestureDirection: windowType == 'landscape'?'vertical-inverted':'vertical'\r\n        }} />)}\r\n    </Root.Navigator>\r\n}\r\n\r\nconst Main = createStackNavigator();\r\n\r\nfunction headerLeft(navigation:any, route:any, windowType:string, isMobile:boolean){\r\n    const canGOBackScreen = ['HomeScreen', 'LoginScreen'].findIndex(v=>v == route.name) == -1\r\n    const goBack = ()=>{\r\n        if (navigation.canGoBack())\r\n            navigation.goBack()\r\n        else if (canGOBackScreen)\r\n            navigation.replace('HomeScreen')\r\n    }\r\n    if (windowType=='portrait' && canGOBackScreen)\r\n        return <TouchableOpacity onPress={goBack}><Ionicons size={isMobile?20:24} style={{marginHorizontal:isMobile?16:20 }} name=\"arrow-back\"/></TouchableOpacity>\r\n    return null\r\n}\r\n\r\nconst MainNavigator = ()=>{\r\n    const windowType = useResizeContext();\r\n    const isMobile = useIsMobile()\r\n    const {auth} = useAuthContext()\r\n    const theme = useColorScheme()\r\n    const {lang, locale} = useLangContext()\r\n    const entries = useMemo(()=>{\r\n        if (auth.user === undefined)\r\n            return []\r\n        console.log('current user: ', auth.user)\r\n        return Object.entries(auth.user === null?login:main)\r\n    }, [auth, locale])\r\n    const modalValues = useMemo(()=>{\r\n        if (auth.user === undefined)\r\n            return []\r\n        return auth.user === null?[]:modals\r\n    }, [auth])\r\n\r\n    const {enable:noti} = useFirebaseContext(auth)\r\n    const headerLeftColor = 'white'\r\n    return (auth.user!==undefined && noti!=null?<View style={{flexDirection:'row', flex:1}}>\r\n        <ModalsProvider modals={modalValues}>\r\n            {auth.user?<DrawerNavigator user={auth.user}/>:undefined}\r\n            <View style={{flex:1}}>\r\n                <WebSocketProvider disable={auth.user === null || auth.user === undefined}>\r\n                        <Main.Navigator\r\n                            screenOptions={({navigation, route})=>({\r\n                                headerStyle:{backgroundColor:Colors[theme].header, height:isMobile?50:undefined},\r\n                                headerTitleStyle:{color:'white'},\r\n                                headerLeft:()=>headerLeft(navigation, route, windowType, isMobile),\r\n                                headerRight:()=><HeaderRight/>,\r\n                                headerLeftContainerStyle:{backgroundColor:headerLeftColor, borderBottomWidth:1, borderColor:headerLeftColor},\r\n                                cardStyle:{flexShrink:1},\r\n                                animationEnabled:windowType=='portrait',\r\n                                cardStyleInterpolator: CardStyleInterpolators.forHorizontalIOS\r\n                            })}\r\n                        >\r\n                            {entries.map(([key, screen])=><Main.Screen key={key} name={key} component={screen.component} options={{ title: lang(screen.title) }} />)}\r\n                            <Main.Screen name=\"NotFound\" component={NotFoundScreen} options={{ title: 'Oops!' }} />\r\n                        </Main.Navigator>\r\n                </WebSocketProvider>\r\n            </View>\r\n        </ModalsProvider>\r\n    </View>:<></>);\r\n}"],"sourceRoot":""}