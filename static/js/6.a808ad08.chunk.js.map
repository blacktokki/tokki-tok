{"version":3,"sources":["src/components/Themed.tsx","src/constants/Colors.ts","src/hooks/useModalsContext.tsx","src/components/CommonButton.tsx","src/hooks/useResizeContext.tsx","src/lib/react-native-paper/Avatar.tsx","src/components/Avatar.tsx","src/components/CommonSection.tsx","src/components/ModalSection.tsx","src/hooks/useModalEffect.ts","src/hooks/lists/useMessengerChannelList.ts","src/hooks/useWebsocketContext.tsx","src/components/TextButton.tsx","src/navigation/index.tsx","src/hooks/lists/useMessengerMemberList.ts","src/modals/ChannelEditModal.tsx","src/components/HeaderRight.tsx","src/hooks/lists/useUserMembershipList.ts","src/components/TabView.tsx","src/components/CommonItem.tsx","src/hooks/lists/useMessengerContentList.ts","src/modals/GuestLogoutModal.tsx","src/components/CommonTextInput.tsx","src/components/MemberItem.tsx","src/modals/DateTimePickerModal.tsx","src/modals/MessageModal.tsx","src/modals/ProfileModal.tsx","src/components/Profile.tsx","src/hooks/useFirebaseContext.tsx","src/components/ContractFooter.tsx","src/screens/main/LoginScreen.tsx","src/components/LinkPreview.tsx","src/lib/react-native-webrtc/useWebsocketContext.tsx","src/lib/react-native-webrtc/webrtc/p2p.tsx","src/lib/react-native-webrtc/webrtc/index.ts","src/lib/react-native-webrtc/LocalCam.tsx","src/lib/react-native-webrtc/RemoteCam.tsx","src/screens/main/ChatScreen/VideoCallSection.tsx","src/components/FilePreview.tsx","src/screens/main/ChatScreen/TimerTags.tsx","src/hooks/lists/useTimerMessageContent.ts","src/screens/main/ChatScreen/index.tsx","src/screens/main/HomeScreen/ConfigSections.tsx","src/screens/main/HomeScreen/index.tsx","src/screens/main/InviteeScreen.tsx","src/screens/index.ts","src/hooks/useLocalSearch.ts","src/modals/InviteModal.tsx","src/hooks/lists/useExternalMembershipList.ts","src/components/RowField.tsx","src/components/TextField.tsx","src/navigation/LinkingConfiguration.ts","web/firebase-config.js","src/screens/NotFoundScreen.tsx","src/navigation/DrawerNavigator.tsx","src/modals/index.ts","src/navigation/RootNavigator.tsx"],"names":["useThemeColor","props","colorName","theme","useColorScheme","colorFromProps","Colors","Text","style","lightColor","darkColor","otherProps","_objectWithoutProperties","_excluded","color","light","dark","React","DefaultText","_extends","View","_excluded2","backgroundColor","DefaultView","text","background","tint","tabIconDefault","tabIconSelected","hoverColor","buttonBackgroundColor","header","headerBottomColor","buttonBorderColor","iconColor","borderColor","focus","ModalsContext","createContext","setModal","ModalsProvider","_ref","children","allModals","modals","_useState","useState","_useState2","_slicedToArray","setModals","windowType","useResizeContext","_useState3","_useState4","animationType","setAnimationType","useEffect","filter","v","visible","length","map","Component","createElement","Provider","value","newModals","m","_objectSpread","modal","index","Modal","key","transparent","useContext","DefaultButton","hover","setHover","Pressable","onPress","onHoverIn","onHoverOut","disabled","paddingVertical","paddingHorizontal","selectable","fontSize","textStyle","title","_props","styles","StyleSheet","create","borderRadius","borderWidth","textAlign","fontWeight","getWindowType","window","height","width","ResizeContextContext","Dimensions","get","ResizeContextProvider","detectMobile","useMobileDetect","_useWindowDimensions","useWindowDimensions","setWindowType","isMobile","normalizeHash","hash","min","max","Math","floor","str","initHash","i","charCodeAt","abs","stringToHSL","name","userId","Avatar","size","label","split","join","toUpperCase","avatarFromChannel","item","user","avatar","member_count","id","subowner","owner","CommonSection","outerContainer","outerContainerStyle","container","containerStyle","withSeparator","separator","undefined","titleView","titleStyle","subtitle","bodyView","bodyStyle","maxWidth","alignItems","marginHorizontal","marginVertical","flexDirection","marginBottom","flex","marginTop","padding","justifyContent","alignSelf","flexShrink","margin","BottomSheet","callback","deps","navigation","useNavigation","event","e","preventDefault","addListener","removeListener","useMessengerChannelList","auth","queryClient","useQueryClient","lastJsonMessage","useWebsocketContext","data","useQuery","_auth$user","_regeneratorRuntime","async","_context","prev","next","awrap","getMessengerChannelList","t0","sent","abrupt","stop","Promise","setQueryData","_data","find","concat","_toConsumableArray","sort","a","b","_data2$message_set$","channel","last_message","content","message_set","created","useMessengerChannelSorted","channelList","_a$last_message","_b$last_message","useMessengerChannelMutation","useMutation","postChannel","onSuccess","invalidateQueries","update","putChannel","direct","postDirectChannel","mutateAsync","defaultContext","sendJsonMessage","WebSocketContext","WebSocketInternalProvider","path","Context","useBackground","token","setToken","AppState","currentState","isActive","setIsActive","_useWebSocket","useWebSocket","websockerURL","shouldReconnect","closeEvent","protocols","onOpen","console","log","onClose","AsyncStorage","getItem","then","onChange","nextState","addEventListener","removeEventListener","WebSocketProvider","_ref2","disable","Fragment","CommonButton","enableScreens","navigationRef","navigate","params","_navigationRef$curren","_navigationRef$curren2","current","Navigation","defaultColorScheme","useDefaultColorScheme","userColorScheme","colorScheme","NavigationContainer","ref","documentTitle","formatter","options","route","linking","process","versions","LinkingConfiguration","DarkTheme","DefaultTheme","RootNavigator","l","search","decoded","slice","s","replace","history","replaceState","pathname","location","ignoreWarnings","_console","_","clone","warn","message","Object","forEach","indexOf","useMessengerMemberList","channel_id","getMessengerMemberList","useMessengerMemberMutation","invite","postBulkMessengerMember","leave","deleteMessengerMember","ChannelEditModal","member_id","type","lang","useLangContext","useAuthContext","useModalsContext","channelMutation","messengerMemberMutation","setName","description","setDescription","back","_name","useModalEffect","ModalSection","TextField","setValue","multiline","groupId","_auth$user2","newChannel","group","screen","field","_useAuthContext","dispatch","defaultButtonProps","username","endsWith","GuestLogoutModal","buttonProps","extra","k","TextButton","useUserMembershipList","getUserMembershipList","_React$useState","_React$useState2","setIndex","entries","tabs","onTab","icons","assign","apply","_defineProperty","icon","TabView","renderTabBar","TabBar","indicatorStyle","activeColor","inactiveColor","renderIcon","scene","onTabPress","findIndex","_ref4","_ref5","navigationState","routes","_ref6","_ref7","onIndexChange","renderScene","SceneMap","_ref8","_ref9","component","tabBarPosition","CommonItem","press","setPress","onPressIn","onPressOut","minHeight","borderBottomWidth","useMessengerContentList","_useInfiniteQuery","useInfiniteQuery","pageParam","getMessengerContentList","select","pages","getNextPageParam","lastPage","refetchOnReconnect","refetchOnWindowFocus","fetchNextPage","pageParams","page","timer","len","newCurrent","useMessengerContentMutation","channelId","postMessage","_patch","patchMessengerContent","_delete","deleteMessengerContent","d","variables","mutate","patch","delete","contentHeight","setContentHeight","TextInput","editable","onChangeText","onContentSizeChange","nativeEvent","contentSize","onBlur","onEndEditing","member","marginRight","dayTypes","hours","Array","keys","toString","padStart","minutes","getDisableDays","date","startDate","startOf","add","endDate","endOf","today","dayjs","result","push","format","Calendar","lazy","CommonPicker","DateTimePickerModal","datetime","_dayjs","restMinute","parseInt","defaultDayjs","_useLangContext","locale","setDate","dayType","setDayType","_useState5","_useState6","hour","setHour","_useState7","_useState8","minute","setMinute","_useState9","_useState10","disableDays","setDisableDays","TouchableOpacity","Ionicons","Suspense","fallback","disableAllTouchEventsForDisabledDays","onMonthChange","dateString","markedDates","reduce","p","c","selected","values","toISOString","MessageModal","isOwner","isTimer","contentMutation","Clipboard","setString","ProfileModal","userList","isSelf","Profile","_auth$user3","patchUser","finally","CommonTextInput","firebaseConfig","require","messagingSenderId","apiKeyEncrypted","FCM_API_KEY","app","firebase","initializeApp","apiKey","messaging","onMessage","payload","Notification","permission","JSON","parse","channel_name","body","alert","FirebaseContext","setEnable","FirebaseProvider","tokenRef","useRef","notification","setNotification","enable","useMemo","isMount","serviceWorkerRegistration","currentToken","_context2","requestPermission","navigator","serviceWorker","register","scope","getToken","vapidKey","FCM_PUBLIC_VAPID_KEY","catch","unregister","requestToken","t","putNotification","noti","_context3","getNotification","postNotification","_useContext","openURL","Platform","OS","url","href","Linking","Styles","footer_buttons","footer_button","AntDesign","paddingBottom","paddingRight","login_container","login_header","paddingTop","login_header_logo","resizeMode","login_header_text","login_header_text_bold","login_wrapper","borderTopRightRadius","borderTopLeftRadius","form","form_error","form_error_text","textAlignVertical","form_input","button","button_label","login_social","login_social_separator","login_social_separator_line","login_social_separator_text","login_social_buttons","login_social_button","login_social_icon","login_social_facebook","login_footer_text","guest_footer_text","login_footer_link","link","onLongPress","image","Image","source","uri","maxHeight","TURN_SERVER","peerConstraints","iceServers","urls","sessionConstraints","mandatory","OfferToReceiveAudio","OfferToReceiveVideo","VoiceActivityDetection","mediaConstraints","audio","video","framerate","onICEcandidate","pc","_message","rtcMessage","candidate","RTCIceCandidate","addIceCandidate","sendICEcandidate","sendMessage","receiver","target","optimizeSdp","offerDescription","arr","sdp","test","RTCSessionDescription","createOffer","pcRefCurrent","stream","addStream","t1","setLocalDescription","camStyle","cam","bottonContainer","position","bottom","buttonBar","_props$user","_useWebsocketContext","_useLocalCam","pcRef","sender","setSender","_stream","setStream","isPlay","CustomRTCView","useCallback","memo","RTCView","videoProps","start","mode","newStream","mediaDevices","getUserMedia","getDisplayMedia","_ref3","error","getTracks","track","websocketOnMessage","response","peerConnection","_peerConnection","answerDescription","_peerConnection2","RTCPeerConnection","setRemoteDescription","useLocalCam","Button","setReceiver","_useRemoteCam","setUser","close","clearInterval","statsInterval","_pcRef$current","_pcRef$current2","_pcRef$current3","_pcRef$current4","streams","_peerConnection3","_answerDescription","_streams","_context5","iceConnectionState","activeStream","setInterval","stats","statsOutput","framePerSecond","_context4","getStats","report","kind","statName","framesPerSecond","Date","toTimeString","addTransceiver","direction","getRemoteStreams","createAnswer","localDescription","useRemoteCam","VideoView","scale","flexGrow","focusGuest","setFocusGuest","VideoCallContainer","setDisable","useIsMobile","videoMode","setVideoMode","guests","setGuests","_useRtcContext","useRtcContext","ceil","sqrt","toggleVideoMode","ThemedView","aspectRatio","borderLeftWidth","flexWrap","RemoteCam","LocalCam","RtcProvider","file","showBorder","FontAwesome","filename","pow","toFixed","humanFileSize","filesize","_timerFormat","now","year","month","day","timerToString","TimerTag","end","ratio","diff","setExpand","isExpand","overflow","Hyperlink","linkDefault","wordBreak","linkStyle","timerMessages","getTimerMessageContentList","sorted","_sorted$","ms","Number","MAX_VALUE","timeout","setTimeout","clearTimeout","useTimerMessageContentList","setNow","expand","MessengerContentPageItem","_nextPage2","nextPage","_nextPage","nextContent","index2","isSystem","isFirst","ownerId","dayChanged","marginLeft","file_set","fileIndex","FilePreview","link_set","linkIndex","LinkPreview","ConfigSection","setLocale","configTheme","useConfigColorScheme","_useFirebaseContext","useFirebaseContext","setNoti","n","textDecorationLine","setColorScheme","MemberTabView","memberItem","MemberItem","ScrollView","MessengerTabView","_item$last_message","_item$last_message2","_item$last_message3","_avatarFromChannel","opacity","paddingLeft","unread_count","ConfigTabView","ConfigSections","getBottomTabs","OneTab","MaterialCommunityIcons","TwoTab","FourTab","SimpleLineIcons","InviteeScreen","_route$params","enterGuest","setEnterGuest","useLayoutEffect","setOptions","headerRight","user_ids","main","HomeScreen","_route$params2","home","setHome","HeaderRight","tab","StyledText","ContractFooter","setParams","ChatScreen","_useMessengerChannelL","inputRef","channelAvatar","_useMessengerContentL","memberList","_memberList$find","setTimer","autoFocus","setAutoFocus","bottomTab","setBottomTab","postValue","InviteModal","renderItem","canGoBack","goBack","_auth$user4","minWidth","VideoCallSection","FlatList","contentContainerStyle","onScroll","contentOffset","y","onLayout","layout","TimerTags","borderBottomRightRadius","top","Entypo","onSubmitEditing","blurOnSubmit","onFocus","borderBottomLeftRadius","resolve","reject","input","document","onchange","files","onabort","onerror","click","f","_auth$user5","login","LoginScreen","setUsername","password","setPassword","_login","placeholder","autoCapitalize","keyboardType","secureTextEntry","localSearchReducer","initialState","action","keyword","active","Error","InviteItem","selectedRef","has","setSelected","GroupTabView","_useLocalSearch","compare","_useReducer","useReducer","_useReducer2","searchState","useLocalSearch","memberSet","Set","includes","dispatchKeyword","ExternalMembershipTabView","setKeyword","copied","setCopied","timeoutRef","externalMemberList","getExternalMembershipList","useExternalMembershipList","inviteLink","drawerTabs","external","RowField","rowStyle","ROOTPATH","prefixes","config","screens","Main","NotFound","module","exports","NotFoundScreen","linkText","DrawerTabView","MessengerTab","colors","useTheme","onAddList","tabBar","card","borderTopColor","border","pointerEvents","accessibilityRole","borderTopWidth","drawerTab","Tab","elevation","borderRightWidth","Root","createStackNavigator","Navigator","headerMode","screenOptions","cardStyle","animationEnabled","cardStyleInterpolator","CardStyleInterpolators","forVerticalIOS","Screen","MainNavigator","headerShown","gestureDirection","modalValues","DrawerNavigator","headerStyle","headerTitleStyle","headerLeft","canGOBackScreen","headerLeftContainerStyle","forHorizontalIOS"],"mappings":"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","file":"static/js/6.a808ad08.chunk.js","sourcesContent":["/**\r\n * Learn more about Light and Dark modes:\r\n * https://docs.expo.io/guides/color-schemes/\r\n */\r\n\r\nimport * as React from 'react';\r\nimport { Text as DefaultText, View as DefaultView } from 'react-native';\r\n\r\nimport Colors from '../constants/Colors'\r\nimport useColorScheme from '../hooks/useColorScheme';\r\n\r\nexport function useThemeColor(\r\n  props: { light?: string; dark?: string },\r\n  colorName: keyof typeof Colors.light & keyof typeof Colors.dark\r\n) {\r\n  const theme = useColorScheme();\r\n  const colorFromProps = props[theme];\r\n\r\n  if (colorFromProps) {\r\n    return colorFromProps;\r\n  } else {\r\n    return Colors[theme][colorName];\r\n  }\r\n}\r\n\r\ntype ThemeProps = {\r\n  lightColor?: string;\r\n  darkColor?: string;\r\n};\r\n\r\nexport type TextProps = ThemeProps & DefaultText['props'];\r\nexport type ViewProps = ThemeProps & DefaultView['props'];\r\n\r\nexport function Text(props: TextProps) {\r\n  const { style, lightColor, darkColor, ...otherProps } = props;\r\n  const color = useThemeColor({ light: lightColor, dark: darkColor }, 'text');\r\n\r\n  return <DefaultText style={[{ color }, style]} {...otherProps} />;\r\n}\r\n\r\nexport function View(props: ViewProps) {\r\n  const { style, lightColor, darkColor, ...otherProps } = props;\r\n  const backgroundColor = useThemeColor({ light: lightColor, dark: darkColor }, 'background');\r\n\r\n  return <DefaultView style={[{ backgroundColor }, style]} {...otherProps} />;\r\n}\r\n","const tintColorLight = '#2f95dc';\r\nconst tintColorDark = '#fff';\r\n\r\nexport default {\r\n  light: {\r\n    text: '#000',\r\n    background: '#fff',\r\n    tint: tintColorLight,\r\n    tabIconDefault: '#ccc',\r\n    tabIconSelected: tintColorLight,\r\n    hoverColor:'rgb(242,242,242)',\r\n    buttonBackgroundColor: '#f6f8fa', //'rgba(9,30,66,0.08)',//rgb(242,242,242)\\\r\n    header:'#f6f8fa',\r\n    headerBottomColor:'rgb(216, 216, 216)',\r\n    buttonBorderColor:'rgba(27,31,36,0.15)',\r\n    iconColor: 'black'\r\n  },\r\n  dark: {\r\n    text: '#fff',\r\n    background: '#000',\r\n    tint: tintColorDark,\r\n    tabIconDefault: '#ccc',\r\n    tabIconSelected: tintColorDark,\r\n    hoverColor: '#010409',//'rgb(1,4,9)',\r\n    buttonBackgroundColor: '#010409',//'#282624',\r\n    header:'#010409',\r\n    headerBottomColor:'rgb(216, 216, 216)',\r\n    buttonBorderColor:'rgba(229,225,220,0.15)',\r\n    iconColor: 'white'\r\n  },\r\n  borderColor:'#d0d7de',\r\n  \r\n  focus:'#0065A4',\r\n};\r\n","import React, { useState, createContext, useContext, useEffect } from \"react\";\r\nimport { Modal } from \"react-native\";\r\nimport useResizeContext from \"./useResizeContext\";\r\n\r\ntype ModalProps = any\r\n\r\ntype ModalState = {\r\n  Component:React.ComponentType<ModalProps>,\r\n  props:any\r\n  visible:boolean\r\n}\r\ntype SetModal = (Component:ModalState[\"Component\"]|null, props:ModalProps|null)=>void\r\n\r\nconst ModalsContext = createContext<{setModal: SetModal}>({\r\n    setModal: () => {}\r\n});\r\n\r\nexport const ModalsProvider = ({children, modals:allModals}:{children:React.ReactNode, modals:React.ComponentType<ModalProps>[]}) => {\r\n    const [modals, setModals] = useState<ModalState[]>([]);\r\n    const windowType = useResizeContext();\r\n    const [animationType, setAnimationType] = useState('none')\r\n    const setModal:SetModal = (Component, props) => {\r\n        const newModals = modals.map(m=>{\r\n            if(Component==null){\r\n                return {\r\n                    ...m,\r\n                    visible:false\r\n                }\r\n            }\r\n            else if(m.Component == Component){\r\n                return {\r\n                    Component, \r\n                    props:props!==null?props:m.props,\r\n                    visible:props!==null\r\n                }\r\n            }\r\n            return m        \r\n        })\r\n        setModals(newModals);\r\n    }\r\n    useEffect(()=>{\r\n        if (modals.filter(v=>v.visible).length == 0)\r\n            setAnimationType(windowType == 'landscape'?'fade':'slide')\r\n    }, [windowType])\r\n    useEffect(()=>{\r\n        setModals(allModals.map((Component)=>({Component, props:null, visible:false})))\r\n    }, [allModals])\r\n    return <ModalsContext.Provider value={{setModal}}>\r\n        {children}\r\n        {modals.map((modal, index)=>{\r\n            const { Component, props, visible } = modal;\r\n            return <Modal key={index} animationType={animationType as any} visible={visible} transparent>\r\n                <Component {...props}/>\r\n            </Modal>\r\n        })}\r\n    </ModalsContext.Provider>\r\n}\r\n\r\nexport default ()=>{\r\n    const modalsContext = useContext(ModalsContext)\r\n    return modalsContext\r\n}\r\n\r\n","import React, { useState } from 'react';\r\nimport { Text, StyleSheet, Pressable, StyleProp, ViewStyle} from 'react-native';\r\nimport Colors from '../constants/Colors';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { CustomButtonProps } from '../types';\r\n\r\nconst DefaultButton = (props:CustomButtonProps & {borderColor:string})=>{\r\n    const [hover, setHover] = useState(false)\r\n    return <Pressable\r\n        onPress={()=>props.onPress()}\r\n        //@ts-ignore\r\n        onHoverIn={()=>setHover(true)}\r\n        onHoverOut={()=>setHover(false)}\r\n        disabled={props.disabled}\r\n        style={[\r\n            {\r\n                paddingVertical:5, \r\n                paddingHorizontal:16\r\n            },\r\n            props.style,\r\n            (hover || props.disabled)?{backgroundColor:props.color, borderColor:props.borderColor}:{}\r\n        ]}>\r\n            {props.children?props.children:\r\n            <Text selectable={false} style={[{fontSize:14}, props.textStyle]}>{props.title}</Text>}\r\n        </Pressable>\r\n}\r\n\r\nexport default (props:CustomButtonProps)=>{\r\n    const theme = useColorScheme()\r\n    const _props = {\r\n        color:Colors[theme].hoverColor,\r\n        borderColor:theme=='light'?Colors[theme].buttonBorderColor:'#7d8590',\r\n        ...props,\r\n        style:[\r\n            styles.style,\r\n            {\r\n                backgroundColor:Colors[theme].buttonBackgroundColor,\r\n                borderColor:Colors[theme].buttonBorderColor\r\n            },\r\n            props.style,\r\n        ] as StyleProp<ViewStyle>,\r\n        textStyle:[\r\n            styles.text, \r\n            {color:Colors[theme].text},\r\n            props.textStyle\r\n        ]\r\n    }\r\n    return <DefaultButton {..._props}/>\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n    style:{\r\n        borderRadius:6, \r\n        borderWidth:1, \r\n    },\r\n    text:{\r\n        textAlign:'center', \r\n        fontWeight:'600'\r\n    }\r\n});\r\n","import React, { useState, useEffect, createContext, useContext, useMemo } from 'react';\r\nimport { Dimensions, ScaledSize, useWindowDimensions } from 'react-native';\r\n//@ts-ignore\r\nimport useMobileDetect from 'use-mobile-detect-hook';\r\n\r\ntype WindowType = 'portrait' | 'landscape'\r\n\r\nconst getWindowType = (window:{width:number, height:number})=> window.height >= window.width?'portrait':'landscape' as WindowType;\r\n\r\nconst ResizeContextContext = createContext<WindowType>(getWindowType(Dimensions.get('window')));\r\n\r\nexport const ResizeContextProvider = ({children}:{children:React.ReactNode})=>{\r\n  const detectMobile = useMobileDetect();\r\n  const {width, height} = useWindowDimensions()\r\n  const [windowType, setWindowType] = useState(getWindowType({width, height}))\r\n  useEffect(()=>{\r\n    setWindowType(getWindowType({width, height}))\r\n  }, [width, height])\r\n  return <ResizeContextContext.Provider value={detectMobile.isMobile()?'portrait':windowType}>\r\n    {children}\r\n  </ResizeContextContext.Provider>\r\n}\r\n\r\nexport default function useResizeContext() {\r\n  const windowType = useContext(ResizeContextContext)\r\n  return windowType\r\n}","import * as React from 'react';\r\nimport { Avatar } from 'react-native-paper';\r\nimport { AvatarProps } from '../../types';\r\n\r\nconst normalizeHash = (hash: number, min: number, max: number) => {\r\n    return Math.floor((hash % (max - min)) + min);\r\n};\r\n\r\nconst stringToHSL = (str: string, initHash?:number) => {\r\n    let hash = initHash || 0;\r\n    for (let i = 0; i < str.length; i++) {\r\n      hash = str.charCodeAt(i) + ((hash << 5) - hash);\r\n    }\r\n    hash = Math.abs(hash);\r\n    return `hsl(${normalizeHash(hash, 0, 360)}, ${normalizeHash(hash, 0, 100)}%, ${normalizeHash(hash, 25, 75)}%)`;\r\n};\r\n\r\nexport default (props:AvatarProps) => {\r\n    const backgroundColor = stringToHSL(props.name, props.userId)\r\n    return <Avatar.Text style={{backgroundColor}} size={props.size} label={props.name.split(' ').map(v=>v[0]).join().toUpperCase()} />\r\n};","import React from 'react';\r\nimport Avatar from '../lib/react-native-paper/Avatar';\r\nimport { AvatarProps, MessengerChannel, User } from '../types';\r\n\r\nexport function avatarFromChannel(item:MessengerChannel, user?:User|null){\r\n    let avatar;\r\n    let name = item.name\r\n    if (item.member_count<3){\r\n        avatar = (item.member_count==1 || user?.id == item.subowner.id)?item.owner:item.subowner\r\n        name = name.length>0?name:avatar.name \r\n    }\r\n    return {avatar, name}\r\n}\r\n\r\nexport default (props:AvatarProps)=>{\r\n    return <Avatar {...props}/>\r\n}\r\n\r\n","import * as React from 'react';\r\nimport { View, Text } from './Themed';\r\nimport { StyleSheet, StyleProp, ViewStyle, TextStyle } from 'react-native';\r\nimport Colors from '../constants/Colors';\r\n\r\nexport type SectionParamList = {\r\n    title?: string,\r\n    titleStyle?:StyleProp<TextStyle>\r\n    outerContainerStyle?:StyleProp<TextStyle>\r\n    containerStyle?:StyleProp<ViewStyle>\r\n    bodyStyle?:StyleProp<ViewStyle>\r\n    subtitle?: string\r\n    withSeparator?: boolean\r\n    children?: React.ReactNode\r\n}\r\n\r\nexport default function CommonSection(props:SectionParamList){\r\n  return (\r\n    <View style={[styles.outerContainer, props.outerContainerStyle]}>\r\n        <View style={[styles.container, props.containerStyle]}>\r\n            {props.withSeparator?<View style={styles.separator} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />:undefined}\r\n            {props.title?<View style={styles.titleView}>\r\n              <Text style={[styles.title, props.titleStyle]}>{props.title}</Text>\r\n              <Text style={styles.subtitle}>{props.subtitle}</Text>\r\n            </View>:undefined}\r\n            <View style={[styles.bodyView, props.bodyStyle]}>\r\n            {props.children}\r\n            </View>\r\n          </View>\r\n        </View>\r\n    )\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  outerContainer:{\r\n    width:'100%',\r\n    maxWidth:1080,\r\n    alignItems:'stretch',\r\n    backgroundColor:'transparent'\r\n  },  \r\n  container: {\r\n      marginHorizontal:20,\r\n      marginVertical: 10,\r\n      backgroundColor:'transparent',\r\n    },\r\n    titleView:{\r\n      width: '100%',\r\n      flexDirection:'row',\r\n      backgroundColor:'transparent',\r\n      marginBottom:5,\r\n    },\r\n    title: {\r\n      flex:1,\r\n      fontSize: 16,\r\n    },\r\n    subtitle: {\r\n      flex:1,\r\n      fontSize: 12,\r\n      textAlign: 'right',\r\n      marginTop:4\r\n    },\r\n    separator: {\r\n      marginBottom: 20,\r\n      height: 1,\r\n      width: '100%',\r\n    },\r\n    bodyView:{\r\n      width: '100%',\r\n      padding: 20,\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      borderWidth:1,\r\n      borderColor:Colors.borderColor,\r\n      borderRadius:6\r\n    }\r\n  });\r\n  ","import React from 'react'\r\nimport CommonSection from \"./CommonSection\";\r\nimport useResizeContext from '../hooks/useResizeContext';\r\n\r\nexport default (props:{children?: React.ReactNode})=>{\r\n    const windowType = useResizeContext();\r\n    return <CommonSection\r\n        outerContainerStyle={{flex:1, alignSelf:'center', backgroundColor:'#8888', maxWidth:undefined, flexShrink:1}}\r\n        containerStyle={{flex:1, margin:0, justifyContent:'center', alignItems:'center'}}\r\n        bodyStyle={windowType=='landscape'?{width:'90%', height:'90%', padding:'5%'}:{width:'100%', height:'100%', maxWidth:1080}}\r\n    >\r\n        {props.children}\r\n    </CommonSection>\r\n}\r\n\r\nexport const BottomSheet = (props:{children?: React.ReactNode})=><CommonSection\r\n    outerContainerStyle={{flex:1, alignSelf:'center', backgroundColor:'#8888', maxWidth:undefined}}\r\n    containerStyle={{flex:1, margin:0, justifyContent:'flex-end'}}\r\n>\r\n    {props.children}\r\n</CommonSection>","import { DependencyList, useEffect } from \"react\";\r\nimport { EventArg, useNavigation } from \"@react-navigation/core\";\r\n\r\n\r\nexport default (callback:()=>void, deps?:DependencyList)=>{\r\n    const navigation = useNavigation()\r\n    useEffect(()=>{\r\n        const event = (e:EventArg<any, true, any>)=> {\r\n            e.preventDefault();\r\n            callback()\r\n        }\r\n        navigation.addListener('beforeRemove', event)\r\n        return () => {\r\n            navigation.removeListener('beforeRemove', event)\r\n        }\r\n  }, deps)\r\n}","import { useEffect } from \"react\";\r\nimport { useMutation, useQuery, useQueryClient } from \"react-query\";\r\nimport { getMessengerChannelList, postChannel, postDirectChannel, putChannel } from \"../../apis\";\r\nimport { MessengerChannel, MessengerContent } from \"../../types\";\r\nimport { Auth } from \"../useAuthContext\";\r\nimport useWebsocketContext from \"../useWebsocketContext\";\r\n\r\nexport default function useMessengerChannelList(auth?:Auth){\r\n  const queryClient = useQueryClient()\r\n  const {lastJsonMessage} = useWebsocketContext()\r\n  const { data } = useQuery(\"MessengerChannelList\" , async()=>auth?.user?.id?(await getMessengerChannelList(auth.user.id)):[])\r\n\r\n  useEffect(()=>{\r\n    if(lastJsonMessage !=null){\r\n      if(lastJsonMessage['type']=='enter'){\r\n        queryClient.setQueryData<MessengerChannel[]>(\"MessengerChannelList\", (_data)=>{\r\n          return (_data?.find(v=>v.id==lastJsonMessage['data']['id'])?_data:[lastJsonMessage['data'] , ...(_data|| [])]).sort((a, b)=>a.id - b.id)\r\n        })\r\n      }\r\n      if (lastJsonMessage['type']=='next_message'){\r\n        const data:MessengerContent = lastJsonMessage['data']\r\n        queryClient.setQueryData<MessengerChannel[]>(\"MessengerChannelList\", (_data)=>(_data || []).map(v=>{\r\n          if (v.id == data.channel){\r\n            return {...v, last_message:{content:data.message_set[0]?.content, created:data.created}}\r\n          }\r\n          return v\r\n        }))\r\n      }\r\n      // if(lastJsonMessage['type']=='leave'){\r\n      //   queryClient.setQueryData<Channel[]>(\"MessengerChannelList\", (_data)=>_data?.filter(v=>v.id!=lastJsonMessage['data']['channel_id']) || [])\r\n      // }\r\n    }\r\n  }, [lastJsonMessage])\r\n  return data\r\n}\r\n\r\nexport function useMessengerChannelSorted(auth?:Auth){\r\n  const channelList = useMessengerChannelList(auth);\r\n  return channelList?.sort((a, b)=>(a.last_message?.created || '') < (b.last_message?.created || '')?1:-1)\r\n}\r\nexport function useMessengerChannelMutation(){\r\n  const queryClient = useQueryClient()\r\n\r\n  const create = useMutation(postChannel, {\r\n    onSuccess: ()=>queryClient.invalidateQueries(\"MessengerChannelList\")\r\n  });\r\n\r\n  const update = useMutation(putChannel, {\r\n    onSuccess: () => queryClient.invalidateQueries(\"MessengerChannelList\")\r\n  })\r\n\r\n  const direct = useMutation(postDirectChannel, {\r\n    onSuccess: () => queryClient.invalidateQueries(\"MessengerChannelList\")\r\n  })\r\n\r\n  return { create:create.mutateAsync, update:update.mutateAsync, direct:direct.mutateAsync}\r\n}","import React, { Context, createContext,  useContext, useEffect, useState } from \"react\"\r\nimport useWebSocket from \"react-use-websocket\"\r\nimport { SendJsonMessage } from \"react-use-websocket/dist/lib/types\"\r\nimport {websockerURL } from \"../constants/Envs\"\r\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\r\nimport { AppState, AppStateStatus } from \"react-native\";\r\n\r\ntype WebsocketContextType = {lastJsonMessage:any, sendJsonMessage:SendJsonMessage }\r\nconst defaultContext = {lastJsonMessage:undefined, sendJsonMessage:()=>{}}\r\nconst WebSocketContext = createContext<WebsocketContextType>(defaultContext);\r\n\r\nexport const WebSocketInternalProvider = ({children, path, Context, useBackground}:{children:React.ReactNode, path:string, Context:Context<WebsocketContextType>, useBackground?:boolean})=>{\r\n  const [token, setToken] = useState<string|null>(null)\r\n  const [isActive, setIsActive] = useState<boolean>(useBackground || AppState.currentState == 'active')\r\n  const { lastJsonMessage, sendJsonMessage } = useWebSocket(`${websockerURL}/${path}`,{\r\n    shouldReconnect: (closeEvent) => true,\r\n    protocols: token?['Authorization',  token]:undefined,\r\n    onOpen: (e)=>{console.log(`success websocket connection(${path})`)},\r\n    onClose: (e)=> {console.log(`closed websocket connection(${path})`)},\r\n  }, isActive && token!=null)\r\n  useEffect(()=>{\r\n    AsyncStorage.getItem('Authorization').then(setToken)\r\n    const onChange = (nextState:AppStateStatus)=>setIsActive(useBackground || nextState == 'active')\r\n    AppState.addEventListener(\"change\", onChange)\r\n    return ()=>AppState.removeEventListener(\"change\", onChange)\r\n  }, [])\r\n  return <Context.Provider value={token!=null?{lastJsonMessage, sendJsonMessage}:defaultContext}>\r\n      {children}\r\n    </Context.Provider>\r\n}\r\n\r\nexport const WebSocketProvider = ({disable, children}:{disable?:boolean, children:React.ReactNode})=>{\r\n  return disable?<>{children}</>:<WebSocketInternalProvider path={'messenger/ws/'} Context={WebSocketContext}>\r\n    {children}\r\n  </WebSocketInternalProvider>\r\n}\r\n\r\nexport default ()=>{\r\n  const webSocketContext = useContext(WebSocketContext)\r\n  return webSocketContext\r\n}\r\n\r\n","import React, { useState } from 'react';\r\nimport { StyleSheet} from 'react-native';\r\nimport { CustomButtonProps } from '../types';\r\nimport CommonButton from './CommonButton';\r\n\r\nexport default (props:CustomButtonProps)=>{\r\n    return <CommonButton {...props} style={[styles.style, props.style]}/>\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n    style:{\r\n        borderRadius:6, \r\n        backgroundColor: 'transparent',\r\n        borderWidth:0\r\n    },\r\n});\r\n","/**\r\n * If you are not familiar with React Navigation, refer to the \"Fundamentals\" guide:\r\n * https://reactnavigation.org/docs/getting-started\r\n *\r\n */\r\nimport { NavigationContainer, DefaultTheme, DarkTheme, NavigationContainerRef } from '@react-navigation/native';\r\nimport * as React from 'react';\r\n\r\nimport LinkingConfiguration from './LinkingConfiguration';\r\nimport RootNavigator from './RootNavigator';\r\n\r\nimport { useColorScheme as useDefaultColorScheme } from 'react-native';\r\nimport { useColorScheme as useColorScheme } from 'react-native-appearance';\r\nimport { ResizeContextProvider } from '../hooks/useResizeContext';\r\nimport { enableScreens } from 'react-native-screens';\r\n\r\nenableScreens();\r\nconst navigationRef = React.createRef<NavigationContainerRef>();\r\n\r\nexport function navigate(name:string, params?:any) {\r\n  if (params)\r\n    navigationRef.current?.navigate(name, params);\r\n  navigationRef.current?.navigate(name);\r\n}\r\n\r\nexport default function Navigation() {\r\n  const defaultColorScheme = useDefaultColorScheme()\r\n  const userColorScheme = useColorScheme()\r\n  const colorScheme = userColorScheme =='no-preference'?defaultColorScheme:userColorScheme\r\n  return <NavigationContainer\r\n    ref={navigationRef}\r\n    documentTitle={{formatter: (options, route) => {return `TOKKI TOK`}}}\r\n    linking={(process.versions && process.versions['electron'])?undefined:LinkingConfiguration}\r\n    theme={colorScheme === 'dark' ? DarkTheme : DefaultTheme}>\r\n        <ResizeContextProvider>\r\n          <RootNavigator />\r\n        </ResizeContextProvider>\r\n  </NavigationContainer>\r\n}\r\n\r\n(function(l) {  // for github-page\r\n    if (l !== undefined && l.search[1] === '/' ) {\r\n        var decoded = l.search.slice(1).split('&').map(function(s) { \r\n        return s.replace(/~and~/g, '&')\r\n        }).join('?');\r\n        window.history.replaceState(null, '',\r\n            l.pathname.slice(0, -1) + decoded + l.hash\r\n        );\r\n    }\r\n}(window.location))\r\n    \r\nconst ignoreWarnings = ['ReactNativeFiberHostComponent'];\r\nlet _console:any = ()=>{}\r\nimport('lodash').then(_=>{\r\n  _console = _.clone(console);\r\n})\r\nconsole.warn = (message: string|Object) => {\r\n    var warn = true;\r\n    if (message instanceof Object)\r\n    warn = false;\r\n    else{\r\n    ignoreWarnings.forEach((value)=>{\r\n        if (message.indexOf && message.indexOf(value) <= -1) {\r\n            warn = false;\r\n        }\r\n    })\r\n    };\r\n    if (warn){\r\n        _console.warn(message);\r\n    }\r\n    else{\r\n        // console.log(message)\r\n    }\r\n};\r\n","import { useMutation, useQuery, useQueryClient } from \"react-query\";\r\nimport { postBulkMessengerMember, deleteMessengerMember, getMessengerMemberList } from \"../../apis\";\r\n\r\nexport default function useMessengerMemberList(channel_id:number){\r\n  const { data } = useQuery([\"MessengerMemberList\", channel_id] , async()=>await getMessengerMemberList(channel_id))\r\n  return data\r\n}\r\n\r\n\r\nexport function useMessengerMemberMutation(){\r\n  const queryClient = useQueryClient()\r\n  const invite = useMutation(postBulkMessengerMember, {\r\n    onSuccess: ()=>{\r\n      queryClient.invalidateQueries(\"MessengerMemberList\")\r\n    }\r\n  })\r\n\r\n  const leave = useMutation(deleteMessengerMember, {\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries(\"MessengerChannelList\")\r\n      queryClient.invalidateQueries(\"MessengerMemberList\")\r\n    }\r\n  })\r\n  return {invite:invite.mutateAsync, leave:leave.mutateAsync}\r\n}","import React, {useState, useEffect } from 'react';\r\nimport { StyleSheet } from 'react-native';\r\nimport { View, Text } from '../components/Themed';\r\nimport CommonButton from '../components/CommonButton';\r\n// import useBoardChannelList, { useBoardChannelMutation } from '../hooks/lists/useBoardChannelList';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport { navigate } from '../navigation';\r\nimport { Channel } from '../types';\r\nimport useMessengerChannelList, { useMessengerChannelMutation } from '../hooks/lists/useMessengerChannelList';\r\nimport TextField from '../components/TextField';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport ModalSection from '../components/ModalSection';\r\nimport { useMessengerMemberMutation } from '../hooks/lists/useMessengerMemberList';\r\nimport { avatarFromChannel } from '../components/Avatar';\r\nimport useModalEffect from '../hooks/useModalEffect';\r\n\r\nexport default function ChannelEditModal({id, member_id, type}: {id?:number, member_id?:number, type:string}) {\r\n  const { lang } = useLangContext()\r\n  const {auth} = useAuthContext()\r\n  const { setModal } = useModalsContext()\r\n  const channelList = useMessengerChannelList(auth)\r\n  const channelMutation = useMessengerChannelMutation()\r\n  const messengerMemberMutation = useMessengerMemberMutation()\r\n  const channel = channelList?.find(v=>v.id==id)\r\n  const [name, setName] = useState('')\r\n  const [description, setDescription] = useState('')\r\n  const back = ()=>{\r\n    setModal(ChannelEditModal, null)\r\n  }\r\n\r\n  useEffect(()=>{\r\n    if (channel){\r\n      const {name:_name} = avatarFromChannel(channel, auth.user)\r\n      setName(_name)\r\n      setDescription(channel?.description || '')\r\n    }\r\n  }, [channel])\r\n  useModalEffect(back, [])\r\n  return <ModalSection>\r\n    <View style={{justifyContent:'space-between', flex:1, width:'100%'}}>\r\n      <View style={{width:'100%'}}>\r\n        <Text style={{fontSize:20}}>{id?lang('Chat Setting'):lang('New chat')}</Text>\r\n        <View style={styles.separator} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n        <TextField name={lang('Channel Name')} value={name} setValue={setName} width={'60%'}/>\r\n        <TextField name={lang('Description')} value={description} setValue={setDescription} multiline width={'60%'}/>\r\n      </View>\r\n      <View style={{width:'100%', flexDirection:'row'}}>\r\n        {member_id &&<View style={{flexDirection:'row', justifyContent:'flex-start'}}>\r\n          <CommonButton title={lang('leave')} style={{marginHorizontal:5}} textStyle={{color:'red'}} onPress={()=>messengerMemberMutation.leave(member_id).then(back)}/>\r\n        </View>}\r\n        <View style={{flex:1, flexDirection:'row', justifyContent:'flex-end'}}>\r\n          <CommonButton title={lang('save')} onPress={()=>{\r\n            if(auth?.user?.id && auth.groupId){\r\n              const newChannel:Channel = {id, name, description, type, owner:auth?.user?.id, group:auth.groupId};\r\n              (id?channelMutation.update(newChannel):channelMutation.create(newChannel)).then(v=>navigate(\"Main\", {\r\n                screen:v.type == 'messenger'?'ChatScreen':'BoardScreen',\r\n                params:{id:v.id}\r\n              }))\r\n            }\r\n          }}/>\r\n          <CommonButton title={lang('cancel')} style={{marginHorizontal:5}} onPress={back}/>\r\n        </View>\r\n      </View>\r\n    </View>\r\n  </ModalSection>\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  field:{\r\n    width:'50%',\r\n    flexDirection:'row',\r\n    padding:10,\r\n  },\r\n  separator: {\r\n    marginBottom: 20,\r\n    height: 1,\r\n    width: '100%',\r\n  },\r\n})","import React from 'react'\r\nimport TextButton from \"./TextButton\"\r\nimport useAuthContext from \"../hooks/useAuthContext\"\r\nimport useResizeContext from '../hooks/useResizeContext'\r\nimport { View } from 'react-native'\r\nimport useModalsContext from '../hooks/useModalsContext'\r\nimport GuestLogoutModal from '../modals/GuestLogoutModal'\r\nimport useLangContext from '../hooks/useLangContext'\r\nimport useColorScheme from '../hooks/useColorScheme'\r\nimport Colors from '../constants/Colors'\r\n\r\ntype ButtonProps = {title:string, onPress:()=>void, windowType?:'landscape'|'portrait'}\r\n\r\nexport default (props:{extra?:ButtonProps[]})=>{\r\n    const { lang } = useLangContext()\r\n    const theme = useColorScheme()\r\n    const {auth, dispatch} = useAuthContext()\r\n    const { setModal } = useModalsContext()\r\n    const windowType = useResizeContext()\r\n    const defaultButtonProps:ButtonProps[] = [{title:lang('sign out'), onPress:()=>{\r\n        if (auth?.user?.username.endsWith(\".guest\")){\r\n            setModal(GuestLogoutModal, {})\r\n        }\r\n        else{\r\n            dispatch({type:\"LOGOUT_REQUEST\"})\r\n        }\r\n    }}]\r\n    const buttonProps = (props.extra?[...props.extra, ...defaultButtonProps]:defaultButtonProps).filter(v=>v.windowType==windowType || v.windowType == undefined)\r\n    return<View style={{flexDirection:'row'}}>\r\n        {buttonProps.map((v,k)=><TextButton key={k} {...v} textStyle={{color:Colors[theme].text}} color='#gray'/>)}\r\n    </View>\r\n}\r\n  ","import { useQuery } from \"react-query\";\r\nimport { getUserMembershipList } from \"../../apis\";\r\nimport { Auth } from \"../useAuthContext\";\r\n\r\nexport default function useUserMembershipList(auth?:Auth){\r\n  const { data } = useQuery([\"UserMembershipList\", auth?.groupId] , async()=>auth?.groupId?(await getUserMembershipList(auth?.groupId)):[])\r\n  return data\r\n}","import React from 'react';\r\nimport { TabView, SceneMap,NavigationState, SceneRendererProps, TabBar } from 'react-native-tab-view';\r\nimport Colors from '../constants/Colors';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport { TabViewRecord } from '../types';\r\n\r\n\r\nexport default (props:{tabs:TabViewRecord, tabBarPosition:\"top\"|\"bottom\", index?:number, onTab?:(index:number)=>void})=>{\r\n  const { lang } = useLangContext()\r\n  const [index, setIndex] = React.useState(props.index || 0);\r\n  const theme = useColorScheme()\r\n  const entries = Object.entries(props.tabs)\r\n  const onTab = props.onTab\r\n  const icons = Object.assign({}, ...entries.map(([k, v])=>({[k]:v.icon})))\r\n  return <TabView\r\n    renderTabBar={(props:SceneRendererProps & {navigationState: NavigationState<any>})=>{\r\n      return <TabBar\r\n        {...props}\r\n        indicatorStyle={{ backgroundColor: \"#2196F3\" }}\r\n        style={{ backgroundColor:Colors[theme].background }}\r\n        activeColor={Colors[theme].text}\r\n        inactiveColor={Colors[theme].text}\r\n        renderIcon={(scene)=>icons[scene.route.key]}\r\n        onTabPress={(scene)=>onTab?.(entries.findIndex(([k, v])=>k == scene.route.key))}\r\n      />\r\n    }}\r\n    navigationState={{ index, routes: entries.map(([k, v])=>({key:k, title:lang(v.title)}))}}\r\n    onIndexChange={setIndex}\r\n    renderScene={SceneMap(Object.assign({}, ...entries.map(([k, v])=>({[k]:v.component}))))}\r\n    tabBarPosition={props.tabBarPosition}\r\n  />\r\n}\r\n\r\n","import * as React from 'react';\r\nimport { View } from './Themed';\r\nimport { StyleSheet, StyleProp, ViewStyle, TextStyle, Pressable } from 'react-native';\r\nimport Colors from '../constants/Colors';\r\n\r\nexport type ItemParamList = {\r\n    outerContainerStyle?:StyleProp<TextStyle>\r\n    containerStyle?:StyleProp<ViewStyle>\r\n    bodyStyle?:StyleProp<ViewStyle>\r\n    children?: React.ReactNode\r\n    onPress?: ()=>void\r\n}\r\n\r\nexport default function CommonItem(props:ItemParamList){\r\n  // const [hover, setHover] = React.useState(false)\r\n  const [press, setPress] = React.useState(false)\r\n  return (\r\n    <Pressable\r\n      style={[styles.outerContainer ,props.outerContainerStyle, (press)?{backgroundColor:'rgb(242,242,242)'}:{}]}\r\n      onPressIn={()=>setPress(true)}\r\n      onPress={()=>props.onPress?.()}\r\n      onPressOut={()=>setPress(false)}\r\n      //  //@ts-ignore\r\n      //  onHoverIn={()=>setHover(true)}\r\n      //  onHoverOut={()=>setHover(false)}\r\n    >\r\n        <View style={[styles.container ,props.containerStyle]}>\r\n            <View style={[styles.bodyView, props.bodyStyle]}>\r\n                <>{props.children}</>\r\n            </View>\r\n      </View>\r\n    </Pressable>\r\n    )\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  outerContainer:{\r\n    width:'100%',\r\n    maxWidth:1080,\r\n    alignItems:'stretch',\r\n  },  \r\n  container: {\r\n      marginHorizontal:20,\r\n      backgroundColor:'transparent'\r\n    },\r\n    bodyView:{\r\n      width: '100%',\r\n      padding: 10,\r\n      minHeight: 40,\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      borderBottomWidth:1,\r\n      borderColor:Colors.borderColor,\r\n      backgroundColor:'transparent'\r\n    }\r\n  });\r\n  ","import { useEffect } from \"react\"\r\nimport { InfiniteData, useInfiniteQuery, useMutation, useQueryClient } from \"react-query\"\r\nimport { getMessengerContentList, postMessage, deleteMessengerContent, patchMessengerContent } from \"../../apis\"\r\nimport { MessengerContent } from \"../../types\"\r\nimport useWebsocketContext from \"../useWebsocketContext\"\r\n\r\nexport type MessengerContentPage = {\r\n  next?:MessengerContentPage\r\n  current:MessengerContent[]\r\n}\r\n\r\nexport default function useMessengerContentList(channel_id:number){  \r\n  const queryClient = useQueryClient()\r\n  const { data, fetchNextPage } = useInfiniteQuery<MessengerContentPage>(\r\n    [\"MessengerContentList\", channel_id], \r\n    async({pageParam})=>getMessengerContentList(channel_id, pageParam).then(current=>({current})), \r\n    {\r\n      select:data=>{\r\n        if(data.pages.length > 1)\r\n          data.pages[data.pages.length - 2].next = data.pages[data.pages.length - 1]\r\n        return data;\r\n      },\r\n      getNextPageParam:(lastPage)=>lastPage?.current.length?lastPage.current[lastPage.current.length - 1].id:undefined,\r\n      refetchOnReconnect:false,\r\n      refetchOnWindowFocus:true\r\n    }\r\n  )\r\n  const { lastJsonMessage } = useWebsocketContext()\r\n  useEffect(()=>{\r\n    if(lastJsonMessage !=null && lastJsonMessage['data']['channel'] == channel_id){\r\n      if(lastJsonMessage['type']=='next_message'){\r\n        queryClient.setQueryData<InfiniteData<MessengerContentPage>>([\"MessengerContentList\", channel_id], (_data)=>{\r\n          if(_data?.pages[0].current && _data?.pages[0].current[0].id != lastJsonMessage['data'].id)\r\n            _data.pages[0].current = [lastJsonMessage['data'], ..._data?.pages[0].current]\r\n          return {...(_data || {pages:[], pageParams:[]})}\r\n        })\r\n      }\r\n      if(lastJsonMessage['type']=='update_message'){\r\n        queryClient.setQueryData<InfiniteData<MessengerContentPage>>([\"MessengerContentList\", channel_id], (_data)=>{\r\n          _data?.pages.forEach(page=>{\r\n            page.current.forEach(v=>{\r\n              if (v.id==lastJsonMessage['data'].id){\r\n                v.timer = lastJsonMessage['data'].timer\r\n              }\r\n            })\r\n          })\r\n          return {...(_data || {pages:[], pageParams:[]})}\r\n        })\r\n      }\r\n      if(lastJsonMessage['type']=='delete_message'){\r\n        queryClient.setQueryData<InfiniteData<MessengerContentPage>>([\"MessengerContentList\", channel_id], (_data)=>{\r\n          _data?.pages.forEach(page=>{\r\n            const len = page.current.length\r\n            const newCurrent = page.current.filter(v=>v.id!=lastJsonMessage['data'].id)\r\n            if (len != newCurrent.length){\r\n              page.current = newCurrent\r\n            }\r\n          })\r\n          return {...(_data || {pages:[], pageParams:[]})}\r\n        })\r\n      }\r\n    }\r\n  }, [lastJsonMessage])\r\n  return { data, fetchNextPage }\r\n}\r\n\r\nexport function useMessengerContentMutation(channelId?:number){\r\n  // const queryClient = useQueryClient()\r\n  const create = useMutation(postMessage, {\r\n    onSuccess: () => {\r\n      // queryClient.setQueryData(['MessengerContentList'], (data:any) => ({\r\n      //   pages: data.pages.slice(0, 1),\r\n      //   pageParams: data.pageParams.slice(0, 1),\r\n      // }))\r\n      // queryClient.invalidateQueries(\"MessengerContentList\")\r\n    }\r\n  });\r\n  const _patch = useMutation(patchMessengerContent);\r\n  const _delete = useMutation(deleteMessengerContent, {\r\n    onSuccess: (d, variables) => {\r\n      // queryClient.setQueryData(['MessengerContentList'], (data:any) => ({\r\n      //   pages: (data.pages as MessengerContent[][]).map(v=>v.filter(v2=>v2.id != variables)),\r\n      //   pageParams: data.pageParams,\r\n      // }))\r\n    }\r\n  })\r\n  return { create:create.mutate, patch:_patch.mutate, delete:_delete.mutate }\r\n}","import React from 'react';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport CommonButton from '../components/CommonButton';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport { Text, View } from '../components/Themed';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport { BottomSheet } from '../components/ModalSection';\r\nimport useModalEffect from '../hooks/useModalEffect';\r\n\r\nexport default function GuestLogoutModal({id}:{id:number}) {\r\n  const { lang } = useLangContext()\r\n  const { setModal } = useModalsContext()\r\n  const {dispatch} = useAuthContext()\r\n  const back = ()=>{\r\n    setModal(GuestLogoutModal, null)\r\n  }\r\n  useModalEffect(back, [])\r\n  return <BottomSheet>\r\n    <Text>{lang('Guest users cannot reconnect after logging out. Please create an account or log in.')}</Text>\r\n    <View style={{width:'100%', flexDirection:'row', justifyContent:'flex-end'}}>\r\n      <CommonButton title={lang('sign out')} onPress={()=>dispatch({type:\"LOGOUT_REQUEST\"})}/>\r\n      <CommonButton title={lang('cancel')} onPress={()=>back()}/>\r\n    </View>\r\n  </BottomSheet>\r\n}\r\n","import React, { useState } from 'react';\r\nimport { TextInput } from 'react-native';\r\nimport Colors from '../constants/Colors';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { CustomTextInputProps } from '../types';\r\n\r\nexport default (props:CustomTextInputProps)=>{\r\n    const [contentHeight, setContentHeight] = useState<number>()\r\n    const minHeight = props.minHeight || 30\r\n    const theme = useColorScheme()\r\n    return <TextInput style={[{\r\n            borderColor:'#d0d7de', \r\n            fontSize:16, \r\n            borderWidth:1, \r\n            borderRadius:6, \r\n            paddingHorizontal:10, \r\n            paddingVertical:3, \r\n            backgroundColor:Colors[theme].background,\r\n            color:Colors[theme].text,\r\n            height:props.multiline?contentHeight:minHeight,\r\n        }, props.style]} \r\n        editable={!props.disabled} \r\n        value={props.value} \r\n        onChangeText={props.setValue}\r\n        onContentSizeChange={props.multiline?(e) => setContentHeight(Math.max(e.nativeEvent.contentSize.height, minHeight) + 2):undefined}\r\n        onBlur={()=>props.onBlur?.(props.value)}\r\n        onEndEditing={()=>props.onEndEditing?.(props.value)}\r\n        multiline={props.multiline}\r\n    />\r\n}","import React from \"react\"\r\nimport CommonItem from \"./CommonItem\"\r\nimport { UserMembership } from \"../types\"\r\nimport Avatar from \"./Avatar\"\r\nimport { Text, View } from \"./Themed\"\r\n\r\nexport default ({member:item, onPress}:{member:UserMembership, onPress?:()=>void})=> {\r\n    return <CommonItem key={item.id} bodyStyle={{flexDirection:'row', justifyContent:'flex-start'}} onPress={onPress}>\r\n        <View style={{marginTop:4, marginRight:12}}><Avatar name={item.name} userId={item.id} size={44}/></View>\r\n        <Text style={{fontSize:20, fontWeight:'400'}}>{item.name}</Text>\r\n    </CommonItem>\r\n}","import React, { Suspense, useState } from 'react';\r\nimport CommonButton from '../components/CommonButton';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport { Text, View } from '../components/Themed';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport { Ionicons } from '../lib/@expo/vector-icons';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport Colors from '../constants/Colors';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { BottomSheet } from '../components/ModalSection';\r\nimport dayjs from 'dayjs';\r\nimport useModalEffect from '../hooks/useModalEffect';\r\n\r\nconst dayTypes = ['AM', 'PM'].map(value=>({label:value, value}))\r\nconst hours = [...Array(12).keys()].map((value, index)=>(index + 1).toString().padStart(2, '0')).map(value=>({label:value, value}))\r\nconst minutes = [...Array(12).keys()].map((value, index)=>(index * 5).toString().padStart(2, '0')).map(value=>({label:value, value}))\r\n\r\n\r\nconst getDisableDays=(date:dayjs.Dayjs)=>{\r\n  let startDate = date.clone().startOf('month').add(-1, 'month')\r\n  const endDate = date.clone().endOf('month').add(1, 'month')\r\n  const today = dayjs().startOf('day')\r\n  const result = []\r\n  while(startDate<=endDate && startDate<today){\r\n    result.push(startDate.format('YYYY-MM-DD'))\r\n    startDate = startDate.add(1, 'day')\r\n  }\r\n  return result\r\n}\r\n\r\nconst defaultDayjs = ()=>{\r\n  const m = dayjs()\r\n  const restMinute = parseInt(m.format('mm')) % 5\r\n  return m.add(5-restMinute, 'minute')\r\n}\r\n\r\nconst Calendar = React.lazy(()=> import('../components/Calendar'))\r\nconst CommonPicker = React.lazy(()=>import('../components/CommonPicker'))\r\n\r\nexport default function DateTimePickerModal({datetime, callback}:{datetime?:string, callback:(datetime?:string)=>void}) {\r\n  const _dayjs = datetime?dayjs(datetime):defaultDayjs()\r\n  const { lang, locale } = useLangContext()\r\n  const theme = useColorScheme()\r\n  const [date, setDate] = useState(_dayjs.format('YYYY-MM-DD'));\r\n  const [dayType, setDayType] = useState(_dayjs.locale('en').format('A'))\r\n  const [hour, setHour] = useState(_dayjs.format('hh'))\r\n  const [minute, setMinute] = useState(_dayjs.format('mm'))\r\n  const [disableDays, setDisableDays] = useState<string[]>(getDisableDays(_dayjs))\r\n  const { setModal } = useModalsContext()\r\n  const back = ()=>{\r\n    setModal(DateTimePickerModal, null)\r\n  }\r\n  useModalEffect(back, [])\r\n  return <BottomSheet>\r\n    <View style={{flexDirection:'row', width:'100%'}}>\r\n      <View style={{flex:1, flexDirection:'row'}}>\r\n        <TouchableOpacity onPress={back}>\r\n          <Ionicons size={20} name=\"arrow-back\" color={Colors[theme].text}/>\r\n        </TouchableOpacity>\r\n      </View>\r\n      <View style={{flex:1}}>\r\n        <Text style={{fontSize:20, textAlign:'center'}}>{lang('Date & Time')}</Text>\r\n      </View>\r\n      <View style={{flex:1}}/>\r\n    </View>\r\n    <View style={{marginBottom: 20, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n    <Suspense fallback={<></>}>\r\n      <Calendar\r\n        locale={locale}\r\n        style={undefined} \r\n        setDate={setDate}\r\n        disableAllTouchEventsForDisabledDays={true}\r\n        onMonthChange={(v)=>setDisableDays(getDisableDays(dayjs(v.dateString)))}\r\n        markedDates={{\r\n          ...disableDays.reduce((p, c)=>{p[c]={disabled:true};return p}, {} as Record<string, any>),\r\n          ...(date?[date]:[]).reduce((p, c)=>{p[c]={selected:true};return p}, {} as Record<string, any>)\r\n        }}\r\n      />\r\n      <View style={{flexDirection:'row', paddingVertical:10, width:400, height:50}}>\r\n        <CommonPicker value={dayType} setValue={setDayType} values={dayTypes}/>\r\n        <Text style={{fontSize:20}}> </Text>\r\n        <CommonPicker value={hour} setValue={setHour} values={hours}/>\r\n        <Text style={{fontSize:20}}> : </Text>\r\n        <CommonPicker value={minute} setValue={setMinute} values={minutes}/>\r\n      </View>\r\n    </Suspense>\r\n    <View style={{flexDirection:'row'}}>\r\n      <CommonButton title={lang('save')} onPress={()=>{\r\n        callback?.(dayjs(`${date} ${hour}:${minute} ${dayType}`).toISOString())\r\n        back()\r\n      }}/>\r\n      <CommonButton title={lang('cancel')} onPress={()=>{\r\n        callback?.(undefined)\r\n        back()\r\n      }}/>\r\n      \r\n    </View>\r\n  </BottomSheet>\r\n}\r\n","import React from 'react';\r\nimport Clipboard from '@react-native-clipboard/clipboard/dist';\r\nimport CommonButton from '../components/CommonButton';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport { Text, View } from '../components/Themed';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport { BottomSheet } from '../components/ModalSection';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport Colors from '../constants/Colors';\r\nimport { Ionicons } from '../lib/@expo/vector-icons';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { useMessengerContentMutation } from '../hooks/lists/useMessengerContentList';\r\nimport useModalEffect from '../hooks/useModalEffect';\r\n\r\nexport default function MessageModal({id,  content, isOwner, isTimer}:{id:number, content:string, isOwner:boolean, isTimer:boolean}) {\r\n  const { lang } = useLangContext()\r\n  const { setModal } = useModalsContext()\r\n  const theme = useColorScheme()\r\n  const contentMutation = useMessengerContentMutation()\r\n  const back = ()=>{\r\n    setModal(MessageModal, null)\r\n  }\r\n  useModalEffect(back, [])\r\n  return <BottomSheet>\r\n    <View style={{flexDirection:'row', width:'100%'}}>\r\n      <View style={{flex:1, flexDirection:'row'}}>\r\n        <TouchableOpacity onPress={back}>\r\n          <Ionicons size={20} name=\"arrow-back\" color={Colors[theme].text}/>\r\n        </TouchableOpacity>\r\n      </View>\r\n      <View style={{flex:1}}>\r\n        <Text style={{fontSize:20, textAlign:'center'}}>{lang('Message')}</Text>\r\n      </View>\r\n      <View style={{flex:1}}/>\r\n    </View>\r\n    <View style={{marginBottom: 20, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n      <CommonButton style={{height:40, width:'100%', maxWidth:320, justifyContent:'center'}} title={lang('copy')} onPress={()=>{Clipboard.setString(content);back()}}/>\r\n      {isOwner && isTimer && <CommonButton style={{height:40, width:'100%', maxWidth:320, justifyContent:'center'}} textStyle={{color:'red'}} title={lang('delete timer')} onPress={()=>{contentMutation.patch({id, timer:null});back()}}/>}\r\n      {isOwner && <CommonButton style={{height:40, width:'100%', maxWidth:320, justifyContent:'center'}} textStyle={{color:'red'}} title={lang('delete')} onPress={()=>{contentMutation.delete(id);back()}}/>}\r\n  </BottomSheet>\r\n}\r\n","import React, { useEffect } from 'react';\r\nimport Profile from '../components/Profile';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport useUserMembershipList from '../hooks/lists/useUserMembershipList';\r\nimport { useMessengerChannelMutation } from '../hooks/lists/useMessengerChannelList';\r\nimport CommonButton from '../components/CommonButton';\r\nimport { Channel } from '../types';\r\nimport { navigate } from '../navigation';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport { Text, View } from '../components/Themed';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport { Ionicons } from '../lib/@expo/vector-icons';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport Colors from '../constants/Colors';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { BottomSheet } from '../components/ModalSection';\r\nimport useModalEffect from '../hooks/useModalEffect';\r\n\r\nexport default function ProfileModal({id}:{id:number}) {\r\n  const { lang } = useLangContext()\r\n  const theme = useColorScheme()\r\n  const {auth} = useAuthContext()\r\n  const { setModal } = useModalsContext()\r\n  const userList = useUserMembershipList(auth)\r\n  const user = userList?.find(v=>v.id==id)\r\n  const isSelf = auth.user && user && (auth.user?.id==user?.id)\r\n  const channelMutation = useMessengerChannelMutation()\r\n  const back = ()=>{\r\n    setModal(ProfileModal, null)\r\n  }\r\n  useEffect(()=>{\r\n    if (!(id && user) && userList)\r\n      back()\r\n  }, [userList])\r\n  useModalEffect(back, [])\r\n  return user?<BottomSheet>\r\n    <View style={{flexDirection:'row', width:'100%'}}>\r\n      <View style={{flex:1, flexDirection:'row'}}>\r\n        <TouchableOpacity onPress={back}>\r\n          <Ionicons size={20} name=\"arrow-back\" color={Colors[theme].text}/>\r\n        </TouchableOpacity>\r\n      </View>\r\n      <View style={{flex:1}}>\r\n        <Text style={{fontSize:20, textAlign:'center'}}>{lang('profile')}</Text>\r\n      </View>\r\n      <View style={{flex:1}}/>\r\n    </View>\r\n    <View style={{marginBottom: 20, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n    \r\n    <Profile username={user.username} name={user.name} userId={user.id} />\r\n    <CommonButton title={lang(isSelf?'Chat with me':'1:1 Chat')} onPress={()=>{\r\n      if(auth?.user?.id && auth.groupId){\r\n        const newChannel:Channel = {name:\"\", type:'messenger', owner:auth?.user?.id, group:auth.groupId, subowner:isSelf?undefined:user.id};\r\n        channelMutation.direct(newChannel).then(v=>navigate(\"Main\", {screen:\"ChatScreen\", params: {id:v.id}}))\r\n      }\r\n    }}/>\r\n  </BottomSheet>:<></>\r\n}\r\n","import React from 'react';\r\nimport {View} from 'react-native'\r\nimport {Text} from './Themed';\r\nimport { ProfileProps } from '../types';\r\nimport Avatar from './Avatar';\r\nimport TextButton from './TextButton';\r\nimport CommonTextInput from './CommonTextInput';\r\nimport { patchUser } from '../apis';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\n\r\nexport default (props:ProfileProps)=>{\r\n    const [name, setName] = React.useState<string>()\r\n    const { auth, dispatch } = useAuthContext()\r\n    const isSelf = auth.user?.id == props.userId\r\n    const onChange = ()=>{\r\n        isSelf && patchUser({id:props.userId, name:name || ''}).finally(()=>{\r\n            setName(undefined)\r\n            dispatch({type:\"REFRESH\"})\r\n        })\r\n    }\r\n    return <View style={{width:'100%', height:135, justifyContent:'space-evenly', alignItems:'center'}}>\r\n        <Avatar {...props} size={75}/>\r\n        {name===undefined?\r\n            <TextButton textStyle={{fontWeight:'bold', fontSize:15}} onPress={()=>isSelf && setName(props.name)} title={props.name} disabled={!isSelf}/>:\r\n            <CommonTextInput value={name} style={{textAlign:'center'}} setValue={setName} onBlur={onChange} onEndEditing={onChange} />}\r\n        <Text style={{fontWeight:'normal', fontSize:14}}>{props.username}</Text>\r\n    </View>\r\n}","import React, { useState,  useEffect, createContext, useMemo, useRef, useContext } from \"react\"\r\nimport firebase from \"firebase/app\";\r\nimport \"firebase/messaging\";\r\nimport {FCM_PUBLIC_VAPID_KEY, FCM_API_KEY} from \"../constants/Envs\"\r\nimport { Notification as NotificationType, UserMembership } from \"../types\";\r\nimport { getNotification, postNotification, putNotification } from \"../apis/notification\";\r\n\r\nconst firebaseConfig = require(\"../../web/firebase-config.js\")\r\n// Initialize Firebase\r\nconst key = firebaseConfig.messagingSenderId\r\nconst apiKeyEncrypted = (FCM_API_KEY as string).split('').map((v, i)=> (v.charCodeAt(0) ^ key.charCodeAt(i)).toString(16).padStart(2, '0')).join('')\r\nconst app = firebase.initializeApp({...firebaseConfig, apiKey:FCM_API_KEY});\r\n// const analytics = getAnalytics(app);\r\nconst messaging = firebase.messaging(app);\r\n\r\nmessaging.onMessage((payload) => {\r\n  if (!(\"Notification\" in window)) {\r\n    alert(\"This browser does not support desktop notification\");\r\n  }\r\n  else if (Notification.permission === \"granted\") {\r\n    const message_set = JSON.parse(payload.data['message_set'])[0]\r\n    new Notification(payload.data.channel_name, { body: `${payload.data.name}: ${message_set.content}` });\r\n  }\r\n});\r\n\r\nconst requestToken = async()=>{\r\n  const permission = await Notification.requestPermission();\r\n  if (permission === 'granted') {\r\n    const serviceWorkerRegistration = await navigator.serviceWorker.register(`${process.env.PUBLIC_URL}/firebase-messaging-sw.js?${apiKeyEncrypted}`)\r\n    console.log('[SW]: SCOPE: ', serviceWorkerRegistration.scope);\r\n    const currentToken = await messaging.getToken({serviceWorkerRegistration, vapidKey: FCM_PUBLIC_VAPID_KEY }).catch(\r\n      async()=>await messaging.getToken({serviceWorkerRegistration, vapidKey: FCM_PUBLIC_VAPID_KEY })\r\n    )\r\n    window.addEventListener('beforeunload', (event:any) => {\r\n      event.preventDefault();\r\n      serviceWorkerRegistration.unregister()\r\n    });\r\n    if (currentToken)\r\n      return currentToken\r\n  }\r\n  return null\r\n}\r\n\r\nconst FirebaseContext = createContext<{enable?:boolean, setEnable:(enable:boolean)=>void}>({setEnable:()=>{}});\r\n\r\nexport const FirebaseProvider = ({user, children}:{user?:UserMembership|null, children:React.ReactNode})=>{\r\n  const tokenRef = useRef<string|null>()\r\n  const [notification, setNotification] = useState<NotificationType>()\r\n  const enable = useMemo(()=>notification==undefined?undefined:(notification.token?true:false), [notification])\r\n  const setEnable = (enable:boolean)=>{\r\n    if(user && notification){\r\n      putNotification({...notification, token:enable?(tokenRef.current==undefined?null:tokenRef.current):null}).then((noti)=>{\r\n        setNotification(noti)\r\n      })\r\n    }\r\n  }\r\n  useEffect(()=>{\r\n    let isMount = true;\r\n    if(user){\r\n      requestToken().then((t)=>{\r\n        tokenRef.current = t\r\n        if (notification){\r\n          putNotification({...notification, token:tokenRef.current}).then((noti)=>{\r\n            if(isMount)setNotification(noti)\r\n          })\r\n        }\r\n      });\r\n      (async ()=>{\r\n        let noti = await getNotification(user.id)\r\n        if(noti==undefined){\r\n          noti = await postNotification({user:user.id, type:'WEB', token:null})\r\n        }\r\n        else if (noti.token && tokenRef.current){\r\n          noti = await putNotification({...noti, token:tokenRef.current})\r\n        }\r\n        if(isMount)setNotification(noti)\r\n      })()\r\n    }\r\n    return ()=>{isMount=false}\r\n  }, [user])\r\n  return enable!=undefined?\r\n  <FirebaseContext.Provider value={{enable, setEnable}}>\r\n    {children}\r\n  </FirebaseContext.Provider>:\r\n  <></>\r\n}\r\n\r\nexport default ()=>{\r\n  const {enable, setEnable} = useContext(FirebaseContext)\r\n  return {enable, setEnable}\r\n}\r\n","import React from 'react'\r\nimport { View, StyleSheet, Linking, Platform } from 'react-native'\r\nimport { TouchableOpacity } from 'react-native-gesture-handler'\r\nimport { AntDesign } from '../lib/@expo/vector-icons'; \r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport Colors from '../constants/Colors';\r\n\r\nconst openURL = Platform.OS=='web'?(url:string)=>{location.href=url}:Linking.openURL\r\n\r\nexport default (props:{theme:'light'|'dark'})=>{\r\n    return<View style={Styles.footer_buttons}>\r\n        <TouchableOpacity style={Styles.footer_button} onPress={()=>openURL(\"https://github.com/blacktokki/tokki-tok\")}>\r\n            <AntDesign name=\"github\" size={24} color={Colors[props.theme].iconColor} />\r\n        </TouchableOpacity>\r\n        <TouchableOpacity style={Styles.footer_button} onPress={()=>Linking.openURL(\"mailto:ydh051541@naver.com\")}>\r\n            <AntDesign name=\"mail\" size={24} color={Colors[props.theme].iconColor} />\r\n        </TouchableOpacity>\r\n    </View>\r\n}\r\n\r\nconst Styles = StyleSheet.create({\r\n      footer_buttons: {\r\n        width: '100%',\r\n        flexDirection: 'row',\r\n        justifyContent: 'flex-end',\r\n        paddingBottom: 20,\r\n        paddingRight: 20,\r\n      },\r\n      footer_button: {\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        width: 38,\r\n        height: 38,\r\n        marginHorizontal: 12,\r\n        borderWidth: 1,\r\n        borderColor: '#E7E7E7',\r\n        borderRadius: 60,\r\n      },\r\n})","import React, {useLayoutEffect, useState} from 'react';\r\nimport {\r\n  Text,\r\n  TextInput,\r\n  TouchableOpacity,\r\n  View,\r\n  StyleSheet,\r\n} from 'react-native';\r\nimport { StackScreenProps } from '@react-navigation/stack';\r\nimport useAuthContext from '../../hooks/useAuthContext';\r\nimport useLangContext from '../../hooks/useLangContext';\r\nimport ContractFooter from '../../components/ContractFooter';\r\n\r\nexport default function LoginScreen({\r\n  navigation, route\r\n}: StackScreenProps<any, 'Login'>) {\r\n  const { lang } = useLangContext()\r\n  const [username, setUsername] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const {error, dispatch} = useAuthContext()\r\n  const _login = ()=>dispatch({type:'LOGIN_REQUEST', username, password})\r\n  useLayoutEffect(() => {\r\n    navigation.setOptions({\r\n      headerRight: undefined\r\n    });\r\n  }, [navigation, route]);\r\n\r\n  return (<View style={Styles.login_container}>\r\n    <View style={Styles.login_wrapper}>\r\n      <View style={Styles.form}>\r\n        {error && <View style={Styles.form_error}>\r\n          <Text style={Styles.form_error_text}>{lang(error)}</Text>\r\n        </View>}\r\n        <TextInput\r\n          style={Styles.form_input}\r\n          value={username}\r\n          placeholder={lang('Username')}\r\n          onChangeText={(text) => setUsername(text)}\r\n          autoCapitalize={'none'}\r\n          keyboardType={'email-address'}\r\n          onSubmitEditing={_login}\r\n        />\r\n        <TextInput\r\n          style={Styles.form_input}\r\n          value={password}\r\n          placeholder={lang('Password')}\r\n          secureTextEntry\r\n          onChangeText={(text) => setPassword(text)}\r\n          onSubmitEditing={_login}\r\n        />\r\n        <TouchableOpacity onPress={_login}>\r\n          <View style={Styles.button}>\r\n            <Text style={Styles.button_label}>{lang('Sign in')}</Text>\r\n          </View>\r\n        </TouchableOpacity>\r\n        <TouchableOpacity onPress={() => dispatch({type:\"LOGIN_GUEST\"})}>\r\n          <Text style={Styles.guest_footer_text}>\r\n            {lang(\"Sign in as guest\")}\r\n          </Text>\r\n        </TouchableOpacity>\r\n      </View>\r\n      <View style={Styles.login_social}>\r\n        <View style={Styles.login_social_separator}>\r\n          <View style={Styles.login_social_separator_line} />\r\n          <Text style={Styles.login_social_separator_text}>{'*'}</Text>\r\n          <View style={Styles.login_social_separator_line} />\r\n        </View>\r\n        <View style={Styles.login_social_buttons}>\r\n        </View>\r\n      </View>\r\n      {/* <>\r\n        <TouchableOpacity onPress={() => navigate(\"RegistrationScreen\")}>\r\n          <Text style={Styles.login_footer_text}>\r\n            {\"Don't have an account? \"}\r\n            <Text style={Styles.login_footer_link}>{'Sign up'}</Text>\r\n          </Text>\r\n        </TouchableOpacity>\r\n      </> */}\r\n    </View>\r\n    <ContractFooter theme='light'/>\r\n  </View>);\r\n};\r\n\r\nconst Styles = StyleSheet.create({\r\n    login_container: {\r\n      flex: 1,\r\n      backgroundColor: '#FFF',\r\n    },\r\n    login_header: {\r\n      alignItems: 'center',\r\n      paddingTop: 30,\r\n      paddingBottom: 50,\r\n      backgroundColor: '#208AEC',\r\n    },\r\n    login_header_logo: {\r\n      width: 220,\r\n      resizeMode: 'contain',\r\n    },\r\n    login_header_text: {\r\n      marginTop: 15,\r\n      color: '#f0f0f0',\r\n      fontSize: 16,\r\n    },\r\n    login_header_text_bold: {\r\n      color: '#fff',\r\n      fontWeight: 'bold',\r\n    },\r\n    login_wrapper: {\r\n      flex: 1,\r\n      justifyContent: 'space-between',\r\n      paddingTop: 40,\r\n      borderTopRightRadius: 12,\r\n      borderTopLeftRadius: 12,\r\n      backgroundColor: '#fff',\r\n      alignItems: 'center',\r\n    },\r\n    form: {\r\n      width: '100%',\r\n      maxWidth: 320,\r\n    },\r\n    form_error: {\r\n      height: 22,\r\n      width:'100%',\r\n    },\r\n    form_error_text:{\r\n      textAlignVertical:'center',\r\n      color:'red',\r\n      fontSize:13,\r\n    },\r\n    form_input: {\r\n      height: 44,\r\n      paddingHorizontal: 20,\r\n      marginBottom: 20,\r\n      backgroundColor: '#EDF0F7',\r\n      borderRadius: 50,\r\n    },\r\n    button: {\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      height: 44,\r\n      backgroundColor: '#0065A4',\r\n      borderRadius: 50,\r\n    },\r\n    button_label: {\r\n      color: '#fff',\r\n      fontSize: 16,\r\n    },\r\n    login_social: {\r\n      width: '100%',\r\n      maxWidth: 280,\r\n      marginTop: 20,\r\n    },\r\n    login_social_separator: {\r\n      flexDirection: 'row',\r\n      alignItems: 'center',\r\n    },\r\n    login_social_separator_line: {\r\n      flex: 1,\r\n      width: '100%',\r\n      height: 1,\r\n      backgroundColor: '#E0E0E0',\r\n    },\r\n    login_social_separator_text: {\r\n      marginHorizontal: 10,\r\n      color: '#808080',\r\n      fontSize: 16,\r\n    },\r\n    login_social_buttons: {\r\n      flexDirection: 'row',\r\n      justifyContent: 'center',\r\n      marginTop: 20,\r\n    },\r\n    login_social_button: {\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      width: 60,\r\n      height: 60,\r\n      marginHorizontal: 12,\r\n      borderWidth: 1,\r\n      borderColor: '#E7E7E7',\r\n      borderRadius: 60,\r\n    },\r\n    login_social_icon: {\r\n      width: 38,\r\n      height: 38,\r\n      resizeMode: 'contain',\r\n    },\r\n    login_social_facebook: {\r\n      backgroundColor: '#4267B2',\r\n      borderColor: '#4267B2',\r\n    },\r\n    login_footer_text: {\r\n      flexDirection: 'row',\r\n      alignItems: 'center',\r\n      color: '#808080',\r\n      fontSize: 14,\r\n    },\r\n    guest_footer_text: {\r\n      flexDirection: 'row',\r\n      alignSelf: 'center',\r\n      color: '#808080',\r\n      fontSize: 15,\r\n      margin: 15\r\n    },\r\n    login_footer_link: {\r\n      color: '#208AEC',\r\n      fontSize: 15,\r\n      fontWeight: 'bold',\r\n    },\r\n  });\r\n  ","import React from 'react'\r\nimport { Image, Linking } from \"react-native\"\r\nimport { TouchableOpacity } from \"react-native-gesture-handler\"\r\nimport CommonSection from \"./CommonSection\"\r\nimport { View, Text } from \"./Themed\"\r\nimport { Link } from \"../types\"\r\n\r\n\r\n\r\nexport default ({link, isMobile}:{link:Link, isMobile:boolean})=>{\r\n    return <CommonSection containerStyle={{marginHorizontal:0}} bodyStyle={{padding:0}}>\r\n    <TouchableOpacity \r\n        onPress={()=>Linking.openURL(link.url)}\r\n        onLongPress={()=>{}}\r\n        style={{width:'100%', flexDirection:'row'}}\r\n    >\r\n        {link.image && <Image source={{uri:link.image}} resizeMode=\"cover\" style={{ width:'100%', maxWidth:isMobile?120:150, maxHeight:isMobile?120:150, borderWidth:1}}/>}\r\n        <View style={{flex:1, marginHorizontal:20}}>\r\n        <Text style={{fontSize:18}}>{link.title}</Text>\r\n        <Text style={{fontSize:14}}>{link.description}</Text>\r\n        <Text style={{fontSize:12}}>{link.url}</Text>\r\n        </View>\r\n    </TouchableOpacity>\r\n    </CommonSection>\r\n}","import React, { createContext, useContext } from \"react\"\r\nimport { SendJsonMessage } from \"react-use-websocket/dist/lib/types\";\r\nimport { WebSocketInternalProvider } from \"../../hooks/useWebsocketContext\";\r\n\r\nconst WebSocketContext = createContext<{lastJsonMessage:any, sendJsonMessage:SendJsonMessage }>({lastJsonMessage:undefined, sendJsonMessage:()=>{}});\r\n\r\nexport const WebSocketProvider = ({disable, children}:{disable?:boolean, children:React.ReactNode})=>{\r\n  return disable?<></>:<WebSocketInternalProvider path={'messenger/ws/rtc/'} Context={WebSocketContext} useBackground>\r\n    {children}\r\n  </WebSocketInternalProvider>\r\n}\r\n\r\nexport default ()=>{\r\n  const webSocketContext = useContext(WebSocketContext)\r\n  return webSocketContext\r\n}\r\n\r\n","import React, { useCallback, useRef, useState, useMemo } from \"react\";\r\n//@ts-ignore\r\nimport { RTCView, mediaDevices, RTCPeerConnection, MediaStream, RTCSessionDescription, RTCIceCandidate } from \"react-native-webrtc-web-shim\";\r\nimport {TURN_SERVER} from \"../../../constants/Envs\"\r\n\r\n\r\nconsole.log(TURN_SERVER?\"use turn server\": \"use stun server\")\r\n\r\nexport const peerConstraints = {\r\n\ticeServers: [TURN_SERVER?JSON.parse(TURN_SERVER):{urls: 'stun:stun.l.google.com:19302'}]\r\n};\r\n\r\nexport const sessionConstraints = {\r\n\tmandatory: {\r\n\t\tOfferToReceiveAudio: true,\r\n\t\tOfferToReceiveVideo: true,\r\n\t\tVoiceActivityDetection: true\r\n\t}\r\n};\r\n\r\nconst mediaConstraints = {audio:true, video:{framerate:30}}\r\n\r\n//@ts-ignore\r\nexport {MediaStream, RTCPeerConnection, RTCSessionDescription} from \"react-native-webrtc-web-shim\";\r\n\r\nconst onICEcandidate = (pc:typeof RTCPeerConnection, message:any)=>{\r\n\tconst _message = message.data.rtcMessage\r\n\t\tconst candidate = new RTCIceCandidate(_message);\r\n\t\tif (pc) {\r\n\t\t\tconsole.log(\"ICE candidate Added\");\r\n\t\t\tpc.addIceCandidate(candidate);\r\n\t\t}\r\n}\r\n\r\nconst sendICEcandidate = (event:any, sendMessage:(data:any)=>void, receiver:string, target:string) => {\r\n\t// When you find a null candidate then there are no more candidates.\r\n\t// Gathering of candidates has finished.\r\n\tif ( !event.candidate ) { return; };\r\n\t// Send the event.candidate onto the person you're calling.\r\n\t// Keeping to Trickle ICE Standards, you should send the candidates immediately.\r\n\tsendMessage({type:'ICEcandidate', receiver, data:{target, rtcMessage:event.candidate}})\r\n  }\r\n\r\nconst BAND_WIDTH = 8000\r\n\r\nconst optimizeSdp = (offerDescription:RTCSessionDescription)=>{\r\n\tvar arr = offerDescription.sdp.split('\\r\\n');\r\n\tarr.forEach((str:string, i:number) => {\r\n\t\tif (/^a=fmtp:\\d*/.test(str)) {\r\n\t\t\tarr[i] = str + `;x-google-max-bitrate=${BAND_WIDTH};x-google-min-bitrate=${BAND_WIDTH};x-google-start-bitrate=${BAND_WIDTH}`;\r\n\t\t} else if (/^a=mid:(0|video)/.test(str)) { // if with audio then 0=>1\r\n\t\t\tarr[i] += `\\r\\nb=AS:${BAND_WIDTH}`;\r\n\t\t}\r\n\t});\r\n  \treturn new RTCSessionDescription({\r\n    \ttype: offerDescription.type,\r\n    \tsdp: arr.join('\\r\\n'),\r\n  \t})\r\n}\r\n\r\nconst createOffer = async(pcRefCurrent:{pc?:typeof RTCPeerConnection, receiver:string}, sendMessage:(data:any)=>void, stream:typeof MediaStream, target:string, user?:{name:string})=>{\r\n\tstream && pcRefCurrent.pc.addStream( stream );\r\n\tconst offerDescription = optimizeSdp((await pcRefCurrent.pc.createOffer( sessionConstraints )));\r\n\tawait pcRefCurrent.pc.setLocalDescription( offerDescription );\r\n\tsendMessage({type:'call', receiver:pcRefCurrent.receiver, data:{target, name:user?.name, rtcMessage:offerDescription}})\r\n}\r\n\r\nexport const useLocalCam = (sendMessage:(data:any)=>void)=>{\r\n\tconst pcRef = useRef<Record<number,{pc:typeof RTCPeerConnection, receiver:string}>>({})\r\n\tconst [sender, setSender] = useState<string>()\r\n\tconst [_stream, setStream] = useState<MediaStream>()\r\n\tconst isPlay = useMemo(()=>_stream?true:false, [_stream])\r\n\tconst CustomRTCView = useCallback(React.memo(({style}:{style:any})=>(_stream?<RTCView stream={_stream} style={style} videoProps={{height:'100%'}} />:<></>)) , [_stream])\r\n\tconst start = useCallback(async(user:{name:string}, stream?:typeof MediaStream, mode?:'camera'|'display')=>{\r\n\t\tconsole.log(\"start\");\r\n\t\tif (!_stream || mode!==undefined) {\r\n\t\t\ttry {\r\n\t\t\t\tlet newStream:typeof MediaStream;\r\n\t\t\t\tif(mode == 'camera'){\r\n\t\t\t\t\tnewStream = await mediaDevices.getUserMedia(mediaConstraints)\r\n\t\t\t\t}\r\n\t\t\t\telse if (mode == 'display'){\r\n\t\t\t\t\tnewStream = await mediaDevices.getDisplayMedia(mediaConstraints)\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tnewStream = stream || await mediaDevices.getUserMedia(mediaConstraints).catch((e:any)=>mediaDevices.getDisplayMedia(mediaConstraints));\r\n\t\t\t\t}\r\n\t\t\t\tsetStream(newStream)\r\n\t\t\t\tObject.entries(pcRef.current).map(([k, v])=>{\r\n\t\t\t\t\tcreateOffer(v, sendMessage, newStream, 'guest', user)\r\n\t\t\t\t})\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.error(e);\r\n\t\t\t}\r\n\t\t}\r\n\t}, [_stream])\r\n\tconst stop = useCallback(()=>{\r\n\t\tconsole.log(\"stop\");\r\n\t\tif(_stream){\r\n\t\t\t_stream.getTracks().map((track:any) => track.stop());\r\n\t\t\tsetStream(undefined)\r\n\t\t}\r\n\t}, [_stream])\r\n\treturn {\r\n\t\tstart,\r\n\t\tstop,\r\n\t\twebsocketOnMessage: async(response:any, user:{name:string})=>{\r\n\t\t\tlet type = response.type;\r\n\t\t\tif (type == 'connection'){\r\n\t\t\t\tsetSender(response.data.channel_name)\r\n\t\t\t}\r\n\t\t\tif (type == 'start' && response.data.target=='host'){\r\n\t\t\t  console.log('1 start')\r\n\t\t\t  const peerConnection = new RTCPeerConnection( peerConstraints );\r\n\t\t\t  peerConnection.addEventListener( 'icecandidate', (event:any) => sendICEcandidate(event, sendMessage, response.sender, 'guest'));\r\n\t\t\t  pcRef.current[response.sender] = {pc:peerConnection, receiver: response.sender}\r\n\t\t\t  createOffer(pcRef.current[response.sender], sendMessage, _stream, 'guest', user)\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (type == \"answer\" && response.data.target == 'host'){\r\n\t\t\t  console.log('3 answer')\r\n\t\t\t  const peerConnection = pcRef.current[response.sender].pc\r\n\t\t\t  const answerDescription = new RTCSessionDescription(response.data.rtcMessage);\r\n\t\t\t  await peerConnection.setRemoteDescription( answerDescription );\r\n\t\t\t  // const streams = pcRef.current.pc.getRemoteStreams()\r\n\t\t\t  // setMirrorStream(streams[streams.length - 1])\r\n\t\t\t}\r\n\t\t\tif (type == \"ICEcandidate\" && response.data.target=='host'){\r\n\t\t\t\tconst peerConnection = pcRef.current[response.sender].pc\r\n\t\t\t\tonICEcandidate(peerConnection, response)\r\n\t\t\t}\r\n\t\t},\r\n\t\tCustomRTCView,\r\n\t\tisPlay,\r\n\t\tsender,\r\n\t\t// renderMirrorView,\r\n\t}\r\n}\r\n\r\nexport const useRemoteCam = (sendMessage:(data:any)=>void)=>{\r\n\tconst pcRef = useRef<{pc?:RTCPeerConnection, receiver?:string, statsInterval?:any}>({})\r\n\tconst [user, setUser] = useState<{name:string}>()\r\n\tconst [_stream, setStream] = useState<MediaStream>()\r\n\tconst CustomRTCView = useCallback(React.memo((style:any)=>_stream?<RTCView stream={_stream} style={style} videoProps={{height:'100%'}} />:<></>), [_stream])\r\n\tconst isPlay = useMemo(()=>_stream?true:false, [_stream])\r\n\tconst start = useCallback((receiver:string)=>{\r\n\t\tconsole.log(\"start\");\r\n\t\tif (!pcRef.current.pc) {\r\n\t\t  pcRef.current.pc = new RTCPeerConnection( peerConstraints );\r\n\t\t  pcRef.current.receiver = receiver\r\n\t\t}\r\n\t\tif (!_stream){\r\n\t\t\tsendMessage({type:'start', receiver, data:{'target': 'host'}})\r\n\t\t}\r\n\t}, [_stream])\r\n\tconst stop = () => {\r\n\t\tconsole.log(\"stop\");\r\n\t\tif (pcRef.current.pc) {\r\n\t\t  // peerConnection._unregisterEvents();\r\n\t\t  setStream(undefined)\r\n\t\t  pcRef.current.pc.close();\r\n\t\t  pcRef.current.pc = undefined\r\n\t\t  pcRef.current.receiver = undefined\r\n\t\t  clearInterval(pcRef.current.statsInterval)\r\n\t\t}\r\n\t}\r\n\treturn {\r\n\t\tstart,\r\n\t\tstop,\r\n\t\twebsocketOnMessage: async(response:any)=>{\r\n\t\t\tlet type = response.type;\r\n\t\t\tif (type == 'start' && response.data.target=='guest' && response.sender == pcRef.current?.receiver){\r\n\t\t\t\tconsole.log('(remote)1 start')\r\n\t\t\t\tconst peerConnection = pcRef.current.pc\r\n\t\t\t\tsetUser({name: response.data.name})\r\n\t\t\t\tpeerConnection.addEventListener('icecandidate', (event:any) => sendICEcandidate(event, sendMessage, response.sender, 'host'));\r\n\t\t\t\tpeerConnection.addEventListener('iceconnectionstatechange', (e:any)=>{\r\n\t\t\t\t\tif (pcRef.current.pc.iceConnectionState == 'connected'){\r\n\t\t\t\t\t\tlet activeStream = false\r\n\t\t\t\t\t\tpcRef.current.statsInterval = setInterval(async()=>{\r\n\t\t\t\t\t\t\tconst stats = await pcRef.current.pc.getStats(null)\r\n\t\t\t\t\t\t\tlet statsOutput = \"\";\r\n\t\t\t\t\t\t\tlet framePerSecond = undefined\r\n\t\t\t\t\t\t\tstats.forEach((report:any) => {\r\n\t\t\t\t\t\t\t\tif (report.type === \"inbound-rtp\" && report.kind === \"video\") {\r\n\t\t\t\t\t\t\t\t\tObject.keys(report).forEach((statName) => {\r\n\t\t\t\t\t\t\t\t\t\tstatsOutput += `${statName}: ${report[statName]}\\n`;\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\tframePerSecond = report.framesPerSecond\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tconsole.log(activeStream, framePerSecond)\r\n\t\t\t\t\t\t\tif (framePerSecond != undefined){\r\n\t\t\t\t\t\t\t\tactiveStream = true\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (activeStream){\r\n\t\t\t\t\t\t\t\tstop()\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tconsole.log(new Date().toTimeString().split(' ')[0], statsOutput)\r\n\t\t\t\t\t\t}, 1000);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (pcRef.current.pc.iceConnectionState == 'failed'){\r\n\t\t\t\t\t\tstop()\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t// peerConnection.addTransceiver('audio', {\r\n\t\t\t\t// \tdirection: 'recvonly'\r\n\t\t\t\t// });\r\n\t\t\t\tpeerConnection.addTransceiver('video', {\r\n\t\t\t\t\tdirection: 'recvonly'\r\n\t\t\t\t});\r\n\t\t\t\tawait createOffer({pc:pcRef.current.pc, receiver:response.sender}, sendMessage, _stream, 'host', user)\r\n\t\t\t}  \r\n\t\t\tif (type == \"answer\" && response.data.target=='guest' && response.sender == pcRef.current?.receiver){\r\n\t\t\t\tconsole.log('(remote)3 answer')\r\n\t\t\t\tconst answerDescription = new RTCSessionDescription(response.data.rtcMessage);\r\n\t\t\t\tawait pcRef.current.pc.setRemoteDescription( answerDescription );\r\n\t\t\t\tconst streams = pcRef.current.pc.getRemoteStreams()\r\n\t\t\t\tsetStream(streams[streams.length - 1])\r\n\t\t\t\tsendMessage({type:'end', receiver:pcRef.current.receiver, data:{}})\r\n\t\t\t}\r\n\t\t\tif (type == \"call\" && response.sender == pcRef.current?.receiver){\r\n\t\t\t  console.log('2 call')\r\n\t\t\t  const peerConnection = pcRef.current.pc\r\n\t\t\t  setUser({name:response.data.name})\r\n\t\t\t  if (!peerConnection)\r\n\t\t\t\treturn\r\n\t\t\t  peerConnection.addEventListener( 'icecandidate', (event:any) => sendICEcandidate(event, sendMessage, response.sender, 'host'));\r\n\t\t\t  const offerDescription = new RTCSessionDescription(response.data.rtcMessage);\r\n\t\t\t  await peerConnection.setRemoteDescription( offerDescription );\r\n\t\t\t  const answerDescription = await peerConnection.createAnswer( sessionConstraints );\r\n\t\t\t  await peerConnection.setLocalDescription( answerDescription );\r\n\t\t\t  sendMessage({type:'answer', receiver:pcRef.current.receiver, data:{target:'host', rtcMessage:peerConnection.localDescription}})\r\n\t\t\t  // Here is a good place to process candidates.\r\n\t\t\t  const streams = pcRef.current.pc.getRemoteStreams()\r\n\t\t\t  setStream(streams[streams.length - 1])\r\n\t\t\t}\r\n\t\t\tif (type == \"ICEcandidate\" && response.data.target=='guest' && response.sender == pcRef.current?.receiver)\r\n\t\t\t  onICEcandidate(pcRef.current.pc, response)\r\n\t\t},\r\n\t\tCustomRTCView,\r\n\t\tuser,\r\n\t\tisPlay\r\n\t}\r\n}","import {StyleSheet} from \"react-native\";\r\nexport {useLocalCam, useRemoteCam} from \"./p2p\"\r\n\r\nexport const camStyle = StyleSheet.create({\r\n\tcontainer:{ flex: 1},\r\n\tcam:{ flex: 1, height:'100%'},\r\n\tbottonContainer: {position:\"absolute\", bottom:0, justifyContent:'flex-end'},\r\n\tbuttonBar: { flexDirection: \"row\", justifyContent: \"space-around\" },\r\n\tlabel: {backgroundColor:'#0008', color:'white', paddingHorizontal:5},\r\n})","import React, { useEffect } from \"react\";\r\nimport {Button, View, Text} from \"react-native\";\r\nimport useWebsocketContext from \"./useWebsocketContext\";\r\nimport { useLocalCam, camStyle} from \"./webrtc\";\r\n\r\n\r\nexport default (props:{user?:{name:string}|null, mode?:'camera'|'display'|null})=>{\r\n  const {lastJsonMessage, sendJsonMessage} = useWebsocketContext()\r\n  const {start, stop, websocketOnMessage, CustomRTCView, isPlay} = useLocalCam(sendJsonMessage)\r\n  useEffect(()=>{\r\n    props.user && lastJsonMessage && websocketOnMessage(lastJsonMessage, props.user)\r\n  }, [lastJsonMessage, props.user])\r\n  useEffect(()=>{\r\n    if(props.mode && !isPlay){\r\n      props.user && start(props.user, undefined, props.mode)\r\n    }\r\n    else if(props.mode===null && isPlay){\r\n      stop()\r\n    }\r\n    return ()=>{isPlay && stop()}\r\n  }, [isPlay, props.user, props.mode])\r\n  return (\r\n    <View style={camStyle.container}>\r\n      <CustomRTCView style={camStyle.cam}/>\r\n      <View style={camStyle.bottonContainer}>\r\n        <View style={camStyle.buttonBar}>  \r\n        </View>\r\n        <View style={{flexDirection:'row'}}><Text style={camStyle.label}>{props.user?.name}</Text></View>\r\n        <View style={camStyle.buttonBar}>\r\n          {props.mode === undefined && !isPlay && <Button title=\"Start\" onPress={()=>props.user && start(props.user)} />}\r\n          {props.mode === undefined && isPlay && <Button title=\"Stop\" onPress={stop} />}\r\n        </View>\r\n      </View>\r\n    </View>\r\n  );\r\n}\r\n","import React, { useState, useEffect, } from \"react\";\r\nimport {Button,Text, TextInput, View} from \"react-native\";\r\nimport useWebsocketContext from \"./useWebsocketContext\";\r\nimport { useRemoteCam, camStyle} from \"./webrtc\";\r\n\r\nexport default (props:{receiver?:string})=>{\r\n  const [receiver, setReceiver] = useState('')\r\n  const {lastJsonMessage, sendJsonMessage} = useWebsocketContext()\r\n  const {start, stop, websocketOnMessage, CustomRTCView, isPlay, user} = useRemoteCam(sendJsonMessage)\r\n  useEffect(()=>{\r\n    lastJsonMessage && websocketOnMessage(lastJsonMessage)\r\n  }, [lastJsonMessage])\r\n  useEffect(()=>{\r\n    if(props.receiver){\r\n      start(props.receiver)\r\n    }\r\n    return ()=>stop()\r\n  }, [props.receiver])\r\n  return (\r\n    <View style={camStyle.container}>\r\n      <CustomRTCView style={camStyle.cam}/>\r\n      <View style={camStyle.bottonContainer}>\r\n        <View style={camStyle.buttonBar}>\r\n        </View>\r\n        <View style={{flexDirection:'row'}}>{\r\n          (props.receiver || isPlay)?\r\n          <Text style={camStyle.label}>{user?.name || 'loading...'}</Text>:\r\n          <>\r\n            <Text style={{borderWidth:1}}>Receiver:&nbsp;</Text>\r\n            <TextInput style={{borderWidth:1, flex:1}} value={receiver} onChangeText={setReceiver}/>\r\n          </> \r\n        }</View>\r\n        <View style={camStyle.buttonBar}>\r\n          {props.receiver === undefined && !isPlay && <Button title=\"Start\" onPress={()=>start(receiver)} />}\r\n          {props.receiver === undefined && isPlay && <Button title=\"Stop\" onPress={stop} />}\r\n        </View>\r\n      </View>\r\n    </View>\r\n  );\r\n}\r\n\r\n","import React, {useEffect, useState} from 'react';\r\nimport { StyleSheet, View } from 'react-native';\r\nimport { View as ThemedView } from '../../../components/Themed' \r\nimport Colors from '../../../constants/Colors';\r\nimport {default as useRtcContext, WebSocketProvider as RtcProvider} from \"../../../lib/react-native-webrtc/useWebsocketContext\";\r\nimport LocalCam from '../../../lib/react-native-webrtc/LocalCam';\r\nimport RemoteCam from '../../../lib/react-native-webrtc/RemoteCam';\r\nimport useResizeContext from '../../../hooks/useResizeContext';\r\nimport useAuthContext from '../../../hooks/useAuthContext';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport CommonButton from '../../../components/CommonButton';\r\nimport { Ionicons } from '../../../lib/@expo/vector-icons';\r\nimport useIsMobile from '../../../hooks/useIsMobile';\r\n\r\ntype VideoType = 'camera'|'display'|null\r\ntype VideoCallProps = {channel_id:number, setDisable:(disable:boolean)=>void, disable?:boolean}\r\n\r\n\r\nconst VideoView = (props:{\r\n  scale:string,\r\n  focusGuest?:string,\r\n  setFocusGuest:(focusGuest?:string)=>void\r\n  receiver?:string\r\n  children:React.ReactNode\r\n})=>{\r\n  return <View style={[{maxWidth:props.scale, maxHeight:props.scale, borderWidth:1, borderColor:Colors.borderColor, backgroundColor:'gray', flexDirection:'row', flexGrow:1}, (props.focusGuest == undefined || props.focusGuest == props.receiver)?{height:'100%'}:{maxWidth:0, height:0}]}>\r\n    <TouchableOpacity style={{flex:1}} containerStyle={{flex:1, justifyContent:'center'}} onPress={()=>props.setFocusGuest(props.focusGuest?undefined:props.receiver)}>\r\n    {props.children}\r\n    </TouchableOpacity>\r\n  </View>\r\n    \r\n  \r\n}\r\n\r\nconst VideoCallContainer = ({channel_id, disable, setDisable}:VideoCallProps)=>{\r\n  const {auth} = useAuthContext()\r\n  const isMobile = useIsMobile()\r\n  const [videoMode, setVideoMode] = useState<VideoType>(null)\r\n  const [guests, setGuests] = useState<string[]>([])\r\n  const [focusGuest, setFocusGuest] = useState<string>()\r\n  const windowType = useResizeContext()\r\n  const { lastJsonMessage, sendJsonMessage } = useRtcContext()\r\n  useEffect(()=>{\r\n    if(lastJsonMessage !=null){\r\n      if(lastJsonMessage['type']=='connection'){\r\n        sendJsonMessage({'type':'broadcast', 'data':{'channel_id':channel_id}})\r\n      }\r\n      if(lastJsonMessage['type']=='broadcast_guest' || lastJsonMessage['type']=='broadcast_host'){\r\n        setGuests([...guests, lastJsonMessage['sender']])\r\n      }\r\n      if(lastJsonMessage['type']=='broadcast_disconnect'){\r\n        const channel_name = lastJsonMessage['sender']\r\n        const exist = guests.find(v=>v == channel_name)\r\n        exist && setGuests(guests.filter(v=>v != channel_name))\r\n      }\r\n    }\r\n  }, [lastJsonMessage])\r\n  const scale = focusGuest?'100%':`${100 / Math.max(2, Math.ceil(Math.sqrt(guests.length + 1)))}%`\r\n  const toggleVideoMode = (mode:VideoType)=>{\r\n    setVideoMode(videoMode!=mode?mode:null)\r\n  }\r\n  return lastJsonMessage !==undefined ?\r\n    <ThemedView style={[\r\n      {aspectRatio:!disable?16/9:0, borderColor:Colors.borderColor, borderRadius:10},\r\n      windowType=='landscape'?{flexShrink:1, flexGrow:0, height:'100%', borderLeftWidth:1, paddingBottom:65}:{maxHeight:'36%', width:'100%', borderBottomWidth:1}\r\n    ]}>\r\n      <View style={{aspectRatio:focusGuest?undefined:16/9, backgroundColor:'white', flexWrap:'wrap', flexDirection:'row', width:'100%', height:'100%'}}>\r\n        {guests.map((receiver, i)=><VideoView scale={scale} focusGuest={focusGuest} setFocusGuest={setFocusGuest} receiver={receiver}>\r\n          <RemoteCam receiver={receiver}/>\r\n        </VideoView>\r\n        )}\r\n        <VideoView scale={scale} focusGuest={focusGuest} setFocusGuest={setFocusGuest} receiver={auth.user?.name}>\r\n          <LocalCam user={auth.user} mode={videoMode}/>\r\n        </VideoView>\r\n      </View>\r\n      <ThemedView style={[\r\n          {position:'absolute', alignItems:'center', justifyContent:'flex-end', width:'100%',flexDirection:'row'},\r\n          windowType=='landscape'?{bottom:0, paddingTop:15, paddingBottom:10, paddingHorizontal:19}:{backgroundColor:'transparent'}\r\n        ]}>\r\n        <CommonButton title={''} style={{height:40, paddingTop:8}} onPress={()=>toggleVideoMode('camera')}/>\r\n        {!isMobile && <CommonButton title={''} style={{height:40, paddingTop:8}} onPress={()=>toggleVideoMode('display')}/>}\r\n        <CommonButton title={''} style={{height:40, paddingTop:8}} onPress={()=>setDisable(true)}>\r\n          <Ionicons size={20} name=\"arrow-back\" color={'deepskyblue'}/>\r\n        </CommonButton>\r\n      </ThemedView>\r\n    </ThemedView>:\r\n  <></>\r\n  }\r\n  \r\nexport default React.memo(({channel_id, disable, setDisable}:VideoCallProps)=>{\r\n  return <RtcProvider disable={disable}>\r\n    <VideoCallContainer channel_id={channel_id} disable={disable} setDisable={setDisable}/>\r\n  </RtcProvider>\r\n})\r\n","import React from 'react'\r\nimport { Linking, TextStyle } from \"react-native\"\r\nimport {TouchableOpacity} from \"react-native-gesture-handler\"\r\nimport CommonSection from \"./CommonSection\"\r\nimport { FontAwesome } from '../lib/@expo/vector-icons'; \r\nimport { View, Text } from \"./Themed\"\r\nimport { File } from \"../types\"\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport Colors from '../constants/Colors';\r\n\r\nfunction humanFileSize(size:number) {\r\n    var i = size == 0 ? 0 : Math.floor(Math.log(size) / Math.log(1024));\r\n    return (size / Math.pow(1024, i)).toFixed(2) + ' ' + ['B', 'kB', 'MB', 'GB', 'TB'][i];\r\n  }\r\n  \r\n\r\nexport default ({file, isMobile, showBorder}:{file:File, isMobile:boolean, showBorder:ConstrainBoolean})=>{\r\n    const theme = useColorScheme()\r\n    return <CommonSection containerStyle={{marginHorizontal:0}} bodyStyle={showBorder?{padding:10}:{borderWidth:0, padding:0}}>\r\n    <TouchableOpacity \r\n        onPress={()=>Linking.openURL(file.file)} \r\n        onLongPress={()=>{}}\r\n        style={{flexDirection:'row', alignItems:'flex-start', width:'100%'}} \r\n    >\r\n        <FontAwesome name=\"file-o\" size={20} color={Colors[theme].iconColor} />\r\n        <View style={{flex:1, marginHorizontal:10}}>\r\n            <Text style={{fontSize:18}}>{file.filename}</Text>\r\n            <Text style={{fontSize:14}}>{humanFileSize(file.filesize)}</Text>\r\n        </View>\r\n    </TouchableOpacity>\r\n    </CommonSection>\r\n}","import React, {useState, useEffect} from \"react\"\r\nimport dayjs from \"dayjs\";\r\nimport {View, TouchableOpacity} from 'react-native'\r\nimport { Text } from \"../../../components/Themed\";\r\nimport useTimerMessageContentList from \"../../../hooks/lists/useTimerMessageContent\";\r\nimport { MessengerContent } from \"../../../types\";\r\nimport Avatar from \"../../../components/Avatar\";\r\nimport Hyperlink from \"react-native-hyperlink\";\r\n\r\nexport function timerFormat(datetime:string){\r\n    return _timerFormat(dayjs(datetime), dayjs())\r\n}\r\n\r\nfunction _timerFormat(m:dayjs.Dayjs, now:dayjs.Dayjs){\r\n    if (m.year() != now.year()){\r\n        return m.format('YYYY.MM')\r\n    }\r\n    if(m.month()!= now.month() || m.day() != now.day()){\r\n        return m.format('MM.DD')\r\n    }\r\n    return m.format('HH:mm')\r\n  }\r\n\r\nexport function timerToString(timer:string){\r\n    return dayjs(timer).format('YYYY.MM.DD HH:mm')\r\n}\r\n\r\nconst TimerTag = (props:{data:MessengerContent, now:dayjs.Dayjs, isExpand:boolean, setExpand:(id?:number)=>void})=>{\r\n    const start = dayjs(props.data.created)\r\n    const end = dayjs(props.data.timer)\r\n    const ratio = (start.diff(props.now)/start.diff(end))\r\n    return <TouchableOpacity onPress={()=>props.setExpand(props.isExpand?undefined:props.data.id)}>\r\n        <View style={{backgroundColor:'lightgray', borderRadius:20, overflow:'hidden', margin:5}}>\r\n            <View style={{backgroundColor:'darkgray', position:'absolute', width:`${ratio*100}%`, height:'100%'}}/>\r\n            {props.isExpand?\r\n            <View style={{paddingVertical:5, paddingHorizontal:5, maxWidth:270}}>\r\n                <View style={{flexDirection:'row'}}>\r\n                    <Avatar name={props.data.name} userId={props.data.user} size={20}/>\r\n                    <View style={{paddingHorizontal:5}}><Text>{props.data.name}</Text></View>\r\n                </View>\r\n                <View style={{flexDirection:'row', alignItems:'stretch'}}>\r\n                    <Text></Text>\r\n                    <Text selectable>{timerToString(props.data.timer)}</Text>\r\n                </View>\r\n                {/* @ts-ignore */}\r\n                <Hyperlink linkDefault={ true } style={{wordBreak:\"break-word\"}} linkStyle={{color: '#12b886'}}>\r\n                    <Text selectable>{props.data.message_set[0].content}</Text>\r\n                </Hyperlink>\r\n            </View>:    \r\n            <View style={{paddingVertical:5, paddingHorizontal:5, flexDirection:'row'}}>\r\n                <Avatar name={props.data.name} userId={props.data.user} size={20}/>\r\n                <View style={{paddingHorizontal:5}}><Text>{_timerFormat(end, props.now)}</Text></View>\r\n            </View>}\r\n        </View>\r\n    </TouchableOpacity>\r\n}\r\n\r\n\r\nexport default (props:{channel_id:number})=>{\r\n    const timerMessages = useTimerMessageContentList(props.channel_id)\r\n    const [now, setNow] = useState(dayjs())\r\n    const [expand, setExpand] = useState<number>()\r\n    useEffect(()=>{\r\n        const timeout = setTimeout(()=>{\r\n            setNow(dayjs())\r\n        }, 2000)\r\n        return ()=>clearTimeout(timeout)\r\n    }, [now])\r\n    return <View style={{flexDirection:'row', paddingTop:5, paddingHorizontal:20}}>\r\n        {timerMessages?.map((v,i)=><TimerTag key={i} data={v} now={now} isExpand={v.id==expand} setExpand={setExpand}/>)}\r\n    </View>\r\n}","import { useEffect, useMemo } from \"react\"\r\nimport { useQuery, useQueryClient } from \"react-query\"\r\nimport { getTimerMessageContentList } from \"../../apis\"\r\nimport { MessengerContent } from \"../../types\"\r\nimport useWebsocketContext from \"../useWebsocketContext\"\r\nimport dayjs from \"dayjs\"\r\n\r\nexport default function useTimerMessageContentList(channel_id:number){  \r\n  const queryClient = useQueryClient()\r\n  const { data } = useQuery<MessengerContent[]>(\r\n    [\"TimerMessageContentList\", channel_id], \r\n    async()=>await getTimerMessageContentList(channel_id, dayjs().toISOString()), \r\n  )\r\n  const { lastJsonMessage } = useWebsocketContext()\r\n  useEffect(()=>{\r\n    if(lastJsonMessage !=null && lastJsonMessage['data']['channel'] == channel_id){\r\n      if(lastJsonMessage['type']=='next_message'){\r\n        if(lastJsonMessage['data']['timer'] && dayjs() < dayjs(lastJsonMessage['data']['timer']))\r\n          queryClient.setQueryData<MessengerContent[]>([\"TimerMessageContentList\", channel_id], (_data)=>{\r\n            return [...(_data || []), lastJsonMessage['data']]\r\n          })\r\n      }\r\n      if(lastJsonMessage['type']=='update_message'){\r\n        queryClient.setQueryData<MessengerContent[]>([\"TimerMessageContentList\", channel_id], (_data)=>{\r\n          return [...(_data?.filter(v=>v.id!=lastJsonMessage['data'].id || lastJsonMessage['data']['timer']!=null) || [])]\r\n        })\r\n      }\r\n      if(lastJsonMessage['type']=='delete_message'){\r\n        queryClient.setQueryData<MessengerContent[]>([\"TimerMessageContentList\", channel_id], (_data)=>{\r\n          return [...(_data?.filter(v=>v.id!=lastJsonMessage['data'].id) || [])]\r\n        })\r\n      }\r\n    }\r\n  }, [lastJsonMessage])\r\n  const sorted = useMemo(()=>data?.sort((a, b)=>(a.timer || '') > (b.timer || '')?1:-1), [data])\r\n  useEffect(()=>{\r\n    if (sorted?.[0]?.timer){\r\n      const id = sorted[0].id\r\n      const ms = Math.min(dayjs(sorted[0].timer).diff(dayjs()), Number.MAX_VALUE)\r\n      let timeout = setTimeout(()=>{\r\n        queryClient.setQueryData<MessengerContent[]>([\"TimerMessageContentList\", channel_id], (_data)=>{\r\n          return (_data || []).filter(v=>v.id!=id || dayjs(v.timer).diff(dayjs()) > 0)\r\n        })\r\n      }, ms)\r\n      return ()=>clearTimeout(timeout)\r\n    }\r\n  },[sorted])\r\n  return sorted\r\n}\r\n","import React, {useCallback, useEffect, useLayoutEffect, useMemo, useRef, useState} from 'react';\r\nimport { StackScreenProps } from '@react-navigation/stack';\r\nimport { Platform, StyleSheet, View, TouchableOpacity } from 'react-native';\r\nimport CommonSection from '../../../components/CommonSection';\r\nimport { FlatList, TextInput } from 'react-native-gesture-handler';\r\nimport CommonButton from '../../../components/CommonButton';\r\nimport useMessengerContentList, { MessengerContentPage, useMessengerContentMutation } from '../../../hooks/lists/useMessengerContentList';\r\nimport useAuthContext from '../../../hooks/useAuthContext';\r\nimport HeaderRight from '../../../components/HeaderRight';\r\nimport useMessengerMemberList from '../../../hooks/lists/useMessengerMemberList';\r\nimport Colors from '../../../constants/Colors';\r\nimport useColorScheme from '../../../hooks/useColorScheme';\r\nimport { Text, View as ThemedView } from '../../../components/Themed' \r\nimport Hyperlink from 'react-native-hyperlink'\r\nimport useMessengerChannelList from '../../../hooks/lists/useMessengerChannelList';\r\nimport useIsMobile from '../../../hooks/useIsMobile';\r\nimport LinkPreview from '../../../components/LinkPreview';\r\nimport Avatar, { avatarFromChannel } from '../../../components/Avatar';\r\nimport VideoCallSection from './VideoCallSection';\r\nimport useResizeContext from '../../../hooks/useResizeContext';\r\nimport FilePreview from '../../../components/FilePreview';\r\nimport useModalsContext from '../../../hooks/useModalsContext';\r\nimport InviteModal from '../../../modals/InviteModal';\r\nimport DateTimePickerModal from '../../../modals/DateTimePickerModal'\r\nimport useLangContext from '../../../hooks/useLangContext';\r\nimport { Entypo } from '../../../lib/@expo/vector-icons';\r\nimport TimerTags, { timerFormat, timerToString } from './TimerTags';\r\nimport MessageModal from '../../../modals/MessageModal';\r\nimport ChannelEditModal from '../../../modals/ChannelEditModal';\r\n\r\n\r\nfunction uploadFile(){\r\n  return new Promise<Blob|undefined>((resolve, reject)=>{\r\n    if (Platform.OS == 'web'){\r\n      var input = document.createElement('input');\r\n      input.type = 'file';\r\n      input.onchange = e => { \r\n        resolve((e.target as any).files[0])\r\n      }\r\n      input.onabort = reject\r\n      input.onerror = reject\r\n      input.click();\r\n    }\r\n    else\r\n      resolve(undefined)\r\n  })\r\n}\r\n\r\nconst MessengerContentPageItem = React.memo((props:MessengerContentPage & {ownerId?:number})=>{\r\n  const isMobile = useIsMobile()\r\n  const { setModal } = useModalsContext()\r\n  let nextPage = props.next;\r\n    while(nextPage?.next && nextPage.current.length==0){\r\n      nextPage = nextPage.next\r\n    }\r\n    const nextContent = nextPage?.current[0]\r\n    return <View style={{flexDirection: 'column-reverse'}}>\r\n      \r\n      {props.current.map((content, index2)=>{\r\n        const next = index2 + 1 < props.current.length?props.current[index2+1]:nextContent\r\n        const created:string = content.created.slice(0, 16)\r\n        const date = created.slice(0, 10)\r\n        const isSystem = content.user == null\r\n        const isFirst = next==undefined || (content.user != next.user || created != next.created.slice(0, 16))\r\n        const isSelf = props.ownerId == content.user\r\n        const dayChanged = next==undefined || date != next.created.slice(0, 10)\r\n        const message = content.message_set[0]\r\n        const openModal = ()=>setModal(MessageModal, {id:content.id, content:message.content, isOwner:isSelf, isTimer:content.timer?true:false})\r\n        if (isSystem)\r\n          return <View key={content.id} style={{flexDirection:'row', justifyContent:'center', width:'100%', marginVertical:5}}>\r\n            <Text>{message.content}</Text>\r\n          </View>\r\n        return <View key={content.id}>\r\n          {dayChanged?<View style={{flexDirection:'row', justifyContent:'center', width:'100%'}}><Text>{date}</Text></View>:undefined}\r\n          <View key={content.id} style={{flexDirection:'row', justifyContent:isSelf?'space-between':'flex-start', width:'100%'}}>\r\n            {isFirst && !isSelf? <View style={{marginTop:3, marginLeft:12}}><Avatar name={content.name} userId={content.user} size={36}/></View>:<View style={{width:48}}/>}\r\n            <CommonSection outerContainerStyle={{width:undefined, maxWidth:'90%'}} title={isFirst?content.name:undefined} titleStyle={{flex:undefined}} bodyStyle={{padding:10}} subtitle={`${created.slice(11)}`}>\r\n              <TouchableOpacity onLongPress={openModal}>\r\n                {content.timer && <View style={{flexDirection:'row', alignItems:'stretch'}}>\r\n                  <Text style={{fontSize:12}}></Text>\r\n                  <Text style={{fontSize:12}} selectable={!isMobile}>{timerToString(content.timer)}</Text>\r\n                </View>}\r\n                <View style={{width:\"100%\"}}>\r\n                  {/* @ts-ignore */}\r\n                  <Hyperlink linkDefault={ true } style={{wordBreak:\"break-word\"}} linkStyle={{color: '#12b886'}}>\r\n                    <Text selectable={!isMobile} style={{textAlign:isSelf?'right':'left'}}>{message.content}</Text>\r\n                  </Hyperlink>\r\n                </View>\r\n              {content.file_set.map((file, fileIndex)=><FilePreview key={fileIndex} file={file} isMobile={isMobile} showBorder={content.file_set.length>1 || message.content.length>0}/>)}\r\n              {content.link_set.map((link, linkIndex)=><LinkPreview key={linkIndex} link={link} isMobile={isMobile}/>)}\r\n              </TouchableOpacity>        \r\n            </CommonSection>\r\n          </View>\r\n        </View>\r\n      })}\r\n    </View>\r\n\r\n})\r\n\r\nexport default function ChatScreen({navigation, route}: StackScreenProps<any, 'Chat'>) {\r\n  const { lang, locale } = useLangContext()\r\n  const isMobile = useIsMobile()\r\n  const channel_id = route?.params?.id\r\n  const height = useRef(0)\r\n  const inputRef = useRef<TextInput>(null)\r\n  const {auth} = useAuthContext()\r\n  const { setModal } = useModalsContext()\r\n  const channel = useMessengerChannelList(auth)?.find(v=>v.id==parseInt(channel_id))\r\n  const channelAvatar = channel?avatarFromChannel(channel, auth.user):undefined\r\n  const {data, fetchNextPage } = useMessengerContentList(channel_id)\r\n  const memberList = useMessengerMemberList(channel_id)\r\n  const member_id = useMemo(()=>memberList?.find(v=>v.user == auth.user?.id)?.id, [auth, memberList])\r\n  const windowType = useResizeContext()\r\n  const [value, setValue] = useState('')\r\n  const [timer, setTimer] = useState<string>()\r\n  const [autoFocus, setAutoFocus] = useState<boolean|null>(null)\r\n  const [videoMode, setVideoMode] = useState<boolean>(false)\r\n  const [bottomTab, setBottomTab] = useState<boolean>(false)\r\n\r\n  const theme = useColorScheme()\r\n  const postValue = ()=>{\r\n    if (value.length>0){\r\n      contentMutation.create({channel:channel_id, user:auth.user?.id, content:value, timer})\r\n      setValue('')\r\n      setTimer(undefined)\r\n      setBottomTab(false)\r\n      setAutoFocus(true)\r\n    }\r\n  }\r\n  const contentMutation = useMessengerContentMutation()\r\n\r\n  useLayoutEffect(() => {\r\n    navigation.setOptions({\r\n      headerRight: ()=> <HeaderRight extra={[\r\n        {title:lang('invite'), onPress:()=>setModal(InviteModal, {id:channel_id})},\r\n        {title:lang('setting'), onPress:()=>setModal(ChannelEditModal, {id:channel_id, type:'messenger', member_id})}\r\n      ]}/>,\r\n      title: channelAvatar?.name\r\n    });\r\n  }, [navigation, route, member_id, locale]);\r\n\r\n  const renderItem = useCallback(({item, index}:{item:MessengerContentPage, index:number})=><MessengerContentPageItem {...item} ownerId={auth.user?.id}/>, [auth])\r\n  \r\n  const back = ()=>{\r\n    if(navigation.canGoBack())\r\n        navigation.goBack()\r\n      else{\r\n        navigation.navigate('HomeScreen', {tab:2})\r\n      }\r\n  }\r\n  useEffect(()=>{\r\n    setModal(null, null)\r\n    if (!channel_id)\r\n      back()\r\n  }, [route])\r\n  useEffect(()=>{\r\n    if (memberList===null || (memberList!=undefined && memberList.find(v=>v.user==auth.user?.id)==undefined))\r\n      back()\r\n  }, [memberList])\r\n  useEffect(()=>{\r\n    if(autoFocus){\r\n      (inputRef.current as any).focus()\r\n      setAutoFocus(false)\r\n    }\r\n  }, [autoFocus])\r\n  useEffect(()=>{\r\n    if (autoFocus==null && !isMobile){\r\n      const timeout = setTimeout(()=>setAutoFocus(true), 500)\r\n      return ()=>clearTimeout(timeout)\r\n    }\r\n  })\r\n  return <View style={[\r\n    {flex:1, alignItems:'center'},\r\n    windowType=='landscape'?{flexDirection:'row-reverse', minWidth:480}:{flexDirection:'column'}\r\n  ]}>\r\n    <VideoCallSection channel_id={channel_id} setDisable={(d)=>setVideoMode(!d)} disable={!videoMode}/>\r\n    <View style={[{flex:videoMode?undefined:1, flexShrink:1}, windowType=='landscape'?{minWidth:320, height:'100%'}:{width:'100%'}]}>\r\n      <FlatList\r\n        style={{flexDirection: 'column-reverse'}}\r\n        contentContainerStyle={{padding:10, flexGrow:1, flexDirection: 'column-reverse'}}\r\n        data={data?.pages}\r\n        renderItem={renderItem}\r\n        onScroll={(e)=>{\r\n          if (e.nativeEvent.contentOffset.y + e.nativeEvent.contentSize.height - height.current < 1)\r\n            fetchNextPage()\r\n        }}\r\n        onLayout={(p)=>{height.current = p.nativeEvent.layout.height}}\r\n      />\r\n      <View style={{position:'absolute'}}>\r\n        <TimerTags channel_id={channel_id}/>\r\n      </View>\r\n      <ThemedView style={{bottom:0, width:'100%', paddingTop:15, paddingBottom:10, paddingHorizontal:19}}>\r\n        <View style={{alignItems:'center', width:'100%',flexDirection:'row'}}>\r\n          <CommonButton title={''} style={{height:40, paddingTop:8, borderTopRightRadius:0, borderBottomRightRadius:0}} onPress={()=>setBottomTab(!bottomTab)}>\r\n            <View style={{top:-2}}>\r\n              <Entypo name={bottomTab?\"cross\":\"plus\"} size={24} color={Colors[theme].text}/>\r\n            </View>\r\n          </CommonButton>\r\n          {timer && <CommonButton style={{height:40, paddingTop:8, borderRadius:0}} title={`${timerFormat(timer)}`} onPress={()=>{setModal(DateTimePickerModal, {datetime:timer, callback:(datetime:string)=>setTimer(datetime)});setBottomTab(false)}}/>}\r\n          <TextInput ref={inputRef} value={value} onChangeText={setValue} style={{\r\n            flex:1, borderWidth:1, height:40, borderColor:Colors.borderColor, backgroundColor:Colors[theme].background, color:Colors[theme].text\r\n          }} onSubmitEditing={postValue} blurOnSubmit={true} onFocus={()=>setBottomTab(false)}/>\r\n          <CommonButton style={{height:40, paddingTop:8, borderTopLeftRadius:0, borderBottomLeftRadius:0}} title={''} onPress={postValue}/>\r\n        </View>\r\n\r\n        {bottomTab && <View style={{alignItems:'center', width:'100%', flexDirection:'row', paddingTop:15, paddingBottom:5}}>\r\n          <CommonButton style={{height:80, flex:1, justifyContent:'center', marginRight:15}} title={`\\n ${lang('File')}`} onPress={()=>uploadFile().then(f=>{contentMutation.create({channel:channel_id, user:auth.user?.id, content:'', file:f});setBottomTab(false)})}/>\r\n          <CommonButton style={{height:80, flex:1, justifyContent:'center', marginRight:15}} title={`\\n ${lang('Timer')}`} onPress={()=>{setModal(DateTimePickerModal, {datetime:timer, callback:(datetime:string)=>setTimer(datetime)});setBottomTab(false)}}/>\r\n          <CommonButton style={{height:80, flex:1, justifyContent:'center'}} title={`\\n ${lang('Video Call')}`} onPress={()=>{setVideoMode(!videoMode);setBottomTab(false)}} disabled={videoMode}/>\r\n        </View>}\r\n      </ThemedView>\r\n    </View>\r\n  </View>\r\n}","import React from \"react\"\r\nimport CommonSection from \"../../../components/CommonSection\"\r\nimport Colors from \"../../../constants/Colors\"\r\nimport useColorScheme, { setColorScheme } from \"../../../hooks/useColorScheme\"\r\nimport { StyleSheet, Text, View} from 'react-native';\r\nimport useLangContext from \"../../../hooks/useLangContext\";\r\nimport { useColorScheme as useConfigColorScheme} from 'react-native-appearance';\r\nimport useAuthContext from \"../../../hooks/useAuthContext\";\r\nimport useFirebaseContext from \"../../../hooks/useFirebaseContext\";\r\nimport TextButton from \"../../../components/TextButton\";\r\n\r\n\r\nconst ConfigSection = ({title, children}:{title:string, children?: React.ReactNode})=>{\r\n  const theme = useColorScheme()\r\n  const color = Colors[theme].text\r\n  return <CommonSection bodyStyle={{alignItems:'flex-start', backgroundColor:theme=='light'?'transparent':\"black\"}}>\r\n    <Text style={{fontSize:20, color, fontWeight:'600'}}>{title}</Text>\r\n    {children}\r\n  </CommonSection>\r\n}\r\n\r\nexport default ()=>{\r\n  const { lang, locale, setLocale } = useLangContext()\r\n  const theme = useColorScheme()\r\n  const configTheme = useConfigColorScheme()\r\n  const { auth } = useAuthContext()\r\n  const {enable:noti, setEnable:setNoti} = useFirebaseContext(auth)\r\n  const color = Colors[theme].text\r\n  return <>\r\n    <ConfigSection title={lang('* Notification Settings')}>\r\n      <View style={{flexDirection:'row'}}>\r\n        {[[lang('On'), true], [lang('Off'), false]].map(([title, n])=><TextButton\r\n          key={title} title={title || ''} textStyle={{fontSize:16, color, textDecorationLine:noti==n?'underline':'none'}} style={{borderRadius:20}} onPress={()=>{setNoti(n)}}/>)}\r\n      </View>\r\n    </ConfigSection>\r\n    <ConfigSection title={lang('* Language Settings')}>\r\n    <View style={{flexDirection:'row'}}>\r\n        {[[lang('Auto'), 'auto'], ['', 'ko'], ['English', 'en']].map(([title, l])=><TextButton \r\n          key={title} title={title || ''} textStyle={{fontSize:16, color, textDecorationLine:locale==l?'underline':'none'}} style={{borderRadius:20}} onPress={()=>setLocale(l)}/>)}\r\n      </View>\r\n    </ConfigSection>\r\n    <ConfigSection title={lang('* Skin Settings')}>\r\n      <View style={{flexDirection:'row'}}>\r\n        {[[lang('Auto'), 'no-preference'], [lang('Light'), 'light'], [lang('Dark'), 'dark']].map(([title, colorScheme])=><TextButton \r\n          key={title} title={title} textStyle={{fontSize:16, color, textDecorationLine:configTheme==colorScheme?'underline':'none'}} style={{borderRadius:20}} onPress={(\r\n            )=>setColorScheme(colorScheme)}/>)}\r\n      </View>\r\n    </ConfigSection>\r\n  </>\r\n}","import React, {useState, useEffect, useLayoutEffect, useMemo} from 'react';\r\nimport { StackScreenProps } from '@react-navigation/stack';\r\nimport { StyleSheet, View, ScrollView} from 'react-native';\r\nimport { Text as StyledText } from 'react-native-paper';\r\nimport { Text } from '../../../components/Themed'\r\nimport useResizeContext from '../../../hooks/useResizeContext';\r\nimport TabView from '../../../components/TabView';\r\nimport HeaderRight from '../../../components/HeaderRight';\r\nimport TextButton from '../../../components/TextButton';\r\nimport Colors from '../../../constants/Colors';\r\nimport useColorScheme  from '../../../hooks/useColorScheme';\r\nimport useModalsContext from '../../../hooks/useModalsContext';\r\nimport ChannelEditModal from '../../../modals/ChannelEditModal';\r\nimport useLangContext from '../../../hooks/useLangContext';\r\nimport ContractFooter from '../../../components/ContractFooter';\r\nimport { TabViewRecord } from '../../../types';\r\nimport useAuthContext from '../../../hooks/useAuthContext';\r\nimport useUserMembershipList from '../../../hooks/lists/useUserMembershipList';\r\nimport { FontAwesome, Ionicons, MaterialCommunityIcons, SimpleLineIcons } from '../../../lib/@expo/vector-icons';\r\nimport { useMessengerChannelSorted } from '../../../hooks/lists/useMessengerChannelList';\r\nimport CommonItem from '../../../components/CommonItem';\r\nimport MemberItem from '../../../components/MemberItem';\r\nimport ProfileModal from '../../../modals/ProfileModal';\r\nimport { navigate } from '../../../navigation';\r\nimport CommonSection from '../../../components/CommonSection';\r\nimport ConfigSections from './ConfigSections';\r\nimport Avatar, { avatarFromChannel } from '../../../components/Avatar';\r\n\r\nconst MemberTabView = ()=>{\r\n  const {auth} = useAuthContext()\r\n  const theme = useColorScheme()\r\n  const { setModal } = useModalsContext()\r\n  const userList = useUserMembershipList(auth)\r\n  const memberItem = React.useMemo(\r\n      ()=>userList && userList.map((item, index)=><MemberItem key={index} member={item} onPress={()=>setModal(ProfileModal, {id:item.id})}/>), [userList])\r\n  return <ScrollView style={{flex:1, backgroundColor:Colors[theme].background}}>\r\n      {memberItem}\r\n  </ScrollView>\r\n}\r\n\r\nconst MessengerTabView = ()=>{\r\n  const {auth} = useAuthContext()\r\n  const channelList = useMessengerChannelSorted(auth)\r\n  const theme = useColorScheme()\r\n\r\n  const today = (new Date()).toISOString().slice(0, 10)\r\n  return <ScrollView style={{flex:1, backgroundColor:Colors[theme].background}}>\r\n      {channelList?.map((item, index)=>{\r\n          const {avatar, name} = avatarFromChannel(item, auth.user)\r\n          const date = item.last_message?.created.slice(0,10)\r\n          return <CommonItem key={index} bodyStyle={{flexDirection:'row', justifyContent:'space-between'}} onPress={()=>navigate(\"ChatScreen\", {id:item.id})}>\r\n              <View style={{flexDirection:'row', flexShrink:1}}>\r\n                  {avatar?\r\n                    <View style={{ marginRight:20}}>\r\n                      <Avatar name={avatar.name} size={44} userId={avatar.id}/>\r\n                    </View>:\r\n                    <FontAwesome size={40} color={Colors[theme].iconColor} style={{ marginBottom: -3, marginRight:20 }} name='users'/>}\r\n                  <View>\r\n                      <View style={{flexDirection:'row'}}>\r\n                          <Text style={{fontSize:18}}>{name}</Text>\r\n                          <Text style={{fontSize:18, opacity: 0.4, paddingLeft:5}}>{item.member_count}</Text>\r\n                      </View>\r\n                      <Text style={{fontSize:16, opacity: 0.4}}>{item.last_message?.content}</Text>\r\n                  </View>\r\n              </View>\r\n              <View>\r\n                  <Text style={{fontSize:14, opacity: 0.4, textAlign:'right'}}>{date==today?item.last_message?.created.slice(11,16):date}</Text>\r\n                  <Text style={{fontSize:14, textAlign:'right'}}>{item.unread_count?item.unread_count:' '}</Text>\r\n              </View>\r\n          </CommonItem>\r\n      })}\r\n  </ScrollView>\r\n}\r\n\r\n\r\nconst ConfigTabView = ()=>{\r\n  const theme = useColorScheme()\r\n  return <View style={{flex:1, backgroundColor:Colors[theme].background}}>\r\n    <ConfigSections/>\r\n  </View>\r\n}\r\n\r\nconst getBottomTabs = (theme:'light'|'dark')=>{\r\n  const color = Colors[theme].iconColor\r\n  return {\r\n    OneTab:{\r\n        title:'member',\r\n        component:MemberTabView,\r\n        icon:<MaterialCommunityIcons size={32} color={color} style={{ marginBottom: -3 }} name='account'/>,\r\n    },\r\n    TwoTab:{\r\n        title:'chat',\r\n        component:MessengerTabView,\r\n        icon:<Ionicons size={30} color={color} style={{ marginBottom: -3 }} name='chatbox'/>\r\n    },\r\n    // ThreeTab:{\r\n    //     title:'board',\r\n    //     component:()=><></>,\r\n    //     icon:<></>\r\n    // },\r\n    FourTab:{\r\n        title:'config',\r\n        component:ConfigTabView,\r\n        icon:<SimpleLineIcons size={30} color={color} style={{ marginBottom: -3 }} name='options'/>\r\n    }\r\n  } as TabViewRecord\r\n}\r\n\r\n\r\nexport default function HomeScreen({navigation, route}: StackScreenProps<any, 'Home'>) {\r\n  const { lang, locale } = useLangContext()\r\n  const windowType = useResizeContext();\r\n  const theme = useColorScheme()\r\n  const { setModal } = useModalsContext()\r\n  const [ home, setHome ] = useState(windowType == 'landscape')\r\n  const color = Colors[theme].text\r\n  const options = [\r\n    {title:lang('member'), headerRight:()=><HeaderRight/>},\r\n    {title:lang('chat'), headerRight:()=><HeaderRight extra={[{title:lang('create'), onPress:()=>setModal(ChannelEditModal, {type:'messenger'})}]}/>},\r\n    // {title:'board', headerRight:()=><HeaderRight extra={[{title:'create', onPress:()=>setModal(ChannelEditModal, props:{type:'board'}}) }]}/>},\r\n    {title:lang('config'), headerRight:()=><HeaderRight/>}\r\n  ]\r\n  \r\n  useLayoutEffect(() => {\r\n    const index = route?.params?.tab | 0\r\n    navigation.setOptions(windowType == 'portrait'?options[index]:{\r\n      title: lang('home'),\r\n      headerRight: ()=><HeaderRight/>\r\n    });\r\n  }, [navigation, route, windowType, locale]);\r\n  useEffect(()=>{\r\n    setHome(windowType == 'landscape')\r\n  }, [windowType])\r\n  return home?\r\n    <View style={{flex:1, justifyContent:'center', alignItems:'center'}}>\r\n      <View style={{width:'80%', flex:1, marginTop:72}}>\r\n        <StyledText style={{fontSize:32, color}}>Tokki Tok</StyledText>\r\n        <View style={{backgroundColor:Colors.borderColor, height:1, width:'100%'}}/>\r\n        {/* <Text style={{fontSize:20, color:'gray'}}>Welcome! This is a messenger for teams.</Text>*/}\r\n        <View style={{height:24}}/>\r\n        <CommonSection bodyStyle={{alignItems:'flex-start', backgroundColor:theme=='light'?'transparent':\"black\"}}>\r\n          <TextButton title={lang('+ New chat')} textStyle={{fontSize:20, color}} style={{paddingLeft:0, borderRadius:20}} onPress={()=>setModal(ChannelEditModal, {type:'messenger'})}/>\r\n        </CommonSection>\r\n        <ConfigSections/>\r\n      </View>\r\n      <ContractFooter theme={theme}/>\r\n    </View>:\r\n    <TabView tabs={getBottomTabs(theme)} tabBarPosition=\"bottom\" index={parseInt(route.params?.['tab'] || 0)} onTab={(index)=>{navigation.setParams({tab:index})}}/>\r\n}\r\n\r\n","import React, {useEffect, useLayoutEffect, useState} from 'react';\r\n\r\nimport { StackScreenProps } from '@react-navigation/stack';\r\nimport useAuthContext from '../../hooks/useAuthContext';\r\nimport useMessengerChannelList from '../../hooks/lists/useMessengerChannelList';\r\nimport { Text } from '../../components/Themed';\r\nimport { useMessengerMemberMutation } from '../../hooks/lists/useMessengerMemberList';\r\n\r\nexport default function InviteeScreen({navigation, route}: StackScreenProps<any, 'Invitee'>) {\r\n    const id = route?.params?.id\r\n    const {auth, dispatch} = useAuthContext()\r\n    const [enterGuest, setEnterGuest] = useState(false)\r\n    const channelList = useMessengerChannelList(auth)\r\n    const messengerMemberMutation = useMessengerMemberMutation()\r\n    useLayoutEffect(() => {\r\n        navigation.setOptions({headerRight: undefined});\r\n    }, []);\r\n    useEffect(()=>{\r\n        if(auth.user==null && enterGuest==false){\r\n            dispatch({type:\"LOGIN_GUEST\"})\r\n            setEnterGuest(true)\r\n        }\r\n        else if(auth.user && channelList!==undefined){\r\n            if(channelList.find(v=>v.id==id) === undefined){\r\n                console.log(`invite processing (channel:${id})`)\r\n                messengerMemberMutation.invite({\r\n                    channel_id:id,\r\n                    user_ids:[auth.user.id]\r\n                }).then(()=>navigation.replace(\"ChatScreen\", {id}))\r\n            }\r\n            else{\r\n                console.log('already invite')\r\n                navigation.replace(\"ChatScreen\", {id})\r\n            }\r\n        }\r\n    }, [auth, channelList, enterGuest])\r\n  return <Text>{''}</Text>\r\n};\r\n","import LoginScreen from \"./main/LoginScreen\";\r\nimport ChatScreen from \"./main/ChatScreen\";\r\nimport HomeScreen from \"./main/HomeScreen\";\r\nimport TabOneScreen from \"./main/TabOneScreen\";\r\nimport InviteeScreen from \"./main/InviteeScreen\";\r\n// import BoardScreen from \"../lib/blacktokki-board/BoardScreen\";\r\n// import BoardEditScreen from \"../lib/blacktokki-board/BoardEditScreen\";\r\nimport { Screens } from \"../types\";\r\n\r\nexport const main = {\r\n    HomeScreen:{\r\n        title:'home',\r\n        component:HomeScreen,\r\n        path:'home',\r\n    },\r\n    ChatScreen:{\r\n        title:'chat',\r\n        component:ChatScreen,\r\n        path:'chat'\r\n    },\r\n    // BoardScreen:{\r\n    //     title:'board',\r\n    //     component:BoardScreen,\r\n    //     path:'board'\r\n    // },\r\n    // TabOneScreen:{\r\n    //     title:'tab one',\r\n    //     component:TabOneScreen,\r\n    //     path:'one'\r\n    // },\r\n    InviteeScreen:{\r\n        title: '',        \r\n        component:InviteeScreen,\r\n        path:'invitee'\r\n    }\r\n} as Screens\r\n\r\nexport const login = {\r\n    LoginScreen:{\r\n        path: 'login',\r\n        title: 'Sign in',\r\n        component:LoginScreen\r\n    },\r\n    InviteeScreen:{\r\n        path:'invitee',\r\n        title: '',\r\n        component:InviteeScreen\r\n    }\r\n} as Screens\r\n\r\nexport const modal = {\r\n    // BoardEditScreen:{\r\n    //     title:'board',\r\n    //     component:BoardEditScreen,\r\n    //     path:'modal/board'\r\n    // },\r\n} as Screens","import { useMemo, useReducer } from \"react\"\r\n\r\ntype LocalSearchAction = {type:string, keyword?:string}\r\n\r\ntype LocalSearchState ={active:boolean, keyword:string}\r\n\r\n\r\n\r\nconst localSearchReducer =(initialState:LocalSearchState, action:LocalSearchAction)=>{\r\n    switch (action.type){\r\n        case 'SEARCH':\r\n          return {\r\n            ...initialState,\r\n            keyword: action.keyword\r\n          } as LocalSearchState\r\n        case 'ENABLE_SEARCH':\r\n          return {\r\n            ...initialState,\r\n            active:true,\r\n          }\r\n        case 'DISABLE_SEARCH':\r\n            return{\r\n                ...initialState,\r\n                active:false,\r\n                keyword: ''\r\n            }\r\n        default:\r\n            throw new Error( `Unhandled action type: ${action.type}`)\r\n    }\r\n  }\r\n\r\n\r\nexport default function useLocalSearch<T>(target:T[], compare:(value:T, keyword:string)=>boolean) {\r\n  const [searchState, dispatch] = useReducer(localSearchReducer, {active:false, keyword:''})\r\n  const data = useMemo(()=>searchState.active?target.filter(v=>compare(v, searchState.keyword)):target, [searchState, target])\r\n  return {searchState, dispatch, data}\r\n}","import React, {useRef,MutableRefObject, useMemo, useState, useEffect } from 'react';\r\nimport Clipboard from '@react-native-clipboard/clipboard/dist';\r\nimport { View, Text } from '../components/Themed';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport useUserMembershipList from '../hooks/lists/useUserMembershipList';\r\nimport { TabViewRecord, UserMembership } from '../types';\r\nimport CommonButton from '../components/CommonButton';\r\nimport useMessengerMemberList, { useMessengerMemberMutation } from '../hooks/lists/useMessengerMemberList';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport useExternalMembershipList from '../hooks/lists/useExternalMembershipList';\r\nimport TextField from '../components/TextField';\r\nimport useLocalSearch from '../hooks/useLocalSearch';\r\nimport TabView from '../components/TabView';\r\nimport { FlatList, TouchableOpacity } from 'react-native-gesture-handler';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport MemberItem from '../components/MemberItem';\r\nimport ModalSection from '../components/ModalSection';\r\nimport useModalEffect from '../hooks/useModalEffect';\r\n\r\nconst InviteItem = (props:{item:UserMembership, selectedRef:MutableRefObject<Set<number>>})=>{\r\n  const [selected, setSelected] = useState(props.selectedRef.current.has(props.item.id))\r\n  return <View style={selected?{borderWidth:1, borderColor:'blue'}:{}}>\r\n    <MemberItem member={props.item} onPress={()=>{\r\n      if (selected){\r\n        setSelected(false)\r\n        props.selectedRef.current.delete(props.item.id)\r\n      }\r\n      else{\r\n        setSelected(true)\r\n        props.selectedRef.current.add(props.item.id)\r\n      }\r\n    }}/>\r\n  </View>\r\n\r\n}\r\ntype InviteTabViewProps = {\r\n  id:number,\r\n  selectedRef:MutableRefObject<Set<number>>\r\n}\r\n\r\nconst GroupTabView = ({id, selectedRef}:InviteTabViewProps)=>{\r\n  const { lang } = useLangContext()\r\n  const {auth} = useAuthContext()\r\n  const { setModal } = useModalsContext()\r\n  const userList = useUserMembershipList(auth)\r\n  const memberList = useMessengerMemberList(id)\r\n  const messengerMemberMutation = useMessengerMemberMutation()\r\n  const rawData = useMemo(()=>{\r\n    const memberSet = new Set(memberList?.map(v=>v.user))\r\n    return userList?.filter(v=>!memberSet.has(v.id)) || []\r\n  }, [userList, memberList])\r\n  const {data, dispatch:dispatchKeyword, searchState} = useLocalSearch(rawData, (v, keyword)=>(v.username.includes(keyword) || v.name.includes(keyword)))\r\n  const search = (k:string)=>{\r\n    if (k?.length>0){\r\n      dispatchKeyword({type:'ENABLE_SEARCH'})\r\n      dispatchKeyword({type:'SEARCH', keyword:k})\r\n    }\r\n    else{\r\n      dispatchKeyword({type:'DISABLE_SEARCH'})\r\n    }\r\n  }\r\n  const back = ()=>{\r\n    setModal(InviteModal, null)\r\n  }\r\n  useModalEffect(back, [])\r\n  return <View style={{alignItems:'center', flex:1}}>\r\n    <View style={{'width': '100%', flex:1}}>\r\n      <TextField name={`${lang('Username')} & ${lang('Name')}`} value={searchState.keyword} setValue={search} width={'80%'}/>\r\n      {id && data && <FlatList contentContainerStyle={{flexGrow:1}} data={data} renderItem={({item})=><InviteItem item={item} selectedRef={selectedRef}/>}/>}\r\n    </View>\r\n    <View style={[{width:'100%', flexDirection:'row', padding:10,}, {justifyContent:'flex-end'}]}>\r\n      <CommonButton title={lang('invite')} onPress={()=>{\r\n        messengerMemberMutation.invite({\r\n          channel_id:id,\r\n          user_ids:[...selectedRef.current]\r\n        }).then(back)\r\n      }}/>\r\n      <CommonButton title={lang('cancel')} onPress={back}/>\r\n    </View>\r\n  </View>\r\n}\r\n\r\nconst DELAY = 500\r\n\r\nconst ExternalMembershipTabView = ({id, selectedRef}:InviteTabViewProps)=>{\r\n  const { lang } = useLangContext()\r\n  const [value, setValue] = useState('')\r\n  const [keyword, setKeyword] = useState('')\r\n  const [copied, setCopied] = useState(false)\r\n  const timeoutRef = useRef<NodeJS.Timeout>()\r\n  const { setModal } = useModalsContext()\r\n  const memberList = useMessengerMemberList(id)\r\n  const externalMemberList = useExternalMembershipList(keyword)\r\n  const data = useMemo(()=>{\r\n    const memberSet = new Set(memberList?.map(v=>v.user))\r\n    return externalMemberList?.filter(v=>!memberSet.has(v.id)) || []\r\n  }, [externalMemberList, memberList])\r\n  const messengerMemberMutation = useMessengerMemberMutation()\r\n  useEffect(()=>{\r\n    timeoutRef.current = setTimeout(()=>{\r\n      setKeyword(value)\r\n    }, DELAY)\r\n    return ()=>{timeoutRef.current && clearTimeout(timeoutRef.current)}\r\n  }, [value])\r\n  const back = ()=>{\r\n    setModal(InviteModal, null)\r\n  }\r\n  const inviteLink = location.href.replace('chat', 'invitee')\r\n  return <View style={{alignItems:'center', flex:1}}>\r\n  <TouchableOpacity style={{paddingVertical:10, flexDirection:\"row\"}} onPress={()=>{Clipboard.setString(inviteLink);setCopied(true)}}>\r\n    <Text style={{fontSize:14}}>{lang('invite link')}{\": \"}</Text>\r\n    <Text style={{fontSize:14, color:'#12b886'}}>{inviteLink}{\" \"}</Text>\r\n    {copied && <Text style={{fontSize:12, color:'red'}}>{lang(\"copied\")}</Text>}\r\n  </TouchableOpacity>\r\n  <View style={{'width': '100%', flex:1}}>\r\n    <TextField name={lang('Username')} value={value} setValue={setValue} width={'80%'}/>\r\n    {id && data && <FlatList contentContainerStyle={{flexGrow:1}} data={data} renderItem={({item})=><InviteItem item={item} selectedRef={selectedRef}/>}/>}\r\n  </View>\r\n  <View style={[{width:'100%', flexDirection:'row', padding:10,}, {justifyContent:'flex-end'}]}>\r\n    <CommonButton title={lang('invite')} onPress={()=>{\r\n      messengerMemberMutation.invite({\r\n        channel_id:id,\r\n        user_ids:[...selectedRef.current]\r\n      }).then(back)\r\n    }}/>\r\n    <CommonButton title={lang('cancel')} onPress={back}/>\r\n  </View>\r\n</View>\r\n}\r\n\r\nexport default function InviteModal({id}:{id:number}) {\r\n  const { lang } = useLangContext()\r\n  const selectedRef = useRef<Set<number>>(new Set())\r\n  const drawerTabs:TabViewRecord = {\r\n    group:{\r\n      title: 'Group',\r\n      component: ()=><GroupTabView id={id} selectedRef={selectedRef}/>,\r\n      icon: <></>\r\n    },\r\n    external:{\r\n      title: 'External members',\r\n      component: ()=><ExternalMembershipTabView id={id} selectedRef={selectedRef}/>,\r\n      icon: <></>\r\n    }\r\n  }\r\n  return <ModalSection>\r\n    <View style={{flex:1, width:'100%'}}>\r\n      <View style={{width:'100%'}}>\r\n        <Text style={{fontSize:20}}>{lang('invite')}</Text>\r\n        <View style={{marginBottom: 20, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n      </View>\r\n      <TabView tabs={drawerTabs} tabBarPosition={\"top\"}/>\r\n    </View>\r\n  </ModalSection>\r\n}\r\n\r\n","import { useQuery } from \"react-query\";\r\nimport { getExternalMembershipList } from \"../../apis\";\r\n\r\nexport default function useExternalMembershipList(keyword?:string){\r\n  const { data } = useQuery([\"UserMembershipList\", keyword] , async()=>keyword?(await getExternalMembershipList(keyword)):[])\r\n  return data\r\n}","import React, { useMemo } from 'react';\r\n\r\nimport { TextProps, StyleProp } from 'react-native';\r\nimport {View, Text } from './Themed'\r\nimport useResizeContext from '../hooks/useResizeContext';\r\n\r\ntype Props = {\r\n  name: string,\r\n  width?:number,\r\n  children: React.ReactNode\r\n  textStyle?: StyleProp<TextProps>\r\n}\r\n\r\nexport default function RowField(props:Props) {\r\n  const windowType = useResizeContext()\r\n  const rowStyle = useMemo(()=>windowType=='landscape'?\r\n    {flexDirection:'row', alignItems: 'center', justifyContent:'space-between'}:\r\n    {flexDirection:'column', alignItems:'flex-start'} as any\r\n  , [windowType])\r\n  return (\r\n    <View style={[{paddingVertical:5, width:'100%'}, rowStyle]}>\r\n        <Text style={[windowType=='landscape'?{flex:1}:{width:'100%'},{paddingHorizontal: 15, fontSize:16}, props.textStyle]}>{props.name}</Text>\r\n        <View style={[windowType=='landscape'?{flex:6}:{width:'100%'},{paddingHorizontal: 15}]}>\r\n          <View style={{width:props.width}}>\r\n            {props.children}\r\n          </View>\r\n        </View>\r\n    </View>\r\n  )\r\n}","import React from 'react';\r\nimport { StyleProp, TextStyle } from 'react-native';\r\nimport { CustomTextInputProps } from '../types';\r\nimport CommonTextInput from './CommonTextInput';\r\nimport RowField from './RowField';\r\n\r\nexport default function TextField(props:CustomTextInputProps & {name: string, width?:any, textStyle?:StyleProp<TextStyle>}) {\r\n  return (\r\n    <RowField name={props.name} width={props.width} textStyle={props.textStyle}>\r\n      <CommonTextInput {...props} />\r\n   </RowField>\r\n  )\r\n}","/**\r\n * Learn more about deep linking with React Navigation\r\n * https://reactnavigation.org/docs/deep-linking\r\n * https://reactnavigation.org/docs/configuring-links\r\n */\r\n\r\nimport { LinkingOptions } from '@react-navigation/native';\r\nimport * as Linking from 'expo-linking';\r\nimport {main, login, modal} from '../screens';\r\n\r\nconst ROOTPATH = 'tokki-tok'  // github repository name\r\n\r\nObject.values(modal).forEach(v=>v.path = ROOTPATH + '/' + v.path)\r\n\r\nexport default  {\r\n  prefixes: [Linking.makeUrl('/')],\r\n  config: {\r\n    screens: {\r\n      Main: {\r\n        screens:{\r\n          ...main,\r\n          ...login,\r\n          NotFound: '*',\r\n        },\r\n        path: ROOTPATH\r\n      },\r\n      ...modal\r\n    },\r\n  },\r\n} as LinkingOptions;\r\n","firebaseConfig = {\n    \"authDomain\": \"virtual-metrics-355712.firebaseapp.com\",\n    \"projectId\": \"virtual-metrics-355712\",\n    \"storageBucket\": \"virtual-metrics-355712.appspot.com\",\n    \"messagingSenderId\": \"76003576924\",\n    \"appId\": \"1:76003576924:web:c8c8a006d07918bbc02a99\",\n    \"measurementId\": \"G-SEL35L4N5R\"\n}\nif (typeof module !== 'undefined') {\n    module.exports = firebaseConfig\n}\n","import { StackScreenProps } from '@react-navigation/stack';\r\nimport * as React from 'react';\r\nimport { StyleSheet, Text, TouchableOpacity, View } from 'react-native';\r\nimport useLangContext from '../hooks/useLangContext';\r\n\r\nexport default function NotFoundScreen({\r\n  navigation,\r\n}: StackScreenProps<any, 'NotFound'>) {\r\n  const { lang } = useLangContext()\r\n  return (\r\n    <View style={styles.container}>\r\n      <Text style={styles.title}>{lang(\"This screen doesn't exist.\")}</Text>\r\n      <TouchableOpacity onPress={() => navigation.replace('HomeScreen')} style={styles.link}>\r\n        <Text style={styles.linkText}>{lang(\"Go to home screen!\")}</Text>\r\n      </TouchableOpacity>\r\n    </View>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: '#fff',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    padding: 20,\r\n  },\r\n  title: {\r\n    fontSize: 20,\r\n    fontWeight: 'bold',\r\n  },\r\n  link: {\r\n    marginTop: 15,\r\n    paddingVertical: 15,\r\n  },\r\n  linkText: {\r\n    fontSize: 14,\r\n    color: '#2e78b7',\r\n  },\r\n});\r\n","import { useTheme } from '@react-navigation/native';\r\nimport React, { useState } from 'react';\r\nimport { View, StyleSheet } from 'react-native';\r\nimport Profile from '../components/Profile';\r\nimport TextButton from '../components/TextButton';\r\nimport Colors from '../constants/Colors';\r\nimport useResizeContext from '../hooks/useResizeContext';\r\nimport TabView from '../components/TabView';\r\nimport { MessengerChannel, TabViewRecord, User, UserMembership } from '../types';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport ChannelEditModal from '../modals/ChannelEditModal';\r\nimport CommonItem from '../components/CommonItem';\r\nimport { Text } from '../components/Themed';\r\nimport useAuthContext, { Auth } from '../hooks/useAuthContext';\r\nimport { useMessengerChannelSorted } from '../hooks/lists/useMessengerChannelList';\r\nimport { navigate } from '.'\r\nimport { avatarFromChannel } from '../components/Avatar';\r\n\r\nconst DrawerTabView = (props:{auth:Auth, data:(MessengerChannel & {onPress?:()=>void})[]})=><View style={{flex:1}}>\r\n    {props.data.map((item, index)=>{\r\n      const {name} = avatarFromChannel(item, props.auth.user)\r\n      return <CommonItem key={index} containerStyle={{marginHorizontal:0}} bodyStyle={{alignItems:'flex-start'}} onPress={item.onPress}>\r\n        <Text style={{marginLeft:20}}>{name}</Text>\r\n      </CommonItem>\r\n    })}\r\n</View>\r\n\r\nconst MessengerTabView = ()=>{\r\n  const {auth} = useAuthContext()\r\n  const channelList = useMessengerChannelSorted(auth);\r\n  return <DrawerTabView auth={auth} data={(channelList || []).map(item=>({...item, onPress:()=>navigate(\"ChatScreen\", {id:item.id})}))}/>\r\n}\r\n\r\nconst drawerTabs:TabViewRecord = {\r\n  MessengerTab:{\r\n      title:'messenger',\r\n      component:MessengerTabView,\r\n      icon:<></>\r\n  },\r\n}\r\n\r\nexport default ({user}:{user:UserMembership})=> {\r\n  const { colors } = useTheme();\r\n  const windowType = useResizeContext();\r\n  const [index, setIndex] = useState(0);\r\n  const { setModal } = useModalsContext()\r\n  const onAddList = [\r\n    ()=>setModal(ChannelEditModal, {type:'messenger'}),\r\n    ()=>setModal(ChannelEditModal, {type:'board'})\r\n  ]\r\n  return <View style={windowType=='landscape'?[\r\n      styles.tabBar,\r\n      {\r\n        backgroundColor: colors.card,\r\n        borderTopColor: colors.border,\r\n      },\r\n      // tabBarStyle,\r\n    ]:{width:0}}\r\n    pointerEvents={false ? 'none' : 'auto'}\r\n  >\r\n    <Profile userId={user.id} username={user.username} name={user.name}/>\r\n    {windowType=='landscape' && <>\r\n      <View style={{flexDirection:'row-reverse'}}>\r\n          <TextButton title='+' textStyle={{fontSize:20}} style={{borderRadius:20}} onPress={onAddList[index]}/>\r\n      </View>\r\n      <View accessibilityRole=\"tablist\" style={styles.content}>\r\n        {Object.keys(drawerTabs).length>1 ? \r\n          <TabView tabs={drawerTabs} tabBarPosition={\"top\"} onTab={setIndex}/>: \r\n          <View style={{borderTopWidth:1, flex:1, borderColor:colors.border}}>            \r\n            {Object.values(drawerTabs).map(drawerTab=>{const Tab = drawerTab.component; return <Tab key={drawerTab.title}/>})}\r\n          </View>\r\n        }\r\n      </View>\r\n    </>}\r\n  </View>\r\n}\r\n\r\n{/*<Text style={[styles.label, { color: d.isFocused ? colors.primary : '#222' }]}></Text> */}\r\n\r\nconst styles = StyleSheet.create({\r\n    tabBar: {\r\n      width:240,\r\n      elevation: 8,\r\n      borderRightWidth:1,\r\n      borderColor:Colors.borderColor\r\n    },\r\n    content: {\r\n      flex: 1,\r\n      flexDirection: 'row',\r\n    },\r\n    tab: {\r\n        flex: 1,\r\n        alignItems: 'center',\r\n    },\r\n    label: {\r\n        textAlign: 'center',\r\n        backgroundColor: 'transparent',\r\n      },\r\n  });","import InviteModal from \"./InviteModal\";\r\nimport ProfileModal from \"./ProfileModal\";\r\nimport ChannelEditModal from \"./ChannelEditModal\"\r\nimport GuestLogoutModal from \"./GuestLogoutModal\";\r\nimport DateTimePickerModal from \"./DateTimePickerModal\"\r\nimport MessageModal from \"./MessageModal\";\r\n\r\nexport default [\r\n    InviteModal,\r\n    ProfileModal,\r\n    ChannelEditModal,\r\n    GuestLogoutModal,\r\n    DateTimePickerModal,\r\n    MessageModal\r\n]","import { CardStyleInterpolators, createStackNavigator } from '@react-navigation/stack';\r\nimport React, {useMemo} from 'react';\r\nimport { View } from 'react-native';\r\nimport { Ionicons } from '../lib/@expo/vector-icons';\r\nimport useResizeContext from '../hooks/useResizeContext';\r\nimport NotFoundScreen from '../screens/NotFoundScreen';\r\nimport {main, login, modal} from '../screens';\r\nimport DrawerNavigator from './DrawerNavigator';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport { WebSocketProvider } from '../hooks/useWebsocketContext';\r\nimport HeaderRight from '../components/HeaderRight'\r\nimport Colors from '../constants/Colors';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport useFirebaseContext, { FirebaseProvider } from '../hooks/useFirebaseContext';\r\nimport useIsMobile from '../hooks/useIsMobile';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { ModalsProvider } from '../hooks/useModalsContext';\r\nimport modals from '../modals';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport CommonButton from '../components/CommonButton';\r\n\r\nconst Root = createStackNavigator();\r\n\r\nexport default function RootNavigator() {\r\n    const windowType = useResizeContext();\r\n    return <Root.Navigator\r\n        mode= 'modal'\r\n        headerMode= 'screen'\r\n        screenOptions={{\r\n            cardStyle:{backgroundColor:\"white\"},\r\n            animationEnabled: true,\r\n            cardStyleInterpolator: CardStyleInterpolators.forVerticalIOS,\r\n        }}\r\n    >\r\n        <Root.Screen name=\"Main\" component={MainNavigator} options={{headerShown:false}}/>\r\n        {Object.entries(modal).map(([key, screen])=><Root.Screen key={key} name={key} component={screen.component} options={{\r\n            title: screen.title,\r\n            gestureDirection: windowType == 'landscape'?'vertical-inverted':'vertical'\r\n        }} />)}\r\n    </Root.Navigator>\r\n}\r\n\r\nconst Main = createStackNavigator();\r\n\r\nfunction headerLeft(navigation:any, route:any, windowType:string, theme:'light'|'dark', isMobile:boolean){\r\n    const canGOBackScreen = ['HomeScreen', 'LoginScreen'].findIndex(v=>v == route.name) == -1\r\n    const goBack = ()=>{\r\n        if (navigation.canGoBack())\r\n            navigation.goBack()\r\n        else if (canGOBackScreen)\r\n            navigation.replace('HomeScreen')\r\n    }\r\n    if (windowType=='portrait' && canGOBackScreen)\r\n        return <TouchableOpacity onPress={goBack} disabled={!isMobile}>\r\n            <CommonButton title={''} color={isMobile?Colors[theme].buttonBackgroundColor:Colors[theme].hoverColor} onPress={goBack} disabled={isMobile} style={{width:32, height:32, margin:16, paddingVertical:1, paddingHorizontal:4}}>\r\n                <Ionicons size={24} color={Colors[theme].iconColor} name=\"arrow-back\"/>\r\n            </CommonButton>\r\n        </TouchableOpacity>\r\n    return null\r\n}\r\n\r\nconst MainNavigator = ()=>{\r\n    const windowType = useResizeContext();\r\n    const isMobile = useIsMobile()\r\n    const {auth} = useAuthContext()\r\n    const theme = useColorScheme()\r\n    const {lang, locale} = useLangContext()\r\n    const entries = useMemo(()=>{\r\n        if (auth.user === undefined)\r\n            return []\r\n        console.log('current user: ', auth.user)\r\n        return Object.entries(auth.user === null?login:main)\r\n    }, [auth, locale])\r\n    const modalValues = useMemo(()=>{\r\n        if (auth.user === undefined)\r\n            return []\r\n        return auth.user === null?[]:modals\r\n    }, [auth])\r\n    return (auth.user!==undefined?<View style={{flexDirection:'row', flex:1}}>\r\n        <ModalsProvider modals={modalValues}>\r\n            {auth.user?<DrawerNavigator user={auth.user}/>:undefined}\r\n            <View style={{flex:1}}>\r\n                <WebSocketProvider disable={auth.user === null || auth.user === undefined}>\r\n                    <FirebaseProvider user={auth.user}>\r\n                        <Main.Navigator\r\n                            screenOptions={({navigation, route})=>({\r\n                                headerStyle:{backgroundColor:Colors[theme].header, height:isMobile?50:undefined},\r\n                                headerTitleStyle:{color:Colors[theme].text},\r\n                                headerLeft:()=>headerLeft(navigation, route, windowType, theme, isMobile),\r\n                                headerRight:()=><HeaderRight/>,\r\n                                headerLeftContainerStyle:{backgroundColor:Colors[theme].header, borderBottomWidth:1, borderColor:Colors[theme].headerBottomColor},\r\n                                cardStyle:[{flexShrink:1}, theme=='light'?{}:{backgroundColor:'#010409'}],\r\n                                animationEnabled:windowType=='portrait',\r\n                                cardStyleInterpolator: CardStyleInterpolators.forHorizontalIOS\r\n                            })}\r\n                        >\r\n                            {entries.map(([key, screen])=><Main.Screen key={key} name={key} component={screen.component} options={{ title: lang(screen.title) }} />)}\r\n                            <Main.Screen name=\"NotFound\" component={NotFoundScreen} options={{ title: 'Oops!' }} />\r\n                        </Main.Navigator>\r\n                    </FirebaseProvider>\r\n                </WebSocketProvider>\r\n            </View>\r\n        </ModalsProvider>\r\n    </View>:<></>);\r\n}"],"sourceRoot":""}