(this.webpackJsonp=this.webpackJsonp||[]).push([[2],{1163:function(e,t,n){"use strict";var r=n(16),i=n.n(r),c=n(593),o=n(599),a=n(0),s=n(39),l=n(108),u=n(261),d=n(29),b=n(249),j=n(263),f=n(104),O=n(91),h=n(10);function g(e){var t=e.navigation,n=Object(O.b)().lang,r=Object(f.b)().auth;return Object(h.jsxs)(s.a,{style:p.container,children:[Object(h.jsx)(b.a,{style:p.title,children:n("This screen doesn't exist.")}),Object(h.jsx)(j.a,{onPress:function(){return t.replace(r.user?"HomeScreen":"LoginScreen")},style:p.link,children:Object(h.jsx)(b.a,{style:p.linkText,children:n("Go to home screen!")})})]})}var p=d.a.create({container:{flex:1,backgroundColor:"#fff",alignItems:"center",justifyContent:"center",padding:20},title:{fontSize:20,fontWeight:"bold"},link:{marginTop:15,paddingVertical:15},linkText:{fontSize:14,color:"#2e78b7"}}),y=n(495),x=n(175),m=n(579),v=n(382),w=n(250),S=n(445),C=n(255),P=n(383),k=n(447),D=n(246),E=n(305),_=n(325),M=n(293),z=n(105),R=n(340),T=n(381),I=n(450),L=function(){var e=Object(f.b)().auth,t=Object(C.b)().setModal,n=Object(R.a)(e);return Object(h.jsx)(s.a,{style:{flex:1},children:null==n?void 0:n.map((function(e,n){return Object(h.jsx)(k.a,{containerStyle:{marginHorizontal:0},bodyStyle:{alignItems:"flex-start"},onPress:function(){return t(T.a,{id:e.id})},children:Object(h.jsx)(D.a,{style:{marginLeft:20},children:e.name})},n)}))})},B=function(){var e=Object(f.b)().auth,t=Object(E.c)("messenger",e);return Object(h.jsx)(s.a,{style:{flex:1},children:null==t?void 0:t.map((function(t,n){var r=Object(M.a)(t,e.user).name;return Object(h.jsx)(k.a,{containerStyle:{marginHorizontal:0},bodyStyle:{alignItems:"flex-start"},onPress:function(){return Object(_.navigate)("ChatScreen",{id:t.id})},children:Object(h.jsx)(D.a,{style:{marginLeft:20},children:r})},n)}))})},A=function(e){var t=e.auth,n=Object(x.a)().colors,r=Object(z.a)(),c=Object(u.b)(),o=Object(a.useState)(),d=i()(o,2),b=d[0],j=d[1],f=Object(C.b)().setModal,O=[function(){return f(I.a,{})},function(){return f(P.a,{type:"messenger"})}],g=function(e){var t=w.a[e].iconColor;return{MemberTab:{title:"people",component:L,icon:Object(h.jsx)(l.e,{size:32,color:t,style:{marginBottom:-3},name:"account"})},ChatTab:{title:"chat",component:B,icon:Object(h.jsx)(l.d,{size:30,color:t,style:{marginBottom:-3},name:"chatbox"})}}}(r);return Object(a.useEffect)((function(){void 0===b&&j(0)}),[]),Object(h.jsx)(s.a,{style:"landscape"==c?[H.tabBar,{backgroundColor:w.a[r].background,borderTopColor:n.border}]:{width:0},pointerEvents:"auto",children:"landscape"==c&&t.user&&void 0!==b&&Object(h.jsxs)(h.Fragment,{children:[Object(h.jsx)(m.a,{userId:t.user.id,username:t.user.username,name:t.user.name}),Object(h.jsx)(s.a,{style:{flexDirection:"row-reverse"},children:Object(h.jsx)(v.a,{title:"+",textStyle:{fontSize:20},style:{borderRadius:20},onPress:O[b]})}),Object(h.jsx)(s.a,{accessibilityRole:"tablist",style:H.content,children:Object.keys(g).length>1?Object(h.jsx)(S.a,{tabs:g,tabBarPosition:"top",onTab:j,index:b}):Object(h.jsx)(s.a,{style:{borderTopWidth:1,flex:1,borderColor:n.border},children:Object.values(g).map((function(e){var t=e.component;return Object(h.jsx)(t,{},e.title)}))})})]})})},H=d.a.create({tabBar:{width:240,elevation:8,borderRightWidth:1,borderColor:w.a.borderColor},content:{flex:1,flexDirection:"row"},tab:{flex:1,alignItems:"center"},label:{textAlign:"center",backgroundColor:"transparent"}}),W=n(326),V=n(448),F=n(264),Q=n(585),N=n(112),G=n(501),U=n(584),J=n(548),Y=n(575),K=n(402),q=[G.b,I.a,T.a,P.a,U.a,J.a,Y.a,K.a],$=n(262),Z=n(431),X=Object(c.a)();t.a=function(){var e=Object(u.b)(),t=Object(N.a)(),n=Object(f.b)().auth,r=Object(z.a)(),c=Object(O.b)(),d=c.lang,b=c.locale,j=Object(a.useMemo)((function(){return void 0===n.user?[]:(console.log("current user: ",n.user),Object.entries(null===n.user?y.a:y.b))}),[n,b]),p=Object(a.useMemo)((function(){return void 0===n.user||null===n.user?[]:q}),[n]),x="light"==r?{}:{backgroundColor:"#010409"};return void 0!==n.user?Object(h.jsx)(s.a,{style:{flexDirection:"row",flex:1},children:Object(h.jsx)(Z.a,{children:Object(h.jsxs)(C.a,{modals:p,children:[n.user?Object(h.jsx)(A,{auth:n}):void 0,Object(h.jsx)(s.a,{style:[{flex:1},x],children:Object(h.jsx)(W.b,{disable:null===n.user||void 0===n.user,children:Object(h.jsx)(Q.a,{user:n.user,children:Object(h.jsxs)(X.Navigator,{screenOptions:function(n){var i=n.navigation,c=n.route;return{headerStyle:{backgroundColor:w.a[r].header,height:t?50:void 0},headerTitleStyle:{color:w.a[r].text},headerLeft:function(){return function(e,t,n,r,i){var c=-1==["HomeScreen","LoginScreen"].findIndex((function(e){return e==t.name})),o=function(){e.canGoBack()?e.goBack():c&&e.replace("HomeScreen")};return"portrait"==n&&c?Object(h.jsx)(F.c,{onPress:o,disabled:!i,children:Object(h.jsx)($.a,{title:"",color:i?w.a[r].buttonBackgroundColor:w.a[r].hoverColor,onPress:o,disabled:i,style:{width:32,height:32,margin:16,paddingVertical:1,paddingHorizontal:4},children:Object(h.jsx)(l.d,{size:24,color:w.a[r].iconColor,name:"arrow-back"})})}):null}(i,c,e,r,t)},headerRight:function(){return Object(h.jsx)(V.a,{})},headerLeftContainerStyle:{backgroundColor:w.a[r].header,borderBottomWidth:1,borderColor:w.a[r].headerBottomColor},cardStyle:[{flexShrink:1},x],animationEnabled:"portrait"==e,cardStyleInterpolator:o.a.forHorizontalIOS}},children:[j.map((function(e){var t=i()(e,2),n=t[0],r=t[1];return Object(h.jsx)(X.Screen,{name:n,component:r.component,options:{title:d(r.title)}},n)})),Object(h.jsx)(X.Screen,{name:"NotFound",component:g,options:{title:"Oops!"}})]})})})})]})})}):Object(h.jsx)(h.Fragment,{})}},246:function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return p}));var r=n(9),i=n.n(r),c=n(68),o=n.n(c),a=(n(0),n(249)),s=n(39),l=n(250),u=n(105),d=n(10),b=["style","lightColor","darkColor"],j=["style","lightColor","darkColor"];function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function h(e,t){var n=Object(u.a)(),r=e[n];return r||l.a[n][t]}function g(e){var t=e.style,n=e.lightColor,r=e.darkColor,i=o()(e,b),c=h({light:n,dark:r},"text");return Object(d.jsx)(a.a,O({style:[{color:c},t]},i))}function p(e){var t=e.style,n=e.lightColor,r=e.darkColor,i=o()(e,j),c=h({light:n,dark:r},"background");return Object(d.jsx)(s.a,O({style:[{backgroundColor:c},t]},i))}},250:function(e,t,n){"use strict";t.a={light:{text:"#000",background:"#fff",tint:"#2f95dc",tabIconDefault:"#ccc",tabIconSelected:"#2f95dc",hoverColor:"rgb(242,242,242)",buttonBackgroundColor:"#f6f8fa",header:"#f6f8fa",headerBottomColor:"rgb(216, 216, 216)",buttonBorderColor:"rgba(27,31,36,0.15)",iconColor:"black"},dark:{text:"#fff",background:"#000",tint:"#fff",tabIconDefault:"#ccc",tabIconSelected:"#fff",hoverColor:"#010409",buttonBackgroundColor:"#010409",header:"#010409",headerBottomColor:"rgb(40, 40, 40)",buttonBorderColor:"rgba(229,225,220,0.15)",iconColor:"white"},borderColor:"#d0d7de",focus:"#0065A4"}},255:function(e,t,n){"use strict";n.d(t,"a",(function(){return f}));var r=n(9),i=n.n(r),c=n(16),o=n.n(c),a=n(0),s=n(498),l=n(261),u=n(10);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var j=Object(a.createContext)({setModal:function(){}}),f=function(e){var t=e.children,n=e.modals,r=Object(a.useState)([]),i=o()(r,2),c=i[0],d=i[1],f=Object(l.b)(),O=Object(a.useState)("none"),h=o()(O,2),g=h[0],p=h[1];return Object(a.useEffect)((function(){0==c.filter((function(e){return e.visible})).length&&p("landscape"==f?"fade":"slide")}),[f]),Object(a.useEffect)((function(){d(n.map((function(e){return{Component:e,props:null,visible:!1}})))}),[n]),Object(u.jsxs)(j.Provider,{value:{setModal:function(e,t){var n=c.map((function(n){return null==e||n.Component!=e?b(b({},n),{},{visible:!1}):n.Component==e?{Component:e,props:null!==t?t:n.props,visible:null!==t}:n}));d(n)}},children:[t,c.map((function(e,t){var n=e.Component,r=e.props,i=e.visible;return Object(u.jsx)(s.a,{animationType:g,visible:i,transparent:!0,children:Object(u.jsx)(n,b({},r))},t)}))]})};t.b=function(){return Object(a.useContext)(j)}},261:function(e,t,n){"use strict";n.d(t,"a",(function(){return j})),n.d(t,"b",(function(){return f}));var r=n(16),i=n.n(r),c=n(0),o=n(40),a=n(304),s=n(136),l=n.n(s),u=n(10),d=function(e){return e.height>=e.width?"portrait":"landscape"},b=Object(c.createContext)(d(o.a.get("window"))),j=function(e){var t=e.children,n=l()(),r=Object(a.a)(),o=r.width,s=r.height,j=Object(c.useState)(d({width:o,height:s})),f=i()(j,2),O=f[0],h=f[1];return Object(c.useEffect)((function(){h(d({width:o,height:s}))}),[o,s]),Object(u.jsx)(b.Provider,{value:n.isMobile()?"portrait":O,children:t})};function f(){return Object(c.useContext)(b)}},262:function(e,t,n){"use strict";var r=n(9),i=n.n(r),c=n(16),o=n.n(c),a=n(0),s=n(249),l=n(29),u=n(350),d=n(250),b=n(105),j=n(10);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h=function(e){var t=Object(a.useState)(!1),n=o()(t,2),r=n[0],i=n[1];return Object(j.jsx)(u.a,{onPress:function(){return e.onPress()},onHoverIn:function(){return i(!0)},onHoverOut:function(){return i(!1)},disabled:e.disabled,style:[{paddingVertical:5,paddingHorizontal:16},e.style,r||e.disabled?{backgroundColor:e.color,borderColor:e.borderColor}:{}],children:e.children?e.children:Object(j.jsx)(s.a,{selectable:!1,style:[{fontSize:14},e.textStyle],children:e.title})})};t.a=function(e){var t=Object(b.a)(),n=O(O({color:d.a[t].hoverColor,borderColor:"light"==t?d.a[t].buttonBorderColor:"#7d8590"},e),{},{style:[g.style,{backgroundColor:d.a[t].buttonBackgroundColor,borderColor:d.a[t].buttonBorderColor},e.style],textStyle:[g.text,{color:d.a[t].text},e.textStyle]});return Object(j.jsx)(h,O({},n))};var g=l.a.create({style:{borderRadius:6,borderWidth:1},text:{textAlign:"center",fontWeight:"600"}})},287:function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));n(0);var r=n(298),i=n(261),c=n(10);t.b=function(e){var t=Object(i.b)();return Object(c.jsx)(r.a,{autoScale:!0,outerContainerStyle:{flex:1,alignSelf:"center",backgroundColor:"#8888",flexShrink:1,width:"100%"},containerStyle:{flex:1,margin:0,justifyContent:"center",alignItems:"center"},bodyStyle:"landscape"==t?{width:"90%",height:"90%",padding:"5%"}:{width:"100%",height:"100%",maxWidth:1080},children:e.children})};var o=function(e){return Object(c.jsx)(r.a,{autoScale:!0,outerContainerStyle:{flex:1,alignSelf:"center",backgroundColor:"#8888",width:"100%"},containerStyle:{flex:1,margin:0,justifyContent:"flex-end"},children:e.children})}},293:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(9),i=n.n(r),c=(n(0),n(687)),o=n(10),a=function(e,t,n){return Math.floor(e%(n-t)+t)},s=function(e){var t=function(e,t){for(var n=t||0,r=0;r<e.length;r++)n=e.charCodeAt(r)+((n<<5)-n);return n=Math.abs(n),"hsl("+a(n,0,360)+", "+a(n,0,100)+"%, "+a(n,25,75)+"%)"}(e.name,e.userId);return Object(o.jsx)(c.a.Text,{style:{backgroundColor:t},size:e.size,label:e.name.split(" ").map((function(e){return e[0]})).join().toUpperCase()})};function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e,t){var n,r=e.name;return e.member_count<3&&(n=1==e.member_count||(null==t?void 0:t.id)==e.subowner.id?e.owner:e.subowner,r=r.length>0?r:n.name),{avatar:n,name:r}}t.b=function(e){return Object(o.jsx)(s,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e))}},298:function(e,t,n){"use strict";n.d(t,"a",(function(){return s}));n(0);var r=n(246),i=n(29),c=n(250),o=n(264),a=n(10);function s(e){var t=Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(r.a,{style:[l.title,e.titleStyle],children:e.title}),Object(a.jsx)(r.a,{style:l.subtitle,children:e.subtitle})]});return Object(a.jsx)(r.b,{style:[l.outerContainer,e.autoScale?{}:l.outerContainerFill,e.outerContainerStyle],children:Object(a.jsxs)(r.b,{style:[l.container,e.containerStyle],children:[e.withSeparator?Object(a.jsx)(r.b,{style:l.separator,lightColor:"#ddd",darkColor:"rgba(255,255,255, 0.3)"}):void 0,e.title?e.titleOnPress?Object(a.jsx)(o.c,{onPress:e.titleOnPress,style:l.titleView,children:t}):Object(a.jsx)(r.b,{style:l.titleView,children:t}):void 0,Object(a.jsx)(r.b,{style:[l.bodyView,e.bodyStyle],children:e.children})]})})}var l=i.a.create({outerContainer:{alignItems:"stretch",backgroundColor:"transparent"},outerContainerFill:{width:"100%",maxWidth:1080},container:{marginHorizontal:20,marginVertical:10,backgroundColor:"transparent"},titleView:{width:"100%",flexDirection:"row",backgroundColor:"transparent",marginBottom:5},title:{flex:1,fontSize:16},subtitle:{flex:1,fontSize:12,textAlign:"right",marginTop:4},separator:{marginBottom:0,height:1,width:"100%"},bodyView:{width:"100%",padding:20,alignItems:"center",justifyContent:"center",borderWidth:1,borderColor:c.a.borderColor,borderRadius:6}})},305:function(e,t,n){"use strict";n.d(t,"a",(function(){return O})),n.d(t,"c",(function(){return h})),n.d(t,"b",(function(){return g}));var r=n(9),i=n.n(r),c=n(44),o=n.n(c),a=n(4),s=n.n(a),l=n(0),u=n(70),d=n(71),b=n(326);function j(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?j(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):j(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function O(e,t){var n=Object(u.useQueryClient)(),r=Object(b.c)().lastJsonMessage,i=Object(u.useQuery)(["ChannelList",e],s()((function*(){var n;return yield Object(d.d)(e,null==t||null==(n=t.user)?void 0:n.id)}))).data;return Object(l.useEffect)((function(){if(null!=r&&("enter"==r.type&&n.setQueryData(["ChannelList",e],(function(e){return(null!=e&&e.find((function(e){return e.id==r.data.id}))?e:[r.data].concat(o()(e||[]))).sort((function(e,t){return e.id-t.id}))})),"next_message"==r.type)){var t=r.data;n.setQueryData(["ChannelList",e],(function(e){return(e||[]).map((function(e){var n;return e.id==t.channel?f(f({},e),{},{last_message:{content:null==(n=t.message_set[0])?void 0:n.content,created:t.created}}):e}))}))}}),[r]),i}function h(e,t){var n=O(e,t);return null==n?void 0:n.sort((function(e,t){var n,r;return((null==(n=e.last_message)?void 0:n.created)||"")<((null==(r=t.last_message)?void 0:r.created)||"")?1:-1}))}function g(e){var t=Object(u.useQueryClient)(),n=Object(u.useMutation)(d.q,{onSuccess:function(){return t.invalidateQueries(["ChannelList",e])}}),r=Object(u.useMutation)(d.u,{onSuccess:function(){return t.invalidateQueries(["ChannelList",e])}}),i=Object(u.useMutation)(d.r,{onSuccess:function(){return t.invalidateQueries(["ChannelList",e])}});return{create:n.mutateAsync,update:r.mutateAsync,direct:i.mutateAsync}}},313:function(e,t,n){"use strict";var r=n(0),i=n(337);t.a=function(e,t){var n=Object(i.useNavigation)();Object(r.useEffect)((function(){var t=function(t){t.preventDefault(),e()};return n.addListener("beforeRemove",t),function(){n.removeListener("beforeRemove",t)}}),t)}},325:function(e,t,n){"use strict";n.r(t),function(e){n.d(t,"navigate",(function(){return v})),n.d(t,"default",(function(){return C}));var r=n(16),i=n.n(r),c=n(0),o=n(461),a=n(96),s=n(497),l=n(689),u=n(600),d=n(115),b=n(593),j=n(599),f=n(261),O=n(755),h=n(495),g=n(866),p=n(1163),y=n(10);Object(s.enableScreens)();var x,m=c.createRef();function v(e,t){var n,r;t&&(null==(n=m.current)||n.navigate(e,t)),null==(r=m.current)||r.navigate(e)}try{var w,S;x=null==(w=e)||null==(S=w.versions)?void 0:S.electron}catch(_){x=void 0}function C(){var e=Object(o.a)(),t=Object(a.useColorScheme)(),n="no-preference"==t?e:t;return Object(y.jsx)(l.a,{ref:m,documentTitle:{formatter:function(e,t){return"TOKKI TOK"}},linking:x?void 0:g.a,theme:"dark"===n?u.a:d.a,children:Object(y.jsx)(f.a,{children:Object(y.jsx)(k,{})})})}var P=Object(b.a)();function k(){var e=Object(f.b)();return Object(O.a)(),Object(y.jsxs)(P.Navigator,{mode:"modal",headerMode:"screen",screenOptions:{cardStyle:{backgroundColor:"white"},animationEnabled:!0,cardStyleInterpolator:j.a.forVerticalIOS},children:[Object(y.jsx)(P.Screen,{name:"Main",component:p.a,options:{headerShown:!1}}),Object.entries(h.c).map((function(t){var n=i()(t,2),r=n[0],c=n[1];return Object(y.jsx)(P.Screen,{name:r,component:c.component,options:{title:c.title,gestureDirection:"landscape"==e?"vertical-inverted":"vertical"}},r)}))]})}Object(O.b)(window.location);var D=["setNativeProps","useNativeDriver"],E=console.warn;console.warn=function(e){var t=!0;(e instanceof Object||D.some((function(t){return e.includes(t)})))&&(t=!1),t&&E(e)}}.call(this,n(116))},326:function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return O}));var r=n(16),i=n.n(r),c=n(0),o=n(756),a=n.n(o),s=n(73),l=n(38),u=n(413),d=n(10),b={lastJsonMessage:void 0,sendJsonMessage:function(){}},j=Object(c.createContext)(b),f=function(e){var t=e.children,n=e.path,r=e.Context,o=e.useBackground,j=Object(c.useState)(null),f=i()(j,2),O=f[0],h=f[1],g=Object(c.useState)(o||"active"==u.a.currentState),p=i()(g,2),y=p[0],x=p[1],m=a()(s.f+"/"+n,{shouldReconnect:function(e){return!0},protocols:O?["Authorization",O]:void 0,onOpen:function(e){console.log("success websocket connection("+n+")")},onClose:function(e){console.log("closed websocket connection("+n+")")}},y&&null!=O),v=m.lastJsonMessage,w=m.sendJsonMessage;return Object(c.useEffect)((function(){l.a.getItem("Authorization").then(h);var e=u.a.addEventListener("change",(function(e){return x(o||"active"==e)}));return function(){return e.remove()}}),[]),Object(d.jsx)(r.Provider,{value:null!=O?{lastJsonMessage:v,sendJsonMessage:w}:b,children:t})},O=function(e){var t=e.disable,n=e.children;return t?Object(d.jsx)(d.Fragment,{children:n}):Object(d.jsx)(f,{path:"messenger/ws/",Context:j,children:n})};t.c=function(){return Object(c.useContext)(j)}},340:function(e,t,n){"use strict";n.d(t,"a",(function(){return l})),n.d(t,"b",(function(){return u}));var r=n(4),i=n.n(r),c=n(70),o=n(71),a=n(104);function s(e){var t=function(e){var t;return Object(c.useQuery)(["People",null==e||null==(t=e.user)?void 0:t.id],i()((function*(){var t;if(null!=e&&null!=(t=e.user)&&t.id){var n=yield Object(o.d)("people",e.user.id);if(null===n)return;return 0===n.length?(yield Object(o.q)({type:"people",owner:e.user.id,name:""})).id:n[0].id}}))).data}(e),n=Object(c.useQuery)(["PeopleList",t],i()((function*(){return t?yield Object(o.j)(t):[]}))).data;return{peopleId:t,peopleList:n}}function l(e){var t=s(e).peopleList;return null==t?void 0:t.map((function(e){return e.user}))}function u(){var e=s(Object(a.b)().auth),t=e.peopleId,n=e.peopleList,r=Object(c.useQueryClient)(),l=Object(c.useMutation)(function(){var e=i()((function*(e){var n=e.user_ids;t&&(yield Object(o.p)({channel_id:t,user_ids:n}))}));return function(t){return e.apply(this,arguments)}}(),{onSuccess:function(e,t){r.invalidateQueries("PeopleList")}}),u=Object(c.useMutation)(function(){var e=i()((function*(e){var t,r=null==n||null==(t=n.find((function(t){return t.user.id===e})))?void 0:t.id;r&&(yield Object(o.b)(r))}));return function(t){return e.apply(this,arguments)}}(),{onSuccess:function(){r.invalidateQueries("PeopleList")}});return{create:l.mutateAsync,delete:u.mutateAsync}}},359:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n(4),i=n.n(r),c=n(70),o=n(71);function a(e){return Object(c.useQuery)(["MessengerMemberList",e],i()((function*(){return yield Object(o.h)(e)}))).data}function s(){var e=Object(c.useQueryClient)(),t=Object(c.useMutation)(o.p,{onSuccess:function(){e.invalidateQueries("MessengerMemberList")}}),n=Object(c.useMutation)(o.b,{onSuccess:function(){e.invalidateQueries("ChannelList"),e.invalidateQueries("MessengerMemberList")}});return{invite:t.mutateAsync,leave:n.mutateAsync}}},381:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));n(0);var r=n(579),i=n(104),c=n(340),o=n(305),a=n(262),s=n(325),l=n(255),u=n(246),d=n(91),b=n(108),j=n(264),f=n(250),O=n(105),h=n(287),g=n(313),p=n(402),y=n(444),x=n(10);function m(e){var t,n,v=e.id,w=Object(d.b)().lang,S=Object(O.a)(),C=Object(i.b)().auth,P=Object(l.b)().setModal,k=Object(c.a)(C),D=Object(c.b)(),E=Object(y.b)(v),_=C.user&&E&&(null==(t=C.user)?void 0:t.id)==(null==E?void 0:E.id),M=void 0===(null==k?void 0:k.find((function(e){return e.id===(null==E?void 0:E.id)}))),z=Object(o.b)("messenger"),R=function(){P(m,null)};return Object(g.a)(R,[]),E?Object(x.jsxs)(h.a,{children:[Object(x.jsxs)(u.b,{style:{flexDirection:"row",width:"100%"},children:[Object(x.jsx)(u.b,{style:{flex:1,flexDirection:"row"},children:Object(x.jsx)(j.c,{onPress:R,children:Object(x.jsx)(b.d,{size:20,name:"arrow-back",color:f.a[S].text})})}),Object(x.jsx)(u.b,{style:{flex:1},children:Object(x.jsx)(u.a,{style:{fontSize:20,textAlign:"center"},children:w("profile")})}),Object(x.jsx)(u.b,{style:{flex:1}})]}),Object(x.jsx)(u.b,{style:{marginBottom:20,height:1,width:"100%"},lightColor:"#ddd",darkColor:"rgba(255,255,255, 0.3)"}),Object(x.jsx)(r.a,{username:E.username,name:E.name,userId:E.id}),_&&!(null!=(n=C.user)&&n.is_guest)&&Object(x.jsx)(a.a,{title:w("Account Settings"),onPress:function(){P(p.a,{})}}),Object(x.jsx)(a.a,{title:w(_?"Chat with me":"1:1 Chat"),onPress:function(){var e;if(null!=C&&null!=(e=C.user)&&e.id){var t,n={name:"",type:"messenger",owner:null==C||null==(t=C.user)?void 0:t.id,subowner:_?void 0:E.id};z.direct(n).then((function(e){return Object(s.navigate)("Main",{screen:"ChatScreen",params:{id:e.id}})}))}}}),!_&&(M?Object(x.jsx)(a.a,{title:w("Add people"),onPress:function(){return D.create({user_ids:[v]}).then(R)}}):Object(x.jsx)(a.a,{title:w("Delete people"),onPress:function(){return D.delete(v).then(R)}}))]}):Object(x.jsx)(x.Fragment,{})}},382:function(e,t,n){"use strict";var r=n(9),i=n.n(r),c=(n(0),n(29)),o=n(262),a=n(10);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.a=function(e){return Object(a.jsx)(o.a,l(l({},e),{},{style:[u.style,e.style]}))};var u=c.a.create({style:{borderRadius:6,backgroundColor:"transparent",borderWidth:0}})},383:function(e,t,n){"use strict";n.d(t,"a",(function(){return m}));var r=n(16),i=n.n(r),c=n(0),o=n(29),a=n(292),s=n(246),l=n(262),u=n(104),d=n(325),b=n(305),j=n(581),f=n(255),O=n(91),h=n(287),g=n(359),p=n(293),y=n(313),x=n(10);function m(e){var t=e.id,n=e.member_id,r=e.type,o=Object(O.b)().lang,w=Object(u.b)().auth,S=Object(f.b)().setModal,C=Object(b.a)(r,w),P=Object(b.b)(r),k=Object(g.b)(),D=null==C?void 0:C.find((function(e){return e.id==t})),E="messenger"==r?o(t?"Chat Setting":"New chat"):"",_=Object(c.useState)(""),M=i()(_,2),z=M[0],R=M[1],T=Object(c.useState)(""),I=i()(T,2),L=I[0],B=I[1],A=function(){S(m,null)};return Object(c.useEffect)((function(){if(D){var e=Object(p.a)(D,w.user).name;R(e),B((null==D?void 0:D.description)||"")}}),[null==D?void 0:D.id]),Object(y.a)(A,[]),Object(x.jsx)(h.b,{children:Object(x.jsxs)(s.b,{style:{justifyContent:"space-between",flex:1,width:"100%"},children:[Object(x.jsxs)(s.b,{style:{width:"100%"},children:[Object(x.jsx)(s.a,{style:{fontSize:20},children:E}),Object(x.jsx)(s.b,{style:v.separator,lightColor:"#ddd",darkColor:"rgba(255,255,255, 0.3)"})]}),Object(x.jsxs)(a.a,{style:{width:"100%",flexGrow:1,maxHeight:"80%"},children:[Object(x.jsx)(j.a,{name:o("Channel Name"),value:z,setValue:R,width:"60%"}),Object(x.jsx)(j.a,{name:o("Description"),value:L,setValue:B,multiline:!0,width:"60%"})]}),Object(x.jsxs)(s.b,{style:{width:"100%",flexDirection:"row"},children:[n&&Object(x.jsx)(s.b,{style:{flexDirection:"row",justifyContent:"flex-start"},children:Object(x.jsx)(l.a,{title:o("leave"),style:{marginHorizontal:5},textStyle:{color:"red"},onPress:function(){return k.leave(n).then(A)}})}),Object(x.jsxs)(s.b,{style:{flex:1,flexDirection:"row",justifyContent:"flex-end"},children:[Object(x.jsx)(l.a,{title:o("save"),onPress:function(){var e;if(null!=w&&null!=(e=w.user)&&e.id){var n,i={id:t,name:z,description:L,type:r,owner:null==w||null==(n=w.user)?void 0:n.id};(t?P.update(i):P.create(i)).then((function(e){return Object(d.navigate)("Main",{screen:"ChatScreen",params:{id:e.id}})}))}}}),Object(x.jsx)(l.a,{title:o("cancel"),style:{marginHorizontal:5},onPress:A})]})]})]})})}var v=o.a.create({field:{width:"50%",flexDirection:"row",padding:10},separator:{marginBottom:20,height:1,width:"100%"}})},402:function(e,t,n){"use strict";n.d(t,"a",(function(){return x}));var r=n(16),i=n.n(r),c=n(0),o=n(29),a=n(91),s=n(70),l=n(71),u=n(104);var d=n(287),b=n(255),j=n(246),f=n(443),O=n(262),h=n(580),g=n(444),p=n(10),y=function(e){var t=Object(a.b)().lang;return e.message?Object(p.jsx)(j.b,{style:m.form_error,children:Object(p.jsx)(j.a,{style:m.form_error_text,children:t(e.message)})}):Object(p.jsx)(p.Fragment,{})};function x(){var e=Object(a.b)().lang,t=Object(u.b)().auth,n=Object(b.b)().setModal,r=Object(c.useState)(""),o=i()(r,2),v=o[0],w=o[1],S=Object(c.useState)(""),C=i()(S,2),P=C[0],k=C[1],D=Object(c.useState)(""),E=i()(D,2),_=E[0],M=E[1],z=Object(c.useState)(""),R=i()(z,2),T=R[0],I=R[1],L=Object(c.useState)(!1),B=i()(L,2),A=(B[0],B[1],Object(c.useState)({})),H=i()(A,2),W=H[0],V=H[1],F=Object(g.a)(v),Q=function(){var e=Object(u.b)(),t=e.auth,n=e.dispatch,r=Object(s.useMutation)(l.t,{onSuccess:function(){}}),i=Object(s.useMutation)(l.o,{onSuccess:function(e,r){var i;r.id==(null==(i=t.user)?void 0:i.id)&&(r.username&&r.password?n({type:"LOGIN_REQUEST",username:r.username,password:r.password}):n({type:"REFRESH"}))}}),c=Object(s.useMutation)(l.c,{onSuccess:function(e,r){var i;r==(null==(i=t.user)?void 0:i.id)&&n({type:"LOGOUT_REQUEST"})}});return{create:r.mutateAsync,update:i.mutateAsync,delete:c.mutateAsync}}(),N=t.user,G=N&&!1===N.is_guest;Object(c.useEffect)((function(){N&&(w(N.username),k(N.name))}),[null==N?void 0:N.id]);var U=function(){n(x,null)};return Object(p.jsx)(d.b,{children:Object(p.jsxs)(j.b,{style:{justifyContent:"space-between",flex:1,width:"100%"},children:[Object(p.jsxs)(j.b,{style:{flex:1,width:"100%"},children:[Object(p.jsx)(j.a,{style:{fontSize:20},children:e(G?"Edit User":"Create User")}),Object(p.jsx)(j.b,{style:m.separator,lightColor:"#ddd",darkColor:"rgba(255,255,255, 0.3)"}),Object(p.jsxs)(f.a,{name:e("Username"),width:"60%",children:[G?Object(p.jsx)(j.a,{style:{fontSize:16},children:v}):Object(p.jsx)(h.a,{value:v,setValue:function(e){return w(e)},keyboardType:"email-address"}),Object(p.jsx)(y,{message:W.username})]}),Object(p.jsxs)(f.a,{name:e("Name"),width:"60%",children:[Object(p.jsx)(h.a,{value:P,setValue:function(e){return k(e)}}),Object(p.jsx)(y,{message:W.name})]}),Object(p.jsxs)(f.a,{name:e("Password"),width:"60%",children:[Object(p.jsx)(h.a,{value:_,secureTextEntry:!0,setValue:function(e){return M(e)}}),Object(p.jsx)(y,{message:W.password})]}),Object(p.jsxs)(f.a,{name:e("Check Password"),width:"60%",children:[Object(p.jsx)(h.a,{value:T,secureTextEntry:!0,setValue:function(e){return I(e)}}),Object(p.jsx)(y,{message:W.checkPassword})]})]}),Object(p.jsxs)(j.b,{style:{width:"100%",flexDirection:"row"},children:[(null==N?void 0:N.id)&&Object(p.jsx)(j.b,{style:{flexDirection:"row",justifyContent:"flex-start"},children:Object(p.jsx)(O.a,{title:e("delete account"),style:{marginHorizontal:5},textStyle:{color:"red"},onPress:function(){return Q.delete(N.id).then(U)}})}),Object(p.jsxs)(j.b,{style:{flex:1,flexDirection:"row",justifyContent:"flex-end"},children:[Object(p.jsx)(O.a,{title:e("save"),onPress:function(){var e={};((null==F?void 0:F.length)||0)>0&&!G&&(e.username="The username is already in use."),(v.length<10||v.length>64)&&(e.username="Set 10-64 characters."),(P.length<1||P.length>64)&&(e.name="Set 1-64 characters."),/^(?=.*[A-Za-z])(?=.*\d)(?=.*[@$!%*#?&])[A-Za-z\d@$!%*#?&]{10,64}$/.test(_)||G&&0==_.length||(e.password="Set 10-64 characters with a combination of letters/numbers/valid special characters."),_!=T&&(e.checkPassword="Incorrect between password and check password."),Object.keys(e).length>0?V(e):null!=N&&N.id&&Q.update({id:null==N?void 0:N.id,name:P,username:G?void 0:v,is_guest:!1,password:_.length>0?_:void 0}).then(U)}}),Object(p.jsx)(O.a,{title:e("cancel"),style:{marginHorizontal:5},onPress:U})]})]})]})})}var m=o.a.create({form_error:{height:22,width:"100%"},form_error_text:{textAlignVertical:"center",color:"red",fontSize:13},separator:{marginBottom:20,height:1,width:"100%"}})},430:function(e,t,n){"use strict";n.d(t,"a",(function(){return g})),n.d(t,"b",(function(){return p}));var r=n(4),i=n.n(r),c=n(44),o=n.n(c),a=n(9),s=n.n(a),l=n(0),u=n(70),d=n(71),b=n(326),j=n(431);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h=function(e,t){var n=0;e.forEach((function(e){n!=t.length&&(e.current.forEach((function(e){n!=t.length&&e.id==t[n].id&&(e.timer=t[n].timer,e.is_archive=t[n].is_archive,n+=1)})),e.current=e.current.filter((function(e){return!e.is_archive})))}))};function g(e){var t=Object(u.useQueryClient)(),n=Object(u.useInfiniteQuery)(["MessengerContentList",e],function(){var t=i()((function*(t){var n=t.pageParam;return Object(d.g)(e,n).then((function(e){return{current:e}}))}));return function(e){return t.apply(this,arguments)}}(),{select:function(e){return e.pages.length>1&&(e.pages[e.pages.length-2].next=e.pages[e.pages.length-1]),e},getNextPageParam:function(e){return null!=e&&e.current.length?e.current[e.current.length-1].id:void 0},refetchOnReconnect:!1,refetchOnWindowFocus:function(n){var r=new Date(n.state.dataUpdatedAt).toISOString(),i=O({},n.state.data);return Object(d.i)(e,r).then((function(n){if(i.pages){var r=i.pages[0].current[0].id||0,c=n.filter((function(e){return e.id>r&&0==e.is_archive})),a=n.filter((function(e){return e.id<=r})),s=c.findIndex((function(e){return e.timer}))>=0||a.length>0;i.pages[0].current=[].concat(o()(c),o()(i.pages[0].current)),h(i.pages,a),s&&t.invalidateQueries(["TimerMessageContentList",e])}})),!1}}),r=n.data,c=n.fetchNextPage,a=Object(b.c)().lastJsonMessage;return Object(l.useEffect)((function(){null!=a&&a.data.channel==e&&("next_message"==a.type&&t.setQueryData(["MessengerContentList",e],(function(e){return null!=e&&e.pages[0].current&&(null==e?void 0:e.pages[0].current[0].id)!=a.data.id&&(e.pages[0].current=[a.data].concat(o()(null==e?void 0:e.pages[0].current))),O({},e||{pages:[],pageParams:[]})})),"update_message"==a.type&&t.setQueryData(["MessengerContentList",e],(function(e){return(null==e?void 0:e.pages)&&h(e.pages,[a.data]),O({},e||{pages:[],pageParams:[]})})))}),[a]),{data:r,fetchNextPage:c}}function p(e){var t=Object(j.b)().dispatch,n=Object(u.useMutation)((function(e){return Object(d.s)(e,t)}),{onSuccess:function(){}}),r=Object(u.useMutation)(d.n);return{create:n.mutate,patch:r.mutate}}},431:function(e,t,n){"use strict";n.d(t,"a",(function(){return O})),n.d(t,"b",(function(){return h}));var r=n(16),i=n.n(r),c=n(9),o=n.n(c),a=n(44),s=n.n(a),l=n(0),u=n(10);function d(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function b(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?d(Object(n),!0).forEach((function(t){o()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):d(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var j=Object(l.createContext)({upload:{},dispatch:function(){}}),f=function(e,t){var n=s()(e[t.channel]||[]),r=n.findIndex((function(e){return e.filename==t.filename}));return r>=0?n[r]={filename:t.filename,progress:t.progress}:n.push({filename:t.filename,progress:t.progress}),b(b({},e),{},o()({},t.channel,n.filter((function(e){return(e.progress||0)<1}))))},O=function(e){var t=e.children,n=Object(l.useReducer)(f,{}),r=i()(n,2),c=r[0],o=r[1];return Object(u.jsx)(j.Provider,{value:{upload:c,dispatch:o},children:t})};function h(){return Object(l.useContext)(j)}},443:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));var r=n(0),i=n(246),c=n(261),o=n(10);function a(e){var t=Object(c.b)(),n=Object(r.useMemo)((function(){return"landscape"==t?{flexDirection:"row",alignItems:"center",justifyContent:"space-between"}:{flexDirection:"column",alignItems:"flex-start"}}),[t]);return Object(o.jsxs)(i.b,{style:[{paddingVertical:"landscape"==t?15:5,width:"100%"},n],children:[Object(o.jsx)(i.a,{style:["landscape"==t?{flex:1}:{width:"100%"},{paddingHorizontal:15,fontSize:16},e.textStyle],children:e.name}),Object(o.jsx)(i.b,{style:["landscape"==t?{flex:6}:{width:"100%"},{paddingHorizontal:15}],children:Object(o.jsx)(i.b,{style:{width:e.width},children:e.children})})]})}},444:function(e,t,n){"use strict";n.d(t,"a",(function(){return a})),n.d(t,"b",(function(){return s}));var r=n(4),i=n.n(r),c=n(70),o=n(71);function a(e){return Object(c.useQuery)(["UserList",e],i()((function*(){return e?yield Object(o.f)(e):[]}))).data}function s(e){return Object(c.useQuery)(["UserList",e],i()((function*(){return yield Object(o.e)(e)}))).data}},445:function(e,t,n){"use strict";var r=n(9),i=n.n(r),c=n(16),o=n.n(c),a=n(44),s=n.n(a),l=(n(0),n(14)),u=n(1172),d=n(1162),b=n(1170),j=n(250),f=n(105),O=n(91),h=n(10);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.a=function(e){var t=Object(O.b)().lang,n=e.index||0,r=Object(f.a)(),c=Object.entries(e.tabs),a=e.onTab,g=Object.assign.apply(Object,[{}].concat(s()(c.map((function(e){var t=o()(e,2),n=t[0],r=t[1];return i()({},n,r.icon)})))));return Object(h.jsx)(u.a,{renderTabBar:function(e){return Object(h.jsx)(d.a,p(p({},e),{},{indicatorStyle:{backgroundColor:"#2196F3"},style:{backgroundColor:j.a[r].background},labelStyle:{whiteSpace:"nowrap"},activeColor:j.a[r].text,inactiveColor:j.a[r].text,renderIcon:function(e){return g[e.route.key]},onTabPress:function(e){return null==a?void 0:a(c.findIndex((function(t){var n=o()(t,2),r=n[0];n[1];return r==e.route.key})))}}))},navigationState:{index:n,routes:c.map((function(e){var n=o()(e,2),r=n[0],i=n[1];return{key:r,title:t(i.title)}}))},onIndexChange:function(e){null==a||a(e)},onSwipeStart:function(){if("web"===l.a.OS&&window.getSelection){var e=window.getSelection();null==e||e.removeAllRanges()}},renderScene:Object(b.a)(Object.assign.apply(Object,[{}].concat(s()(c.map((function(e){var t=o()(e,2),n=t[0],r=t[1];return i()({},n,r.component)})))))),tabBarPosition:e.tabBarPosition})}},447:function(e,t,n){"use strict";n.d(t,"a",(function(){return d}));var r=n(16),i=n.n(r),c=n(0),o=n(246),a=n(29),s=n(350),l=n(250),u=n(10);function d(e){var t=c.useState(!1),n=i()(t,2),r=n[0],a=n[1];return Object(u.jsx)(s.a,{style:[b.outerContainer,e.outerContainerStyle,r?{backgroundColor:"rgb(242,242,242)"}:{}],onPressIn:function(){return a(!0)},onPress:function(){return null==e.onPress?void 0:e.onPress()},onPressOut:function(){return a(!1)},children:Object(u.jsx)(o.b,{style:[b.container,e.containerStyle],children:Object(u.jsx)(o.b,{style:[b.bodyView,e.bodyStyle],children:Object(u.jsx)(u.Fragment,{children:e.children})})})})}var b=a.a.create({outerContainer:{width:"100%",maxWidth:1080,alignItems:"stretch"},container:{marginHorizontal:20,backgroundColor:"transparent"},bodyView:{width:"100%",padding:10,minHeight:40,alignItems:"center",justifyContent:"center",borderBottomWidth:1,borderColor:l.a.borderColor,backgroundColor:"transparent"}})},448:function(e,t,n){"use strict";var r=n(9),i=n.n(r),c=n(44),o=n.n(c),a=(n(0),n(382)),s=n(104),l=n(261),u=n(39),d=n(255),b=n(584),j=n(91),f=n(105),O=n(250),h=n(10);function g(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function p(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?g(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):g(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.a=function(e){var t=Object(j.b)().lang,n=Object(f.a)(),r=Object(s.b)(),i=r.auth,c=r.dispatch,g=Object(d.b)().setModal,y=Object(l.b)(),x=[{title:t("sign out"),onPress:function(){var e;null!=i&&null!=(e=i.user)&&e.is_guest?g(b.a,{type:"GUEST_LOGOUT"}):c({type:"LOGOUT_REQUEST"})}}],m=(e.extra?[].concat(o()(e.extra),x):x).filter((function(e){return e.windowType==y||void 0==e.windowType}));return Object(h.jsx)(u.a,{style:{flexDirection:"row"},children:m.map((function(e,t){return Object(h.jsx)(a.a,p(p({},e),{},{textStyle:{color:O.a[n].text},color:"#gray"}),t)}))})}},450:function(e,t,n){"use strict";n.d(t,"a",(function(){return O}));var r=n(44),i=n.n(r),c=n(0),o=n(246),a=n(104),s=n(340),l=n(262),u=n(255),d=n(91),b=n(287),j=n(501),f=n(10);function O(){var e=Object(d.b)().lang,t=Object(c.useRef)(new Set),n=Object(a.b)().auth,r=Object(s.a)(n),h=Object(s.b)(),g=Object(c.useMemo)((function(){var e=new Set(null==r?void 0:r.map((function(e){return e.id})));return function(t){return!e.has(t.id)}}),[r]),p=Object(u.b)().setModal,y=function(){p(O,null)};return Object(f.jsx)(b.b,{children:Object(f.jsxs)(o.b,{style:{flex:1,width:"100%"},children:[Object(f.jsxs)(o.b,{style:{width:"100%"},children:[Object(f.jsx)(o.a,{style:{fontSize:20},children:e("Add people")}),Object(f.jsx)(o.b,{style:{marginBottom:20,height:1,width:"100%"},lightColor:"#ddd",darkColor:"rgba(255,255,255, 0.3)"})]}),Object(f.jsx)(j.a,{selectedRef:t,userFilter:g,isChannel:!1}),Object(f.jsxs)(o.b,{style:[{width:"100%",flexDirection:"row",padding:10},{justifyContent:"flex-end"}],children:[Object(f.jsx)(l.a,{title:e("add"),onPress:function(){h.create({user_ids:i()(t.current)}).then(y)}}),Object(f.jsx)(l.a,{title:e("cancel"),onPress:y})]})]})})}},495:function(e,t,n){"use strict";n.d(t,"b",(function(){return Qe})),n.d(t,"a",(function(){return Ne})),n.d(t,"c",(function(){return Ge}));var r=n(16),i=n.n(r),c=n(0),o=n.n(c),a=n(249),s=n(297),l=n(263),u=n(39),d=n(29),b=n(104),j=n(91),f=n(312),O=n(14),h=n(264),g=n(108),p=n(250),y=n(10),x="web"==O.a.OS?function(e){location.href=e}:f.a.openURL,m=function(e){return Object(y.jsxs)(u.a,{style:v.footer_buttons,children:[Object(y.jsx)(l.a,{style:v.footer_button,onPress:function(){return x("https://github.com/blacktokki/tokki-tok")},children:Object(y.jsx)(g.a,{name:"github",size:24,color:p.a[e.theme].iconColor})}),Object(y.jsx)(l.a,{style:v.footer_button,onPress:function(){return f.a.openURL("mailto:ydh051541@naver.com")},children:Object(y.jsx)(g.a,{name:"mail",size:24,color:p.a[e.theme].iconColor})})]})},v=d.a.create({footer_buttons:{width:"100%",flexDirection:"row",justifyContent:"flex-end",paddingBottom:20,paddingRight:20},footer_button:{alignItems:"center",justifyContent:"center",width:38,height:38,marginHorizontal:12,borderWidth:1,borderColor:"#E7E7E7",borderRadius:60}});var w=d.a.create({login_container:{flex:1,backgroundColor:"#FFF"},login_header:{alignItems:"center",paddingTop:30,paddingBottom:50,backgroundColor:"#208AEC"},login_header_logo:{width:220,resizeMode:"contain"},login_header_text:{marginTop:15,color:"#f0f0f0",fontSize:16},login_header_text_bold:{color:"#fff",fontWeight:"bold"},login_wrapper:{flex:1,justifyContent:"space-between",paddingTop:40,borderTopRightRadius:12,borderTopLeftRadius:12,backgroundColor:"#fff",alignItems:"center"},form:{width:"100%",maxWidth:320},form_error:{height:22,width:"100%"},form_error_text:{textAlignVertical:"center",color:"red",fontSize:13},form_input:{height:44,paddingHorizontal:20,marginBottom:20,backgroundColor:"#EDF0F7",borderRadius:50},button:{alignItems:"center",justifyContent:"center",height:44,backgroundColor:"#0065A4",borderRadius:50},button_label:{color:"#fff",fontSize:16},login_social:{width:"100%",maxWidth:280,marginTop:20},login_social_separator:{flexDirection:"row",alignItems:"center"},login_social_separator_line:{flex:1,width:"100%",height:1,backgroundColor:"#E0E0E0"},login_social_separator_text:{marginHorizontal:10,color:"#808080",fontSize:16},login_social_buttons:{flexDirection:"row",justifyContent:"center",marginTop:20},login_social_button:{alignItems:"center",justifyContent:"center",width:60,height:60,marginHorizontal:12,borderWidth:1,borderColor:"#E7E7E7",borderRadius:60},login_social_icon:{width:38,height:38,resizeMode:"contain"},login_social_facebook:{backgroundColor:"#4267B2",borderColor:"#4267B2"},login_footer_text:{flexDirection:"row",alignItems:"center",color:"#808080",fontSize:14},guest_footer_text:{flexDirection:"row",alignSelf:"center",color:"#808080",fontSize:15,margin:15},login_footer_link:{color:"#208AEC",fontSize:15,fontWeight:"bold"}});var S=n(44),C=n.n(S),P=n(246),k=n(326),D=Object(c.createContext)({lastJsonMessage:void 0,sendJsonMessage:function(){}}),E=function(e){var t=e.disable,n=e.children;return t?Object(y.jsx)(y.Fragment,{}):Object(y.jsx)(k.a,{path:"messenger/ws/rtc/",Context:D,useBackground:!0,children:n})},_=function(){return Object(c.useContext)(D)},M=n(377),z=n(4),R=n.n(z),T=n(353),I=n(73);console.log(I.c?"use turn server":"use stun server");var L={iceServers:[I.c?JSON.parse(I.c):{urls:"stun:stun.l.google.com:19302"}]},B={mandatory:{OfferToReceiveAudio:!0,OfferToReceiveVideo:!0,VoiceActivityDetection:!0}},A={audio:!0,video:{framerate:30}},H=function(e,t){var n=t.data.rtcMessage,r=new T.a(n);e&&(console.log("ICE candidate Added"),e.addIceCandidate(r))},W=function(e,t,n,r){e.candidate&&t({type:"ICEcandidate",receiver:n,data:{target:r,rtcMessage:e.candidate}})},V=function(){var e=R()((function*(e,t,n,r,i){n&&e.pc.addStream(n);var c=function(e){var t=e.sdp.split("\r\n");return t.forEach((function(e,n){/^a=fmtp:\d*/.test(e)?t[n]=e+";x-google-max-bitrate=8000;x-google-min-bitrate=8000;x-google-start-bitrate=8000":/^a=mid:(0|video)/.test(e)&&(t[n]+="\r\nb=AS:8000")})),new T.c({type:e.type,sdp:t.join("\r\n")})}(yield e.pc.createOffer(B));yield e.pc.setLocalDescription(c),t({type:"call",receiver:e.receiver,data:{target:r,name:null==i?void 0:i.name,rtcMessage:c}})}));return function(t,n,r,i,c){return e.apply(this,arguments)}}(),F=d.a.create({container:{flex:1},cam:{flex:1,height:"100%"},bottonContainer:{position:"absolute",bottom:0,justifyContent:"flex-end"},buttonBar:{flexDirection:"row",justifyContent:"space-around"},label:{backgroundColor:"#0008",color:"white",paddingHorizontal:5}}),Q=function(e){var t,n=_(),r=n.lastJsonMessage,s=function(e){var t=Object(c.useRef)({}),n=Object(c.useState)(),r=i()(n,2),a=r[0],s=r[1],l=Object(c.useState)(),u=i()(l,2),d=u[0],b=u[1],j=Object(c.useMemo)((function(){return!!d}),[d]),f=Object(c.useCallback)(o.a.memo((function(e){var t=e.style;return d?Object(y.jsx)(T.d,{stream:d,style:t,videoProps:{height:"100%"}}):Object(y.jsx)(y.Fragment,{})})),[d]);return{start:Object(c.useCallback)(function(){var n=R()((function*(n,r,c){if(console.log("start"),!d||void 0!==c)try{var o;o="camera"==c?yield T.e.getUserMedia(A):"display"==c?yield T.e.getDisplayMedia(A):r||(yield T.e.getUserMedia(A).catch((function(e){return T.e.getDisplayMedia(A)}))),b(o),Object.entries(t.current).map((function(t){var r=i()(t,2),c=(r[0],r[1]);V(c,e,o,"guest",n)}))}catch(a){console.error(a)}}));return function(e,t,r){return n.apply(this,arguments)}}(),[d]),stop:Object(c.useCallback)((function(){console.log("stop"),d&&(d.getTracks().map((function(e){return e.stop()})),b(void 0))}),[d]),websocketOnMessage:function(){var n=R()((function*(n,r){var i=n.type;if("connection"==i&&s(n.data.channel_name),"start"==i&&"host"==n.data.target){console.log("1 start");var c=new T.b(L);c.addEventListener("icecandidate",(function(t){return W(t,e,n.sender,"guest")})),t.current[n.sender]={pc:c,receiver:n.sender},V(t.current[n.sender],e,d,"guest",r)}if("answer"==i&&"host"==n.data.target){console.log("3 answer");var o=t.current[n.sender].pc,a=new T.c(n.data.rtcMessage);yield o.setRemoteDescription(a)}if("ICEcandidate"==i&&"host"==n.data.target){var l=t.current[n.sender].pc;H(l,n)}}));return function(e,t){return n.apply(this,arguments)}}(),CustomRTCView:f,isPlay:j,sender:a}}(n.sendJsonMessage),l=s.start,d=s.stop,b=s.websocketOnMessage,j=s.CustomRTCView,f=s.isPlay;return Object(c.useEffect)((function(){e.user&&r&&b(r,e.user)}),[r,e.user]),Object(c.useEffect)((function(){return e.mode&&!f?e.user&&l(e.user,void 0,e.mode):null===e.mode&&f&&d(),function(){f&&d()}}),[f,e.user,e.mode]),Object(y.jsxs)(u.a,{style:F.container,children:[Object(y.jsx)(j,{style:F.cam}),Object(y.jsxs)(u.a,{style:F.bottonContainer,children:[Object(y.jsx)(u.a,{style:F.buttonBar}),Object(y.jsx)(u.a,{style:{flexDirection:"row"},children:Object(y.jsx)(a.a,{style:F.label,children:null==(t=e.user)?void 0:t.name})}),Object(y.jsxs)(u.a,{style:F.buttonBar,children:[void 0===e.mode&&!f&&Object(y.jsx)(M.a,{title:"Start",onPress:function(){return e.user&&l(e.user)}}),void 0===e.mode&&f&&Object(y.jsx)(M.a,{title:"Stop",onPress:d})]})]})]})},N=function(e){var t=Object(c.useState)(""),n=i()(t,2),r=n[0],l=n[1],d=_(),b=d.lastJsonMessage,j=function(e){var t=Object(c.useRef)({}),n=Object(c.useState)(),r=i()(n,2),a=r[0],s=r[1],l=Object(c.useState)(),u=i()(l,2),d=u[0],b=u[1],j=Object(c.useCallback)(o.a.memo((function(e){return d?Object(y.jsx)(T.d,{stream:d,style:e,videoProps:{height:"100%"}}):Object(y.jsx)(y.Fragment,{})})),[d]),f=Object(c.useMemo)((function(){return!!d}),[d]),O=Object(c.useCallback)((function(n){console.log("start"),t.current.pc||(t.current.pc=new T.b(L),t.current.receiver=n),d||e({type:"start",receiver:n,data:{target:"host"}})}),[d]),h=function(){console.log("stop"),t.current.pc&&(b(void 0),t.current.pc.close(),t.current.pc=void 0,t.current.receiver=void 0,clearInterval(t.current.statsInterval))};return{start:O,stop:h,websocketOnMessage:function(){var n=R()((function*(n){var r,i,c,o,l=n.type;if("start"==l&&"guest"==n.data.target&&n.sender==(null==(r=t.current)?void 0:r.receiver)){console.log("(remote)1 start");var u=t.current.pc;s({name:n.data.name}),u.addEventListener("icecandidate",(function(t){return W(t,e,n.sender,"host")})),u.addEventListener("iceconnectionstatechange",(function(e){if("connected"==t.current.pc.iceConnectionState){var n=!1;t.current.statsInterval=setInterval(R()((function*(){var e=yield t.current.pc.getStats(null),r="",i=void 0;e.forEach((function(e){"inbound-rtp"===e.type&&"video"===e.kind&&(Object.keys(e).forEach((function(t){r+=t+": "+e[t]+"\n"})),i=e.framesPerSecond)})),console.log(n,i),void 0!=i?n=!0:n&&h(),console.log((new Date).toTimeString().split(" ")[0],r)})),1e3)}else"failed"==t.current.pc.iceConnectionState&&h()})),u.addTransceiver("video",{direction:"recvonly"}),yield V({pc:t.current.pc,receiver:n.sender},e,d,"host",a)}if("answer"==l&&"guest"==n.data.target&&n.sender==(null==(i=t.current)?void 0:i.receiver)){console.log("(remote)3 answer");var j=new T.c(n.data.rtcMessage);yield t.current.pc.setRemoteDescription(j);var f=t.current.pc.getRemoteStreams();b(f[f.length-1]),e({type:"end",receiver:t.current.receiver,data:{}})}if("call"==l&&n.sender==(null==(c=t.current)?void 0:c.receiver)){console.log("2 call");var O=t.current.pc;if(s({name:n.data.name}),!O)return;O.addEventListener("icecandidate",(function(t){return W(t,e,n.sender,"host")}));var g=new T.c(n.data.rtcMessage);yield O.setRemoteDescription(g);var p=yield O.createAnswer(B);yield O.setLocalDescription(p),e({type:"answer",receiver:t.current.receiver,data:{target:"host",rtcMessage:O.localDescription}});var y=t.current.pc.getRemoteStreams();b(y[y.length-1])}"ICEcandidate"==l&&"guest"==n.data.target&&n.sender==(null==(o=t.current)?void 0:o.receiver)&&H(t.current.pc,n)}));return function(e){return n.apply(this,arguments)}}(),CustomRTCView:j,user:a,isPlay:f}}(d.sendJsonMessage),f=j.start,O=j.stop,h=j.websocketOnMessage,g=j.CustomRTCView,p=j.isPlay,x=j.user;return Object(c.useEffect)((function(){b&&h(b)}),[b]),Object(c.useEffect)((function(){return e.receiver&&f(e.receiver),function(){return O()}}),[e.receiver]),Object(y.jsxs)(u.a,{style:F.container,children:[Object(y.jsx)(g,{style:F.cam}),Object(y.jsxs)(u.a,{style:F.bottonContainer,children:[Object(y.jsx)(u.a,{style:F.buttonBar}),Object(y.jsx)(u.a,{style:{flexDirection:"row"},children:e.receiver||p?Object(y.jsx)(a.a,{style:F.label,children:(null==x?void 0:x.name)||"loading..."}):Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(a.a,{style:{borderWidth:1},children:"Receiver:\xa0"}),Object(y.jsx)(s.a,{style:{borderWidth:1,flex:1},value:r,onChangeText:l})]})}),Object(y.jsxs)(u.a,{style:F.buttonBar,children:[void 0===e.receiver&&!p&&Object(y.jsx)(M.a,{title:"Start",onPress:function(){return f(r)}}),void 0===e.receiver&&p&&Object(y.jsx)(M.a,{title:"Stop",onPress:O})]})]})]})},G=n(261),U=n(262),J=n(112),Y=function(e){return Object(y.jsx)(u.a,{style:[{maxWidth:e.scale,maxHeight:e.scale,borderWidth:1,borderColor:p.a.borderColor,backgroundColor:"gray",flexDirection:"row",flexGrow:1},void 0==e.focusGuest||e.focusGuest==e.receiver?{height:"100%"}:{maxWidth:0,height:0}],children:Object(y.jsx)(h.c,{style:{flex:1},containerStyle:{flex:1,justifyContent:"center"},onPress:function(){return e.setFocusGuest(e.focusGuest?void 0:e.receiver)},children:e.children})})},K=function(e){var t,n=e.channel_id,r=e.disable,o=e.setDisable,a=Object(b.b)().auth,s=Object(J.a)(),l=Object(c.useState)(null),d=i()(l,2),j=d[0],f=d[1],O=Object(c.useState)([]),h=i()(O,2),x=h[0],m=h[1],v=Object(c.useState)(),w=i()(v,2),S=w[0],k=w[1],D=Object(G.b)(),E=_(),M=E.lastJsonMessage,z=E.sendJsonMessage;Object(c.useEffect)((function(){if(null!=M&&("connection"==M.type&&z({type:"broadcast",data:{channel_id:n}}),"broadcast_guest"!=M.type&&"broadcast_host"!=M.type||m([].concat(C()(x),[M.sender])),"broadcast_disconnect"==M.type)){var e=M.sender;x.find((function(t){return t==e}))&&m(x.filter((function(t){return t!=e})))}}),[M]);var R=S?"100%":100/Math.max(2,Math.ceil(Math.sqrt(x.length+1)))+"%",T=function(e){f(j!=e?e:null)};return void 0!==M?Object(y.jsxs)(P.b,{style:[{aspectRatio:r?0:16/9,borderColor:p.a.borderColor,borderRadius:10},"landscape"==D?{flexShrink:1,flexGrow:0,height:"100%",borderLeftWidth:1,paddingBottom:65}:{maxHeight:"36%",width:"100%",borderBottomWidth:1}],children:[Object(y.jsxs)(u.a,{style:{aspectRatio:S?void 0:16/9,backgroundColor:"white",flexWrap:"wrap",flexDirection:"row",width:"100%",height:"100%"},children:[x.map((function(e,t){return Object(y.jsx)(Y,{scale:R,focusGuest:S,setFocusGuest:k,receiver:e,children:Object(y.jsx)(N,{receiver:e})})})),Object(y.jsx)(Y,{scale:R,focusGuest:S,setFocusGuest:k,receiver:null==(t=a.user)?void 0:t.name,children:Object(y.jsx)(Q,{user:a.user,mode:j})})]}),Object(y.jsxs)(P.b,{style:[{position:"absolute",alignItems:"center",justifyContent:"flex-end",width:"100%",flexDirection:"row"},"landscape"==D?{bottom:0,paddingTop:15,paddingBottom:10,paddingHorizontal:19}:{backgroundColor:"transparent"}],children:[Object(y.jsx)(U.a,{title:"\u23fa\ufe0f",style:{height:40,paddingTop:8},onPress:function(){return T("camera")}}),!s&&Object(y.jsx)(U.a,{title:"\ud83d\udda5\ufe0f",style:{height:40,paddingTop:8},onPress:function(){return T("display")}}),Object(y.jsx)(U.a,{title:"",style:{height:40,paddingTop:8},onPress:function(){return o(!0)},children:Object(y.jsx)(g.d,{size:20,name:"arrow-back",color:"deepskyblue"})})]})]}):Object(y.jsx)(y.Fragment,{})},q=o.a.memo((function(e){var t=e.channel_id,n=e.disable,r=e.setDisable;return Object(y.jsx)(E,{disable:n,children:Object(y.jsx)(K,{channel_id:t,disable:n,setDisable:r})})})),$=n(430),Z=n(105),X=n(548),ee=n(690),te=n(431),ne=function(e){return Object(y.jsxs)(u.a,{style:{backgroundColor:"lightgray",borderRadius:20,overflow:"hidden",margin:5},children:[Object(y.jsx)(u.a,{style:{backgroundColor:"darkgray",position:"absolute",width:100*(e.data.progress||0)+"%",height:"100%"}}),Object(y.jsxs)(u.a,{style:{paddingVertical:5,paddingHorizontal:5,flexDirection:"row"},children:[Object(y.jsx)(P.a,{children:"\ud83d\udce4"}),Object(y.jsx)(u.a,{style:{paddingHorizontal:5},children:Object(y.jsx)(P.a,{children:e.data.filename})})]})]})},re=function(e){var t=Object(te.b)().upload,n=Object(c.useState)(),r=i()(n,2),o=r[0],a=r[1],s=t[e.channel_id];return Object(y.jsx)(u.a,{style:{flexDirection:"row",paddingTop:5,paddingHorizontal:((null==s?void 0:s.length)||0)>0?20:0},children:null==s?void 0:s.map((function(e,t){return Object(y.jsx)(ne,{data:e,index:t,isExpand:t==o,setExpand:a},t)}))})},ie=n(688),ce=n(1161),oe=n(863),ae=function(e){return Object(y.jsx)(ce.a,{tinymceScriptSrc:"/tokki-tok/tinymce/tinymce.min.js",onInit:function(t,n){null==e.onReady||e.onReady()},onEditorChange:e.setValue,init:{setup:oe.setup,plugins:oe.plugins,toolbar:oe.toolbar,height:"100%",skin:"light"==e.theme?"oxide":"oxide-dark",content_css:"light"==e.theme?"default":"dark",menubar:!1,branding:!1,statusbar:!1,block_formats:"\uc81c\ubaa91=h2;\uc81c\ubaa92=h3;\uc81c\ubaa93=h4;\ubcf8\ubb38=p;",fontsize_formats:"11pt 14pt 18pt 24pt"},value:e.value})},se=function(e){var t=Object(c.useState)(!1),n=i()(t,2),r=n[0],o=n[1];return Object(c.useEffect)((function(){e.active||o(!1)}),[e.active]),e.active?Object(y.jsxs)(u.a,{style:{flex:1,height:"100%"},children:[!r&&e.children,Object(y.jsx)(ae,{theme:e.theme,value:e.value,setValue:e.setValue,onReady:function(){r||(o(!0),null==e.onReady||e.onReady())}})]}):Object(y.jsx)(y.Fragment,{children:e.children})},le=n(255);var ue=function(e){var t=e.channel_id,n=e.isEditor,r=e.setIsEditor,o=e.style,a=e.extraButtons,s=Object(Z.a)(),l=Object(G.b)(),d=Object(j.b)().lang,f=Object(J.a)(),x=Object(b.b)().auth,m=Object(le.b)().setModal,v=Object(c.useRef)(null),w=Object(c.useState)(""),S=i()(w,2),C=S[0],k=S[1],D=Object(c.useState)(""),E=i()(D,2),_=E[0],M=E[1],z=Object(c.useState)(),R=i()(z,2),T=R[0],I=R[1],L=Object(c.useState)(),B=i()(L,2),A=B[0],H=B[1],W=Object(c.useState)(!1),V=i()(W,2),F=V[0],Q=V[1],N=Object(c.useState)(null),Y=i()(N,2),K=Y[0],q=Y[1],te=Object(c.useMemo)((function(){return F?1:C.split("\n").length}),[C,F]),ne=Object($.b)(),ce=function(){if(C.length>0){var e,i;if(n)ne.create({channel:t,user:null==(e=x.user)?void 0:e.id,content:"",timer:T,editor:{title:C,content:_}});else ne.create({channel:t,user:null==(i=x.user)?void 0:i.id,content:C,timer:T});I(void 0),Q(!1),k(""),q(!0),n&&(M(""),r(!1))}};return Object(c.useEffect)((function(){A&&(r(!1),k(C.concat(C.length>0?"\n":"",A.value)),M(_.concat("\r\n",A.editorValue)),H(void 0),r(!0))}),[A,C,_]),Object(c.useEffect)((function(){K&&(null==v.current.focus||v.current.focus(),q(!1))}),[K]),Object(y.jsxs)(u.a,{style:o,children:[Object(y.jsx)(ie.a,{channel_id:t,auth:x,reverse:!0,sendToScreen:H}),Object(y.jsxs)(u.a,{style:{position:"absolute",flexDirection:"row"},children:[Object(y.jsx)(re,{channel_id:t}),Object(y.jsx)(ee.a,{channel_id:t})]}),Object(y.jsxs)(P.b,{style:[{bottom:0,width:"100%",paddingTop:15,paddingBottom:10,paddingHorizontal:19},n?{height:"landscape"==l?"50%":"100%"}:{}],children:[Object(y.jsxs)(u.a,{style:{alignItems:"center",width:"100%",flexDirection:"row"},children:[Object(y.jsx)(U.a,{title:"",style:{height:"100%",paddingTop:8,borderTopRightRadius:0,borderBottomRightRadius:0,justifyContent:"center"},onPress:function(){n?r(!1):Q(!F)},children:Object(y.jsx)(u.a,{style:{top:-2},children:Object(y.jsx)(g.b,{name:n||F?"cross":"plus",size:24,color:p.a[s].text})})}),T&&Object(y.jsx)(U.a,{style:{height:"100%",paddingTop:8,borderRadius:0},title:"\u231a"+Object(ee.b)(T),onPress:function(){m(X.a,{datetime:T,callback:function(e){return I(e)}}),Q(!1)}}),Object(y.jsx)(h.b,{ref:v,value:C,onChangeText:k,onKeyPress:function(e){if(!f){var t=e;t.shiftKey||"Enter"!==t.key||(ce(),t.preventDefault())}},style:{flex:1,borderWidth:1,minHeight:41,borderColor:p.a.borderColor,backgroundColor:p.a[s].background,color:p.a[s].text,paddingVertical:1,paddingHorizontal:3},onFocus:function(){return Q(!1)},multiline:!0,numberOfLines:te}),Object(y.jsx)(U.a,{style:{height:"100%",paddingTop:8,borderTopLeftRadius:0,borderBottomLeftRadius:0,justifyContent:"center"},title:"\ud83d\udcac",onPress:ce})]}),Object(y.jsx)(se,{theme:s,active:n,value:_,setValue:M,onReady:function(){return Q(!1)}}),F&&Object(y.jsxs)(u.a,{style:{alignItems:"center",width:"100%",flexDirection:"row",paddingTop:15,paddingBottom:5},children:[Object(y.jsx)(U.a,{style:{height:80,flex:1,justifyContent:"center",marginRight:15},title:"\ud83d\udce4\n "+d("File"),onPress:function(){return new Promise((function(e,t){if("web"==O.a.OS){var n=document.createElement("input");n.type="file",n.onchange=function(t){e(t.target.files[0])},n.onabort=t,n.onerror=t,n.click()}else e(void 0)})).then((function(e){var n;ne.create({channel:t,user:null==(n=x.user)?void 0:n.id,content:"",file:e}),Q(!1)}))}}),Object(y.jsx)(U.a,{style:{height:80,flex:1,justifyContent:"center",marginRight:15},title:"\u270f\ufe0f\n "+d("Editor"),onPress:function(){r(!n),n&&Q(!1)}}),Object(y.jsx)(U.a,{style:{height:80,flex:1,justifyContent:"center",marginRight:15},title:"\u231a\n "+d("Timer"),onPress:function(){m(X.a,{datetime:T,callback:function(e){return I(e)}}),Q(!1)}}),null==a?void 0:a.map((function(e,t){return Object(y.jsx)(U.a,{style:{height:80,flex:1,justifyContent:"center",marginRight:15},title:e.title,onPress:function(){e.onPress(),Q(!1)},disabled:e.disabled},t)}))]})]})]})},de=n(359),be=n(305),je=n(293),fe=n(501),Oe=n(448),he=n(383);var ge=n(9),pe=n.n(ge),ye=n(292),xe=n(304),me=n(442),ve=n(445),we=n(382),Se=n(340),Ce=n(447),Pe=n(583),ke=n(381),De=n(325),Ee=n(298),_e=n(96),Me=n(585),ze=n(402),Re=function(e){var t=e.title,n=e.children,r=Object(Z.a)(),i=p.a[r].text;return Object(y.jsxs)(Ee.a,{bodyStyle:{alignItems:"flex-start",backgroundColor:"light"==r?"transparent":"black"},children:[Object(y.jsx)(a.a,{style:{fontSize:20,color:i,fontWeight:"600"},children:t}),n]})},Te=function(){var e,t=Object(j.b)(),n=t.lang,r=t.locale,c=t.setLocale,o=Object(le.b)().setModal,a=Object(b.b)().auth,s=Object(Z.a)(),l=Object(_e.useColorScheme)(),d=Object(Me.b)(),f=d.enable,O=d.setEnable,h=p.a[s].text;return Object(y.jsxs)(y.Fragment,{children:[Object(y.jsx)(Re,{title:n("* Notification Settings"),children:Object(y.jsx)(u.a,{style:{flexDirection:"row"},children:[[n("On"),!0],[n("Off"),!1]].map((function(e){var t=i()(e,2),n=t[0],r=t[1];return Object(y.jsx)(we.a,{title:n||"",textStyle:{fontSize:16,color:h,textDecorationLine:f==r?"underline":"none"},style:{borderRadius:20},onPress:function(){O(r)}},n)}))})}),Object(y.jsx)(Re,{title:n("* Language Settings"),children:Object(y.jsx)(u.a,{style:{flexDirection:"row"},children:[[n("Auto"),"auto"],["\ud55c\uad6d\uc5b4","ko"],["English","en"]].map((function(e){var t=i()(e,2),n=t[0],o=t[1];return Object(y.jsx)(we.a,{title:n||"",textStyle:{fontSize:16,color:h,textDecorationLine:r==o?"underline":"none"},style:{borderRadius:20},onPress:function(){return c(o)}},n)}))})}),Object(y.jsx)(Re,{title:n("* Skin Settings"),children:Object(y.jsx)(u.a,{style:{flexDirection:"row"},children:[[n("Auto"),"no-preference"],[n("Light"),"light"],[n("Dark"),"dark"]].map((function(e){var t=i()(e,2),n=t[0],r=t[1];return Object(y.jsx)(we.a,{title:n,textStyle:{fontSize:16,color:h,textDecorationLine:l==r?"underline":"none"},style:{borderRadius:20},onPress:function(){return Object(Z.b)(r)}},n)}))})}),!(null!=(e=a.user)&&e.is_guest)&&Object(y.jsx)(Ee.a,{bodyStyle:{alignItems:"flex-start",backgroundColor:"light"==s?"transparent":"black"},children:Object(y.jsx)(we.a,{title:n("Account Settings"),textStyle:{fontSize:20,color:h},style:{paddingLeft:0,borderRadius:20},onPress:function(){return o(ze.a,{})}})})]})},Ie=n(228),Le=n(450);function Be(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ae(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Be(Object(n),!0).forEach((function(t){pe()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Be(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var He=function(){var e=Object(b.b)().auth,t=Object(Z.a)(),n=Object(le.b)().setModal,r=Object(Se.a)(e),i=o.a.useMemo((function(){return r&&r.map((function(e,t){return Object(y.jsx)(Pe.a,{member:e,onPress:function(){return n(ke.a,{id:e.id})}},t)}))}),[r]);return Object(y.jsx)(ye.a,{style:{flex:1,backgroundColor:p.a[t].background},children:i})},We=function(){var e=Object(b.b)().auth,t=Object(be.c)("messenger",e),n=Object(Z.a)(),r=(new Date).toISOString().slice(0,10);return Object(y.jsx)(ye.a,{style:{flex:1,backgroundColor:p.a[n].background},children:null==t?void 0:t.map((function(t,i){var c,o,a,s,l=Object(je.a)(t,e.user),d=l.avatar,b=l.name,j=null==(c=t.last_message)?void 0:c.created.slice(0,10),f=(null==(o=t.last_message)?void 0:o.preview_content)||(null==(a=t.last_message)?void 0:a.content)||"";return Object(y.jsxs)(Ce.a,{bodyStyle:{flexDirection:"row",justifyContent:"space-between"},onPress:function(){return Object(De.navigate)("ChatScreen",{id:t.id})},children:[Object(y.jsxs)(u.a,{style:{flexDirection:"row",flexShrink:1},children:[d?Object(y.jsx)(u.a,{style:{marginRight:20},children:Object(y.jsx)(je.b,{name:d.name,size:44,userId:d.id})}):Object(y.jsx)(g.c,{size:40,color:p.a[n].iconColor,style:{marginBottom:-3,marginRight:20},name:"users"}),Object(y.jsxs)(u.a,{children:[Object(y.jsxs)(u.a,{style:{flexDirection:"row"},children:[Object(y.jsx)(P.a,{style:{fontSize:18},children:b}),"messenger"==t.type&&Object(y.jsx)(P.a,{style:{fontSize:18,opacity:.4,paddingLeft:5},children:t.member_count})]}),Object(y.jsx)(P.a,{style:{fontSize:16,opacity:.4},children:f.replaceAll("\n"," ")})]})]}),Object(y.jsxs)(u.a,{children:[Object(y.jsx)(P.a,{style:{fontSize:14,opacity:.4,textAlign:"right"},children:j==r?null==(s=t.last_message)?void 0:s.created.slice(11,16):j}),Object(y.jsx)(P.a,{style:{fontSize:14,textAlign:"right"},children:t.unread_count?t.unread_count:" "})]})]},i)}))})},Ve=function(){var e=Object(Z.a)();return Object(y.jsx)(ye.a,{style:{flex:1,backgroundColor:p.a[e].background},children:Object(y.jsx)(Te,{})})},Fe=function(e,t){var n,r,i=p.a[e].iconColor;return{OneTab:{title:"people",component:(n=He,r=t,function(e){return Object(y.jsx)(u.a,{style:{flex:1},ref:r,children:Object(y.jsx)(n,Ae({},e))})}),icon:Object(y.jsx)(g.e,{size:32,color:i,style:{marginBottom:-3},name:"account"})},TwoTab:{title:"chat",component:We,icon:Object(y.jsx)(g.d,{size:30,color:i,style:{marginBottom:-3},name:"chatbox"})},FourTab:{title:"config",component:Ve,icon:Object(y.jsx)(g.f,{size:30,color:i,style:{marginBottom:-3},name:"options"})}}};var Qe={HomeScreen:{title:"home",component:function(e){var t,n=e.navigation,r=e.route,o=Object(j.b)(),a=o.lang,s=o.locale,l=Object(G.b)(),d=Object(Z.a)(),f=Object(le.b)().setModal,O=(Object(b.b)().auth,Object(c.useState)("landscape"==l)),h=i()(O,2),g=h[0],x=h[1],v=p.a[d].text,w=[{title:a("people"),headerRight:function(){return Object(y.jsx)(Oe.a,{extra:[{title:a("create"),onPress:function(){return f(Le.a,{})}}]})}},{title:a("chat"),headerRight:function(){return Object(y.jsx)(Oe.a,{extra:[{title:a("create"),onPress:function(){return f(he.a,{type:"messenger"})}}]})}},{title:a("config"),headerRight:function(){return Object(y.jsx)(Oe.a,{})}}],S=function(e){var t=Object(c.useRef)(),n=Object(c.useRef)(),r=Object(xe.a)().width,i=Object(Ie.useNavigation)();return Object(c.useEffect)((function(){return function(){clearInterval(t.current)}}),[]),function(c){clearInterval(t.current),t.current=setInterval((function(){null==c||c.measure((function(t,c,o,a,s,l){var u=Math.round(-s/r);n.current!=u&&(n.current=u,i.setOptions(e[u]))}))}),300)}}(w);return Object(c.useLayoutEffect)((function(){var e,t=0|(null==r||null==(e=r.params)?void 0:e.tab);n.setOptions("portrait"==l?w[t]:{title:a("home"),headerRight:function(){return Object(y.jsx)(Oe.a,{})}})}),[n,r,l,s]),Object(c.useEffect)((function(){x("landscape"==l)}),[l]),g?Object(y.jsxs)(ye.a,{contentContainerStyle:{flex:1,alignItems:"center"},children:[Object(y.jsxs)(u.a,{style:{flexGrow:1,width:"80%",marginTop:72},children:[Object(y.jsx)(me.a,{style:{fontSize:32,color:v},children:"Tokki Tok"}),Object(y.jsx)(u.a,{style:{backgroundColor:p.a.borderColor,height:1,width:"100%"}}),Object(y.jsx)(u.a,{style:{height:24}}),Object(y.jsx)(Ee.a,{bodyStyle:{alignItems:"flex-start",backgroundColor:"light"==d?"transparent":"black"},children:Object(y.jsx)(we.a,{title:a("+ New chat"),textStyle:{fontSize:20,color:v},style:{paddingLeft:0,borderRadius:20},onPress:function(){return f(he.a,{type:"messenger"})}})}),Object(y.jsx)(Te,{})]}),Object(y.jsx)(m,{theme:d})]}):Object(y.jsx)(ve.a,{tabs:Fe(d,S),tabBarPosition:"bottom",index:parseInt((null==(t=r.params)?void 0:t.tab)||0),onTab:function(e){n.setParams({tab:e})}})},path:"home"},ChatScreen:{title:"chat",component:function(e){var t,n=e.navigation,r=e.route,o=null==r||null==(t=r.params)?void 0:t.id,a=Object(G.b)(),s=Object(j.b)().lang,l=Object(c.useState)(!1),d=i()(l,2),f=d[0],O=d[1],h=Object(c.useState)(!1),g=i()(h,2),p=g[0],x=g[1];return function(e,t,n,r,i){var o=Object(j.b)(),a=o.lang,s=o.locale,l=Object(b.b)().auth,u=Object(le.b)().setModal,d=Object(G.b)(),f=Object(be.a)(r,l),O=null==f?void 0:f.find((function(e){return e.id==parseInt(n)})),h=O?Object(je.a)(O,l.user):void 0,g=Object(de.a)(n),p=Object(c.useMemo)((function(){var e;return null==g||null==(e=g.find((function(e){var t;return e.user==(null==(t=l.user)?void 0:t.id)})))?void 0:e.id}),[l,g]);Object(c.useLayoutEffect)((function(){e.setOptions({headerRight:function(){return Object(y.jsx)(Oe.a,{extra:"messenger"==(null==O?void 0:O.type)?[{title:a("invite"),onPress:function(){return u(fe.b,{id:n})}},{title:a("setting"),onPress:function(){return u(he.a,{id:n,type:null==O?void 0:O.type,member_id:p})}}]:[{title:a("setting"),onPress:function(){return u(he.a,{id:n,type:null==O?void 0:O.type,member_id:p})}}]})},title:null==h?void 0:h.name,headerShown:!("portrait"==d&&i)})}),[e,t,p,s,d,i,O]);var x=function(){e.canGoBack()?e.goBack():e.navigate("HomeScreen",{tab:2})};Object(c.useEffect)((function(){u(null,null),n||x()}),[t]),Object(c.useEffect)((function(){(null===g||void 0!=g&&void 0==g.find((function(e){var t;return e.user==(null==(t=l.user)?void 0:t.id)})))&&x()}),[g]),Object(c.useEffect)((function(){(null===f||void 0!=f&&void 0==O)&&x()}),[f])}(n,r,o,"messenger",f),Object(y.jsxs)(u.a,{style:[{flex:1,alignItems:"center"},"landscape"==a?{flexDirection:"row-reverse",minWidth:480}:{flexDirection:"column"}],children:[Object(y.jsx)(q,{channel_id:o,setDisable:function(e){return x(!e)},disable:!p}),Object(y.jsx)(ue,{channel_id:o,isEditor:f,setIsEditor:O,style:[p?{flexShrink:1}:{flex:1},"landscape"==a?{minWidth:320,height:"100%"}:{width:"100%"}],extraButtons:[{title:"\ud83d\udcf9\n "+s("Video Call"),onPress:function(){return x(!p)},disabled:p}]})]})},path:"chat"}},Ne={LoginScreen:{path:"login",title:"Sign in",component:function(e){var t=e.navigation,n=(e.route,Object(j.b)().lang),r=Object(c.useState)(""),o=i()(r,2),d=o[0],f=o[1],O=Object(c.useState)(""),h=i()(O,2),g=h[0],p=h[1],x=Object(b.b)(),v=x.error,S=x.dispatch,C=function(){return S({type:"LOGIN_REQUEST",username:d,password:g})};return Object(c.useEffect)((function(){t.setOptions({headerRight:void 0})}),[t]),Object(y.jsxs)(u.a,{style:w.login_container,children:[Object(y.jsxs)(u.a,{style:w.login_wrapper,children:[Object(y.jsxs)(u.a,{style:w.form,children:[v&&Object(y.jsx)(u.a,{style:w.form_error,children:Object(y.jsx)(a.a,{style:w.form_error_text,children:n(v)})}),Object(y.jsx)(s.a,{style:w.form_input,value:d,placeholder:n("Username"),onChangeText:function(e){return f(e)},autoCapitalize:"none",keyboardType:"email-address",onSubmitEditing:C}),Object(y.jsx)(s.a,{style:w.form_input,value:g,placeholder:n("Password"),secureTextEntry:!0,onChangeText:function(e){return p(e)},onSubmitEditing:C}),Object(y.jsx)(l.a,{onPress:C,children:Object(y.jsx)(u.a,{style:w.button,children:Object(y.jsx)(a.a,{style:w.button_label,children:n("Sign in")})})}),Object(y.jsx)(l.a,{onPress:function(){return S({type:"LOGIN_GUEST"})},children:Object(y.jsx)(a.a,{style:w.guest_footer_text,children:n("Sign in as guest")})})]}),Object(y.jsxs)(u.a,{style:w.login_social,children:[Object(y.jsxs)(u.a,{style:w.login_social_separator,children:[Object(y.jsx)(u.a,{style:w.login_social_separator_line}),Object(y.jsx)(a.a,{style:w.login_social_separator_text,children:"*"}),Object(y.jsx)(u.a,{style:w.login_social_separator_line})]}),Object(y.jsx)(u.a,{style:w.login_social_buttons})]})]}),Object(y.jsx)(m,{theme:"light"})]})}},DemoScreen:{title:"",component:function(e){var t=e.navigation,n=Object(b.b)().dispatch;return Object(c.useLayoutEffect)((function(){t.setOptions({headerRight:void 0}),n({type:"LOGIN_GUEST"})}),[]),Object(y.jsx)(y.Fragment,{})},path:"demo"}},Ge={}},501:function(e,t,n){"use strict";n.d(t,"a",(function(){return L})),n.d(t,"b",(function(){return B}));var r=n(44),i=n.n(r),c=n(16),o=n.n(c),a=n(0),s=n(246),l=n(104),u=n(340),d=n(262),b=n(359),j=n(255),f=n(444),O=n(581),h=n(9),g=n.n(h);function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function y(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){g()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var x=function(e,t){switch(t.type){case"SEARCH":return y(y({},e),{},{keyword:t.keyword});case"ENABLE_SEARCH":return y(y({},e),{},{active:!0});case"DISABLE_SEARCH":return y(y({},e),{},{active:!1,keyword:""});default:throw new Error("Unhandled action type: "+t.type)}};var m=n(445),v=n(264),w=n(91),S=n(583),C=n(287),P=n(313),k=n(39),D=n(576),E=n.n(D),_=n(443),M=n(261),z=n(10);function R(e){var t=Object(w.b)().lang,n=Object(M.b)(),r=Object(a.useState)(!1),i=o()(r,2),c=i[0],l=i[1];return Object(z.jsx)(_.a,{name:e.name,width:e.width,textStyle:e.textStyle,children:Object(z.jsxs)(k.a,{style:{flexDirection:"landscape"==n?"row":"column",justifyContent:"space-between"},children:[Object(z.jsx)(k.a,{style:{justifyContent:"center"},children:Object(z.jsx)(s.a,{style:{fontSize:16},children:e.value})}),Object(z.jsxs)(k.a,{children:[Object(z.jsx)(d.a,{title:t("copy"),onPress:function(){E.a.setString(e.value),l(!0)}}),c&&Object(z.jsx)(s.a,{style:{fontSize:12,alignSelf:"center",color:"red"},children:t("copied")})]})]})})}var T=function(e){var t=Object(a.useState)(e.selectedRef.current.has(e.item.id)),n=o()(t,2),r=n[0],i=n[1];return Object(z.jsx)(s.b,{style:r?{borderWidth:1,borderColor:"blue"}:{},children:Object(z.jsx)(S.a,{member:e.item,onPress:function(){r?(i(!1),e.selectedRef.current.delete(e.item.id)):(i(!0),e.selectedRef.current.add(e.item.id))}})})},I=function(e){var t,n=e.selectedRef,r=e.userFilter,i=Object(w.b)().lang,c=Object(l.b)().auth,d=Object(u.a)(c),b=function(e,t){var n=Object(a.useReducer)(x,{active:!1,keyword:""}),r=o()(n,2),i=r[0],c=r[1],s=Object(a.useMemo)((function(){return i.active?e.filter((function(e){return t(e,i.keyword)})):e}),[i,e]);return{searchState:i,dispatch:c,data:s}}(Object(a.useMemo)((function(){return(null==d?void 0:d.filter(r))||[]}),[d,r]),(function(e,t){return e.username.includes(t)||e.name.includes(t)})),j=b.data,f=b.dispatch,h=b.searchState;return Object(z.jsx)(s.b,{style:{alignItems:"center",flex:1},children:Object(z.jsxs)(s.b,{style:{width:"100%",flex:1},children:[Object(z.jsx)(O.a,{name:i("Username")+" & "+i("Name"),placeholder:null==(t=c.user)?void 0:t.name,value:h.keyword,setValue:function(e){(null==e?void 0:e.length)>0?(f({type:"ENABLE_SEARCH"}),f({type:"SEARCH",keyword:e})):f({type:"DISABLE_SEARCH"})},width:"80%"}),j&&Object(z.jsx)(v.a,{contentContainerStyle:{flexGrow:1},data:j,renderItem:function(e){var t=e.item;return Object(z.jsx)(T,{item:t,selectedRef:n})}})]})})},L=function(e){var t,n=e.selectedRef,r=e.userFilter,i=e.isChannel,c=Object(w.b)().lang,u=Object(a.useState)(""),d=o()(u,2),b=d[0],j=d[1],h=Object(a.useState)(""),g=o()(h,2),p=g[0],y=g[1],x=Object(a.useRef)(),m=Object(l.b)().auth,S=Object(f.a)(p),C=Object(a.useMemo)((function(){return(null==S?void 0:S.filter(r))||[]}),[S,r]);Object(a.useEffect)((function(){return x.current=setTimeout((function(){y(b)}),500),function(){x.current&&clearTimeout(x.current)}}),[b]);var P=i?location.href.replace("chat","invitee"):void 0;return Object(z.jsx)(s.b,{style:{alignItems:"center",flex:1},children:Object(z.jsxs)(s.b,{style:{width:"100%",flex:1,paddingVertical:10},children:[P&&Object(z.jsxs)(z.Fragment,{children:[Object(z.jsx)(R,{name:c("invite link"),width:"80%",value:P}),Object(z.jsx)(s.b,{style:{marginVertical:10,height:1,width:"100%"},lightColor:"#ddd",darkColor:"rgba(255,255,255, 0.3)"})]}),Object(z.jsx)(O.a,{name:c("Username"),placeholder:null==(t=m.user)?void 0:t.username,value:b,setValue:j,width:"80%"}),C&&Object(z.jsx)(v.a,{contentContainerStyle:{flexGrow:1},data:C,renderItem:function(e){var t=e.item;return Object(z.jsx)(T,{item:t,selectedRef:n})}})]})})};function B(e){var t=e.id,n=Object(w.b)().lang,r=Object(a.useRef)(new Set),c=Object(b.a)(t),o=Object(a.useMemo)((function(){var e=new Set(null==c?void 0:c.map((function(e){return e.user})));return function(t){return!e.has(t.id)}}),[c]),l={member:{title:"People",component:function(){return Object(z.jsx)(I,{selectedRef:r,userFilter:o})},icon:Object(z.jsx)(z.Fragment,{})},external:{title:"External members",component:function(){return Object(z.jsx)(L,{selectedRef:r,userFilter:o,isChannel:!0})},icon:Object(z.jsx)(z.Fragment,{})}},u=Object(b.b)(),f=Object(j.b)().setModal,O=function(){f(B,null)};return Object(P.a)(O,[]),Object(z.jsx)(C.b,{children:Object(z.jsxs)(s.b,{style:{flex:1,width:"100%"},children:[Object(z.jsxs)(s.b,{style:{width:"100%"},children:[Object(z.jsx)(s.a,{style:{fontSize:20},children:n("invite")}),Object(z.jsx)(s.b,{style:{marginBottom:20,height:1,width:"100%"},lightColor:"#ddd",darkColor:"rgba(255,255,255, 0.3)"})]}),Object(z.jsx)(m.a,{tabs:l,tabBarPosition:"top"}),Object(z.jsxs)(s.b,{style:[{width:"100%",flexDirection:"row",padding:10},{justifyContent:"flex-end"}],children:[Object(z.jsx)(d.a,{title:n("invite"),onPress:function(){u.invite({channel_id:t,user_ids:i()(r.current)}).then(O)}}),Object(z.jsx)(d.a,{title:n("cancel"),onPress:O})]})]})})}},548:function(e,t,n){"use strict";n.d(t,"a",(function(){return z}));var r=n(9),i=n.n(r),c=n(16),o=n.n(c),a=n(44),s=n.n(a),l=n(0),u=n.n(l),d=n(262),b=n(255),j=n(246),f=n(91),O=n(108),h=n(264),g=n(250),p=n(105),y=n(287),x=n(336),m=n.n(x),v=n(313),w=n(10);function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function C(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var P=["AM","PM"].map((function(e){return{label:e,value:e}})),k=s()(Array(12).keys()).map((function(e,t){return(t+1).toString().padStart(2,"0")})).map((function(e){return{label:e,value:e}})),D=s()(Array(12).keys()).map((function(e,t){return(5*t).toString().padStart(2,"0")})).map((function(e){return{label:e,value:e}})),E=function(e){for(var t=e.clone().startOf("month").add(-1,"month"),n=e.clone().endOf("month").add(1,"month"),r=m()().startOf("day"),i=[];t<=n&&t<r;)i.push(t.format("YYYY-MM-DD")),t=t.add(1,"day");return i},_=u.a.lazy((function(){return Promise.all([n.e(7),n.e(9)]).then(n.bind(null,920))})),M=u.a.lazy((function(){return n.e(10).then(n.bind(null,1160))}));function z(e){var t=e.datetime,n=e.callback,r=t?m()(t):function(){var e=m()(),t=parseInt(e.format("mm"))%5;return e.add(5-t,"minute")}(),i=Object(f.b)(),c=i.lang,a=i.locale,s=Object(p.a)(),u=Object(l.useState)(r.format("YYYY-MM-DD")),x=o()(u,2),S=x[0],R=x[1],T=Object(l.useState)(r.locale("en").format("A")),I=o()(T,2),L=I[0],B=I[1],A=Object(l.useState)(r.format("hh")),H=o()(A,2),W=H[0],V=H[1],F=Object(l.useState)(r.format("mm")),Q=o()(F,2),N=Q[0],G=Q[1],U=Object(l.useState)(E(r)),J=o()(U,2),Y=J[0],K=J[1],q=Object(b.b)().setModal,$=function(){q(z,null)};return Object(v.a)($,[]),Object(w.jsxs)(y.a,{children:[Object(w.jsxs)(j.b,{style:{flexDirection:"row",width:"100%"},children:[Object(w.jsx)(j.b,{style:{flex:1,flexDirection:"row"},children:Object(w.jsx)(h.c,{onPress:$,children:Object(w.jsx)(O.d,{size:20,name:"arrow-back",color:g.a[s].text})})}),Object(w.jsx)(j.b,{style:{flex:1},children:Object(w.jsx)(j.a,{style:{fontSize:20,textAlign:"center"},children:c("Date & Time")})}),Object(w.jsx)(j.b,{style:{flex:1}})]}),Object(w.jsx)(j.b,{style:{marginBottom:20,height:1,width:"100%"},lightColor:"#ddd",darkColor:"rgba(255,255,255, 0.3)"}),Object(w.jsxs)(l.Suspense,{fallback:Object(w.jsx)(w.Fragment,{}),children:[Object(w.jsx)(_,{locale:a,style:void 0,setDate:R,disableAllTouchEventsForDisabledDays:!0,onMonthChange:function(e){return K(E(m()(e.dateString)))},markedDates:C(C({},Y.reduce((function(e,t){return e[t]={disabled:!0},e}),{})),(S?[S]:[]).reduce((function(e,t){return e[t]={selected:!0},e}),{}))}),Object(w.jsxs)(j.b,{style:{flexDirection:"row",paddingVertical:10,width:400,height:50},children:[Object(w.jsx)(M,{value:L,setValue:B,values:P}),Object(w.jsx)(j.a,{style:{fontSize:20},children:" "}),Object(w.jsx)(M,{value:W,setValue:V,values:k}),Object(w.jsx)(j.a,{style:{fontSize:20},children:" : "}),Object(w.jsx)(M,{value:N,setValue:G,values:D})]})]}),Object(w.jsxs)(j.b,{style:{flexDirection:"row"},children:[Object(w.jsx)(d.a,{title:c("save"),onPress:function(){null==n||n(m()(S+" "+W+":"+N+" "+L).toISOString()),$()}}),Object(w.jsx)(d.a,{title:c("cancel"),onPress:function(){null==n||n(void 0),$()}})]})]})}},574:function(e,t,n){"use strict";n(0);var r=n(1166),i=n(246),c=n(10);t.a=function(e){return Object(c.jsx)(r.a,{linkDefault:!0,style:{wordBreak:"break-word"},linkStyle:{color:"#12b886"},onPress:e.onPressLink,children:Object(c.jsx)(i.a,{selectable:e.selectable,style:e.textStyle,children:e.content})})}},575:function(e,t,n){"use strict";n.d(t,"a",(function(){return p}));n(0);var r=n(576),i=n.n(r),c=n(262),o=n(255),a=n(246),s=n(91),l=n(287),u=n(264),d=n(250),b=n(108),j=n(105),f=n(430),O=n(313),h=n(578),g=n(10);function p(e){var t=e.content,n=e.isOwner,r=e.sendToScreen,y=t.message_set[0],x=t.attatchment_set.filter((function(e){return"editor"==e.type})),m=x.length>0?x[0]:void 0,v=m?m.title.concat("\r\n",m.description.replaceAll(h.b,"")):y.content,w=Object(s.b)().lang,S=Object(o.b)().setModal,C=Object(j.a)(),P=Object(f.b)(),k=function(){S(p,null)};return Object(O.a)(k,[]),Object(g.jsxs)(l.a,{children:[Object(g.jsxs)(a.b,{style:{flexDirection:"row",width:"100%"},children:[Object(g.jsx)(a.b,{style:{flex:1,flexDirection:"row"},children:Object(g.jsx)(u.c,{onPress:k,children:Object(g.jsx)(b.d,{size:20,name:"arrow-back",color:d.a[C].text})})}),Object(g.jsx)(a.b,{style:{flex:1},children:Object(g.jsx)(a.a,{style:{fontSize:20,textAlign:"center"},children:w("Message")})}),Object(g.jsx)(a.b,{style:{flex:1}})]}),Object(g.jsx)(a.b,{style:{marginBottom:20,height:1,width:"100%"},lightColor:"#ddd",darkColor:"rgba(255,255,255, 0.3)"}),Object(g.jsx)(c.a,{style:{height:40,width:"100%",maxWidth:320,justifyContent:"center"},title:w("copy"),onPress:function(){i.a.setString(v),k()}}),m&&r&&Object(g.jsx)(c.a,{style:{height:40,width:"100%",maxWidth:320,justifyContent:"center"},title:w("move to editor"),onPress:function(){r({value:m.title,editorValue:m.description}),k()}}),n&&t.timer&&Object(g.jsx)(c.a,{style:{height:40,width:"100%",maxWidth:320,justifyContent:"center"},textStyle:{color:"red"},title:w("delete timer"),onPress:function(){P.patch({id:t.id,timer:null}),k()}}),n&&Object(g.jsx)(c.a,{style:{height:40,width:"100%",maxWidth:320,justifyContent:"center"},textStyle:{color:"red"},title:w("delete"),onPress:function(){P.patch({id:t.id,is_archive:!0}),k()}})]})}},578:function(e,t,n){"use strict";n.d(t,"b",(function(){return d}));var r=n(0),i=n.n(r),c=n(298),o=n(246),a=n(105),s=n(250),l=n(10),u=i.a.lazy((function(){return n.e(5).then(n.t.bind(null,1006,7))})),d=/<\/?[^>]*>/gi;t.a=i.a.memo((function(e){var t=e.content,n=Object(a.a)();return Object(l.jsxs)(o.b,{children:[Object(l.jsx)(o.a,{style:{fontSize:18,fontWeight:"600",minWidth:140},children:t.title}),Object(l.jsx)(c.a,{containerStyle:{width:"100%",margin:0},bodyStyle:{borderWidth:0,borderRadius:0,borderTopWidth:1,padding:0,alignItems:"flex-start"},children:Object(l.jsx)(r.Suspense,{fallback:Object(l.jsx)(o.a,{children:t.description.replaceAll(d,"")}),children:Object(l.jsx)(u,{contentWidth:320,source:{html:t.description},baseStyle:{color:s.a[n].text}})})})]})}))},579:function(e,t,n){"use strict";var r=n(9),i=n.n(r),c=(n(0),n(39)),o=n(246),a=n(293),s=n(10);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function u(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}t.a=function(e){return Object(s.jsxs)(c.a,{style:{width:"100%",height:135,justifyContent:"space-evenly",alignItems:"center"},children:[Object(s.jsx)(a.b,u(u({},e),{},{size:75})),Object(s.jsx)(o.a,{style:{fontWeight:"bold",fontSize:15},children:e.name}),Object(s.jsx)(o.a,{style:{fontWeight:"normal",fontSize:14},children:e.username})]})}},580:function(e,t,n){"use strict";var r=n(16),i=n.n(r),c=n(0),o=n(297),a=n(250),s=n(105),l=n(10);t.a=function(e){var t=Object(c.useState)(),n=i()(t,2),r=n[0],u=n[1],d=e.minHeight||30,b=Object(s.a)();return Object(l.jsx)(o.a,{style:[{borderColor:"#d0d7de",fontSize:16,borderWidth:1,borderRadius:6,paddingHorizontal:10,paddingVertical:3,backgroundColor:a.a[b].background,color:a.a[b].text,height:e.multiline?r:d},e.style],placeholder:e.placeholder,editable:!e.disabled,keyboardType:e.keyboardType,secureTextEntry:e.secureTextEntry,value:e.value,onChangeText:e.setValue,onContentSizeChange:e.multiline?function(e){var t=Math.max(e.nativeEvent.contentSize.height,d)+2;(null==r||r+1<t)&&u(t)}:void 0,onBlur:function(){return null==e.onBlur?void 0:e.onBlur(e.value)},onEndEditing:function(){return null==e.onEndEditing?void 0:e.onEndEditing(e.value)},multiline:e.multiline})}},581:function(e,t,n){"use strict";n.d(t,"a",(function(){return u}));var r=n(9),i=n.n(r),c=(n(0),n(580)),o=n(443),a=n(10);function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e){return Object(a.jsx)(o.a,{name:e.name,width:e.width,textStyle:e.textStyle,children:Object(a.jsx)(c.a,l({},e))})}},583:function(e,t,n){"use strict";n(0);var r=n(447),i=n(293),c=n(246),o=n(10);t.a=function(e){var t=e.member,n=e.onPress;return Object(o.jsxs)(r.a,{bodyStyle:{flexDirection:"row",justifyContent:"flex-start"},onPress:n,children:[Object(o.jsx)(c.b,{style:{marginTop:4,marginRight:12},children:Object(o.jsx)(i.b,{name:t.name,userId:t.id,size:44})}),Object(o.jsx)(c.a,{style:{fontSize:20,fontWeight:"400"},children:t.name})]},t.id)}},584:function(e,t,n){"use strict";n.d(t,"a",(function(){return b}));n(0);var r=n(104),i=n(262),c=n(255),o=n(246),a=n(91),s=n(287),l=n(313),u=n(402),d=n(10);function b(e){var t=e.type,n=Object(a.b)().lang,j=Object(c.b)().setModal,f=Object(r.b)(),O=(f.auth,f.dispatch),h=function(){j(b,null)},g={GUEST_LOGOUT:{message:"Guest users cannot reconnect after logging out. Please create an account or log in.",buttons:[{title:"Create User",onPress:function(){j(u.a,{})}},{title:"sign out",onPress:function(){return O({type:"LOGOUT_REQUEST"})}}]}};return Object(l.a)(h,[]),Object(d.jsxs)(s.a,{children:[Object(d.jsx)(o.a,{children:n(g[t].message)}),Object(d.jsxs)(o.b,{style:{width:"100%",flexDirection:"row",justifyContent:"flex-end"},children:[g[t].buttons.map((function(e,t){return Object(d.jsx)(i.a,{style:{marginRight:10},title:n(e.title),onPress:e.onPress},t)})),Object(d.jsx)(i.a,{title:n("cancel"),onPress:function(){return h()}})]})]})}},585:function(e,t,n){"use strict";n.d(t,"a",(function(){return w}));var r=n(16),i=n.n(r),c=n(4),o=n.n(c),a=n(9),s=n.n(a),l=n(0),u=n(864),d=(n(1164),n(73)),b=n(100),j=n(10);function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){s()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var h=n(865),g=h.messagingSenderId,p=d.a.split("").map((function(e,t){return(e.charCodeAt(0)^g.charCodeAt(t)).toString(16).padStart(2,"0")})).join(""),y=u.a.initializeApp(O(O({},h),{},{apiKey:d.a})),x=u.a.messaging(y);x.onMessage((function(e){if("Notification"in window){if("granted"===Notification.permission){var t=JSON.parse(e.data.message_set)[0];new Notification(e.data.channel_name,{body:e.data.name+": "+t.content})}}else alert("This browser does not support desktop notification")}));var m=function(){var e=o()((function*(){if("granted"===(yield Notification.requestPermission())){var e=yield navigator.serviceWorker.register("/tokki-tok/firebase-messaging-sw.js?"+p);console.log("[SW]: SCOPE: ",e.scope);var t=yield x.getToken({serviceWorkerRegistration:e,vapidKey:d.b}).catch(o()((function*(){return yield x.getToken({serviceWorkerRegistration:e,vapidKey:d.b})})));if(window.addEventListener("beforeunload",(function(t){t.preventDefault(),e.unregister()})),t)return t}return null}));return function(){return e.apply(this,arguments)}}(),v=Object(l.createContext)({setEnable:function(){}}),w=function(e){var t=e.user,n=e.children,r=Object(l.useRef)(),c=Object(l.useState)(),o=i()(c,2),a=o[0],s=o[1],u=Object(l.useMemo)((function(){return void 0===a?void 0:!(null==a||!a.token)}),[a]);return Object(l.useEffect)((function(){var e=!0;return t&&(void 0===r.current&&(r.current=null,m().then((function(t){r.current=t,a&&Object(b.c)(O(O({},a),{},{token:r.current})).then((function(t){e&&s(t)}))}))),void 0===a?Object(b.a)(t.id).then((function(t){e&&s(t||null)})):null===a?Object(b.b)({user:t.id,type:"WEB",token:null}).then((function(t){e&&s(t)})):a.token&&r.current&&r.current!=a.token&&Object(b.c)(O(O({},a),{},{token:r.current})).then((function(t){e&&s(t)}))),function(){e=!1}}),[t,a]),Object(j.jsx)(v.Provider,{value:{enable:u,setEnable:function(e){t&&a&&Object(b.c)(O(O({},a),{},{token:e?void 0==r.current?null:r.current:null})).then((function(e){s(e)}))}},children:(void 0!=u||null===t)&&n})};t.b=function(){var e=Object(l.useContext)(v);return{enable:e.enable,setEnable:e.setEnable}}},688:function(e,t,n){"use strict";var r=n(9),i=n.n(r),c=n(0),o=n.n(c),a=n(39),s=n(263),l=n(264),u=n(430),d=n(112),b=n(255),j=n(246),f=n(293),O=n(265),h=n(312),g=n(298),p=n(10),y=function(e){var t=e.link,n=e.isMobile,r=e.touchableRef;return Object(p.jsx)(g.a,{containerStyle:{marginHorizontal:0},bodyStyle:{padding:0},children:Object(p.jsxs)(l.c,{onPress:function(){return r.current()&&h.a.openURL(t.url)},onLongPress:function(){},style:{width:"100%",flexDirection:"row"},children:[t.image_url?Object(p.jsx)(O.a,{source:{uri:t.image_url},resizeMode:"cover",style:{width:"100%",maxWidth:n?120:150,maxHeight:n?120:150,borderWidth:1}}):void 0,Object(p.jsxs)(j.b,{style:{flex:1,marginHorizontal:20},children:[Object(p.jsx)(j.a,{style:{fontSize:18},children:t.title}),Object(p.jsx)(j.a,{style:{fontSize:14},children:t.description}),Object(p.jsx)(j.a,{style:{fontSize:12},children:t.url})]})]})})},x=n(108),m=n(105),v=n(250);function w(e){var t=0==e?0:Math.floor(Math.log(e)/Math.log(1024));return(e/Math.pow(1024,t)).toFixed(2)+" "+["B","kB","MB","GB","TB"][t]}var S=function(e){var t=e.file,n=e.isMobile,r=e.showBorder,i=e.touchableRef,c=Object(m.a)();return Object(p.jsx)(g.a,{containerStyle:{marginHorizontal:0},bodyStyle:r?{padding:10}:{borderWidth:0,padding:0},children:Object(p.jsxs)(l.c,{onPress:function(){return i.current()&&h.a.openURL(t.file)},onLongPress:function(){},style:{flexDirection:"row",alignItems:"flex-start",width:"100%"},children:[t.thumbnail?Object(p.jsx)(O.a,{source:{uri:t.thumbnail},resizeMode:"cover",style:{width:n?120:150,height:n?120:150,borderWidth:1}}):Object(p.jsx)(x.c,{name:"file-o",size:20,color:v.a[c].iconColor}),Object(p.jsxs)(j.b,{style:{flex:1,marginHorizontal:10},children:[Object(p.jsx)(j.a,{style:{fontSize:18},children:t.filename}),Object(p.jsx)(j.a,{style:{fontSize:14},children:w(t.filesize)})]})]})})},C=n(575),P=n(690),k=n(4),D=n.n(k),E=n(70),_=n(71);var M=n(578),z=n(574),R=n(381);function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function I(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var L=o.a.memo((function(e){for(var t,n=Object(b.b)().setModal,r=Object(c.useRef)(Date.now()),i=Object(c.useRef)((function(){return Date.now()-r.current>350})),o=Object(d.a)(),l=e.next;null!=(u=l)&&u.next&&0==l.current.length;){var u;l=l.next}var O=null==(t=l)?void 0:t.current[0];return Object(p.jsx)(a.a,{style:{flexDirection:e.reverse?"column-reverse":"column"},onTouchMove:function(){r.current=Date.now()},children:e.current.map((function(t,r){var c=r+1<e.current.length?e.current[r+1]:O,l=t.created.slice(0,16),u=l.slice(0,10),d=null==t.user,b=void 0==c||t.user!=c.user||l!=c.created.slice(0,16),h=e.ownerId==t.user,x=void 0==c||u!=c.created.slice(0,10),m=t.message_set[0],v=function(){return n(R.a,{id:t.user})};return d?Object(p.jsx)(a.a,{style:{flexDirection:"row",justifyContent:"center",width:"100%",marginVertical:5},children:Object(p.jsx)(j.a,{children:m.content})},t.id):Object(p.jsxs)(a.a,{children:[x?Object(p.jsx)(a.a,{style:{flexDirection:"row",justifyContent:"center",width:"100%"},children:Object(p.jsx)(j.a,{children:u})}):void 0,Object(p.jsxs)(a.a,{style:{flexDirection:"row",justifyContent:h?"space-between":"flex-start",width:"100%"},children:[b&&!h?Object(p.jsx)(s.a,{style:{marginTop:3,marginLeft:12},onPress:v,children:Object(p.jsx)(f.b,{name:t.name,userId:t.user,size:36})}):Object(p.jsx)(a.a,{style:{width:48}}),Object(p.jsx)(g.a,{autoScale:!0,outerContainerStyle:{maxWidth:"90%"},title:b?t.name:void 0,titleStyle:{flex:void 0},titleOnPress:b?v:void 0,bodyStyle:{padding:10},subtitle:""+l.slice(11),children:Object(p.jsxs)(s.a,{onLongPress:null==e.getOnPress?void 0:e.getOnPress(t),children:[t.timer&&Object(p.jsxs)(a.a,{style:{flexDirection:"row",alignItems:"stretch"},children:[Object(p.jsx)(j.a,{style:{fontSize:12},children:"\u231a"}),Object(p.jsx)(j.a,{style:{fontSize:12},selectable:!o,children:Object(P.c)(t.timer)})]}),Object(p.jsx)(z.a,{selectable:!o,textStyle:{textAlign:h?"right":"left"},onPressLink:i.current()?void 0:function(){},content:m.content}),t.attatchment_set.map((function(e,t){return"editor"==e.type?Object(p.jsx)(M.a,{content:e},t):"file"==e.type?Object(p.jsx)(S,{file:e,isMobile:o,showBorder:!1,touchableRef:i},t):"link"==e.type?Object(p.jsx)(y,{link:e,isMobile:o,touchableRef:i},t):void 0}))]})})]},t.id)]},t.id)}))})}));t.a=function(e){var t=Object(c.useRef)(0),n=e.auth?Object(u.a)(e.channel_id):function(e){var t=Object(E.useInfiniteQuery)(["ViewerContentList",e],function(){var t=D()((function*(t){var n=t.pageParam;return Object(_.g)(e,n,!0).then((function(e){return{current:e}}))}));return function(e){return t.apply(this,arguments)}}(),{select:function(e){return e.pages.length>1&&(e.pages[e.pages.length-2].next=e.pages[e.pages.length-1]),e},getNextPageParam:function(e){return null!=e&&e.current.length?e.current[e.current.length-1].id:void 0},refetchOnReconnect:!1,refetchOnWindowFocus:!1});return{data:t.data,fetchNextPage:t.fetchNextPage}}(e.channel_id),r=n.data,i=n.fetchNextPage,o=Object(c.useMemo)((function(){var t,n;return null==(t=e.auth)||null==(n=t.user)?void 0:n.id}),[e.auth]),a=Object(b.b)().setModal,s=function(t){return function(){return a(C.a,{content:t,isOwner:o==t.user,sendToScreen:e.sendToScreen})}},d=Object(c.useCallback)((function(t){var n=t.item;t.index;return Object(p.jsx)(L,I(I({},n),{},{ownerId:o,reverse:e.reverse,getOnPress:s}))}),[o]);return Object(p.jsx)(l.a,{style:{flexDirection:e.reverse?"column-reverse":"column"},contentContainerStyle:{padding:10,flexGrow:1,flexDirection:e.reverse?"column-reverse":"column"},data:null==r?void 0:r.pages,renderItem:d,onScroll:function(n){n.nativeEvent.contentSize.height-t.current+(e.reverse?1:-1)*n.nativeEvent.contentOffset.y<1&&i()},onLayout:function(e){t.current=e.nativeEvent.layout.height}})}},690:function(e,t,n){"use strict";n.d(t,"b",(function(){return m})),n.d(t,"c",(function(){return w}));var r=n(16),i=n.n(r),c=n(0),o=n(336),a=n.n(o),s=n(39),l=n(263),u=n(246),d=n(44),b=n.n(d),j=n(4),f=n.n(j),O=n(70),h=n(71),g=n(326);var p=n(293),y=n(574),x=n(10);function m(e){return v(a()(e),a()())}function v(e,t){return e.year()!=t.year()?e.format("YYYY.MM"):e.month()!=t.month()||e.date()!=t.date()?e.format("MM.DD"):e.format("HH:mm")}function w(e){return a()(e).format("YYYY.MM.DD HH:mm")}var S=function(e){var t=a()(e.data.created),n=a()(e.data.timer),r=t.diff(e.now)/t.diff(n),i=e.data.message_set[0];return Object(x.jsx)(l.a,{onPress:function(){return e.setExpand(e.isExpand?void 0:e.data.id)},children:Object(x.jsxs)(s.a,{style:{backgroundColor:"lightgray",borderRadius:20,overflow:"hidden",margin:5},children:[Object(x.jsx)(s.a,{style:{backgroundColor:"darkgray",position:"absolute",width:100*r+"%",height:"100%"}}),e.isExpand?Object(x.jsxs)(s.a,{style:{paddingVertical:5,paddingHorizontal:5,maxWidth:270},children:[Object(x.jsxs)(s.a,{style:{flexDirection:"row"},children:[Object(x.jsx)(p.b,{name:e.data.name,userId:e.data.user,size:20}),Object(x.jsx)(s.a,{style:{paddingHorizontal:5},children:Object(x.jsx)(u.a,{children:e.data.name})})]}),e.data.timer&&Object(x.jsxs)(s.a,{style:{flexDirection:"row",alignItems:"stretch"},children:[Object(x.jsx)(u.a,{children:"\u231a"}),Object(x.jsx)(u.a,{selectable:!0,children:w(e.data.timer)})]}),Object(x.jsx)(y.a,{selectable:!0,content:i.preview_content||i.content})]}):Object(x.jsxs)(s.a,{style:{paddingVertical:5,paddingHorizontal:5,flexDirection:"row"},children:[Object(x.jsx)(p.b,{name:e.data.name,userId:e.data.user,size:20}),Object(x.jsx)(s.a,{style:{paddingHorizontal:5},children:Object(x.jsx)(u.a,{children:v(n,e.now)})})]})]})})};t.a=function(e){var t=function(e){var t=Object(O.useQueryClient)(),n=Object(O.useQuery)(["TimerMessageContentList",e],f()((function*(){return yield Object(h.k)(e,a()().toISOString())})),{refetchOnReconnect:!1,refetchOnWindowFocus:!1}).data,r=Object(g.c)().lastJsonMessage;Object(c.useEffect)((function(){null!=r&&r.data.channel==e&&("next_message"==r.type&&r.data.timer&&a()()<a()(r.data.timer)&&t.setQueryData(["TimerMessageContentList",e],(function(e){return[].concat(b()(e||[]),[r.data])})),"update_message"==r.type&&t.setQueryData(["TimerMessageContentList",e],(function(e){return b()((null==e?void 0:e.filter((function(e){return e.id!=r.data.id||null!=r.data.timer&&!r.data.is_archive})))||[])})))}),[r]);var i=Object(c.useMemo)((function(){return null==n?void 0:n.sort((function(e,t){return(e.timer||"")>(t.timer||"")?1:-1}))}),[n]);return Object(c.useEffect)((function(){var n;if(null!=i&&null!=(n=i[0])&&n.timer){var r=i[0].id,c=Math.min(a()(i[0].timer).diff(a()()),Number.MAX_VALUE),o=setTimeout((function(){t.setQueryData(["TimerMessageContentList",e],(function(e){return(e||[]).filter((function(e){return e.id!=r||a()(e.timer).diff(a()())>0}))}))}),c);return function(){return clearTimeout(o)}}}),[i]),i}(e.channel_id),n=Object(c.useState)(a()()),r=i()(n,2),o=r[0],l=r[1],u=Object(c.useState)(),d=i()(u,2),j=d[0],p=d[1];return Object(c.useEffect)((function(){var e=setTimeout((function(){l(a()())}),2e3);return function(){return clearTimeout(e)}}),[o]),Object(x.jsx)(s.a,{style:{flexDirection:"row",paddingTop:5,paddingHorizontal:20},children:null==t?void 0:t.map((function(e,t){return Object(x.jsx)(S,{data:e,now:o,isExpand:e.id==j,setExpand:p},t)}))})}},755:function(e,t,n){"use strict";n.d(t,"b",(function(){return u}));var r,i=n(0),c=n(325),o=n(305),a=n(359),s=n(104),l=0,u=function(e){if(void 0!==e&&e.pathname.endsWith("/invitee")){var t=e.search.slice(1).split("&").filter((function(e){return e.startsWith("id=")}));t.length>0&&(r=parseInt(t[0].split("=")[1])),window.history.replaceState(null,"",e.href.split("invitee")[0])}};t.a=function(){var e=Object(s.b)().auth,t=Object(o.a)("messenger",e),n=Object(a.b)();Object(i.useEffect)((function(){if(e.user){if(r&&t){var i=r,o=function(){return Object(c.navigate)("Main",{screen:"ChatScreen",params:{id:i}})};r=void 0,l=1,void 0===t.find((function(e){return e.id==i}))?(console.log("invite processing (channel:"+i+")"),n.invite({channel_id:i,user_ids:[e.user.id]}).then(o)):(console.log("already invite"),o())}}else 1==l&&(l=2)}),[e,t]),Object(i.useEffect)((function(){e.user&&2==l&&Object(c.navigate)("Main",{screen:"HomeScreen"})}),[e.user])}},863:function(e,t,n){editorConfig={plugins:"image link charmap advlist lists paste",toolbar:"fontsizeselect | bold italic underline strikethrough | undo redo | alignleft aligncenter alignright | bullist numlist | link",setup:function(e){}},e.exports=editorConfig},865:function(e,t,n){firebaseConfig={authDomain:"virtual-metrics-355712.firebaseapp.com",projectId:"virtual-metrics-355712",storageBucket:"virtual-metrics-355712.appspot.com",messagingSenderId:"76003576924",appId:"1:76003576924:web:c8c8a006d07918bbc02a99",measurementId:"G-SEL35L4N5R"},e.exports=firebaseConfig},866:function(e,t,n){"use strict";var r=n(9),i=n.n(r),c=n(1159),o=n(495);function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){i()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}Object.values(o.c).forEach((function(e){return e.path="tokki-tok/"+e.path})),t.a={prefixes:[c.a("/")],config:{screens:s({Main:{screens:s(s(s({},o.b),o.a),{},{NotFound:"*"}),path:"tokki-tok"}},o.c)}}},886:function(e,t){}}]);
//# sourceMappingURL=2.3801015c.chunk.js.map