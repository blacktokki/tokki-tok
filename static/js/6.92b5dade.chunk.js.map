{"version":3,"sources":["src/components/Themed.tsx","src/constants/Colors.ts","src/hooks/useModalsContext.tsx","src/components/CommonButton.tsx","src/hooks/useResizeContext.tsx","src/components/ModalSection.tsx","src/lib/react-native-paper/Avatar.tsx","src/components/Avatar.tsx","src/components/CommonSection.tsx","src/hooks/useModalEffect.ts","src/hooks/lists/useMessengerChannelList.ts","src/navigation/index.tsx","src/hooks/useWebsocketContext.tsx","src/hooks/lists/useUserMembershipList.ts","src/components/TextButton.tsx","src/hooks/lists/useMessengerMemberList.ts","src/modals/ChannelEditModal.tsx","src/modals/RegistrationModal.tsx","src/components/HeaderRight.tsx","src/components/RowField.tsx","src/components/TabView.tsx","src/components/CommonItem.tsx","src/modals/ProfileModal.tsx","src/hooks/lists/useMessengerContentList.ts","src/modals/AlertModal.tsx","src/components/TextField.tsx","src/components/CommonTextInput.tsx","src/components/MemberItem.tsx","src/modals/DateTimePickerModal.tsx","src/modals/MessageModal.tsx","src/components/Profile.tsx","src/hooks/useFirebaseContext.tsx","src/hooks/useInvitee.ts","src/components/ContractFooter.tsx","src/screens/main/LoginScreen.tsx","src/components/LinkPreview.tsx","src/lib/react-native-webrtc/useWebsocketContext.tsx","src/lib/react-native-webrtc/webrtc/p2p.tsx","src/lib/react-native-webrtc/webrtc/index.ts","src/lib/react-native-webrtc/LocalCam.tsx","src/lib/react-native-webrtc/RemoteCam.tsx","src/screens/main/ChatScreen/VideoCallSection.tsx","src/components/FilePreview.tsx","src/screens/main/ChatScreen/TimerTags.tsx","src/hooks/lists/useTimerMessageContent.ts","src/screens/main/ChatScreen/index.tsx","src/screens/main/HomeScreen/ConfigSections.tsx","src/screens/main/HomeScreen/index.tsx","src/screens/index.ts","src/screens/main/DemoScreen.tsx","src/hooks/useLocalSearch.ts","src/components/CopyField.tsx","src/modals/InviteModal.tsx","src/hooks/lists/useExternalMembershipList.ts","src/navigation/LinkingConfiguration.ts","web/firebase-config.js","src/screens/NotFoundScreen.tsx","src/navigation/DrawerNavigator.tsx","src/modals/index.ts","src/navigation/RootNavigator.tsx"],"names":["useThemeColor","props","colorName","theme","useColorScheme","colorFromProps","Colors","Text","style","lightColor","darkColor","otherProps","color","light","dark","View","backgroundColor","text","background","tint","tabIconDefault","tabIconSelected","hoverColor","buttonBackgroundColor","header","headerBottomColor","buttonBorderColor","iconColor","borderColor","focus","ModalsContext","createContext","setModal","ModalsProvider","children","allModals","modals","useState","setModals","windowType","useResizeContext","animationType","setAnimationType","useEffect","filter","v","visible","length","map","Component","Provider","value","newModals","m","modal","index","key","transparent","useContext","DefaultButton","hover","setHover","onPress","onHoverIn","onHoverOut","disabled","paddingVertical","paddingHorizontal","selectable","fontSize","textStyle","title","_props","styles","StyleSheet","create","borderRadius","borderWidth","textAlign","fontWeight","getWindowType","window","height","width","ResizeContextContext","Dimensions","get","ResizeContextProvider","detectMobile","useMobileDetect","useWindowDimensions","setWindowType","isMobile","outerContainerStyle","flex","alignSelf","maxWidth","undefined","flexShrink","containerStyle","margin","justifyContent","alignItems","bodyStyle","padding","BottomSheet","normalizeHash","hash","min","max","Math","floor","str","initHash","i","charCodeAt","abs","stringToHSL","name","userId","size","label","split","join","toUpperCase","avatarFromChannel","item","user","avatar","member_count","id","subowner","owner","Avatar","CommonSection","outerContainer","container","withSeparator","separator","titleView","titleStyle","subtitle","bodyView","marginHorizontal","marginVertical","flexDirection","marginBottom","marginTop","callback","deps","navigation","useNavigation","event","e","preventDefault","addListener","removeListener","useMessengerChannelList","auth","queryClient","useQueryClient","lastJsonMessage","useWebsocketContext","data","useQuery","a","async","getMessengerChannelList","setQueryData","_data","find","sort","b","channel","last_message","content","message_set","created","useMessengerChannelSorted","channelList","useMessengerChannelMutation","useMutation","postChannel","onSuccess","invalidateQueries","update","putChannel","direct","postDirectChannel","mutateAsync","enableScreens","navigationRef","React","navigate","params","current","Navigation","defaultColorScheme","useDefaultColorScheme","userColorScheme","colorScheme","ref","documentTitle","formatter","options","route","linking","process","versions","LinkingConfiguration","DarkTheme","DefaultTheme","l","search","decoded","slice","s","replace","history","replaceState","pathname","location","replaceInviteeState","ignoreWarnings","_console","then","_","clone","console","warn","message","Object","forEach","indexOf","defaultContext","sendJsonMessage","WebSocketContext","WebSocketInternalProvider","path","Context","useBackground","token","setToken","AppState","currentState","isActive","setIsActive","useWebSocket","websockerURL","shouldReconnect","closeEvent","protocols","onOpen","log","onClose","AsyncStorage","getItem","onChange","nextState","addEventListener","removeEventListener","WebSocketProvider","disable","useUserMembershipList","groupId","getUserMembershipList","useUserMembershipMutation","useAuthContext","dispatch","_create","postUser","_update","patchUser","type","_delete","deleteUser","delete","useMessengerMemberList","channel_id","getMessengerMemberList","useMessengerMemberMutation","invite","postBulkMessengerMember","leave","deleteMessengerMember","ChannelEditModal","member_id","lang","useLangContext","useModalsContext","channelMutation","messengerMemberMutation","setName","description","setDescription","back","_name","useModalEffect","setValue","multiline","newChannel","group","screen","field","ErrorView","form_error","form_error_text","RegistrationModal","username","setUsername","password","setPassword","checkPassword","setCheckPassword","isStaff","error","setError","userList","userMembershipMutation","keyboardType","secureTextEntry","newError","test","keys","is_guest","is_staff","inviteGroupId","textAlignVertical","defaultButtonProps","AlertModal","buttonProps","extra","k","RowField","rowStyle","useMemo","setIndex","entries","tabs","onTab","icons","assign","icon","renderTabBar","indicatorStyle","activeColor","inactiveColor","renderIcon","scene","onTabPress","findIndex","navigationState","routes","onIndexChange","renderScene","SceneMap","component","tabBarPosition","CommonItem","press","setPress","onPressIn","onPressOut","minHeight","borderBottomWidth","ProfileModal","isSelf","updateContnetPage","pages","updateMessages","update_i","page","timer","is_archive","useMessengerContentList","useInfiniteQuery","pageParam","getMessengerContentList","select","next","getNextPageParam","lastPage","refetchOnReconnect","refetchOnWindowFocus","query","updated_gte","Date","state","dataUpdatedAt","toISOString","newData","getNewMessengerContentList","contents","lastMessageId","nextMessages","timerMessageRefetch","fetchNextPage","pageParams","useMessengerContentMutation","channelId","postMessage","_patch","patchMessengerContent","mutate","patch","messages","TextField","contentHeight","setContentHeight","placeholder","editable","onChangeText","onContentSizeChange","nativeEvent","contentSize","onBlur","onEndEditing","member","marginRight","dayTypes","hours","Array","toString","padStart","minutes","getDisableDays","date","startDate","startOf","add","endDate","endOf","today","dayjs","result","push","format","Calendar","lazy","CommonPicker","DateTimePickerModal","datetime","_dayjs","restMinute","parseInt","defaultDayjs","locale","setDate","dayType","setDayType","hour","setHour","minute","setMinute","disableDays","setDisableDays","fallback","disableAllTouchEventsForDisabledDays","onMonthChange","dateString","markedDates","reduce","p","c","selected","values","MessageModal","isOwner","isTimer","contentMutation","Clipboard","setString","firebaseConfig","require","messagingSenderId","apiKeyEncrypted","FCM_API_KEY","app","firebase","initializeApp","apiKey","messaging","onMessage","payload","Notification","permission","JSON","parse","channel_name","body","alert","FirebaseContext","setEnable","FirebaseProvider","tokenRef","useRef","notification","setNotification","enable","isMount","requestPermission","navigator","serviceWorker","register","serviceWorkerRegistration","scope","getToken","vapidKey","FCM_PUBLIC_VAPID_KEY","catch","currentToken","unregister","requestToken","t","putNotification","noti","getNotification","postNotification","invitee_id","invitee_state","endsWith","startsWith","href","redirect","user_ids","openURL","Platform","OS","url","Linking","Styles","footer_buttons","footer_button","paddingBottom","paddingRight","login_container","login_header","paddingTop","login_header_logo","resizeMode","login_header_text","login_header_text_bold","login_wrapper","borderTopRightRadius","borderTopLeftRadius","form","form_input","button","button_label","login_social","login_social_separator","login_social_separator_line","login_social_separator_text","login_social_buttons","login_social_button","login_social_icon","login_social_facebook","login_footer_text","guest_footer_text","login_footer_link","link","onLongPress","image","Image","source","uri","maxHeight","TURN_SERVER","peerConstraints","iceServers","urls","sessionConstraints","mandatory","OfferToReceiveAudio","OfferToReceiveVideo","VoiceActivityDetection","mediaConstraints","audio","video","framerate","onICEcandidate","pc","_message","rtcMessage","candidate","RTCIceCandidate","addIceCandidate","sendICEcandidate","sendMessage","receiver","target","optimizeSdp","offerDescription","arr","sdp","RTCSessionDescription","createOffer","pcRefCurrent","stream","addStream","setLocalDescription","camStyle","cam","bottonContainer","position","bottom","buttonBar","pcRef","sender","setSender","_stream","setStream","isPlay","CustomRTCView","useCallback","memo","videoProps","start","mode","mediaDevices","getUserMedia","newStream","getDisplayMedia","stop","getTracks","track","websocketOnMessage","response","peerConnection","RTCPeerConnection","answerDescription","setRemoteDescription","useLocalCam","Button","setReceiver","setUser","close","clearInterval","statsInterval","iceConnectionState","activeStream","setInterval","getStats","stats","statsOutput","framePerSecond","report","kind","statName","framesPerSecond","toTimeString","addTransceiver","direction","streams","getRemoteStreams","createAnswer","localDescription","useRemoteCam","TextInput","VideoView","scale","flexGrow","focusGuest","setFocusGuest","VideoCallContainer","setDisable","useIsMobile","videoMode","setVideoMode","guests","setGuests","useRtcContext","ceil","sqrt","toggleVideoMode","Themed","aspectRatio","borderLeftWidth","flexWrap","RemoteCam","LocalCam","CommonButton","file","showBorder","filename","pow","toFixed","humanFileSize","filesize","_timerFormat","now","year","month","timerToString","TimerTag","end","ratio","diff","TouchableOpacity","setExpand","isExpand","overflow","linkDefault","wordBreak","linkStyle","timerMessages","getTimerMessageContentList","sorted","ms","Number","MAX_VALUE","timeout","setTimeout","clearTimeout","useTimerMessageContentList","setNow","expand","MessengerContentPageItem","nextPage","nextContent","index2","isSystem","isFirst","ownerId","dayChanged","marginLeft","file_set","fileIndex","FilePreview","link_set","linkIndex","LinkPreview","ConfigSection","setLocale","configTheme","useConfigColorScheme","useFirebaseContext","setNoti","n","TextButton","textDecorationLine","setColorScheme","paddingLeft","MemberTabView","memberItem","MemberItem","ScrollView","MessengerTabView","opacity","unread_count","ConfigTabView","ConfigSections","getBottomTabs","OneTab","TwoTab","FourTab","main","HomeScreen","home","setHome","headerRight","HeaderRight","useLayoutEffect","tab","setOptions","contentContainerStyle","ContractFooter","TabView","setParams","ChatScreen","inputRef","channelAvatar","memberList","setTimer","autoFocus","setAutoFocus","bottomTab","setBottomTab","postValue","InviteModal","renderItem","canGoBack","goBack","minWidth","VideoCallSection","d","onScroll","contentOffset","y","onLayout","layout","TimerTags","borderBottomRightRadius","top","onSubmitEditing","blurOnSubmit","onFocus","borderBottomLeftRadius","Promise","resolve","reject","input","document","createElement","onchange","files","onabort","onerror","click","f","login","LoginScreen","_login","autoCapitalize","DemoScreen","localSearchReducer","initialState","action","keyword","active","Error","CopyField","copied","setCopied","InviteItem","selectedRef","has","setSelected","GroupTabView","compare","useReducer","searchState","useLocalSearch","memberSet","Set","includes","dispatchKeyword","ExternalMembershipTabView","setKeyword","timeoutRef","externalMemberList","getExternalMembershipList","useExternalMembershipList","inviteLink","drawerTabs","external","ModalSection","ROOTPATH","prefixes","config","screens","Main","NotFound","module","exports","NotFoundScreen","linkText","colors","useTheme","onAddList","MemberTab","ChatTab","getDrawerTabs","tabBar","borderTopColor","border","pointerEvents","Profile","accessibilityRole","borderTopWidth","drawerTab","Tab","elevation","borderRightWidth","Root","createStackNavigator","RootNavigator","useInvitee","Navigator","headerMode","screenOptions","cardStyle","animationEnabled","cardStyleInterpolator","CardStyleInterpolators","forVerticalIOS","Screen","MainNavigator","headerShown","gestureDirection","modalValues","backgroundStyle","DrawerNavigator","headerStyle","headerTitleStyle","headerLeft","canGOBackScreen","headerLeftContainerStyle","forHorizontalIOS"],"mappings":"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","file":"static/js/6.92b5dade.chunk.js","sourcesContent":["/**\n * Learn more about Light and Dark modes:\n * https://docs.expo.io/guides/color-schemes/\n */\n\nimport * as React from 'react';\nimport { Text as DefaultText, View as DefaultView } from 'react-native';\n\nimport Colors from '../constants/Colors'\nimport useColorScheme from '../hooks/useColorScheme';\n\nexport function useThemeColor(\n  props: { light?: string; dark?: string },\n  colorName: keyof typeof Colors.light & keyof typeof Colors.dark\n) {\n  const theme = useColorScheme();\n  const colorFromProps = props[theme];\n\n  if (colorFromProps) {\n    return colorFromProps;\n  } else {\n    return Colors[theme][colorName];\n  }\n}\n\ntype ThemeProps = {\n  lightColor?: string;\n  darkColor?: string;\n};\n\nexport type TextProps = ThemeProps & DefaultText['props'];\nexport type ViewProps = ThemeProps & DefaultView['props'];\n\nexport function Text(props: TextProps) {\n  const { style, lightColor, darkColor, ...otherProps } = props;\n  const color = useThemeColor({ light: lightColor, dark: darkColor }, 'text');\n\n  return <DefaultText style={[{ color }, style]} {...otherProps} />;\n}\n\nexport function View(props: ViewProps) {\n  const { style, lightColor, darkColor, ...otherProps } = props;\n  const backgroundColor = useThemeColor({ light: lightColor, dark: darkColor }, 'background');\n\n  return <DefaultView style={[{ backgroundColor }, style]} {...otherProps} />;\n}\n","const tintColorLight = '#2f95dc';\nconst tintColorDark = '#fff';\n\nexport default {\n  light: {\n    text: '#000',\n    background: '#fff',\n    tint: tintColorLight,\n    tabIconDefault: '#ccc',\n    tabIconSelected: tintColorLight,\n    hoverColor:'rgb(242,242,242)',\n    buttonBackgroundColor: '#f6f8fa', //'rgba(9,30,66,0.08)',//rgb(242,242,242)\\\n    header:'#f6f8fa',\n    headerBottomColor:'rgb(216, 216, 216)',\n    buttonBorderColor:'rgba(27,31,36,0.15)',\n    iconColor: 'black'\n  },\n  dark: {\n    text: '#fff',\n    background: '#000',\n    tint: tintColorDark,\n    tabIconDefault: '#ccc',\n    tabIconSelected: tintColorDark,\n    hoverColor: '#010409',//'rgb(1,4,9)',\n    buttonBackgroundColor: '#010409',//'#282624',\n    header:'#010409',\n    headerBottomColor:'rgb(40, 40, 40)',\n    buttonBorderColor:'rgba(229,225,220,0.15)',\n    iconColor: 'white'\n  },\n  borderColor:'#d0d7de',\n  \n  focus:'#0065A4',\n};\n","import React, { useState, createContext, useContext, useEffect } from \"react\";\nimport { Modal } from \"react-native\";\nimport useResizeContext from \"./useResizeContext\";\n\ntype ModalProps = any\n\ntype ModalState = {\n  Component:React.ComponentType<ModalProps>,\n  props:any\n  visible:boolean\n}\ntype SetModal = (Component:ModalState[\"Component\"]|null, props:ModalProps|null)=>void\n\nconst ModalsContext = createContext<{setModal: SetModal}>({\n    setModal: () => {}\n});\n\nexport const ModalsProvider = ({children, modals:allModals}:{children:React.ReactNode, modals:React.ComponentType<ModalProps>[]}) => {\n    const [modals, setModals] = useState<ModalState[]>([]);\n    const windowType = useResizeContext();\n    const [animationType, setAnimationType] = useState('none')\n    const setModal:SetModal = (Component, props) => {\n        const newModals = modals.map(m=>{\n            if(Component==null){\n                return {\n                    ...m,\n                    visible:false\n                }\n            }\n            else if(m.Component == Component){\n                return {\n                    Component, \n                    props:props!==null?props:m.props,\n                    visible:props!==null\n                }\n            }\n            return m        \n        })\n        setModals(newModals);\n    }\n    useEffect(()=>{\n        if (modals.filter(v=>v.visible).length == 0)\n            setAnimationType(windowType == 'landscape'?'fade':'slide')\n    }, [windowType])\n    useEffect(()=>{\n        setModals(allModals.map((Component)=>({Component, props:null, visible:false})))\n    }, [allModals])\n    return <ModalsContext.Provider value={{setModal}}>\n        {children}\n        {modals.map((modal, index)=>{\n            const { Component, props, visible } = modal;\n            return <Modal key={index} animationType={animationType as any} visible={visible} transparent>\n                <Component {...props}/>\n            </Modal>\n        })}\n    </ModalsContext.Provider>\n}\n\nexport default ()=>{\n    const modalsContext = useContext(ModalsContext)\n    return modalsContext\n}\n\n","import React, { useState } from 'react';\nimport { Text, StyleSheet, Pressable, StyleProp, ViewStyle} from 'react-native';\nimport Colors from '../constants/Colors';\nimport useColorScheme from '../hooks/useColorScheme';\nimport { CustomButtonProps } from '../types';\n\nconst DefaultButton = (props:CustomButtonProps & {borderColor:string})=>{\n    const [hover, setHover] = useState(false)\n    return <Pressable\n        onPress={()=>props.onPress()}\n        //@ts-ignore\n        onHoverIn={()=>setHover(true)}\n        onHoverOut={()=>setHover(false)}\n        disabled={props.disabled}\n        style={[\n            {\n                paddingVertical:5, \n                paddingHorizontal:16\n            },\n            props.style,\n            (hover || props.disabled)?{backgroundColor:props.color, borderColor:props.borderColor}:{}\n        ]}>\n            {props.children?props.children:\n            <Text selectable={false} style={[{fontSize:14}, props.textStyle]}>{props.title}</Text>}\n        </Pressable>\n}\n\nexport default (props:CustomButtonProps)=>{\n    const theme = useColorScheme()\n    const _props = {\n        color:Colors[theme].hoverColor,\n        borderColor:theme=='light'?Colors[theme].buttonBorderColor:'#7d8590',\n        ...props,\n        style:[\n            styles.style,\n            {\n                backgroundColor:Colors[theme].buttonBackgroundColor,\n                borderColor:Colors[theme].buttonBorderColor\n            },\n            props.style,\n        ] as StyleProp<ViewStyle>,\n        textStyle:[\n            styles.text, \n            {color:Colors[theme].text},\n            props.textStyle\n        ]\n    }\n    return <DefaultButton {..._props}/>\n}\n\nconst styles = StyleSheet.create({\n    style:{\n        borderRadius:6, \n        borderWidth:1, \n    },\n    text:{\n        textAlign:'center', \n        fontWeight:'600'\n    }\n});\n","import React, { useState, useEffect, createContext, useContext, useMemo } from 'react';\nimport { Dimensions, ScaledSize, useWindowDimensions } from 'react-native';\n//@ts-ignore\nimport useMobileDetect from 'use-mobile-detect-hook';\n\ntype WindowType = 'portrait' | 'landscape'\n\nconst getWindowType = (window:{width:number, height:number})=> window.height >= window.width?'portrait':'landscape' as WindowType;\n\nconst ResizeContextContext = createContext<WindowType>(getWindowType(Dimensions.get('window')));\n\nexport const ResizeContextProvider = ({children}:{children:React.ReactNode})=>{\n  const detectMobile = useMobileDetect();\n  const {width, height} = useWindowDimensions()\n  const [windowType, setWindowType] = useState(getWindowType({width, height}))\n  useEffect(()=>{\n    setWindowType(getWindowType({width, height}))\n  }, [width, height])\n  return <ResizeContextContext.Provider value={detectMobile.isMobile()?'portrait':windowType}>\n    {children}\n  </ResizeContextContext.Provider>\n}\n\nexport default function useResizeContext() {\n  const windowType = useContext(ResizeContextContext)\n  return windowType\n}","import React from 'react'\nimport CommonSection from \"./CommonSection\";\nimport useResizeContext from '../hooks/useResizeContext';\n\nexport default (props:{children?: React.ReactNode})=>{\n    const windowType = useResizeContext();\n    return <CommonSection\n        outerContainerStyle={{flex:1, alignSelf:'center', backgroundColor:'#8888', maxWidth:undefined, flexShrink:1}}\n        containerStyle={{flex:1, margin:0, justifyContent:'center', alignItems:'center'}}\n        bodyStyle={windowType=='landscape'?{width:'90%', height:'90%', padding:'5%'}:{width:'100%', height:'100%', maxWidth:1080}}\n    >\n        {props.children}\n    </CommonSection>\n}\n\nexport const BottomSheet = (props:{children?: React.ReactNode})=><CommonSection\n    outerContainerStyle={{flex:1, alignSelf:'center', backgroundColor:'#8888', maxWidth:undefined}}\n    containerStyle={{flex:1, margin:0, justifyContent:'flex-end'}}\n>\n    {props.children}\n</CommonSection>","import * as React from 'react';\nimport { Avatar } from 'react-native-paper';\nimport { AvatarProps } from '../../types';\n\nconst normalizeHash = (hash: number, min: number, max: number) => {\n    return Math.floor((hash % (max - min)) + min);\n};\n\nconst stringToHSL = (str: string, initHash?:number) => {\n    let hash = initHash || 0;\n    for (let i = 0; i < str.length; i++) {\n      hash = str.charCodeAt(i) + ((hash << 5) - hash);\n    }\n    hash = Math.abs(hash);\n    return `hsl(${normalizeHash(hash, 0, 360)}, ${normalizeHash(hash, 0, 100)}%, ${normalizeHash(hash, 25, 75)}%)`;\n};\n\nexport default (props:AvatarProps) => {\n    const backgroundColor = stringToHSL(props.name, props.userId)\n    return <Avatar.Text style={{backgroundColor}} size={props.size} label={props.name.split(' ').map(v=>v[0]).join().toUpperCase()} />\n};","import React from 'react';\nimport Avatar from '../lib/react-native-paper/Avatar';\nimport { AvatarProps, MessengerChannel, User } from '../types';\n\nexport function avatarFromChannel(item:MessengerChannel, user?:User|null){\n    let avatar;\n    let name = item.name\n    if (item.member_count<3){\n        avatar = (item.member_count==1 || user?.id == item.subowner.id)?item.owner:item.subowner\n        name = name.length>0?name:avatar.name \n    }\n    return {avatar, name}\n}\n\nexport default (props:AvatarProps)=>{\n    return <Avatar {...props}/>\n}\n\n","import * as React from 'react';\nimport { View, Text } from './Themed';\nimport { StyleSheet, StyleProp, ViewStyle, TextStyle } from 'react-native';\nimport Colors from '../constants/Colors';\n\nexport type SectionParamList = {\n    title?: string,\n    titleStyle?:StyleProp<TextStyle>\n    outerContainerStyle?:StyleProp<TextStyle>\n    containerStyle?:StyleProp<ViewStyle>\n    bodyStyle?:StyleProp<ViewStyle>\n    subtitle?: string\n    withSeparator?: boolean\n    children?: React.ReactNode\n}\n\nexport default function CommonSection(props:SectionParamList){\n  return (\n    <View style={[styles.outerContainer, props.outerContainerStyle]}>\n        <View style={[styles.container, props.containerStyle]}>\n            {props.withSeparator?<View style={styles.separator} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />:undefined}\n            {props.title?<View style={styles.titleView}>\n              <Text style={[styles.title, props.titleStyle]}>{props.title}</Text>\n              <Text style={styles.subtitle}>{props.subtitle}</Text>\n            </View>:undefined}\n            <View style={[styles.bodyView, props.bodyStyle]}>\n            {props.children}\n            </View>\n          </View>\n        </View>\n    )\n}\n\nconst styles = StyleSheet.create({\n  outerContainer:{\n    width:'100%',\n    maxWidth:1080,\n    alignItems:'stretch',\n    backgroundColor:'transparent'\n  },  \n  container: {\n      marginHorizontal:20,\n      marginVertical: 10,\n      backgroundColor:'transparent',\n    },\n    titleView:{\n      width: '100%',\n      flexDirection:'row',\n      backgroundColor:'transparent',\n      marginBottom:5,\n    },\n    title: {\n      flex:1,\n      fontSize: 16,\n    },\n    subtitle: {\n      flex:1,\n      fontSize: 12,\n      textAlign: 'right',\n      marginTop:4\n    },\n    separator: {\n      marginBottom: 20,\n      height: 1,\n      width: '100%',\n    },\n    bodyView:{\n      width: '100%',\n      padding: 20,\n      alignItems: 'center',\n      justifyContent: 'center',\n      borderWidth:1,\n      borderColor:Colors.borderColor,\n      borderRadius:6\n    }\n  });\n  ","import { DependencyList, useEffect } from \"react\";\nimport { EventArg, useNavigation } from \"@react-navigation/core\";\n\n\nexport default (callback:()=>void, deps?:DependencyList)=>{\n    const navigation = useNavigation()\n    useEffect(()=>{\n        const event = (e:EventArg<any, true, any>)=> {\n            e.preventDefault();\n            callback()\n        }\n        navigation.addListener('beforeRemove', event)\n        return () => {\n            navigation.removeListener('beforeRemove', event)\n        }\n  }, deps)\n}","import { useEffect } from \"react\";\nimport { useMutation, useQuery, useQueryClient } from \"react-query\";\nimport { getMessengerChannelList, postChannel, postDirectChannel, putChannel } from \"../../apis\";\nimport { MessengerChannel, MessengerContent } from \"../../types\";\nimport { Auth } from \"../useAuthContext\";\nimport useWebsocketContext from \"../useWebsocketContext\";\n\nexport default function useMessengerChannelList(auth?:Auth){\n  const queryClient = useQueryClient()\n  const {lastJsonMessage} = useWebsocketContext()\n  const { data } = useQuery(\"MessengerChannelList\" , async()=>await getMessengerChannelList(auth?.user?.id))\n\n  useEffect(()=>{\n    if(lastJsonMessage !=null){\n      if(lastJsonMessage['type']=='enter'){\n        queryClient.setQueryData<MessengerChannel[]>(\"MessengerChannelList\", (_data)=>{\n          return (_data?.find(v=>v.id==lastJsonMessage['data']['id'])?_data:[lastJsonMessage['data'] , ...(_data|| [])]).sort((a, b)=>a.id - b.id)\n        })\n      }\n      if (lastJsonMessage['type']=='next_message'){\n        const data:MessengerContent = lastJsonMessage['data']\n        queryClient.setQueryData<MessengerChannel[]>(\"MessengerChannelList\", (_data)=>(_data || []).map(v=>{\n          if (v.id == data.channel){\n            return {...v, last_message:{content:data.message_set[0]?.content, created:data.created}}\n          }\n          return v\n        }))\n      }\n      // if(lastJsonMessage['type']=='leave'){\n      //   queryClient.setQueryData<Channel[]>(\"MessengerChannelList\", (_data)=>_data?.filter(v=>v.id!=lastJsonMessage['data']['channel_id']) || [])\n      // }\n    }\n  }, [lastJsonMessage])\n  return data\n}\n\nexport function useMessengerChannelSorted(auth?:Auth){\n  const channelList = useMessengerChannelList(auth);\n  return channelList?.sort((a, b)=>(a.last_message?.created || '') < (b.last_message?.created || '')?1:-1)\n}\nexport function useMessengerChannelMutation(){\n  const queryClient = useQueryClient()\n\n  const create = useMutation(postChannel, {\n    onSuccess: ()=>queryClient.invalidateQueries(\"MessengerChannelList\")\n  });\n\n  const update = useMutation(putChannel, {\n    onSuccess: () => queryClient.invalidateQueries(\"MessengerChannelList\")\n  })\n\n  const direct = useMutation(postDirectChannel, {\n    onSuccess: () => queryClient.invalidateQueries(\"MessengerChannelList\")\n  })\n\n  return { create:create.mutateAsync, update:update.mutateAsync, direct:direct.mutateAsync}\n}","/**\n * If you are not familiar with React Navigation, refer to the \"Fundamentals\" guide:\n * https://reactnavigation.org/docs/getting-started\n *\n */\nimport { NavigationContainer, DefaultTheme, DarkTheme, NavigationContainerRef } from '@react-navigation/native';\nimport * as React from 'react';\n\nimport LinkingConfiguration from './LinkingConfiguration';\nimport RootNavigator from './RootNavigator';\n\nimport { useColorScheme as useDefaultColorScheme } from 'react-native';\nimport { useColorScheme as useColorScheme } from 'react-native-appearance';\nimport { ResizeContextProvider } from '../hooks/useResizeContext';\nimport { enableScreens } from 'react-native-screens';\nimport { replaceInviteeState } from '../hooks/useInvitee';\n\nenableScreens();\nconst navigationRef = React.createRef<NavigationContainerRef>();\n\nexport function navigate(name:string, params?:any) {\n  if (params)\n    navigationRef.current?.navigate(name, params);\n  navigationRef.current?.navigate(name);\n}\n\nexport default function Navigation() {\n  const defaultColorScheme = useDefaultColorScheme()\n  const userColorScheme = useColorScheme()\n  const colorScheme = userColorScheme =='no-preference'?defaultColorScheme:userColorScheme\n  return <NavigationContainer\n    ref={navigationRef}\n    documentTitle={{formatter: (options, route) => {return `TOKKI TOK`}}}\n    linking={(process.versions && process.versions['electron'])?undefined:LinkingConfiguration}\n    theme={colorScheme === 'dark' ? DarkTheme : DefaultTheme}>\n        <ResizeContextProvider>\n          <RootNavigator />\n        </ResizeContextProvider>\n  </NavigationContainer>\n}\n\n(function(l) {  // for github-page\n    if (l !== undefined && l.search[1] === '/' ) {\n        var decoded = l.search.slice(1).split('&').map(function(s) { \n        return s.replace(/~and~/g, '&')\n        }).join('?');\n        window.history.replaceState(null, '',\n            l.pathname.slice(0, -1) + decoded + l.hash\n        );\n    }\n}(window.location))\n\nreplaceInviteeState(window.location)\n\nconst ignoreWarnings = ['ReactNativeFiberHostComponent'];\nlet _console:any = ()=>{}\nimport('lodash').then(_=>{\n  _console = _.clone(console);\n})\nconsole.warn = (message: string|Object) => {\n    var warn = true;\n    if (message instanceof Object)\n    warn = false;\n    else{\n    ignoreWarnings.forEach((value)=>{\n        if (message.indexOf && message.indexOf(value) <= -1) {\n            warn = false;\n        }\n    })\n    };\n    if (warn){\n        _console.warn(message);\n    }\n    else{\n        // console.log(message)\n    }\n};\n","import React, { Context, createContext,  useContext, useEffect, useState } from \"react\"\nimport useWebSocket from \"react-use-websocket\"\nimport { SendJsonMessage } from \"react-use-websocket/dist/lib/types\"\nimport {websockerURL } from \"../constants/Envs\"\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\nimport { AppState, AppStateStatus } from \"react-native\";\n\ntype WebsocketContextType = {lastJsonMessage:any, sendJsonMessage:SendJsonMessage }\nconst defaultContext = {lastJsonMessage:undefined, sendJsonMessage:()=>{}}\nconst WebSocketContext = createContext<WebsocketContextType>(defaultContext);\n\nexport const WebSocketInternalProvider = ({children, path, Context, useBackground}:{children:React.ReactNode, path:string, Context:Context<WebsocketContextType>, useBackground?:boolean})=>{\n  const [token, setToken] = useState<string|null>(null)\n  const [isActive, setIsActive] = useState<boolean>(useBackground || AppState.currentState == 'active')\n  const { lastJsonMessage, sendJsonMessage } = useWebSocket(`${websockerURL}/${path}`,{\n    shouldReconnect: (closeEvent) => true,\n    protocols: token?['Authorization',  token]:undefined,\n    onOpen: (e)=>{console.log(`success websocket connection(${path})`)},\n    onClose: (e)=> {console.log(`closed websocket connection(${path})`)},\n  }, isActive && token!=null)\n  useEffect(()=>{\n    AsyncStorage.getItem('Authorization').then(setToken)\n    const onChange = (nextState:AppStateStatus)=>setIsActive(useBackground || nextState == 'active')\n    AppState.addEventListener(\"change\", onChange)\n    return ()=>AppState.removeEventListener(\"change\", onChange)\n  }, [])\n  return <Context.Provider value={token!=null?{lastJsonMessage, sendJsonMessage}:defaultContext}>\n      {children}\n    </Context.Provider>\n}\n\nexport const WebSocketProvider = ({disable, children}:{disable?:boolean, children:React.ReactNode})=>{\n  return disable?<>{children}</>:<WebSocketInternalProvider path={'messenger/ws/'} Context={WebSocketContext}>\n    {children}\n  </WebSocketInternalProvider>\n}\n\nexport default ()=>{\n  const webSocketContext = useContext(WebSocketContext)\n  return webSocketContext\n}\n\n","import { useMutation, useQuery, useQueryClient } from \"react-query\";\nimport { deleteUser, getUserMembershipList, patchUser, postUser } from \"../../apis\";\nimport useAuthContext, { Auth } from \"../useAuthContext\";\n\nexport default function useUserMembershipList(auth?:Auth){\n  const { data } = useQuery([\"UserMembershipList\", auth?.groupId] , async()=>auth?.groupId?(await getUserMembershipList(auth?.groupId)):[])\n  return data\n}\n\nexport function useUserMembershipMutation(){\n  const queryClient = useQueryClient()\n  const { auth, dispatch } = useAuthContext()\n  const _create = useMutation(postUser, {\n    onSuccess: ()=>{\n      queryClient.invalidateQueries(\"UserMembershipList\")\n    }\n  })\n  const _update = useMutation(patchUser, {\n    onSuccess: (data, user)=>{\n      queryClient.invalidateQueries(\"UserMembershipList\")\n      if (user.id == auth.user?.id)\n        dispatch({type:\"REFRESH\"})\n      \n    }\n  })\n  const _delete = useMutation(deleteUser, {\n    onSuccess: (data, id)=>{\n      queryClient.invalidateQueries(\"UserMembershipList\")\n      if (id == auth.user?.id)\n        dispatch({type:\"LOGOUT_REQUEST\"})\n    }\n  })\n  return {create:_create.mutateAsync, update:_update.mutateAsync, delete:_delete.mutateAsync}\n}","import React, { useState } from 'react';\nimport { StyleSheet} from 'react-native';\nimport { CustomButtonProps } from '../types';\nimport CommonButton from './CommonButton';\n\nexport default (props:CustomButtonProps)=>{\n    return <CommonButton {...props} style={[styles.style, props.style]}/>\n}\n\nconst styles = StyleSheet.create({\n    style:{\n        borderRadius:6, \n        backgroundColor: 'transparent',\n        borderWidth:0\n    },\n});\n","import { useMutation, useQuery, useQueryClient } from \"react-query\";\nimport { postBulkMessengerMember, deleteMessengerMember, getMessengerMemberList } from \"../../apis\";\n\nexport default function useMessengerMemberList(channel_id:number){\n  const { data } = useQuery([\"MessengerMemberList\", channel_id] , async()=>await getMessengerMemberList(channel_id))\n  return data\n}\n\n\nexport function useMessengerMemberMutation(){\n  const queryClient = useQueryClient()\n  const invite = useMutation(postBulkMessengerMember, {\n    onSuccess: ()=>{\n      queryClient.invalidateQueries(\"MessengerMemberList\")\n    }\n  })\n\n  const leave = useMutation(deleteMessengerMember, {\n    onSuccess: () => {\n      queryClient.invalidateQueries(\"MessengerChannelList\")\n      queryClient.invalidateQueries(\"MessengerMemberList\")\n    }\n  })\n  return {invite:invite.mutateAsync, leave:leave.mutateAsync}\n}","import React, {useState, useEffect } from 'react';\nimport { StyleSheet } from 'react-native';\nimport { View, Text } from '../components/Themed';\nimport CommonButton from '../components/CommonButton';\n// import useBoardChannelList, { useBoardChannelMutation } from '../hooks/lists/useBoardChannelList';\nimport useAuthContext from '../hooks/useAuthContext';\nimport { navigate } from '../navigation';\nimport { Channel } from '../types';\nimport useMessengerChannelList, { useMessengerChannelMutation } from '../hooks/lists/useMessengerChannelList';\nimport TextField from '../components/TextField';\nimport useModalsContext from '../hooks/useModalsContext';\nimport useLangContext from '../hooks/useLangContext';\nimport ModalSection from '../components/ModalSection';\nimport { useMessengerMemberMutation } from '../hooks/lists/useMessengerMemberList';\nimport { avatarFromChannel } from '../components/Avatar';\nimport useModalEffect from '../hooks/useModalEffect';\n\nexport default function ChannelEditModal({id, member_id, type}: {id?:number, member_id?:number, type:string}) {\n  const { lang } = useLangContext()\n  const {auth} = useAuthContext()\n  const { setModal } = useModalsContext()\n  const channelList = useMessengerChannelList(auth)\n  const channelMutation = useMessengerChannelMutation()\n  const messengerMemberMutation = useMessengerMemberMutation()\n  const channel = channelList?.find(v=>v.id==id)\n  const [name, setName] = useState('')\n  const [description, setDescription] = useState('')\n  const back = ()=>{\n    setModal(ChannelEditModal, null)\n  }\n\n  useEffect(()=>{\n    if (channel){\n      const {name:_name} = avatarFromChannel(channel, auth.user)\n      setName(_name)\n      setDescription(channel?.description || '')\n    }\n  }, [channel])\n  useModalEffect(back, [])\n  return <ModalSection>\n    <View style={{justifyContent:'space-between', flex:1, width:'100%'}}>\n      <View style={{width:'100%'}}>\n        <Text style={{fontSize:20}}>{id?lang('Chat Setting'):lang('New chat')}</Text>\n        <View style={styles.separator} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\n        <TextField name={lang('Channel Name')} value={name} setValue={setName} width={'60%'}/>\n        <TextField name={lang('Description')} value={description} setValue={setDescription} multiline width={'60%'}/>\n      </View>\n      <View style={{width:'100%', flexDirection:'row'}}>\n        {member_id &&<View style={{flexDirection:'row', justifyContent:'flex-start'}}>\n          <CommonButton title={lang('leave')} style={{marginHorizontal:5}} textStyle={{color:'red'}} onPress={()=>messengerMemberMutation.leave(member_id).then(back)}/>\n        </View>}\n        <View style={{flex:1, flexDirection:'row', justifyContent:'flex-end'}}>\n          <CommonButton title={lang('save')} onPress={()=>{\n            if(auth?.user?.id && auth.groupId){\n              const newChannel:Channel = {id, name, description, type, owner:auth?.user?.id, group:auth.groupId};\n              (id?channelMutation.update(newChannel):channelMutation.create(newChannel)).then(v=>navigate(\"Main\", {\n                screen:v.type == 'messenger'?'ChatScreen':'BoardScreen',\n                params:{id:v.id}\n              }))\n            }\n          }}/>\n          <CommonButton title={lang('cancel')} style={{marginHorizontal:5}} onPress={back}/>\n        </View>\n      </View>\n    </View>\n  </ModalSection>\n}\n\nconst styles = StyleSheet.create({\n  field:{\n    width:'50%',\n    flexDirection:'row',\n    padding:10,\n  },\n  separator: {\n    marginBottom: 20,\n    height: 1,\n    width: '100%',\n  },\n})","import React, { useState, useEffect } from \"react\";\nimport { StyleSheet, TextInput } from \"react-native\";\nimport useLangContext from \"../hooks/useLangContext\";\nimport useUserMembershipList, { useUserMembershipMutation } from \"../hooks/lists/useUserMembershipList\";\nimport useAuthContext from \"../hooks/useAuthContext\";\nimport ModalSection from \"../components/ModalSection\";\nimport useModalsContext from \"../hooks/useModalsContext\";\nimport { View, Text } from \"../components/Themed\";\nimport RowField from \"../components/RowField\";\nimport CommonButton from \"../components/CommonButton\";\nimport CommonTextInput from \"../components/CommonTextInput\";\n// import TextButton from \"../components/TextButton\";\n// import Colors from \"../constants/Colors\";\n// import useColorScheme from \"../hooks/useColorScheme\";\n\ntype ErrorMessages = {\n    username?:string,\n    name?:string,\n    password?:string,\n    checkPassword?:string\n}\n\nconst ErrorView = (props:{message?:string})=>{\n  const { lang } = useLangContext()\n  return props.message?<View style={styles.form_error}>\n  <Text style={styles.form_error_text}>{lang(props.message)}</Text>\n</View>:<></>\n}\n\nexport default function RegistrationModal({id}:{id?:number}) {\n  const { lang } = useLangContext()\n  const {auth} = useAuthContext()\n  // const theme = useColorScheme()\n  // const color = Colors[theme].text\n  const { setModal } = useModalsContext()\n  const [username, setUsername] = useState(\"\");\n  const [name, setName] = useState(\"\")\n  const [password, setPassword] = useState(\"\");\n  const [checkPassword, setCheckPassword] = useState(\"\")\n  const [isStaff, setIsStaff] = useState(false)\n  const [error, setError] = useState<ErrorMessages>({})\n  const userList = useUserMembershipList(auth)\n  const userMembershipMutation = useUserMembershipMutation()\n  const user = userList?.find(v=>v.id==id)\n  useEffect(()=>{\n    if (user){\n      setUsername(user.username)\n      setName(user.name)\n    }\n  }, [user])\n  const _register = ()=>{\n    let newError:ErrorMessages = {};\n    if (userList?.find(v=>v.username == username) && !id) newError.username = \"The username is already in use.\"\n    if (username.length < 10 || username.length > 64) newError.username = \"Set 10-64 characters.\"\n    if (name.length < 1 || name.length > 64) newError.name = \"Set 1-64 characters.\"\n    if (!/^(?=.*[A-Za-z])(?=.*\\d)(?=.*[@$!%*#?&])[A-Za-z\\d@$!%*#?&]{10,64}$/.test(password) && !(id && password.length==0)) newError.password = \"Set 10-64 characters with a combination of letters/numbers/valid special characters.\"\n    if (password != checkPassword) newError.checkPassword = \"Incorrect between password and check password.\"\n    if (Object.keys(newError).length > 0){\n        setError(newError)\n        return\n    }\n    if (id){\n      userMembershipMutation.update({\n        id,\n        name,\n        password:password.length>0?password:undefined,\n      }).then(()=>{id!=auth.user?.id && back()})\n    }\n    else{\n      auth?.groupId && userMembershipMutation.create({\n          username,\n          name,\n          password,\n          is_guest:false,\n          is_staff:isStaff,\n          inviteGroupId:auth.groupId,\n\n      }).then(back)\n    }\n  }\n  const back = ()=>{\n    setModal(RegistrationModal, null)\n  }\n\n  return <ModalSection>\n    <View style={{justifyContent:'space-between', flex:1, width:'100%'}}>\n      <View style={{flex:1, width:'100%'}}>\n        <Text style={{fontSize:20}}>{lang('Create User')}</Text>\n        <View style={styles.separator} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\n        <RowField name={lang('Username')} width={'60%'}>\n          {id?<Text style={{fontSize:16}}>{username}</Text>:<CommonTextInput\n              value={username}\n              setValue={(text) => setUsername(text)}\n              keyboardType={'email-address'}\n          />}\n          <ErrorView message={error.username}/>\n        </RowField>\n        <RowField name={lang('Name')} width={'60%'}>\n          <CommonTextInput\n              value={name}\n              setValue={(text) => setName(text)}\n          />\n          <ErrorView message={error.name}/>\n        </RowField>\n        <RowField name={lang('Password')} width={'60%'}>\n          <CommonTextInput\n              value={password}\n              secureTextEntry\n              setValue={(text) => setPassword(text)}\n          />\n          <ErrorView message={error.password}/>\n        </RowField>\n        <RowField name={lang('Check Password')} width={'60%'}>\n          <CommonTextInput\n              value={checkPassword}\n              secureTextEntry\n              setValue={(text) => setCheckPassword(text)}\n          />\n          <ErrorView message={error.checkPassword}/>\n        </RowField>\n        {/* <RowField name={lang('Manager Permission')} width={'60%'}>\n          <View style={{flexDirection:'row'}}>\n            {[[lang('Yes'), true], [lang('No'), false]].map(([title, value])=><TextButton \n              key={title} title={title} textStyle={{fontSize:16, color, textDecorationLine:isStaff==value?'underline':'none'}} style={{borderRadius:20}} onPress={(\n              )=>setIsStaff(value)}/>)}\n          </View>\n        </RowField> */}\n      </View>\n      <View style={{width:'100%', flexDirection:'row'}}>\n        {id && <View style={{flexDirection:'row', justifyContent:'flex-start'}}>\n          <CommonButton title={lang('delete account')} style={{marginHorizontal:5}} textStyle={{color:'red'}} onPress={()=>userMembershipMutation.delete(id).then(back)}/>\n        </View>}\n        <View style={{flex:1, flexDirection:'row', justifyContent:'flex-end'}}>\n          <CommonButton title={lang('save')} onPress={_register}/>\n          <CommonButton title={lang('cancel')} style={{marginHorizontal:5}} onPress={back}/>\n        </View>\n      </View>\n    </View>\n  </ModalSection>\n};\n\nconst styles = StyleSheet.create({\n  form_error: {\n    height: 22,\n    width:'100%',\n  },\n  form_error_text:{\n    textAlignVertical:'center',\n    color:'red',\n    fontSize:13,\n  },\n  separator: {\n    marginBottom: 20,\n    height: 1,\n    width: '100%',\n  },\n});","import React from 'react'\nimport TextButton from \"./TextButton\"\nimport useAuthContext from \"../hooks/useAuthContext\"\nimport useResizeContext from '../hooks/useResizeContext'\nimport { View } from 'react-native'\nimport useModalsContext from '../hooks/useModalsContext'\nimport AlertModal from '../modals/AlertModal'\nimport useLangContext from '../hooks/useLangContext'\nimport useColorScheme from '../hooks/useColorScheme'\nimport Colors from '../constants/Colors'\n\ntype ButtonProps = {title:string, onPress:()=>void, windowType?:'landscape'|'portrait'}\n\nexport default (props:{extra?:ButtonProps[]})=>{\n    const { lang } = useLangContext()\n    const theme = useColorScheme()\n    const {auth, dispatch} = useAuthContext()\n    const { setModal } = useModalsContext()\n    const windowType = useResizeContext()\n    const defaultButtonProps:ButtonProps[] = [{title:lang('sign out'), onPress:()=>{\n        if (auth?.user?.is_guest){\n            setModal(AlertModal, {type:\"GUEST_LOGOUT\"})\n        }\n        else{\n            dispatch({type:\"LOGOUT_REQUEST\"})\n        }\n    }}]\n    const buttonProps = (props.extra?[...props.extra, ...defaultButtonProps]:defaultButtonProps).filter(v=>v.windowType==windowType || v.windowType == undefined)\n    return<View style={{flexDirection:'row'}}>\n        {buttonProps.map((v,k)=><TextButton key={k} {...v} textStyle={{color:Colors[theme].text}} color='#gray'/>)}\n    </View>\n}\n  ","import React, { useMemo } from 'react';\n\nimport { TextProps, StyleProp } from 'react-native';\nimport {View, Text } from './Themed'\nimport useResizeContext from '../hooks/useResizeContext';\n\ntype Props = {\n  name: string,\n  width?:any,\n  children: React.ReactNode\n  textStyle?: StyleProp<TextProps>\n}\n\nexport default function RowField(props:Props) {\n  const windowType = useResizeContext()\n  const rowStyle = useMemo(()=>windowType=='landscape'?\n    {flexDirection:'row', alignItems: 'center', justifyContent:'space-between'}:\n    {flexDirection:'column', alignItems:'flex-start'} as any\n  , [windowType])\n  return (\n    <View style={[{paddingVertical:windowType=='landscape'?15:5, width:'100%'}, rowStyle]}>\n        <Text style={[windowType=='landscape'?{flex:1}:{width:'100%'},{paddingHorizontal: 15, fontSize:16}, props.textStyle]}>{props.name}</Text>\n        <View style={[windowType=='landscape'?{flex:6}:{width:'100%'},{paddingHorizontal: 15}]}>\n          <View style={{width:props.width}}>\n            {props.children}\n          </View>\n        </View>\n    </View>\n  )\n}","import React from 'react';\nimport { TabView, SceneMap,NavigationState, SceneRendererProps, TabBar } from 'react-native-tab-view';\nimport Colors from '../constants/Colors';\nimport useColorScheme from '../hooks/useColorScheme';\nimport useLangContext from '../hooks/useLangContext';\nimport { TabViewRecord } from '../types';\n\n\nexport default (props:{tabs:TabViewRecord, tabBarPosition:\"top\"|\"bottom\", index?:number, onTab?:(index:number)=>void})=>{\n  const { lang } = useLangContext()\n  const [index, setIndex] = React.useState(props.index || 0);\n  const theme = useColorScheme()\n  const entries = Object.entries(props.tabs)\n  const onTab = props.onTab\n  const icons = Object.assign({}, ...entries.map(([k, v])=>({[k]:v.icon})))\n  return <TabView\n    renderTabBar={(props:SceneRendererProps & {navigationState: NavigationState<any>})=>{\n      return <TabBar\n        {...props}\n        indicatorStyle={{ backgroundColor: \"#2196F3\" }}\n        style={{ backgroundColor:Colors[theme].background }}\n        activeColor={Colors[theme].text}\n        inactiveColor={Colors[theme].text}\n        renderIcon={(scene)=>icons[scene.route.key]}\n        onTabPress={(scene)=>onTab?.(entries.findIndex(([k, v])=>k == scene.route.key))}\n      />\n    }}\n    navigationState={{ index, routes: entries.map(([k, v])=>({key:k, title:lang(v.title)}))}}\n    onIndexChange={setIndex}\n    renderScene={SceneMap(Object.assign({}, ...entries.map(([k, v])=>({[k]:v.component}))))}\n    tabBarPosition={props.tabBarPosition}\n  />\n}\n\n","import * as React from 'react';\nimport { View } from './Themed';\nimport { StyleSheet, StyleProp, ViewStyle, TextStyle, Pressable } from 'react-native';\nimport Colors from '../constants/Colors';\n\nexport type ItemParamList = {\n    outerContainerStyle?:StyleProp<TextStyle>\n    containerStyle?:StyleProp<ViewStyle>\n    bodyStyle?:StyleProp<ViewStyle>\n    children?: React.ReactNode\n    onPress?: ()=>void\n}\n\nexport default function CommonItem(props:ItemParamList){\n  // const [hover, setHover] = React.useState(false)\n  const [press, setPress] = React.useState(false)\n  return (\n    <Pressable\n      style={[styles.outerContainer ,props.outerContainerStyle, (press)?{backgroundColor:'rgb(242,242,242)'}:{}]}\n      onPressIn={()=>setPress(true)}\n      onPress={()=>props.onPress?.()}\n      onPressOut={()=>setPress(false)}\n      //  //@ts-ignore\n      //  onHoverIn={()=>setHover(true)}\n      //  onHoverOut={()=>setHover(false)}\n    >\n        <View style={[styles.container ,props.containerStyle]}>\n            <View style={[styles.bodyView, props.bodyStyle]}>\n                <>{props.children}</>\n            </View>\n      </View>\n    </Pressable>\n    )\n}\n\nconst styles = StyleSheet.create({\n  outerContainer:{\n    width:'100%',\n    maxWidth:1080,\n    alignItems:'stretch',\n  },  \n  container: {\n      marginHorizontal:20,\n      backgroundColor:'transparent'\n    },\n    bodyView:{\n      width: '100%',\n      padding: 10,\n      minHeight: 40,\n      alignItems: 'center',\n      justifyContent: 'center',\n      borderBottomWidth:1,\n      borderColor:Colors.borderColor,\n      backgroundColor:'transparent'\n    }\n  });\n  ","import React, { useEffect } from 'react';\nimport Profile from '../components/Profile';\nimport useAuthContext from '../hooks/useAuthContext';\nimport useUserMembershipList from '../hooks/lists/useUserMembershipList';\nimport { useMessengerChannelMutation } from '../hooks/lists/useMessengerChannelList';\nimport CommonButton from '../components/CommonButton';\nimport { Channel } from '../types';\nimport { navigate } from '../navigation';\nimport useModalsContext from '../hooks/useModalsContext';\nimport { Text, View } from '../components/Themed';\nimport useLangContext from '../hooks/useLangContext';\nimport { Ionicons } from '../lib/@expo/vector-icons';\nimport { TouchableOpacity } from 'react-native-gesture-handler';\nimport Colors from '../constants/Colors';\nimport useColorScheme from '../hooks/useColorScheme';\nimport { BottomSheet } from '../components/ModalSection';\nimport useModalEffect from '../hooks/useModalEffect';\n\nexport default function ProfileModal({id}:{id:number}) {\n  const { lang } = useLangContext()\n  const theme = useColorScheme()\n  const {auth} = useAuthContext()\n  const { setModal } = useModalsContext()\n  const userList = useUserMembershipList(auth)\n  const user = userList?.find(v=>v.id==id)\n  const isSelf = auth.user && user && (auth.user?.id==user?.id)\n  const channelMutation = useMessengerChannelMutation()\n  const back = ()=>{\n    setModal(ProfileModal, null)\n  }\n  useEffect(()=>{\n    if (!(id && user) && userList)\n      back()\n  }, [userList])\n  useModalEffect(back, [])\n  return user?<BottomSheet>\n    <View style={{flexDirection:'row', width:'100%'}}>\n      <View style={{flex:1, flexDirection:'row'}}>\n        <TouchableOpacity onPress={back}>\n          <Ionicons size={20} name=\"arrow-back\" color={Colors[theme].text}/>\n        </TouchableOpacity>\n      </View>\n      <View style={{flex:1}}>\n        <Text style={{fontSize:20, textAlign:'center'}}>{lang('profile')}</Text>\n      </View>\n      <View style={{flex:1}}/>\n    </View>\n    <View style={{marginBottom: 20, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\n    \n    <Profile username={user.username} name={user.name} userId={user.id} />\n    <CommonButton title={lang(isSelf?'Chat with me':'1:1 Chat')} onPress={()=>{\n      if(auth?.user?.id && auth.groupId){\n        const newChannel:Channel = {name:\"\", type:'messenger', owner:auth?.user?.id, group:auth.groupId, subowner:isSelf?undefined:user.id};\n        channelMutation.direct(newChannel).then(v=>navigate(\"Main\", {screen:\"ChatScreen\", params: {id:v.id}}))\n      }\n    }}/>\n  </BottomSheet>:<></>\n}\n","import { useEffect } from \"react\"\nimport { InfiniteData, Query, QueryKey, useInfiniteQuery, useMutation, useQueryClient } from \"react-query\"\nimport { getMessengerContentList, postMessage, patchMessengerContent, getNewMessengerContentList } from \"../../apis\"\nimport { MessengerContent } from \"../../types\"\nimport useWebsocketContext from \"../useWebsocketContext\"\n\nexport type MessengerContentPage = {\n  next?:MessengerContentPage\n  current:MessengerContent[]\n}\n\nconst updateContnetPage = (pages:MessengerContentPage[], updateMessages:MessengerContent[])=>{\n  let update_i = 0\n  pages.forEach(page=>{\n    if (update_i == updateMessages.length)\n      return\n    page.current.forEach(v=>{\n      if (update_i == updateMessages.length)\n        return\n      if (v.id==updateMessages[update_i].id){\n        v.timer = updateMessages[update_i].timer\n        v.is_archive = updateMessages[update_i].is_archive\n        update_i += 1\n      }\n    })\n    page.current = page.current.filter(v=>!v.is_archive)\n  })\n}\n\nexport default function useMessengerContentList(channel_id:number){  \n  const queryClient = useQueryClient()\n  const refetch = (query:Query<MessengerContentPage, unknown, InfiniteData<MessengerContentPage>, QueryKey>)=>{\n    const updated_gte = new Date(query.state.dataUpdatedAt).toISOString()\n    const newData = {...query.state.data}\n    getNewMessengerContentList(channel_id, updated_gte).then(contents=>{\n      if(newData.pages){\n        const lastMessageId = newData.pages[0].current[0].id || 0\n        const nextMessages = contents.filter(v=>v.id>lastMessageId && v.is_archive==false)\n        const updateMessages = contents.filter(v=>v.id<=lastMessageId)\n        const timerMessageRefetch = nextMessages.findIndex(v=>v.timer) >= 0 || updateMessages.length > 0\n        newData.pages[0].current = [...nextMessages, ...newData.pages[0].current]\n        updateContnetPage(newData.pages, updateMessages)\n        timerMessageRefetch && queryClient.invalidateQueries([\"TimerMessageContentList\", channel_id])\n      }\n    })\n    return false\n  }\n  const { data, fetchNextPage } = useInfiniteQuery<MessengerContentPage>(\n    [\"MessengerContentList\", channel_id], \n    async({pageParam})=>getMessengerContentList(channel_id, pageParam).then(current=>({current})), \n    {\n      select:data=>{\n        if(data.pages.length > 1)\n          data.pages[data.pages.length - 2].next = data.pages[data.pages.length - 1]\n        return data;\n      },\n      getNextPageParam:(lastPage)=>lastPage?.current.length?lastPage.current[lastPage.current.length - 1].id:undefined,\n      refetchOnReconnect:false,\n      refetchOnWindowFocus:refetch\n    }\n  )\n  const { lastJsonMessage } = useWebsocketContext()\n  useEffect(()=>{\n    if(lastJsonMessage !=null && lastJsonMessage['data']['channel'] == channel_id){\n      if(lastJsonMessage['type']=='next_message'){\n        queryClient.setQueryData<InfiniteData<MessengerContentPage>>([\"MessengerContentList\", channel_id], (_data)=>{\n          if(_data?.pages[0].current && _data?.pages[0].current[0].id != lastJsonMessage['data'].id)\n            _data.pages[0].current = [lastJsonMessage['data'], ..._data?.pages[0].current]\n          return {...(_data || {pages:[], pageParams:[]})}\n        })\n      }\n      if(lastJsonMessage['type']=='update_message'){\n        queryClient.setQueryData<InfiniteData<MessengerContentPage>>([\"MessengerContentList\", channel_id], (_data)=>{\n          _data?.pages && updateContnetPage(_data.pages, [lastJsonMessage['data']])\n          return {...(_data || {pages:[], pageParams:[]})}\n        })\n      }\n    }\n  }, [lastJsonMessage])\n  return { data, fetchNextPage }\n}\n\nexport function useMessengerContentMutation(channelId?:number){\n  // const queryClient = useQueryClient()\n  const create = useMutation(postMessage, {\n    onSuccess: () => {\n      // queryClient.setQueryData(['MessengerContentList'], (data:any) => ({\n      //   pages: data.pages.slice(0, 1),\n      //   pageParams: data.pageParams.slice(0, 1),\n      // }))\n      // queryClient.invalidateQueries(\"MessengerContentList\")\n    }\n  });\n  const _patch = useMutation(patchMessengerContent);\n  return { create:create.mutate, patch:_patch.mutate }\n}","import React from 'react';\nimport useAuthContext from '../hooks/useAuthContext';\nimport CommonButton from '../components/CommonButton';\nimport useModalsContext from '../hooks/useModalsContext';\nimport { Text, View } from '../components/Themed';\nimport useLangContext from '../hooks/useLangContext';\nimport { BottomSheet } from '../components/ModalSection';\nimport useModalEffect from '../hooks/useModalEffect';\n\n\nexport default function AlertModal({type}:{type:string}) {\n  const { lang } = useLangContext()\n  const { setModal } = useModalsContext()\n  const {dispatch} = useAuthContext()\n  const back = ()=>{\n    setModal(AlertModal, null)\n  }\n  const messages = {\n    \"GUEST_LOGOUT\":{\n      message: 'Guest users cannot reconnect after logging out. Please create an account or log in.',\n      title: 'sign out',\n      onPress: ()=>dispatch({type:\"LOGOUT_REQUEST\"})\n    }\n  } as Record<string, {message:string, title:string, onPress:()=>void}>\n\n  useModalEffect(back, [])\n  return <BottomSheet>\n    <Text>{lang(messages[type].message)}</Text>\n    <View style={{width:'100%', flexDirection:'row', justifyContent:'flex-end'}}>\n      <CommonButton title={lang(messages[type].title)} onPress={messages[type].onPress}/>\n      <CommonButton title={lang('cancel')} onPress={()=>back()}/>\n    </View>\n  </BottomSheet>\n}\n","import React from 'react';\nimport { StyleProp, TextStyle } from 'react-native';\nimport { CustomTextInputProps } from '../types';\nimport CommonTextInput from './CommonTextInput';\nimport RowField from './RowField';\n\nexport default function TextField(props:CustomTextInputProps & {name: string, width?:any, textStyle?:StyleProp<TextStyle>}) {\n  return (\n    <RowField name={props.name} width={props.width} textStyle={props.textStyle}>\n      <CommonTextInput {...props} />\n   </RowField>\n  )\n}","import React, { useState } from 'react';\nimport { TextInput } from 'react-native';\nimport Colors from '../constants/Colors';\nimport useColorScheme from '../hooks/useColorScheme';\nimport { CustomTextInputProps } from '../types';\n\nexport default (props:CustomTextInputProps)=>{\n    const [contentHeight, setContentHeight] = useState<number>()\n    const minHeight = props.minHeight || 30\n    const theme = useColorScheme()\n    return <TextInput style={[{\n            borderColor:'#d0d7de', \n            fontSize:16, \n            borderWidth:1, \n            borderRadius:6, \n            paddingHorizontal:10, \n            paddingVertical:3, \n            backgroundColor:Colors[theme].background,\n            color:Colors[theme].text,\n            height:props.multiline?contentHeight:minHeight,\n        }, props.style]}\n        placeholder={props.placeholder}\n        editable={!props.disabled} \n        keyboardType={props.keyboardType}\n        secureTextEntry={props.secureTextEntry}\n        value={props.value}\n        onChangeText={props.setValue}\n        onContentSizeChange={props.multiline?(e) => setContentHeight(Math.max(e.nativeEvent.contentSize.height, minHeight) + 2):undefined}\n        onBlur={()=>props.onBlur?.(props.value)}\n        onEndEditing={()=>props.onEndEditing?.(props.value)}\n        multiline={props.multiline}\n    />\n}","import React from \"react\"\nimport CommonItem from \"./CommonItem\"\nimport { UserMembership } from \"../types\"\nimport Avatar from \"./Avatar\"\nimport { Text, View } from \"./Themed\"\n\nexport default ({member:item, onPress}:{member:UserMembership, onPress?:()=>void})=> {\n    return <CommonItem key={item.id} bodyStyle={{flexDirection:'row', justifyContent:'flex-start'}} onPress={onPress}>\n        <View style={{marginTop:4, marginRight:12}}><Avatar name={item.name} userId={item.id} size={44}/></View>\n        <Text style={{fontSize:20, fontWeight:'400'}}>{item.name}</Text>\n    </CommonItem>\n}","import React, { Suspense, useState } from 'react';\nimport CommonButton from '../components/CommonButton';\nimport useModalsContext from '../hooks/useModalsContext';\nimport { Text, View } from '../components/Themed';\nimport useLangContext from '../hooks/useLangContext';\nimport { Ionicons } from '../lib/@expo/vector-icons';\nimport { TouchableOpacity } from 'react-native-gesture-handler';\nimport Colors from '../constants/Colors';\nimport useColorScheme from '../hooks/useColorScheme';\nimport { BottomSheet } from '../components/ModalSection';\nimport dayjs from 'dayjs';\nimport useModalEffect from '../hooks/useModalEffect';\n\nconst dayTypes = ['AM', 'PM'].map(value=>({label:value, value}))\nconst hours = [...Array(12).keys()].map((value, index)=>(index + 1).toString().padStart(2, '0')).map(value=>({label:value, value}))\nconst minutes = [...Array(12).keys()].map((value, index)=>(index * 5).toString().padStart(2, '0')).map(value=>({label:value, value}))\n\n\nconst getDisableDays=(date:dayjs.Dayjs)=>{\n  let startDate = date.clone().startOf('month').add(-1, 'month')\n  const endDate = date.clone().endOf('month').add(1, 'month')\n  const today = dayjs().startOf('day')\n  const result = []\n  while(startDate<=endDate && startDate<today){\n    result.push(startDate.format('YYYY-MM-DD'))\n    startDate = startDate.add(1, 'day')\n  }\n  return result\n}\n\nconst defaultDayjs = ()=>{\n  const m = dayjs()\n  const restMinute = parseInt(m.format('mm')) % 5\n  return m.add(5-restMinute, 'minute')\n}\n\nconst Calendar = React.lazy(()=> import('../components/Calendar'))\nconst CommonPicker = React.lazy(()=>import('../components/CommonPicker'))\n\nexport default function DateTimePickerModal({datetime, callback}:{datetime?:string, callback:(datetime?:string)=>void}) {\n  const _dayjs = datetime?dayjs(datetime):defaultDayjs()\n  const { lang, locale } = useLangContext()\n  const theme = useColorScheme()\n  const [date, setDate] = useState(_dayjs.format('YYYY-MM-DD'));\n  const [dayType, setDayType] = useState(_dayjs.locale('en').format('A'))\n  const [hour, setHour] = useState(_dayjs.format('hh'))\n  const [minute, setMinute] = useState(_dayjs.format('mm'))\n  const [disableDays, setDisableDays] = useState<string[]>(getDisableDays(_dayjs))\n  const { setModal } = useModalsContext()\n  const back = ()=>{\n    setModal(DateTimePickerModal, null)\n  }\n  useModalEffect(back, [])\n  return <BottomSheet>\n    <View style={{flexDirection:'row', width:'100%'}}>\n      <View style={{flex:1, flexDirection:'row'}}>\n        <TouchableOpacity onPress={back}>\n          <Ionicons size={20} name=\"arrow-back\" color={Colors[theme].text}/>\n        </TouchableOpacity>\n      </View>\n      <View style={{flex:1}}>\n        <Text style={{fontSize:20, textAlign:'center'}}>{lang('Date & Time')}</Text>\n      </View>\n      <View style={{flex:1}}/>\n    </View>\n    <View style={{marginBottom: 20, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\n    <Suspense fallback={<></>}>\n      <Calendar\n        locale={locale}\n        style={undefined} \n        setDate={setDate}\n        disableAllTouchEventsForDisabledDays={true}\n        onMonthChange={(v)=>setDisableDays(getDisableDays(dayjs(v.dateString)))}\n        markedDates={{\n          ...disableDays.reduce((p, c)=>{p[c]={disabled:true};return p}, {} as Record<string, any>),\n          ...(date?[date]:[]).reduce((p, c)=>{p[c]={selected:true};return p}, {} as Record<string, any>)\n        }}\n      />\n      <View style={{flexDirection:'row', paddingVertical:10, width:400, height:50}}>\n        <CommonPicker value={dayType} setValue={setDayType} values={dayTypes}/>\n        <Text style={{fontSize:20}}> </Text>\n        <CommonPicker value={hour} setValue={setHour} values={hours}/>\n        <Text style={{fontSize:20}}> : </Text>\n        <CommonPicker value={minute} setValue={setMinute} values={minutes}/>\n      </View>\n    </Suspense>\n    <View style={{flexDirection:'row'}}>\n      <CommonButton title={lang('save')} onPress={()=>{\n        callback?.(dayjs(`${date} ${hour}:${minute} ${dayType}`).toISOString())\n        back()\n      }}/>\n      <CommonButton title={lang('cancel')} onPress={()=>{\n        callback?.(undefined)\n        back()\n      }}/>\n      \n    </View>\n  </BottomSheet>\n}\n","import React from 'react';\nimport Clipboard from '@react-native-clipboard/clipboard/dist';\nimport CommonButton from '../components/CommonButton';\nimport useModalsContext from '../hooks/useModalsContext';\nimport { Text, View } from '../components/Themed';\nimport useLangContext from '../hooks/useLangContext';\nimport { BottomSheet } from '../components/ModalSection';\nimport { TouchableOpacity } from 'react-native-gesture-handler';\nimport Colors from '../constants/Colors';\nimport { Ionicons } from '../lib/@expo/vector-icons';\nimport useColorScheme from '../hooks/useColorScheme';\nimport { useMessengerContentMutation } from '../hooks/lists/useMessengerContentList';\nimport useModalEffect from '../hooks/useModalEffect';\n\nexport default function MessageModal({id,  content, isOwner, isTimer}:{id:number, content:string, isOwner:boolean, isTimer:boolean}) {\n  const { lang } = useLangContext()\n  const { setModal } = useModalsContext()\n  const theme = useColorScheme()\n  const contentMutation = useMessengerContentMutation()\n  const back = ()=>{\n    setModal(MessageModal, null)\n  }\n  useModalEffect(back, [])\n  return <BottomSheet>\n    <View style={{flexDirection:'row', width:'100%'}}>\n      <View style={{flex:1, flexDirection:'row'}}>\n        <TouchableOpacity onPress={back}>\n          <Ionicons size={20} name=\"arrow-back\" color={Colors[theme].text}/>\n        </TouchableOpacity>\n      </View>\n      <View style={{flex:1}}>\n        <Text style={{fontSize:20, textAlign:'center'}}>{lang('Message')}</Text>\n      </View>\n      <View style={{flex:1}}/>\n    </View>\n    <View style={{marginBottom: 20, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\n      <CommonButton style={{height:40, width:'100%', maxWidth:320, justifyContent:'center'}} title={lang('copy')} onPress={()=>{Clipboard.setString(content);back()}}/>\n      {isOwner && isTimer && <CommonButton style={{height:40, width:'100%', maxWidth:320, justifyContent:'center'}} textStyle={{color:'red'}} title={lang('delete timer')} onPress={()=>{contentMutation.patch({id, timer:null});back()}}/>}\n      {isOwner && <CommonButton style={{height:40, width:'100%', maxWidth:320, justifyContent:'center'}} textStyle={{color:'red'}} title={lang('delete')} onPress={()=>{contentMutation.patch({id, is_archive:true});back()}}/>}\n  </BottomSheet>\n}\n","import React from 'react';\nimport {View} from 'react-native'\nimport {Text} from './Themed';\nimport { ProfileProps } from '../types';\nimport Avatar from './Avatar';\n\nexport default (props:ProfileProps)=>{\n    return <View style={{width:'100%', height:135, justifyContent:'space-evenly', alignItems:'center'}}>\n        <Avatar {...props} size={75}/>\n        <Text style={{fontWeight:'bold', fontSize:15}}>{props.name}</Text>\n        <Text style={{fontWeight:'normal', fontSize:14}}>{props.username}</Text>\n    </View>\n}","import React, { useState,  useEffect, createContext, useMemo, useRef, useContext } from \"react\"\nimport firebase from \"firebase/app\";\nimport \"firebase/messaging\";\nimport {FCM_PUBLIC_VAPID_KEY, FCM_API_KEY} from \"../constants/Envs\"\nimport { Notification as NotificationType, UserMembership } from \"../types\";\nimport { getNotification, postNotification, putNotification } from \"../apis/notification\";\n\nconst firebaseConfig = require(\"../../web/firebase-config.js\")\n// Initialize Firebase\nconst key = firebaseConfig.messagingSenderId\nconst apiKeyEncrypted = (FCM_API_KEY as string).split('').map((v, i)=> (v.charCodeAt(0) ^ key.charCodeAt(i)).toString(16).padStart(2, '0')).join('')\nconst app = firebase.initializeApp({...firebaseConfig, apiKey:FCM_API_KEY});\n// const analytics = getAnalytics(app);\nconst messaging = firebase.messaging(app);\n\nmessaging.onMessage((payload) => {\n  if (!(\"Notification\" in window)) {\n    alert(\"This browser does not support desktop notification\");\n  }\n  else if (Notification.permission === \"granted\") {\n    const message_set = JSON.parse(payload.data['message_set'])[0]\n    new Notification(payload.data.channel_name, { body: `${payload.data.name}: ${message_set.content}` });\n  }\n});\n\nconst requestToken = async()=>{\n  const permission = await Notification.requestPermission();\n  if (permission === 'granted') {\n    const serviceWorkerRegistration = await navigator.serviceWorker.register(`${process.env.PUBLIC_URL}/firebase-messaging-sw.js?${apiKeyEncrypted}`)\n    console.log('[SW]: SCOPE: ', serviceWorkerRegistration.scope);\n    const currentToken = await messaging.getToken({serviceWorkerRegistration, vapidKey: FCM_PUBLIC_VAPID_KEY }).catch(\n      async()=>await messaging.getToken({serviceWorkerRegistration, vapidKey: FCM_PUBLIC_VAPID_KEY })\n    )\n    window.addEventListener('beforeunload', (event:any) => {\n      event.preventDefault();\n      serviceWorkerRegistration.unregister()\n    });\n    if (currentToken)\n      return currentToken\n  }\n  return null\n}\n\nconst FirebaseContext = createContext<{enable?:boolean, setEnable:(enable:boolean)=>void}>({setEnable:()=>{}});\n\nexport const FirebaseProvider = ({user, children}:{user?:UserMembership|null, children:React.ReactNode})=>{\n  const tokenRef = useRef<string|null>()\n  const [notification, setNotification] = useState<NotificationType|null>()\n  const enable = useMemo(()=>notification===undefined?undefined:(notification?.token?true:false), [notification])\n  const setEnable = (enable:boolean)=>{\n    if(user && notification){\n      putNotification({...notification, token:enable?(tokenRef.current==undefined?null:tokenRef.current):null}).then((noti)=>{\n        setNotification(noti)\n      })\n    }\n  }\n  useEffect(()=>{\n    let isMount = true;\n    if(user){\n      if (tokenRef.current ===undefined){\n        tokenRef.current = null\n        requestToken().then((t)=>{\n          tokenRef.current = t\n          if (notification){\n            putNotification({...notification, token:tokenRef.current}).then((noti)=>{\n              if(isMount)setNotification(noti)\n            })\n          }\n        });\n      }\n      if (notification===undefined){\n        getNotification(user.id).then((noti)=>{\n          if(isMount)setNotification(noti || null)\n        })\n      }\n      else if(notification===null){\n        postNotification({user:user.id, type:'WEB', token:null}).then((noti)=>{\n          if(isMount)setNotification(noti)\n        })\n      }\n      else if (notification.token && tokenRef.current && tokenRef.current != notification.token){\n        putNotification({...notification, token:tokenRef.current}).then((noti)=>{\n          if(isMount)setNotification(noti)\n        })\n      }\n    }\n    return ()=>{isMount=false}\n  }, [user, notification])\n  return <FirebaseContext.Provider value={{enable, setEnable}}>\n    {(enable!=undefined || user===null) && children}\n  </FirebaseContext.Provider>\n}\n\nexport default ()=>{\n  const {enable, setEnable} = useContext(FirebaseContext)\n  return {enable, setEnable}\n}\n","import { useEffect } from \"react\"\nimport { navigate } from \"../navigation\"\nimport useMessengerChannelList from \"./lists/useMessengerChannelList\"\nimport { useMessengerMemberMutation } from \"./lists/useMessengerMemberList\"\nimport useAuthContext from \"./useAuthContext\"\n\nlet invitee_id:number|undefined\nlet invitee_state:0|1|2=0\n\nexport const replaceInviteeState = (l:Location)=>{\n    if(l !==undefined && l.pathname.endsWith('/invitee')){\n        var params = l.search.slice(1).split('&').filter(v=>v.startsWith('id='))\n        if (params.length>0)\n            invitee_id = parseInt(params[0].split('=')[1])\n        window.history.replaceState(null, '', l.href.split('invitee')[0]\n        );\n    }\n}\n\nexport default ()=>{\n    const {auth} = useAuthContext()\n    const channelList = useMessengerChannelList(auth)\n    const messengerMemberMutation = useMessengerMemberMutation()\n    useEffect(()=>{\n        if (auth.user){\n            if (invitee_id && channelList){\n                var id = invitee_id;\n                var redirect = ()=>navigate(\"Main\", {screen:\"ChatScreen\", params: {id}})\n                invitee_id = undefined;\n                invitee_state = 1;\n                if(channelList.find(v=>v.id==id) === undefined){\n                    console.log(`invite processing (channel:${id})`)\n                    messengerMemberMutation.invite({\n                        channel_id:id,\n                        user_ids:[auth.user.id]\n                    }).then(redirect)\n                }\n                else{\n                    console.log('already invite')\n                    redirect()\n                }\n            }\n        }\n        else{\n            if (invitee_state == 1){\n                invitee_state=2\n            }\n        }\n    }, [auth, channelList])\n    useEffect(()=>{\n        if(auth.user && invitee_state==2){\n            navigate(\"Main\", {screen:\"HomeScreen\"})\n        }\n    }, [auth.user])\n}","import React from 'react'\nimport { View, StyleSheet, Linking, Platform } from 'react-native'\nimport { TouchableOpacity } from 'react-native-gesture-handler'\nimport { AntDesign } from '../lib/@expo/vector-icons'; \nimport useColorScheme from '../hooks/useColorScheme';\nimport Colors from '../constants/Colors';\n\nconst openURL = Platform.OS=='web'?(url:string)=>{location.href=url}:Linking.openURL\n\nexport default (props:{theme:'light'|'dark'})=>{\n    return<View style={Styles.footer_buttons}>\n        <TouchableOpacity style={Styles.footer_button} onPress={()=>openURL(\"https://github.com/blacktokki/tokki-tok\")}>\n            <AntDesign name=\"github\" size={24} color={Colors[props.theme].iconColor} />\n        </TouchableOpacity>\n        <TouchableOpacity style={Styles.footer_button} onPress={()=>Linking.openURL(\"mailto:ydh051541@naver.com\")}>\n            <AntDesign name=\"mail\" size={24} color={Colors[props.theme].iconColor} />\n        </TouchableOpacity>\n    </View>\n}\n\nconst Styles = StyleSheet.create({\n      footer_buttons: {\n        width: '100%',\n        flexDirection: 'row',\n        justifyContent: 'flex-end',\n        paddingBottom: 20,\n        paddingRight: 20,\n      },\n      footer_button: {\n        alignItems: 'center',\n        justifyContent: 'center',\n        width: 38,\n        height: 38,\n        marginHorizontal: 12,\n        borderWidth: 1,\n        borderColor: '#E7E7E7',\n        borderRadius: 60,\n      },\n})","import React, {useLayoutEffect, useState} from 'react';\nimport {\n  Text,\n  TextInput,\n  TouchableOpacity,\n  View,\n  StyleSheet,\n} from 'react-native';\nimport { StackScreenProps } from '@react-navigation/stack';\nimport useAuthContext from '../../hooks/useAuthContext';\nimport useLangContext from '../../hooks/useLangContext';\nimport ContractFooter from '../../components/ContractFooter';\n\nexport default function LoginScreen({\n  navigation, route\n}: StackScreenProps<any, 'Login'>) {\n  const { lang } = useLangContext()\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const {error, dispatch} = useAuthContext()\n  const _login = ()=>dispatch({type:'LOGIN_REQUEST', username, password})\n  useLayoutEffect(() => {\n    navigation.setOptions({\n      headerRight: undefined\n    });\n  }, [navigation, route]);\n\n  return (<View style={Styles.login_container}>\n    <View style={Styles.login_wrapper}>\n      <View style={Styles.form}>\n        {error && <View style={Styles.form_error}>\n          <Text style={Styles.form_error_text}>{lang(error)}</Text>\n        </View>}\n        <TextInput\n          style={Styles.form_input}\n          value={username}\n          placeholder={lang('Username')}\n          onChangeText={(text) => setUsername(text)}\n          autoCapitalize={'none'}\n          keyboardType={'email-address'}\n          onSubmitEditing={_login}\n        />\n        <TextInput\n          style={Styles.form_input}\n          value={password}\n          placeholder={lang('Password')}\n          secureTextEntry\n          onChangeText={(text) => setPassword(text)}\n          onSubmitEditing={_login}\n        />\n        <TouchableOpacity onPress={_login}>\n          <View style={Styles.button}>\n            <Text style={Styles.button_label}>{lang('Sign in')}</Text>\n          </View>\n        </TouchableOpacity>\n        <TouchableOpacity onPress={() => dispatch({type:\"LOGIN_GUEST\"})}>\n          <Text style={Styles.guest_footer_text}>\n            {lang(\"Sign in as guest\")}\n          </Text>\n        </TouchableOpacity>\n      </View>\n      <View style={Styles.login_social}>\n        <View style={Styles.login_social_separator}>\n          <View style={Styles.login_social_separator_line} />\n          <Text style={Styles.login_social_separator_text}>{'*'}</Text>\n          <View style={Styles.login_social_separator_line} />\n        </View>\n        <View style={Styles.login_social_buttons}>\n        </View>\n      </View>\n      {/* <>\n        <TouchableOpacity onPress={() => navigate(\"RegistrationScreen\")}>\n          <Text style={Styles.login_footer_text}>\n            {\"Don't have an account? \"}\n            <Text style={Styles.login_footer_link}>{'Sign up'}</Text>\n          </Text>\n        </TouchableOpacity>\n      </> */}\n    </View>\n    <ContractFooter theme='light'/>\n  </View>);\n};\n\nconst Styles = StyleSheet.create({\n    login_container: {\n      flex: 1,\n      backgroundColor: '#FFF',\n    },\n    login_header: {\n      alignItems: 'center',\n      paddingTop: 30,\n      paddingBottom: 50,\n      backgroundColor: '#208AEC',\n    },\n    login_header_logo: {\n      width: 220,\n      resizeMode: 'contain',\n    },\n    login_header_text: {\n      marginTop: 15,\n      color: '#f0f0f0',\n      fontSize: 16,\n    },\n    login_header_text_bold: {\n      color: '#fff',\n      fontWeight: 'bold',\n    },\n    login_wrapper: {\n      flex: 1,\n      justifyContent: 'space-between',\n      paddingTop: 40,\n      borderTopRightRadius: 12,\n      borderTopLeftRadius: 12,\n      backgroundColor: '#fff',\n      alignItems: 'center',\n    },\n    form: {\n      width: '100%',\n      maxWidth: 320,\n    },\n    form_error: {\n      height: 22,\n      width:'100%',\n    },\n    form_error_text:{\n      textAlignVertical:'center',\n      color:'red',\n      fontSize:13,\n    },\n    form_input: {\n      height: 44,\n      paddingHorizontal: 20,\n      marginBottom: 20,\n      backgroundColor: '#EDF0F7',\n      borderRadius: 50,\n    },\n    button: {\n      alignItems: 'center',\n      justifyContent: 'center',\n      height: 44,\n      backgroundColor: '#0065A4',\n      borderRadius: 50,\n    },\n    button_label: {\n      color: '#fff',\n      fontSize: 16,\n    },\n    login_social: {\n      width: '100%',\n      maxWidth: 280,\n      marginTop: 20,\n    },\n    login_social_separator: {\n      flexDirection: 'row',\n      alignItems: 'center',\n    },\n    login_social_separator_line: {\n      flex: 1,\n      width: '100%',\n      height: 1,\n      backgroundColor: '#E0E0E0',\n    },\n    login_social_separator_text: {\n      marginHorizontal: 10,\n      color: '#808080',\n      fontSize: 16,\n    },\n    login_social_buttons: {\n      flexDirection: 'row',\n      justifyContent: 'center',\n      marginTop: 20,\n    },\n    login_social_button: {\n      alignItems: 'center',\n      justifyContent: 'center',\n      width: 60,\n      height: 60,\n      marginHorizontal: 12,\n      borderWidth: 1,\n      borderColor: '#E7E7E7',\n      borderRadius: 60,\n    },\n    login_social_icon: {\n      width: 38,\n      height: 38,\n      resizeMode: 'contain',\n    },\n    login_social_facebook: {\n      backgroundColor: '#4267B2',\n      borderColor: '#4267B2',\n    },\n    login_footer_text: {\n      flexDirection: 'row',\n      alignItems: 'center',\n      color: '#808080',\n      fontSize: 14,\n    },\n    guest_footer_text: {\n      flexDirection: 'row',\n      alignSelf: 'center',\n      color: '#808080',\n      fontSize: 15,\n      margin: 15\n    },\n    login_footer_link: {\n      color: '#208AEC',\n      fontSize: 15,\n      fontWeight: 'bold',\n    },\n  });\n  ","import React from 'react'\nimport { Image, Linking } from \"react-native\"\nimport { TouchableOpacity } from \"react-native-gesture-handler\"\nimport CommonSection from \"./CommonSection\"\nimport { View, Text } from \"./Themed\"\nimport { Link } from \"../types\"\n\n\n\nexport default ({link, isMobile}:{link:Link, isMobile:boolean})=>{\n    return <CommonSection containerStyle={{marginHorizontal:0}} bodyStyle={{padding:0}}>\n    <TouchableOpacity \n        onPress={()=>Linking.openURL(link.url)}\n        onLongPress={()=>{}}\n        style={{width:'100%', flexDirection:'row'}}\n    >\n        {link.image?<Image source={{uri:link.image}} resizeMode=\"cover\" style={{ width:'100%', maxWidth:isMobile?120:150, maxHeight:isMobile?120:150, borderWidth:1}}/>:undefined}\n        <View style={{flex:1, marginHorizontal:20}}>\n            <Text style={{fontSize:18}}>{link.title}</Text>\n            <Text style={{fontSize:14}}>{link.description}</Text>\n            <Text style={{fontSize:12}}>{link.url}</Text>\n        </View>\n    </TouchableOpacity>\n    </CommonSection>\n}","import React, { createContext, useContext } from \"react\"\nimport { SendJsonMessage } from \"react-use-websocket/dist/lib/types\";\nimport { WebSocketInternalProvider } from \"../../hooks/useWebsocketContext\";\n\nconst WebSocketContext = createContext<{lastJsonMessage:any, sendJsonMessage:SendJsonMessage }>({lastJsonMessage:undefined, sendJsonMessage:()=>{}});\n\nexport const WebSocketProvider = ({disable, children}:{disable?:boolean, children:React.ReactNode})=>{\n  return disable?<></>:<WebSocketInternalProvider path={'messenger/ws/rtc/'} Context={WebSocketContext} useBackground>\n    {children}\n  </WebSocketInternalProvider>\n}\n\nexport default ()=>{\n  const webSocketContext = useContext(WebSocketContext)\n  return webSocketContext\n}\n\n","import React, { useCallback, useRef, useState, useMemo } from \"react\";\n//@ts-ignore\nimport { RTCView, mediaDevices, RTCPeerConnection, MediaStream, RTCSessionDescription, RTCIceCandidate } from \"react-native-webrtc-web-shim\";\nimport {TURN_SERVER} from \"../../../constants/Envs\"\n\n\nconsole.log(TURN_SERVER?\"use turn server\": \"use stun server\")\n\nexport const peerConstraints = {\n\ticeServers: [TURN_SERVER?JSON.parse(TURN_SERVER):{urls: 'stun:stun.l.google.com:19302'}]\n};\n\nexport const sessionConstraints = {\n\tmandatory: {\n\t\tOfferToReceiveAudio: true,\n\t\tOfferToReceiveVideo: true,\n\t\tVoiceActivityDetection: true\n\t}\n};\n\nconst mediaConstraints = {audio:true, video:{framerate:30}}\n\n//@ts-ignore\nexport {MediaStream, RTCPeerConnection, RTCSessionDescription} from \"react-native-webrtc-web-shim\";\n\nconst onICEcandidate = (pc:typeof RTCPeerConnection, message:any)=>{\n\tconst _message = message.data.rtcMessage\n\t\tconst candidate = new RTCIceCandidate(_message);\n\t\tif (pc) {\n\t\t\tconsole.log(\"ICE candidate Added\");\n\t\t\tpc.addIceCandidate(candidate);\n\t\t}\n}\n\nconst sendICEcandidate = (event:any, sendMessage:(data:any)=>void, receiver:string, target:string) => {\n\t// When you find a null candidate then there are no more candidates.\n\t// Gathering of candidates has finished.\n\tif ( !event.candidate ) { return; };\n\t// Send the event.candidate onto the person you're calling.\n\t// Keeping to Trickle ICE Standards, you should send the candidates immediately.\n\tsendMessage({type:'ICEcandidate', receiver, data:{target, rtcMessage:event.candidate}})\n  }\n\nconst BAND_WIDTH = 8000\n\nconst optimizeSdp = (offerDescription:RTCSessionDescription)=>{\n\tvar arr = offerDescription.sdp.split('\\r\\n');\n\tarr.forEach((str:string, i:number) => {\n\t\tif (/^a=fmtp:\\d*/.test(str)) {\n\t\t\tarr[i] = str + `;x-google-max-bitrate=${BAND_WIDTH};x-google-min-bitrate=${BAND_WIDTH};x-google-start-bitrate=${BAND_WIDTH}`;\n\t\t} else if (/^a=mid:(0|video)/.test(str)) { // if with audio then 0=>1\n\t\t\tarr[i] += `\\r\\nb=AS:${BAND_WIDTH}`;\n\t\t}\n\t});\n  \treturn new RTCSessionDescription({\n    \ttype: offerDescription.type,\n    \tsdp: arr.join('\\r\\n'),\n  \t})\n}\n\nconst createOffer = async(pcRefCurrent:{pc?:typeof RTCPeerConnection, receiver:string}, sendMessage:(data:any)=>void, stream:typeof MediaStream, target:string, user?:{name:string})=>{\n\tstream && pcRefCurrent.pc.addStream( stream );\n\tconst offerDescription = optimizeSdp((await pcRefCurrent.pc.createOffer( sessionConstraints )));\n\tawait pcRefCurrent.pc.setLocalDescription( offerDescription );\n\tsendMessage({type:'call', receiver:pcRefCurrent.receiver, data:{target, name:user?.name, rtcMessage:offerDescription}})\n}\n\nexport const useLocalCam = (sendMessage:(data:any)=>void)=>{\n\tconst pcRef = useRef<Record<number,{pc:typeof RTCPeerConnection, receiver:string}>>({})\n\tconst [sender, setSender] = useState<string>()\n\tconst [_stream, setStream] = useState<MediaStream>()\n\tconst isPlay = useMemo(()=>_stream?true:false, [_stream])\n\tconst CustomRTCView = useCallback(React.memo(({style}:{style:any})=>(_stream?<RTCView stream={_stream} style={style} videoProps={{height:'100%'}} />:<></>)) , [_stream])\n\tconst start = useCallback(async(user:{name:string}, stream?:typeof MediaStream, mode?:'camera'|'display')=>{\n\t\tconsole.log(\"start\");\n\t\tif (!_stream || mode!==undefined) {\n\t\t\ttry {\n\t\t\t\tlet newStream:typeof MediaStream;\n\t\t\t\tif(mode == 'camera'){\n\t\t\t\t\tnewStream = await mediaDevices.getUserMedia(mediaConstraints)\n\t\t\t\t}\n\t\t\t\telse if (mode == 'display'){\n\t\t\t\t\tnewStream = await mediaDevices.getDisplayMedia(mediaConstraints)\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tnewStream = stream || await mediaDevices.getUserMedia(mediaConstraints).catch((e:any)=>mediaDevices.getDisplayMedia(mediaConstraints));\n\t\t\t\t}\n\t\t\t\tsetStream(newStream)\n\t\t\t\tObject.entries(pcRef.current).map(([k, v])=>{\n\t\t\t\t\tcreateOffer(v, sendMessage, newStream, 'guest', user)\n\t\t\t\t})\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error(e);\n\t\t\t}\n\t\t}\n\t}, [_stream])\n\tconst stop = useCallback(()=>{\n\t\tconsole.log(\"stop\");\n\t\tif(_stream){\n\t\t\t_stream.getTracks().map((track:any) => track.stop());\n\t\t\tsetStream(undefined)\n\t\t}\n\t}, [_stream])\n\treturn {\n\t\tstart,\n\t\tstop,\n\t\twebsocketOnMessage: async(response:any, user:{name:string})=>{\n\t\t\tlet type = response.type;\n\t\t\tif (type == 'connection'){\n\t\t\t\tsetSender(response.data.channel_name)\n\t\t\t}\n\t\t\tif (type == 'start' && response.data.target=='host'){\n\t\t\t  console.log('1 start')\n\t\t\t  const peerConnection = new RTCPeerConnection( peerConstraints );\n\t\t\t  peerConnection.addEventListener( 'icecandidate', (event:any) => sendICEcandidate(event, sendMessage, response.sender, 'guest'));\n\t\t\t  pcRef.current[response.sender] = {pc:peerConnection, receiver: response.sender}\n\t\t\t  createOffer(pcRef.current[response.sender], sendMessage, _stream, 'guest', user)\n\t\t\t}\n\t\t\t\n\t\t\tif (type == \"answer\" && response.data.target == 'host'){\n\t\t\t  console.log('3 answer')\n\t\t\t  const peerConnection = pcRef.current[response.sender].pc\n\t\t\t  const answerDescription = new RTCSessionDescription(response.data.rtcMessage);\n\t\t\t  await peerConnection.setRemoteDescription( answerDescription );\n\t\t\t  // const streams = pcRef.current.pc.getRemoteStreams()\n\t\t\t  // setMirrorStream(streams[streams.length - 1])\n\t\t\t}\n\t\t\tif (type == \"ICEcandidate\" && response.data.target=='host'){\n\t\t\t\tconst peerConnection = pcRef.current[response.sender].pc\n\t\t\t\tonICEcandidate(peerConnection, response)\n\t\t\t}\n\t\t},\n\t\tCustomRTCView,\n\t\tisPlay,\n\t\tsender,\n\t\t// renderMirrorView,\n\t}\n}\n\nexport const useRemoteCam = (sendMessage:(data:any)=>void)=>{\n\tconst pcRef = useRef<{pc?:RTCPeerConnection, receiver?:string, statsInterval?:any}>({})\n\tconst [user, setUser] = useState<{name:string}>()\n\tconst [_stream, setStream] = useState<MediaStream>()\n\tconst CustomRTCView = useCallback(React.memo((style:any)=>_stream?<RTCView stream={_stream} style={style} videoProps={{height:'100%'}} />:<></>), [_stream])\n\tconst isPlay = useMemo(()=>_stream?true:false, [_stream])\n\tconst start = useCallback((receiver:string)=>{\n\t\tconsole.log(\"start\");\n\t\tif (!pcRef.current.pc) {\n\t\t  pcRef.current.pc = new RTCPeerConnection( peerConstraints );\n\t\t  pcRef.current.receiver = receiver\n\t\t}\n\t\tif (!_stream){\n\t\t\tsendMessage({type:'start', receiver, data:{'target': 'host'}})\n\t\t}\n\t}, [_stream])\n\tconst stop = () => {\n\t\tconsole.log(\"stop\");\n\t\tif (pcRef.current.pc) {\n\t\t  // peerConnection._unregisterEvents();\n\t\t  setStream(undefined)\n\t\t  pcRef.current.pc.close();\n\t\t  pcRef.current.pc = undefined\n\t\t  pcRef.current.receiver = undefined\n\t\t  clearInterval(pcRef.current.statsInterval)\n\t\t}\n\t}\n\treturn {\n\t\tstart,\n\t\tstop,\n\t\twebsocketOnMessage: async(response:any)=>{\n\t\t\tlet type = response.type;\n\t\t\tif (type == 'start' && response.data.target=='guest' && response.sender == pcRef.current?.receiver){\n\t\t\t\tconsole.log('(remote)1 start')\n\t\t\t\tconst peerConnection = pcRef.current.pc\n\t\t\t\tsetUser({name: response.data.name})\n\t\t\t\tpeerConnection.addEventListener('icecandidate', (event:any) => sendICEcandidate(event, sendMessage, response.sender, 'host'));\n\t\t\t\tpeerConnection.addEventListener('iceconnectionstatechange', (e:any)=>{\n\t\t\t\t\tif (pcRef.current.pc.iceConnectionState == 'connected'){\n\t\t\t\t\t\tlet activeStream = false\n\t\t\t\t\t\tpcRef.current.statsInterval = setInterval(async()=>{\n\t\t\t\t\t\t\tconst stats = await pcRef.current.pc.getStats(null)\n\t\t\t\t\t\t\tlet statsOutput = \"\";\n\t\t\t\t\t\t\tlet framePerSecond = undefined\n\t\t\t\t\t\t\tstats.forEach((report:any) => {\n\t\t\t\t\t\t\t\tif (report.type === \"inbound-rtp\" && report.kind === \"video\") {\n\t\t\t\t\t\t\t\t\tObject.keys(report).forEach((statName) => {\n\t\t\t\t\t\t\t\t\t\tstatsOutput += `${statName}: ${report[statName]}\\n`;\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tframePerSecond = report.framesPerSecond\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tconsole.log(activeStream, framePerSecond)\n\t\t\t\t\t\t\tif (framePerSecond != undefined){\n\t\t\t\t\t\t\t\tactiveStream = true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (activeStream){\n\t\t\t\t\t\t\t\tstop()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconsole.log(new Date().toTimeString().split(' ')[0], statsOutput)\n\t\t\t\t\t\t}, 1000);\n\t\t\t\t\t}\n\t\t\t\t\telse if (pcRef.current.pc.iceConnectionState == 'failed'){\n\t\t\t\t\t\tstop()\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t// peerConnection.addTransceiver('audio', {\n\t\t\t\t// \tdirection: 'recvonly'\n\t\t\t\t// });\n\t\t\t\tpeerConnection.addTransceiver('video', {\n\t\t\t\t\tdirection: 'recvonly'\n\t\t\t\t});\n\t\t\t\tawait createOffer({pc:pcRef.current.pc, receiver:response.sender}, sendMessage, _stream, 'host', user)\n\t\t\t}  \n\t\t\tif (type == \"answer\" && response.data.target=='guest' && response.sender == pcRef.current?.receiver){\n\t\t\t\tconsole.log('(remote)3 answer')\n\t\t\t\tconst answerDescription = new RTCSessionDescription(response.data.rtcMessage);\n\t\t\t\tawait pcRef.current.pc.setRemoteDescription( answerDescription );\n\t\t\t\tconst streams = pcRef.current.pc.getRemoteStreams()\n\t\t\t\tsetStream(streams[streams.length - 1])\n\t\t\t\tsendMessage({type:'end', receiver:pcRef.current.receiver, data:{}})\n\t\t\t}\n\t\t\tif (type == \"call\" && response.sender == pcRef.current?.receiver){\n\t\t\t  console.log('2 call')\n\t\t\t  const peerConnection = pcRef.current.pc\n\t\t\t  setUser({name:response.data.name})\n\t\t\t  if (!peerConnection)\n\t\t\t\treturn\n\t\t\t  peerConnection.addEventListener( 'icecandidate', (event:any) => sendICEcandidate(event, sendMessage, response.sender, 'host'));\n\t\t\t  const offerDescription = new RTCSessionDescription(response.data.rtcMessage);\n\t\t\t  await peerConnection.setRemoteDescription( offerDescription );\n\t\t\t  const answerDescription = await peerConnection.createAnswer( sessionConstraints );\n\t\t\t  await peerConnection.setLocalDescription( answerDescription );\n\t\t\t  sendMessage({type:'answer', receiver:pcRef.current.receiver, data:{target:'host', rtcMessage:peerConnection.localDescription}})\n\t\t\t  // Here is a good place to process candidates.\n\t\t\t  const streams = pcRef.current.pc.getRemoteStreams()\n\t\t\t  setStream(streams[streams.length - 1])\n\t\t\t}\n\t\t\tif (type == \"ICEcandidate\" && response.data.target=='guest' && response.sender == pcRef.current?.receiver)\n\t\t\t  onICEcandidate(pcRef.current.pc, response)\n\t\t},\n\t\tCustomRTCView,\n\t\tuser,\n\t\tisPlay\n\t}\n}","import {StyleSheet} from \"react-native\";\nexport {useLocalCam, useRemoteCam} from \"./p2p\"\n\nexport const camStyle = StyleSheet.create({\n\tcontainer:{ flex: 1},\n\tcam:{ flex: 1, height:'100%'},\n\tbottonContainer: {position:\"absolute\", bottom:0, justifyContent:'flex-end'},\n\tbuttonBar: { flexDirection: \"row\", justifyContent: \"space-around\" },\n\tlabel: {backgroundColor:'#0008', color:'white', paddingHorizontal:5},\n})","import React, { useEffect } from \"react\";\nimport {Button, View, Text} from \"react-native\";\nimport useWebsocketContext from \"./useWebsocketContext\";\nimport { useLocalCam, camStyle} from \"./webrtc\";\n\n\nexport default (props:{user?:{name:string}|null, mode?:'camera'|'display'|null})=>{\n  const {lastJsonMessage, sendJsonMessage} = useWebsocketContext()\n  const {start, stop, websocketOnMessage, CustomRTCView, isPlay} = useLocalCam(sendJsonMessage)\n  useEffect(()=>{\n    props.user && lastJsonMessage && websocketOnMessage(lastJsonMessage, props.user)\n  }, [lastJsonMessage, props.user])\n  useEffect(()=>{\n    if(props.mode && !isPlay){\n      props.user && start(props.user, undefined, props.mode)\n    }\n    else if(props.mode===null && isPlay){\n      stop()\n    }\n    return ()=>{isPlay && stop()}\n  }, [isPlay, props.user, props.mode])\n  return (\n    <View style={camStyle.container}>\n      <CustomRTCView style={camStyle.cam}/>\n      <View style={camStyle.bottonContainer}>\n        <View style={camStyle.buttonBar}>  \n        </View>\n        <View style={{flexDirection:'row'}}><Text style={camStyle.label}>{props.user?.name}</Text></View>\n        <View style={camStyle.buttonBar}>\n          {props.mode === undefined && !isPlay && <Button title=\"Start\" onPress={()=>props.user && start(props.user)} />}\n          {props.mode === undefined && isPlay && <Button title=\"Stop\" onPress={stop} />}\n        </View>\n      </View>\n    </View>\n  );\n}\n","import React, { useState, useEffect, } from \"react\";\nimport {Button,Text, TextInput, View} from \"react-native\";\nimport useWebsocketContext from \"./useWebsocketContext\";\nimport { useRemoteCam, camStyle} from \"./webrtc\";\n\nexport default (props:{receiver?:string})=>{\n  const [receiver, setReceiver] = useState('')\n  const {lastJsonMessage, sendJsonMessage} = useWebsocketContext()\n  const {start, stop, websocketOnMessage, CustomRTCView, isPlay, user} = useRemoteCam(sendJsonMessage)\n  useEffect(()=>{\n    lastJsonMessage && websocketOnMessage(lastJsonMessage)\n  }, [lastJsonMessage])\n  useEffect(()=>{\n    if(props.receiver){\n      start(props.receiver)\n    }\n    return ()=>stop()\n  }, [props.receiver])\n  return (\n    <View style={camStyle.container}>\n      <CustomRTCView style={camStyle.cam}/>\n      <View style={camStyle.bottonContainer}>\n        <View style={camStyle.buttonBar}>\n        </View>\n        <View style={{flexDirection:'row'}}>{\n          (props.receiver || isPlay)?\n          <Text style={camStyle.label}>{user?.name || 'loading...'}</Text>:\n          <>\n            <Text style={{borderWidth:1}}>Receiver:&nbsp;</Text>\n            <TextInput style={{borderWidth:1, flex:1}} value={receiver} onChangeText={setReceiver}/>\n          </> \n        }</View>\n        <View style={camStyle.buttonBar}>\n          {props.receiver === undefined && !isPlay && <Button title=\"Start\" onPress={()=>start(receiver)} />}\n          {props.receiver === undefined && isPlay && <Button title=\"Stop\" onPress={stop} />}\n        </View>\n      </View>\n    </View>\n  );\n}\n\n","import React, {useEffect, useState} from 'react';\nimport { StyleSheet, View } from 'react-native';\nimport { View as ThemedView } from '../../../components/Themed' \nimport Colors from '../../../constants/Colors';\nimport {default as useRtcContext, WebSocketProvider as RtcProvider} from \"../../../lib/react-native-webrtc/useWebsocketContext\";\nimport LocalCam from '../../../lib/react-native-webrtc/LocalCam';\nimport RemoteCam from '../../../lib/react-native-webrtc/RemoteCam';\nimport useResizeContext from '../../../hooks/useResizeContext';\nimport useAuthContext from '../../../hooks/useAuthContext';\nimport { TouchableOpacity } from 'react-native-gesture-handler';\nimport CommonButton from '../../../components/CommonButton';\nimport { Ionicons } from '../../../lib/@expo/vector-icons';\nimport useIsMobile from '../../../hooks/useIsMobile';\n\ntype VideoType = 'camera'|'display'|null\ntype VideoCallProps = {channel_id:number, setDisable:(disable:boolean)=>void, disable?:boolean}\n\n\nconst VideoView = (props:{\n  scale:string,\n  focusGuest?:string,\n  setFocusGuest:(focusGuest?:string)=>void\n  receiver?:string\n  children:React.ReactNode\n})=>{\n  return <View style={[{maxWidth:props.scale, maxHeight:props.scale, borderWidth:1, borderColor:Colors.borderColor, backgroundColor:'gray', flexDirection:'row', flexGrow:1}, (props.focusGuest == undefined || props.focusGuest == props.receiver)?{height:'100%'}:{maxWidth:0, height:0}]}>\n    <TouchableOpacity style={{flex:1}} containerStyle={{flex:1, justifyContent:'center'}} onPress={()=>props.setFocusGuest(props.focusGuest?undefined:props.receiver)}>\n    {props.children}\n    </TouchableOpacity>\n  </View>\n    \n  \n}\n\nconst VideoCallContainer = ({channel_id, disable, setDisable}:VideoCallProps)=>{\n  const {auth} = useAuthContext()\n  const isMobile = useIsMobile()\n  const [videoMode, setVideoMode] = useState<VideoType>(null)\n  const [guests, setGuests] = useState<string[]>([])\n  const [focusGuest, setFocusGuest] = useState<string>()\n  const windowType = useResizeContext()\n  const { lastJsonMessage, sendJsonMessage } = useRtcContext()\n  useEffect(()=>{\n    if(lastJsonMessage !=null){\n      if(lastJsonMessage['type']=='connection'){\n        sendJsonMessage({'type':'broadcast', 'data':{'channel_id':channel_id}})\n      }\n      if(lastJsonMessage['type']=='broadcast_guest' || lastJsonMessage['type']=='broadcast_host'){\n        setGuests([...guests, lastJsonMessage['sender']])\n      }\n      if(lastJsonMessage['type']=='broadcast_disconnect'){\n        const channel_name = lastJsonMessage['sender']\n        const exist = guests.find(v=>v == channel_name)\n        exist && setGuests(guests.filter(v=>v != channel_name))\n      }\n    }\n  }, [lastJsonMessage])\n  const scale = focusGuest?'100%':`${100 / Math.max(2, Math.ceil(Math.sqrt(guests.length + 1)))}%`\n  const toggleVideoMode = (mode:VideoType)=>{\n    setVideoMode(videoMode!=mode?mode:null)\n  }\n  return lastJsonMessage !==undefined ?\n    <ThemedView style={[\n      {aspectRatio:!disable?16/9:0, borderColor:Colors.borderColor, borderRadius:10},\n      windowType=='landscape'?{flexShrink:1, flexGrow:0, height:'100%', borderLeftWidth:1, paddingBottom:65}:{maxHeight:'36%', width:'100%', borderBottomWidth:1}\n    ]}>\n      <View style={{aspectRatio:focusGuest?undefined:16/9, backgroundColor:'white', flexWrap:'wrap', flexDirection:'row', width:'100%', height:'100%'}}>\n        {guests.map((receiver, i)=><VideoView scale={scale} focusGuest={focusGuest} setFocusGuest={setFocusGuest} receiver={receiver}>\n          <RemoteCam receiver={receiver}/>\n        </VideoView>\n        )}\n        <VideoView scale={scale} focusGuest={focusGuest} setFocusGuest={setFocusGuest} receiver={auth.user?.name}>\n          <LocalCam user={auth.user} mode={videoMode}/>\n        </VideoView>\n      </View>\n      <ThemedView style={[\n          {position:'absolute', alignItems:'center', justifyContent:'flex-end', width:'100%',flexDirection:'row'},\n          windowType=='landscape'?{bottom:0, paddingTop:15, paddingBottom:10, paddingHorizontal:19}:{backgroundColor:'transparent'}\n        ]}>\n        <CommonButton title={''} style={{height:40, paddingTop:8}} onPress={()=>toggleVideoMode('camera')}/>\n        {!isMobile && <CommonButton title={''} style={{height:40, paddingTop:8}} onPress={()=>toggleVideoMode('display')}/>}\n        <CommonButton title={''} style={{height:40, paddingTop:8}} onPress={()=>setDisable(true)}>\n          <Ionicons size={20} name=\"arrow-back\" color={'deepskyblue'}/>\n        </CommonButton>\n      </ThemedView>\n    </ThemedView>:\n  <></>\n  }\n  \nexport default React.memo(({channel_id, disable, setDisable}:VideoCallProps)=>{\n  return <RtcProvider disable={disable}>\n    <VideoCallContainer channel_id={channel_id} disable={disable} setDisable={setDisable}/>\n  </RtcProvider>\n})\n","import React from 'react'\nimport { Linking, TextStyle } from \"react-native\"\nimport {TouchableOpacity} from \"react-native-gesture-handler\"\nimport CommonSection from \"./CommonSection\"\nimport { FontAwesome } from '../lib/@expo/vector-icons'; \nimport { View, Text } from \"./Themed\"\nimport { File } from \"../types\"\nimport useColorScheme from '../hooks/useColorScheme';\nimport Colors from '../constants/Colors';\n\nfunction humanFileSize(size:number) {\n    var i = size == 0 ? 0 : Math.floor(Math.log(size) / Math.log(1024));\n    return (size / Math.pow(1024, i)).toFixed(2) + ' ' + ['B', 'kB', 'MB', 'GB', 'TB'][i];\n  }\n  \n\nexport default ({file, isMobile, showBorder}:{file:File, isMobile:boolean, showBorder:ConstrainBoolean})=>{\n    const theme = useColorScheme()\n    return <CommonSection containerStyle={{marginHorizontal:0}} bodyStyle={showBorder?{padding:10}:{borderWidth:0, padding:0}}>\n    <TouchableOpacity \n        onPress={()=>Linking.openURL(file.file)} \n        onLongPress={()=>{}}\n        style={{flexDirection:'row', alignItems:'flex-start', width:'100%'}} \n    >\n        <FontAwesome name=\"file-o\" size={20} color={Colors[theme].iconColor} />\n        <View style={{flex:1, marginHorizontal:10}}>\n            <Text style={{fontSize:18}}>{file.filename}</Text>\n            <Text style={{fontSize:14}}>{humanFileSize(file.filesize)}</Text>\n        </View>\n    </TouchableOpacity>\n    </CommonSection>\n}","import React, {useState, useEffect} from \"react\"\nimport dayjs from \"dayjs\";\nimport {View, TouchableOpacity} from 'react-native'\nimport { Text } from \"../../../components/Themed\";\nimport useTimerMessageContentList from \"../../../hooks/lists/useTimerMessageContent\";\nimport { MessengerContent } from \"../../../types\";\nimport Avatar from \"../../../components/Avatar\";\nimport Hyperlink from \"react-native-hyperlink\";\n\nexport function timerFormat(datetime:string){\n    return _timerFormat(dayjs(datetime), dayjs())\n}\n\nfunction _timerFormat(m:dayjs.Dayjs, now:dayjs.Dayjs){\n    if (m.year() != now.year()){\n        return m.format('YYYY.MM')\n    }\n    if(m.month()!= now.month() || m.date() != now.date()){\n        return m.format('MM.DD')\n    }\n    return m.format('HH:mm')\n  }\n\nexport function timerToString(timer:string){\n    return dayjs(timer).format('YYYY.MM.DD HH:mm')\n}\n\nconst TimerTag = (props:{data:MessengerContent, now:dayjs.Dayjs, isExpand:boolean, setExpand:(id?:number)=>void})=>{\n    const start = dayjs(props.data.created)\n    const end = dayjs(props.data.timer)\n    const ratio = (start.diff(props.now)/start.diff(end))\n    return <TouchableOpacity onPress={()=>props.setExpand(props.isExpand?undefined:props.data.id)}>\n        <View style={{backgroundColor:'lightgray', borderRadius:20, overflow:'hidden', margin:5}}>\n            <View style={{backgroundColor:'darkgray', position:'absolute', width:`${ratio*100}%`, height:'100%'}}/>\n            {props.isExpand?\n            <View style={{paddingVertical:5, paddingHorizontal:5, maxWidth:270}}>\n                <View style={{flexDirection:'row'}}>\n                    <Avatar name={props.data.name} userId={props.data.user} size={20}/>\n                    <View style={{paddingHorizontal:5}}><Text>{props.data.name}</Text></View>\n                </View>\n                {props.data.timer &&\n                <View style={{flexDirection:'row', alignItems:'stretch'}}>\n                    <Text></Text>\n                    <Text selectable>{timerToString(props.data.timer)}</Text>\n                </View>}\n                {/* @ts-ignore */}\n                <Hyperlink linkDefault={ true } style={{wordBreak:\"break-word\"}} linkStyle={{color: '#12b886'}}>\n                    <Text selectable>{props.data.message_set[0].content}</Text>\n                </Hyperlink>\n            </View>:    \n            <View style={{paddingVertical:5, paddingHorizontal:5, flexDirection:'row'}}>\n                <Avatar name={props.data.name} userId={props.data.user} size={20}/>\n                <View style={{paddingHorizontal:5}}><Text>{_timerFormat(end, props.now)}</Text></View>\n            </View>}\n        </View>\n    </TouchableOpacity>\n}\n\n\nexport default (props:{channel_id:number})=>{\n    const timerMessages = useTimerMessageContentList(props.channel_id)\n    const [now, setNow] = useState(dayjs())\n    const [expand, setExpand] = useState<number>()\n    useEffect(()=>{\n        const timeout = setTimeout(()=>{\n            setNow(dayjs())\n        }, 2000)\n        return ()=>clearTimeout(timeout)\n    }, [now])\n    return <View style={{flexDirection:'row', paddingTop:5, paddingHorizontal:20}}>\n        {timerMessages?.map((v,i)=><TimerTag key={i} data={v} now={now} isExpand={v.id==expand} setExpand={setExpand}/>)}\n    </View>\n}","import { useEffect, useMemo } from \"react\"\nimport { useQuery, useQueryClient } from \"react-query\"\nimport { getTimerMessageContentList } from \"../../apis\"\nimport { MessengerContent } from \"../../types\"\nimport useWebsocketContext from \"../useWebsocketContext\"\nimport dayjs from \"dayjs\"\n\nexport default function useTimerMessageContentList(channel_id:number){  \n  const queryClient = useQueryClient()\n  const { data } = useQuery<MessengerContent[]>(\n    [\"TimerMessageContentList\", channel_id], \n    async()=>await getTimerMessageContentList(channel_id, dayjs().toISOString()), \n    {\n      refetchOnReconnect:false,\n      refetchOnWindowFocus:false\n    }\n  )\n  const { lastJsonMessage } = useWebsocketContext()\n  useEffect(()=>{\n    if(lastJsonMessage !=null && lastJsonMessage['data']['channel'] == channel_id){\n      if(lastJsonMessage['type']=='next_message'){\n        if(lastJsonMessage['data']['timer'] && dayjs() < dayjs(lastJsonMessage['data']['timer']))\n          queryClient.setQueryData<MessengerContent[]>([\"TimerMessageContentList\", channel_id], (_data)=>{\n            return [...(_data || []), lastJsonMessage['data']]\n          })\n      }\n      if(lastJsonMessage['type']=='update_message'){\n        queryClient.setQueryData<MessengerContent[]>([\"TimerMessageContentList\", channel_id], (_data)=>{\n          return [...(_data?.filter(v=>v.id!=lastJsonMessage['data'].id || (lastJsonMessage['data']['timer']!=null && !lastJsonMessage['data']['is_archive'])) || [])]\n        })\n      }\n    }\n  }, [lastJsonMessage])\n  const sorted = useMemo(()=>data?.sort((a, b)=>(a.timer || '') > (b.timer || '')?1:-1), [data])\n  useEffect(()=>{\n    if (sorted?.[0]?.timer){\n      const id = sorted[0].id\n      const ms = Math.min(dayjs(sorted[0].timer).diff(dayjs()), Number.MAX_VALUE)\n      let timeout = setTimeout(()=>{\n        queryClient.setQueryData<MessengerContent[]>([\"TimerMessageContentList\", channel_id], (_data)=>{\n          return (_data || []).filter(v=>v.id!=id || dayjs(v.timer).diff(dayjs()) > 0)\n        })\n      }, ms)\n      return ()=>clearTimeout(timeout)\n    }\n  },[sorted])\n  return sorted\n}\n","import React, {useCallback, useEffect, useLayoutEffect, useMemo, useRef, useState} from 'react';\nimport { StackScreenProps } from '@react-navigation/stack';\nimport { Platform, StyleSheet, View, TouchableOpacity } from 'react-native';\nimport CommonSection from '../../../components/CommonSection';\nimport { FlatList, TextInput } from 'react-native-gesture-handler';\nimport CommonButton from '../../../components/CommonButton';\nimport useMessengerContentList, { MessengerContentPage, useMessengerContentMutation } from '../../../hooks/lists/useMessengerContentList';\nimport useAuthContext from '../../../hooks/useAuthContext';\nimport HeaderRight from '../../../components/HeaderRight';\nimport useMessengerMemberList from '../../../hooks/lists/useMessengerMemberList';\nimport Colors from '../../../constants/Colors';\nimport useColorScheme from '../../../hooks/useColorScheme';\nimport { Text, View as ThemedView } from '../../../components/Themed' \nimport Hyperlink from 'react-native-hyperlink'\nimport useMessengerChannelList from '../../../hooks/lists/useMessengerChannelList';\nimport useIsMobile from '../../../hooks/useIsMobile';\nimport LinkPreview from '../../../components/LinkPreview';\nimport Avatar, { avatarFromChannel } from '../../../components/Avatar';\nimport VideoCallSection from './VideoCallSection';\nimport useResizeContext from '../../../hooks/useResizeContext';\nimport FilePreview from '../../../components/FilePreview';\nimport useModalsContext from '../../../hooks/useModalsContext';\nimport InviteModal from '../../../modals/InviteModal';\nimport DateTimePickerModal from '../../../modals/DateTimePickerModal'\nimport useLangContext from '../../../hooks/useLangContext';\nimport { Entypo } from '../../../lib/@expo/vector-icons';\nimport TimerTags, { timerFormat, timerToString } from './TimerTags';\nimport MessageModal from '../../../modals/MessageModal';\nimport ChannelEditModal from '../../../modals/ChannelEditModal';\n\n\nfunction uploadFile(){\n  return new Promise<Blob|undefined>((resolve, reject)=>{\n    if (Platform.OS == 'web'){\n      var input = document.createElement('input');\n      input.type = 'file';\n      input.onchange = e => { \n        resolve((e.target as any).files[0])\n      }\n      input.onabort = reject\n      input.onerror = reject\n      input.click();\n    }\n    else\n      resolve(undefined)\n  })\n}\n\nconst MessengerContentPageItem = React.memo((props:MessengerContentPage & {ownerId?:number})=>{\n  const isMobile = useIsMobile()\n  const { setModal } = useModalsContext()\n  let nextPage = props.next;\n    while(nextPage?.next && nextPage.current.length==0){\n      nextPage = nextPage.next\n    }\n    const nextContent = nextPage?.current[0]\n    return <View style={{flexDirection: 'column-reverse'}}>\n      \n      {props.current.map((content, index2)=>{\n        const next = index2 + 1 < props.current.length?props.current[index2+1]:nextContent\n        const created:string = content.created.slice(0, 16)\n        const date = created.slice(0, 10)\n        const isSystem = content.user == null\n        const isFirst = next==undefined || (content.user != next.user || created != next.created.slice(0, 16))\n        const isSelf = props.ownerId == content.user\n        const dayChanged = next==undefined || date != next.created.slice(0, 10)\n        const message = content.message_set[0]\n        const openModal = ()=>setModal(MessageModal, {id:content.id, content:message.content, isOwner:isSelf, isTimer:content.timer?true:false})\n        if (isSystem)\n          return <View key={content.id} style={{flexDirection:'row', justifyContent:'center', width:'100%', marginVertical:5}}>\n            <Text>{message.content}</Text>\n          </View>\n        return <View key={content.id}>\n          {dayChanged?<View style={{flexDirection:'row', justifyContent:'center', width:'100%'}}><Text>{date}</Text></View>:undefined}\n          <View key={content.id} style={{flexDirection:'row', justifyContent:isSelf?'space-between':'flex-start', width:'100%'}}>\n            {isFirst && !isSelf? <View style={{marginTop:3, marginLeft:12}}><Avatar name={content.name} userId={content.user} size={36}/></View>:<View style={{width:48}}/>}\n            <CommonSection outerContainerStyle={{width:undefined, maxWidth:'90%'}} title={isFirst?content.name:undefined} titleStyle={{flex:undefined}} bodyStyle={{padding:10}} subtitle={`${created.slice(11)}`}>\n              <TouchableOpacity onLongPress={openModal}>\n                {content.timer && <View style={{flexDirection:'row', alignItems:'stretch'}}>\n                  <Text style={{fontSize:12}}></Text>\n                  <Text style={{fontSize:12}} selectable={!isMobile}>{timerToString(content.timer)}</Text>\n                </View>}\n                <View style={{width:\"100%\"}}>\n                  {/* @ts-ignore */}\n                  <Hyperlink linkDefault={ true } style={{wordBreak:\"break-word\"}} linkStyle={{color: '#12b886'}}>\n                    <Text selectable={!isMobile} style={{textAlign:isSelf?'right':'left'}}>{message.content}</Text>\n                  </Hyperlink>\n                </View>\n              {content.file_set.map((file, fileIndex)=><FilePreview key={fileIndex} file={file} isMobile={isMobile} showBorder={content.file_set.length>1 || message.content.length>0}/>)}\n              {content.link_set.map((link, linkIndex)=><LinkPreview key={linkIndex} link={link} isMobile={isMobile}/>)}\n              </TouchableOpacity>        \n            </CommonSection>\n          </View>\n        </View>\n      })}\n    </View>\n\n})\n\nexport default function ChatScreen({navigation, route}: StackScreenProps<any, 'Chat'>) {\n  const { lang, locale } = useLangContext()\n  const isMobile = useIsMobile()\n  const channel_id = route?.params?.id\n  const height = useRef(0)\n  const inputRef = useRef<TextInput>(null)\n  const {auth} = useAuthContext()\n  const { setModal } = useModalsContext()\n  const channel = useMessengerChannelList(auth)?.find(v=>v.id==parseInt(channel_id))\n  const channelAvatar = channel?avatarFromChannel(channel, auth.user):undefined\n  const {data, fetchNextPage } = useMessengerContentList(channel_id)\n  const memberList = useMessengerMemberList(channel_id)\n  const member_id = useMemo(()=>memberList?.find(v=>v.user == auth.user?.id)?.id, [auth, memberList])\n  const windowType = useResizeContext()\n  const [value, setValue] = useState('')\n  const [timer, setTimer] = useState<string>()\n  const [autoFocus, setAutoFocus] = useState<boolean|null>(null)\n  const [videoMode, setVideoMode] = useState<boolean>(false)\n  const [bottomTab, setBottomTab] = useState<boolean>(false)\n\n  const theme = useColorScheme()\n  const postValue = ()=>{\n    if (value.length>0){\n      contentMutation.create({channel:channel_id, user:auth.user?.id, content:value, timer})\n      setValue('')\n      setTimer(undefined)\n      setBottomTab(false)\n      setAutoFocus(true)\n    }\n  }\n  const contentMutation = useMessengerContentMutation()\n\n  useLayoutEffect(() => {\n    navigation.setOptions({\n      headerRight: ()=> <HeaderRight extra={[\n        {title:lang('invite'), onPress:()=>setModal(InviteModal, {id:channel_id})},\n        {title:lang('setting'), onPress:()=>setModal(ChannelEditModal, {id:channel_id, type:'messenger', member_id})}\n      ]}/>,\n      title: channelAvatar?.name\n    });\n  }, [navigation, route, member_id, locale]);\n\n  const renderItem = useCallback(({item, index}:{item:MessengerContentPage, index:number})=><MessengerContentPageItem {...item} ownerId={auth.user?.id}/>, [auth])\n  \n  const back = ()=>{\n    if(navigation.canGoBack())\n        navigation.goBack()\n      else{\n        navigation.navigate('HomeScreen', {tab:2})\n      }\n  }\n  useEffect(()=>{\n    setModal(null, null)\n    if (!channel_id)\n      back()\n  }, [route])\n  useEffect(()=>{\n    if (memberList===null || (memberList!=undefined && memberList.find(v=>v.user==auth.user?.id)==undefined))\n      back()\n  }, [memberList])\n  useEffect(()=>{\n    if(autoFocus){\n      (inputRef.current as any).focus()\n      setAutoFocus(false)\n    }\n  }, [autoFocus])\n  useEffect(()=>{\n    if (autoFocus==null && !isMobile){\n      const timeout = setTimeout(()=>setAutoFocus(true), 500)\n      return ()=>clearTimeout(timeout)\n    }\n  })\n  return <View style={[\n    {flex:1, alignItems:'center'},\n    windowType=='landscape'?{flexDirection:'row-reverse', minWidth:480}:{flexDirection:'column'}\n  ]}>\n    <VideoCallSection channel_id={channel_id} setDisable={(d)=>setVideoMode(!d)} disable={!videoMode}/>\n    <View style={[{flex:videoMode?undefined:1, flexShrink:1}, windowType=='landscape'?{minWidth:320, height:'100%'}:{width:'100%'}]}>\n      <FlatList\n        style={{flexDirection: 'column-reverse'}}\n        contentContainerStyle={{padding:10, flexGrow:1, flexDirection: 'column-reverse'}}\n        data={data?.pages}\n        renderItem={renderItem}\n        onScroll={(e)=>{\n          if (e.nativeEvent.contentOffset.y + e.nativeEvent.contentSize.height - height.current < 1)\n            fetchNextPage()\n        }}\n        onLayout={(p)=>{height.current = p.nativeEvent.layout.height}}\n      />\n      <View style={{position:'absolute'}}>\n        <TimerTags channel_id={channel_id}/>\n      </View>\n      <ThemedView style={{bottom:0, width:'100%', paddingTop:15, paddingBottom:10, paddingHorizontal:19}}>\n        <View style={{alignItems:'center', width:'100%',flexDirection:'row'}}>\n          <CommonButton title={''} style={{height:40, paddingTop:8, borderTopRightRadius:0, borderBottomRightRadius:0}} onPress={()=>setBottomTab(!bottomTab)}>\n            <View style={{top:-2}}>\n              <Entypo name={bottomTab?\"cross\":\"plus\"} size={24} color={Colors[theme].text}/>\n            </View>\n          </CommonButton>\n          {timer && <CommonButton style={{height:40, paddingTop:8, borderRadius:0}} title={`${timerFormat(timer)}`} onPress={()=>{setModal(DateTimePickerModal, {datetime:timer, callback:(datetime:string)=>setTimer(datetime)});setBottomTab(false)}}/>}\n          <TextInput ref={inputRef} value={value} onChangeText={setValue} style={{\n            flex:1, borderWidth:1, height:40, borderColor:Colors.borderColor, backgroundColor:Colors[theme].background, color:Colors[theme].text\n          }} onSubmitEditing={postValue} blurOnSubmit={true} onFocus={()=>setBottomTab(false)}/>\n          <CommonButton style={{height:40, paddingTop:8, borderTopLeftRadius:0, borderBottomLeftRadius:0}} title={''} onPress={postValue}/>\n        </View>\n\n        {bottomTab && <View style={{alignItems:'center', width:'100%', flexDirection:'row', paddingTop:15, paddingBottom:5}}>\n          <CommonButton style={{height:80, flex:1, justifyContent:'center', marginRight:15}} title={`\\n ${lang('File')}`} onPress={()=>uploadFile().then(f=>{contentMutation.create({channel:channel_id, user:auth.user?.id, content:'', file:f});setBottomTab(false)})}/>\n          <CommonButton style={{height:80, flex:1, justifyContent:'center', marginRight:15}} title={`\\n ${lang('Timer')}`} onPress={()=>{setModal(DateTimePickerModal, {datetime:timer, callback:(datetime:string)=>setTimer(datetime)});setBottomTab(false)}}/>\n          <CommonButton style={{height:80, flex:1, justifyContent:'center'}} title={`\\n ${lang('Video Call')}`} onPress={()=>{setVideoMode(!videoMode);setBottomTab(false)}} disabled={videoMode}/>\n        </View>}\n      </ThemedView>\n    </View>\n  </View>\n}","import React from \"react\"\nimport CommonSection from \"../../../components/CommonSection\"\nimport Colors from \"../../../constants/Colors\"\nimport useColorScheme, { setColorScheme } from \"../../../hooks/useColorScheme\"\nimport { StyleSheet, Text, View} from 'react-native';\nimport useLangContext from \"../../../hooks/useLangContext\";\nimport { useColorScheme as useConfigColorScheme} from 'react-native-appearance';\nimport useFirebaseContext from \"../../../hooks/useFirebaseContext\";\nimport TextButton from \"../../../components/TextButton\";\nimport useModalsContext from \"../../../hooks/useModalsContext\";\nimport RegistrationModal from \"../../../modals/RegistrationModal\";\nimport useAuthContext from \"../../../hooks/useAuthContext\";\n\n\nconst ConfigSection = ({title, children}:{title:string, children?: React.ReactNode})=>{\n  const theme = useColorScheme()\n  const color = Colors[theme].text\n  return <CommonSection bodyStyle={{alignItems:'flex-start', backgroundColor:theme=='light'?'transparent':\"black\"}}>\n    <Text style={{fontSize:20, color, fontWeight:'600'}}>{title}</Text>\n    {children}\n  </CommonSection>\n}\n\nexport default ()=>{\n  const { lang, locale, setLocale } = useLangContext()\n  const { setModal } = useModalsContext()\n  const {auth} = useAuthContext()\n  const theme = useColorScheme()\n  const configTheme = useConfigColorScheme()\n  const {enable:noti, setEnable:setNoti} = useFirebaseContext()\n  const color = Colors[theme].text\n  return <>\n    <ConfigSection title={lang('* Notification Settings')}>\n      <View style={{flexDirection:'row'}}>\n        {[[lang('On'), true], [lang('Off'), false]].map(([title, n])=><TextButton\n          key={title} title={title || ''} textStyle={{fontSize:16, color, textDecorationLine:noti==n?'underline':'none'}} style={{borderRadius:20}} onPress={()=>{setNoti(n)}}/>)}\n      </View>\n    </ConfigSection>\n    <ConfigSection title={lang('* Language Settings')}>\n    <View style={{flexDirection:'row'}}>\n        {[[lang('Auto'), 'auto'], ['', 'ko'], ['English', 'en']].map(([title, l])=><TextButton \n          key={title} title={title || ''} textStyle={{fontSize:16, color, textDecorationLine:locale==l?'underline':'none'}} style={{borderRadius:20}} onPress={()=>setLocale(l)}/>)}\n      </View>\n    </ConfigSection>\n    <ConfigSection title={lang('* Skin Settings')}>\n      <View style={{flexDirection:'row'}}>\n        {[[lang('Auto'), 'no-preference'], [lang('Light'), 'light'], [lang('Dark'), 'dark']].map(([title, colorScheme])=><TextButton \n          key={title} title={title} textStyle={{fontSize:16, color, textDecorationLine:configTheme==colorScheme?'underline':'none'}} style={{borderRadius:20}} onPress={(\n            )=>setColorScheme(colorScheme)}/>)}\n      </View>\n    </ConfigSection>\n    {!auth.user?.is_guest && <CommonSection bodyStyle={{alignItems:'flex-start', backgroundColor:theme=='light'?'transparent':\"black\"}}>\n      <TextButton title={lang('> Account Settings')} textStyle={{fontSize:20, color}} style={{paddingLeft:0, borderRadius:20}} onPress={()=>setModal(RegistrationModal, {id:auth.user?.id})}/>\n    </CommonSection>}\n  </>\n}","import React, {useState, useEffect, useLayoutEffect, useMemo} from 'react';\nimport { StackScreenProps } from '@react-navigation/stack';\nimport { StyleSheet, View, ScrollView} from 'react-native';\nimport { Text as StyledText } from 'react-native-paper';\nimport { Text } from '../../../components/Themed'\nimport useResizeContext from '../../../hooks/useResizeContext';\nimport TabView from '../../../components/TabView';\nimport HeaderRight from '../../../components/HeaderRight';\nimport TextButton from '../../../components/TextButton';\nimport Colors from '../../../constants/Colors';\nimport useColorScheme  from '../../../hooks/useColorScheme';\nimport useModalsContext from '../../../hooks/useModalsContext';\nimport ChannelEditModal from '../../../modals/ChannelEditModal';\nimport useLangContext from '../../../hooks/useLangContext';\nimport ContractFooter from '../../../components/ContractFooter';\nimport { TabViewRecord } from '../../../types';\nimport useAuthContext from '../../../hooks/useAuthContext';\nimport useUserMembershipList from '../../../hooks/lists/useUserMembershipList';\nimport { FontAwesome, Ionicons, MaterialCommunityIcons, SimpleLineIcons } from '../../../lib/@expo/vector-icons';\nimport { useMessengerChannelSorted } from '../../../hooks/lists/useMessengerChannelList';\nimport CommonItem from '../../../components/CommonItem';\nimport MemberItem from '../../../components/MemberItem';\nimport ProfileModal from '../../../modals/ProfileModal';\nimport { navigate } from '../../../navigation';\nimport CommonSection from '../../../components/CommonSection';\nimport ConfigSections from './ConfigSections';\nimport Avatar, { avatarFromChannel } from '../../../components/Avatar';\nimport RegistrationModal from '../../../modals/RegistrationModal';\n\nconst MemberTabView = ()=>{\n  const {auth} = useAuthContext()\n  const theme = useColorScheme()\n  const { setModal } = useModalsContext()\n  const userList = useUserMembershipList(auth)\n  const memberItem = React.useMemo(\n      ()=>userList && userList.map((item, index)=><MemberItem key={index} member={item} onPress={()=>setModal(ProfileModal, {id:item.id})}/>), [userList])\n  return <ScrollView style={{flex:1, backgroundColor:Colors[theme].background}}>\n      {memberItem}\n  </ScrollView>\n}\n\nconst MessengerTabView = ()=>{\n  const {auth} = useAuthContext()\n  const channelList = useMessengerChannelSorted(auth)\n  const theme = useColorScheme()\n\n  const today = (new Date()).toISOString().slice(0, 10)\n  return <ScrollView style={{flex:1, backgroundColor:Colors[theme].background}}>\n      {channelList?.map((item, index)=>{\n          const {avatar, name} = avatarFromChannel(item, auth.user)\n          const date = item.last_message?.created.slice(0,10)\n          return <CommonItem key={index} bodyStyle={{flexDirection:'row', justifyContent:'space-between'}} onPress={()=>navigate(\"ChatScreen\", {id:item.id})}>\n              <View style={{flexDirection:'row', flexShrink:1}}>\n                  {avatar?\n                    <View style={{ marginRight:20}}>\n                      <Avatar name={avatar.name} size={44} userId={avatar.id}/>\n                    </View>:\n                    <FontAwesome size={40} color={Colors[theme].iconColor} style={{ marginBottom: -3, marginRight:20 }} name='users'/>}\n                  <View>\n                      <View style={{flexDirection:'row'}}>\n                          <Text style={{fontSize:18}}>{name}</Text>\n                          <Text style={{fontSize:18, opacity: 0.4, paddingLeft:5}}>{item.member_count}</Text>\n                      </View>\n                      <Text style={{fontSize:16, opacity: 0.4}}>{item.last_message?.content}</Text>\n                  </View>\n              </View>\n              <View>\n                  <Text style={{fontSize:14, opacity: 0.4, textAlign:'right'}}>{date==today?item.last_message?.created.slice(11,16):date}</Text>\n                  <Text style={{fontSize:14, textAlign:'right'}}>{item.unread_count?item.unread_count:' '}</Text>\n              </View>\n          </CommonItem>\n      })}\n  </ScrollView>\n}\n\n\nconst ConfigTabView = ()=>{\n  const theme = useColorScheme()\n  return <ScrollView style={{flex:1, backgroundColor:Colors[theme].background}}>\n    <ConfigSections/>\n  </ScrollView>\n}\n\nconst getBottomTabs = (theme:'light'|'dark')=>{\n  const color = Colors[theme].iconColor\n  return {\n    OneTab:{\n        title:'member',\n        component:MemberTabView,\n        icon:<MaterialCommunityIcons size={32} color={color} style={{ marginBottom: -3 }} name='account'/>,\n    },\n    TwoTab:{\n        title:'chat',\n        component:MessengerTabView,\n        icon:<Ionicons size={30} color={color} style={{ marginBottom: -3 }} name='chatbox'/>\n    },\n    // ThreeTab:{\n    //     title:'board',\n    //     component:()=><></>,\n    //     icon:<></>\n    // },\n    FourTab:{\n        title:'config',\n        component:ConfigTabView,\n        icon:<SimpleLineIcons size={30} color={color} style={{ marginBottom: -3 }} name='options'/>\n    }\n  } as TabViewRecord\n}\n\n\nexport default function HomeScreen({navigation, route}: StackScreenProps<any, 'Home'>) {\n  const { lang, locale } = useLangContext()\n  const windowType = useResizeContext();\n  const theme = useColorScheme()\n  const { setModal } = useModalsContext()\n  const [ home, setHome ] = useState(windowType == 'landscape')\n  const color = Colors[theme].text\n  const options = [\n    {title:lang('member'), headerRight:()=><HeaderRight extra={[{title:lang('create'), onPress:()=>setModal(RegistrationModal, {})}]}/>},\n    {title:lang('chat'), headerRight:()=><HeaderRight extra={[{title:lang('create'), onPress:()=>setModal(ChannelEditModal, {type:'messenger'})}]}/>},\n    // {title:'board', headerRight:()=><HeaderRight extra={[{title:'create', onPress:()=>setModal(ChannelEditModal, props:{type:'board'}}) }]}/>},\n    {title:lang('config'), headerRight:()=><HeaderRight/>}\n  ]\n  \n  useLayoutEffect(() => {\n    const index = route?.params?.tab | 0\n    navigation.setOptions(windowType == 'portrait'?options[index]:{\n      title: lang('home'),\n      headerRight: ()=><HeaderRight/>\n    });\n  }, [navigation, route, windowType, locale]);\n  useEffect(()=>{\n    setHome(windowType == 'landscape')\n  }, [windowType])\n  return home?\n    <ScrollView contentContainerStyle={{flex:1, alignItems:'center'}}>\n      <View style={{flexGrow:1, width:'80%', marginTop:72}}>\n        <StyledText style={{fontSize:32, color}}>Tokki Tok</StyledText>\n        <View style={{backgroundColor:Colors.borderColor, height:1, width:'100%'}}/>\n        {/* <Text style={{fontSize:20, color:'gray'}}>Welcome! This is a messenger for teams.</Text>*/}\n        <View style={{height:24}}/>\n        <CommonSection bodyStyle={{alignItems:'flex-start', backgroundColor:theme=='light'?'transparent':\"black\"}}>\n          <TextButton title={lang('+ New chat')} textStyle={{fontSize:20, color}} style={{paddingLeft:0, borderRadius:20}} onPress={()=>setModal(ChannelEditModal, {type:'messenger'})}/>\n        </CommonSection>\n        <ConfigSections/>\n      </View>\n      <ContractFooter theme={theme}/>\n    </ScrollView>:\n    <TabView tabs={getBottomTabs(theme)} tabBarPosition=\"bottom\" index={parseInt(route.params?.['tab'] || 0)} onTab={(index)=>{navigation.setParams({tab:index})}}/>\n}\n\n","import LoginScreen from \"./main/LoginScreen\";\nimport ChatScreen from \"./main/ChatScreen\";\nimport HomeScreen from \"./main/HomeScreen\";\n// import BoardScreen from \"../lib/blacktokki-board/BoardScreen\";\n// import BoardEditScreen from \"../lib/blacktokki-board/BoardEditScreen\";\nimport { Screens } from \"../types\";\nimport DemoScreen from \"./main/DemoScreen\";\n\nexport const main = {\n    HomeScreen:{\n        title:'home',\n        component:HomeScreen,\n        path:'home',\n    },\n    ChatScreen:{\n        title:'chat',\n        component:ChatScreen,\n        path:'chat'\n    },\n    // BoardScreen:{\n    //     title:'board',\n    //     component:BoardScreen,\n    //     path:'board'\n    // },\n} as Screens\n\nexport const login = {\n    LoginScreen:{\n        path: 'login',\n        title: 'Sign in',\n        component:LoginScreen\n    },\n    DemoScreen:{\n        title:'',\n        component:DemoScreen,\n        path:'demo'\n    }\n} as Screens\n\nexport const modal = {\n    // BoardEditScreen:{\n    //     title:'board',\n    //     component:BoardEditScreen,\n    //     path:'modal/board'\n    // },\n} as Screens","import React, { useLayoutEffect } from 'react';\n\nimport { StackScreenProps } from '@react-navigation/stack';\nimport useAuthContext from '../../hooks/useAuthContext';\n\nexport default function DemoScreen({navigation}: StackScreenProps<any, 'Demo'>) {\n    const {dispatch} = useAuthContext()\n    useLayoutEffect(() => {\n        navigation.setOptions({headerRight: undefined});\n        dispatch({type:\"LOGIN_GUEST\"})\n    }, []);\n  return <></>\n};","import { useMemo, useReducer } from \"react\"\n\ntype LocalSearchAction = {type:string, keyword?:string}\n\ntype LocalSearchState ={active:boolean, keyword:string}\n\n\n\nconst localSearchReducer =(initialState:LocalSearchState, action:LocalSearchAction)=>{\n    switch (action.type){\n        case 'SEARCH':\n          return {\n            ...initialState,\n            keyword: action.keyword\n          } as LocalSearchState\n        case 'ENABLE_SEARCH':\n          return {\n            ...initialState,\n            active:true,\n          }\n        case 'DISABLE_SEARCH':\n            return{\n                ...initialState,\n                active:false,\n                keyword: ''\n            }\n        default:\n            throw new Error( `Unhandled action type: ${action.type}`)\n    }\n  }\n\n\nexport default function useLocalSearch<T>(target:T[], compare:(value:T, keyword:string)=>boolean) {\n  const [searchState, dispatch] = useReducer(localSearchReducer, {active:false, keyword:''})\n  const data = useMemo(()=>searchState.active?target.filter(v=>compare(v, searchState.keyword)):target, [searchState, target])\n  return {searchState, dispatch, data}\n}","\nimport React, {useState} from 'react';\nimport { StyleProp, TextStyle, View } from 'react-native';\nimport Clipboard from '@react-native-clipboard/clipboard';\nimport useLangContext from '../hooks/useLangContext';\nimport { CustomTextInputProps } from '../types';\nimport CommonButton from './CommonButton';\nimport RowField from './RowField';\nimport { Text } from './Themed';\nimport useResizeContext from '../hooks/useResizeContext';\n\nexport default function CopyField(props:CustomTextInputProps & {name: string, width?:any, textStyle?:StyleProp<TextStyle>}) {\n  const { lang } = useLangContext()\n  const windowType = useResizeContext()\n  const [copied, setCopied] = useState(false)\n  return (\n    <RowField name={props.name} width={props.width} textStyle={props.textStyle}>\n      <View style={{flexDirection:windowType=='landscape'?'row':'column', justifyContent:'space-between'}}>\n        <View style={{justifyContent:'center'}}>\n          <Text style={{fontSize:16}}>{props.value}</Text>\n        </View>\n        <View>\n          <CommonButton title={lang('copy')} onPress={()=>{Clipboard.setString(props.value);setCopied(true)}}/>\n          {copied && <Text style={{fontSize:12, alignSelf:'center', color:'red'}}>{lang(\"copied\")}</Text>}\n        </View>\n      </View>\n   </RowField>\n  )\n}","import React, {useRef,MutableRefObject, useMemo, useState, useEffect } from 'react';\nimport Clipboard from '@react-native-clipboard/clipboard/dist';\nimport { View, Text } from '../components/Themed';\nimport useAuthContext from '../hooks/useAuthContext';\nimport useUserMembershipList from '../hooks/lists/useUserMembershipList';\nimport { TabViewRecord, UserMembership } from '../types';\nimport CommonButton from '../components/CommonButton';\nimport useMessengerMemberList, { useMessengerMemberMutation } from '../hooks/lists/useMessengerMemberList';\nimport useModalsContext from '../hooks/useModalsContext';\nimport useExternalMembershipList from '../hooks/lists/useExternalMembershipList';\nimport TextField from '../components/TextField';\nimport useLocalSearch from '../hooks/useLocalSearch';\nimport TabView from '../components/TabView';\nimport { FlatList, TouchableOpacity } from 'react-native-gesture-handler';\nimport useLangContext from '../hooks/useLangContext';\nimport MemberItem from '../components/MemberItem';\nimport ModalSection from '../components/ModalSection';\nimport useModalEffect from '../hooks/useModalEffect';\nimport CopyField from '../components/CopyField';\n\nconst InviteItem = (props:{item:UserMembership, selectedRef:MutableRefObject<Set<number>>})=>{\n  const [selected, setSelected] = useState(props.selectedRef.current.has(props.item.id))\n  return <View style={selected?{borderWidth:1, borderColor:'blue'}:{}}>\n    <MemberItem member={props.item} onPress={()=>{\n      if (selected){\n        setSelected(false)\n        props.selectedRef.current.delete(props.item.id)\n      }\n      else{\n        setSelected(true)\n        props.selectedRef.current.add(props.item.id)\n      }\n    }}/>\n  </View>\n\n}\ntype InviteTabViewProps = {\n  id:number,\n  selectedRef:MutableRefObject<Set<number>>\n}\n\nconst GroupTabView = ({id, selectedRef}:InviteTabViewProps)=>{\n  const { lang } = useLangContext()\n  const {auth} = useAuthContext()\n  const { setModal } = useModalsContext()\n  const userList = useUserMembershipList(auth)\n  const memberList = useMessengerMemberList(id)\n  const messengerMemberMutation = useMessengerMemberMutation()\n  const rawData = useMemo(()=>{\n    const memberSet = new Set(memberList?.map(v=>v.user))\n    return userList?.filter(v=>!memberSet.has(v.id)) || []\n  }, [userList, memberList])\n  const {data, dispatch:dispatchKeyword, searchState} = useLocalSearch(rawData, (v, keyword)=>(v.username.includes(keyword) || v.name.includes(keyword)))\n  const search = (k:string)=>{\n    if (k?.length>0){\n      dispatchKeyword({type:'ENABLE_SEARCH'})\n      dispatchKeyword({type:'SEARCH', keyword:k})\n    }\n    else{\n      dispatchKeyword({type:'DISABLE_SEARCH'})\n    }\n  }\n  const back = ()=>{\n    setModal(InviteModal, null)\n  }\n  useModalEffect(back, [])\n  return <View style={{alignItems:'center', flex:1}}>\n    <View style={{'width': '100%', flex:1}}>\n      <TextField name={`${lang('Username')} & ${lang('Name')}`} placeholder={auth.user?.name} value={searchState.keyword} setValue={search} width={'80%'}/>\n      {id && data && <FlatList contentContainerStyle={{flexGrow:1}} data={data} renderItem={({item})=><InviteItem item={item} selectedRef={selectedRef}/>}/>}\n    </View>\n    <View style={[{width:'100%', flexDirection:'row', padding:10,}, {justifyContent:'flex-end'}]}>\n      <CommonButton title={lang('invite')} onPress={()=>{\n        messengerMemberMutation.invite({\n          channel_id:id,\n          user_ids:[...selectedRef.current]\n        }).then(back)\n      }}/>\n      <CommonButton title={lang('cancel')} onPress={back}/>\n    </View>\n  </View>\n}\n\nconst DELAY = 500\n\nconst ExternalMembershipTabView = ({id, selectedRef}:InviteTabViewProps)=>{\n  const { lang } = useLangContext()\n  const [value, setValue] = useState('')\n  const [keyword, setKeyword] = useState('')\n  const [copied, setCopied] = useState(false)\n  const timeoutRef = useRef<NodeJS.Timeout>()\n  const {auth} = useAuthContext()\n  const { setModal } = useModalsContext()\n  const memberList = useMessengerMemberList(id)\n  const externalMemberList = useExternalMembershipList(keyword)\n  const data = useMemo(()=>{\n    const memberSet = new Set(memberList?.map(v=>v.user))\n    return externalMemberList?.filter(v=>!memberSet.has(v.id)) || []\n  }, [externalMemberList, memberList])\n  const messengerMemberMutation = useMessengerMemberMutation()\n  useEffect(()=>{\n    timeoutRef.current = setTimeout(()=>{\n      setKeyword(value)\n    }, DELAY)\n    return ()=>{timeoutRef.current && clearTimeout(timeoutRef.current)}\n  }, [value])\n  const back = ()=>{\n    setModal(InviteModal, null)\n  }\n  const inviteLink = location.href.replace('chat', 'invitee')\n  return <View style={{alignItems:'center', flex:1}}>\n  <View style={{'width': '100%', flex:1, paddingVertical:10}}>\n    <CopyField name={lang('invite link')} width={'80%'} value={inviteLink}/>\n    <View style={{marginVertical: 10, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\n    <TextField name={lang('Username')} placeholder={auth.user?.username} value={value} setValue={setValue} width={'80%'}/>\n    {id && data && <FlatList contentContainerStyle={{flexGrow:1}} data={data} renderItem={({item})=><InviteItem item={item} selectedRef={selectedRef}/>}/>}\n  </View>\n  <View style={[{width:'100%', flexDirection:'row', padding:10,}, {justifyContent:'flex-end'}]}>\n    <CommonButton title={lang('invite')} onPress={()=>{\n      messengerMemberMutation.invite({\n        channel_id:id,\n        user_ids:[...selectedRef.current]\n      }).then(back)\n    }}/>\n    <CommonButton title={lang('cancel')} onPress={back}/>\n  </View>\n</View>\n}\n\nexport default function InviteModal({id}:{id:number}) {\n  const { lang } = useLangContext()\n  const selectedRef = useRef<Set<number>>(new Set())\n  const drawerTabs:TabViewRecord = {\n    group:{\n      title: 'Group',\n      component: ()=><GroupTabView id={id} selectedRef={selectedRef}/>,\n      icon: <></>\n    },\n    external:{\n      title: 'External members',\n      component: ()=><ExternalMembershipTabView id={id} selectedRef={selectedRef}/>,\n      icon: <></>\n    }\n  }\n  return <ModalSection>\n    <View style={{flex:1, width:'100%'}}>\n      <View style={{width:'100%'}}>\n        <Text style={{fontSize:20}}>{lang('invite')}</Text>\n        <View style={{marginBottom: 20, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\n      </View>\n      <TabView tabs={drawerTabs} tabBarPosition={\"top\"}/>\n    </View>\n  </ModalSection>\n}\n\n","import { useQuery } from \"react-query\";\nimport { getExternalMembershipList } from \"../../apis\";\n\nexport default function useExternalMembershipList(keyword?:string){\n  const { data } = useQuery([\"UserMembershipList\", keyword] , async()=>keyword?(await getExternalMembershipList(keyword)):[])\n  return data\n}","/**\n * Learn more about deep linking with React Navigation\n * https://reactnavigation.org/docs/deep-linking\n * https://reactnavigation.org/docs/configuring-links\n */\n\nimport { LinkingOptions } from '@react-navigation/native';\nimport * as Linking from 'expo-linking';\nimport {main, login, modal} from '../screens';\n\nconst ROOTPATH = 'tokki-tok'  // github repository name\n\nObject.values(modal).forEach(v=>v.path = ROOTPATH + '/' + v.path)\n\nexport default  {\n  prefixes: [Linking.makeUrl('/')],\n  config: {\n    screens: {\n      Main: {\n        screens:{\n          ...main,\n          ...login,\n          NotFound: '*',\n        },\n        path: ROOTPATH\n      },\n      ...modal\n    },\n  },\n} as LinkingOptions;\n","firebaseConfig = {\n    \"authDomain\": \"virtual-metrics-355712.firebaseapp.com\",\n    \"projectId\": \"virtual-metrics-355712\",\n    \"storageBucket\": \"virtual-metrics-355712.appspot.com\",\n    \"messagingSenderId\": \"76003576924\",\n    \"appId\": \"1:76003576924:web:c8c8a006d07918bbc02a99\",\n    \"measurementId\": \"G-SEL35L4N5R\"\n}\nif (typeof module !== 'undefined') {\n    module.exports = firebaseConfig\n}\n","import { StackScreenProps } from '@react-navigation/stack';\nimport * as React from 'react';\nimport { StyleSheet, Text, TouchableOpacity, View } from 'react-native';\nimport useAuthContext from '../hooks/useAuthContext';\nimport useLangContext from '../hooks/useLangContext';\n\nexport default function NotFoundScreen({\n  navigation,\n}: StackScreenProps<any, 'NotFound'>) {\n  const { lang } = useLangContext()\n  const { auth } = useAuthContext()\n  return (\n    <View style={styles.container}>\n      <Text style={styles.title}>{lang(\"This screen doesn't exist.\")}</Text>\n      <TouchableOpacity onPress={() => navigation.replace(auth.user?'HomeScreen':'LoginScreen')} style={styles.link}>\n        <Text style={styles.linkText}>{lang(\"Go to home screen!\")}</Text>\n      </TouchableOpacity>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#fff',\n    alignItems: 'center',\n    justifyContent: 'center',\n    padding: 20,\n  },\n  title: {\n    fontSize: 20,\n    fontWeight: 'bold',\n  },\n  link: {\n    marginTop: 15,\n    paddingVertical: 15,\n  },\n  linkText: {\n    fontSize: 14,\n    color: '#2e78b7',\n  },\n});\n","import { useTheme } from '@react-navigation/native';\nimport React, { useEffect, useState } from 'react';\nimport { View, StyleSheet } from 'react-native';\nimport Profile from '../components/Profile';\nimport TextButton from '../components/TextButton';\nimport Colors from '../constants/Colors';\nimport useResizeContext from '../hooks/useResizeContext';\nimport TabView from '../components/TabView';\nimport { TabViewRecord, UserMembership } from '../types';\nimport useModalsContext from '../hooks/useModalsContext';\nimport ChannelEditModal from '../modals/ChannelEditModal';\nimport CommonItem from '../components/CommonItem';\nimport { Text } from '../components/Themed';\nimport useAuthContext, { Auth } from '../hooks/useAuthContext';\nimport { useMessengerChannelSorted } from '../hooks/lists/useMessengerChannelList';\nimport { navigate } from '.'\nimport { avatarFromChannel } from '../components/Avatar';\nimport useColorScheme from '../hooks/useColorScheme';\nimport { Ionicons, MaterialCommunityIcons } from '../lib/@expo/vector-icons';\nimport RegistrationModal from '../modals/RegistrationModal';\nimport useUserMembershipList from '../hooks/lists/useUserMembershipList';\nimport ProfileModal from '../modals/ProfileModal';\n\n\nconst MemberTabView = ()=>{\n  const {auth} = useAuthContext()\n  const { setModal } = useModalsContext()\n  const userList = useUserMembershipList(auth)\n  return <View style={{flex:1}}>\n    {userList?.map((item, index)=>{\n      return <CommonItem key={index} containerStyle={{marginHorizontal:0}} bodyStyle={{alignItems:'flex-start'}} onPress={()=>setModal(ProfileModal, {id:item.id})}>\n        <Text style={{marginLeft:20}}>{item.name}</Text>\n      </CommonItem>\n    })}\n  </View>\n}\n\nconst MessengerTabView = ()=>{\n  const {auth} = useAuthContext()\n  const channelList = useMessengerChannelSorted(auth);\n  return <View style={{flex:1}}>\n    {channelList?.map((item, index)=>{\n      const {name} = avatarFromChannel(item, auth.user)\n      return <CommonItem key={index} containerStyle={{marginHorizontal:0}} bodyStyle={{alignItems:'flex-start'}} onPress={()=>navigate(\"ChatScreen\", {id:item.id})}>\n        <Text style={{marginLeft:20}}>{name}</Text>\n      </CommonItem>\n    })}\n  </View>\n}\nconst getDrawerTabs = (theme:'light'|'dark')=>{\n  const color = Colors[theme].iconColor\n  return {\n    MemberTab:{\n      title:'member',\n      component:MemberTabView,\n      icon:<MaterialCommunityIcons size={32} color={color} style={{ marginBottom: -3 }} name='account'/>,\n    },\n    ChatTab:{\n        title:'chat',\n        component:MessengerTabView,\n        icon:<Ionicons size={30} color={color} style={{ marginBottom: -3 }} name='chatbox'/>\n    },\n  } as TabViewRecord\n}\n\nexport default ({auth}:{auth:Auth})=> {\n  const { colors } = useTheme();\n  const theme = useColorScheme();\n  const windowType = useResizeContext();\n  const channelList = useMessengerChannelSorted(auth);\n  const [index, setIndex] = useState<number>();\n  const { setModal } = useModalsContext()\n  \n  const onAddList = [\n    ()=>setModal(RegistrationModal, {}),\n    ()=>setModal(ChannelEditModal, {type:'messenger'}),\n  ]\n  const drawerTabs = getDrawerTabs(theme)\n\n  useEffect(()=>{\n    if(index===undefined && channelList){\n      setIndex(channelList.length>0?1:0)\n    }\n  }, [channelList])\n  return <View style={windowType=='landscape'?[\n      styles.tabBar,\n      {\n        backgroundColor: Colors[theme].background,\n        borderTopColor: colors.border,\n      },\n      // tabBarStyle,\n    ]:{width:0}}\n    pointerEvents={false ? 'none' : 'auto'}\n  >\n    {windowType=='landscape' && auth.user && index!==undefined && <>\n      <Profile userId={auth.user.id} username={auth.user.username} name={auth.user.name}/>\n      <View style={{flexDirection:'row-reverse'}}>\n          <TextButton title='+' textStyle={{fontSize:20}} style={{borderRadius:20}} onPress={onAddList[index]}/>\n      </View>\n      <View accessibilityRole=\"tablist\" style={styles.content}>\n        {Object.keys(drawerTabs).length>1 ? \n          <TabView tabs={drawerTabs} tabBarPosition={\"top\"} onTab={setIndex} index={index}/>: \n          <View style={{borderTopWidth:1, flex:1, borderColor:colors.border}}>            \n            {Object.values(drawerTabs).map(drawerTab=>{const Tab = drawerTab.component; return <Tab key={drawerTab.title}/>})}\n          </View>\n        }\n      </View>\n    </>}\n  </View>\n}\n\n{/*<Text style={[styles.label, { color: d.isFocused ? colors.primary : '#222' }]}></Text> */}\n\nconst styles = StyleSheet.create({\n    tabBar: {\n      width:240,\n      elevation: 8,\n      borderRightWidth:1,\n      borderColor:Colors.borderColor\n    },\n    content: {\n      flex: 1,\n      flexDirection: 'row',\n    },\n    tab: {\n        flex: 1,\n        alignItems: 'center',\n    },\n    label: {\n        textAlign: 'center',\n        backgroundColor: 'transparent',\n      },\n  });","import InviteModal from \"./InviteModal\";\nimport ProfileModal from \"./ProfileModal\";\nimport ChannelEditModal from \"./ChannelEditModal\"\nimport AlertModal from \"./AlertModal\";\nimport DateTimePickerModal from \"./DateTimePickerModal\"\nimport MessageModal from \"./MessageModal\";\nimport RegistrationModal from \"./RegistrationModal\";\n\nexport default [\n    InviteModal,\n    ProfileModal,\n    ChannelEditModal,\n    AlertModal,\n    DateTimePickerModal,\n    MessageModal,\n    RegistrationModal\n]","import { CardStyleInterpolators, createStackNavigator } from '@react-navigation/stack';\nimport React, {useMemo} from 'react';\nimport { View } from 'react-native';\nimport { Ionicons } from '../lib/@expo/vector-icons';\nimport useResizeContext from '../hooks/useResizeContext';\nimport NotFoundScreen from '../screens/NotFoundScreen';\nimport {main, login, modal} from '../screens';\nimport DrawerNavigator from './DrawerNavigator';\nimport useAuthContext from '../hooks/useAuthContext';\nimport { WebSocketProvider } from '../hooks/useWebsocketContext';\nimport HeaderRight from '../components/HeaderRight'\nimport Colors from '../constants/Colors';\nimport { TouchableOpacity } from 'react-native-gesture-handler';\nimport useFirebaseContext, { FirebaseProvider } from '../hooks/useFirebaseContext';\nimport useIsMobile from '../hooks/useIsMobile';\nimport useColorScheme from '../hooks/useColorScheme';\nimport { ModalsProvider } from '../hooks/useModalsContext';\nimport modals from '../modals';\nimport useLangContext from '../hooks/useLangContext';\nimport CommonButton from '../components/CommonButton';\nimport useInvitee from '../hooks/useInvitee';\n\nconst Root = createStackNavigator();\n\nexport default function RootNavigator() {\n    const windowType = useResizeContext();\n    useInvitee()\n    return <Root.Navigator\n        mode= 'modal'\n        headerMode= 'screen'\n        screenOptions={{\n            cardStyle:{backgroundColor:\"white\"},\n            animationEnabled: true,\n            cardStyleInterpolator: CardStyleInterpolators.forVerticalIOS,\n        }}\n    >\n        <Root.Screen name=\"Main\" component={MainNavigator} options={{headerShown:false}}/>\n        {Object.entries(modal).map(([key, screen])=><Root.Screen key={key} name={key} component={screen.component} options={{\n            title: screen.title,\n            gestureDirection: windowType == 'landscape'?'vertical-inverted':'vertical'\n        }} />)}\n    </Root.Navigator>\n}\n\nconst Main = createStackNavigator();\n\nfunction headerLeft(navigation:any, route:any, windowType:string, theme:'light'|'dark', isMobile:boolean){\n    const canGOBackScreen = ['HomeScreen', 'LoginScreen'].findIndex(v=>v == route.name) == -1\n    const goBack = ()=>{\n        if (navigation.canGoBack())\n            navigation.goBack()\n        else if (canGOBackScreen)\n            navigation.replace('HomeScreen')\n    }\n    if (windowType=='portrait' && canGOBackScreen)\n        return <TouchableOpacity onPress={goBack} disabled={!isMobile}>\n            <CommonButton title={''} color={isMobile?Colors[theme].buttonBackgroundColor:Colors[theme].hoverColor} onPress={goBack} disabled={isMobile} style={{width:32, height:32, margin:16, paddingVertical:1, paddingHorizontal:4}}>\n                <Ionicons size={24} color={Colors[theme].iconColor} name=\"arrow-back\"/>\n            </CommonButton>\n        </TouchableOpacity>\n    return null\n}\n\nconst MainNavigator = ()=>{\n    const windowType = useResizeContext();\n    const isMobile = useIsMobile()\n    const {auth} = useAuthContext()\n    const theme = useColorScheme()\n    const {lang, locale} = useLangContext()\n    const entries = useMemo(()=>{\n        if (auth.user === undefined)\n            return []\n        console.log('current user: ', auth.user)\n        return Object.entries(auth.user === null?login:main)\n    }, [auth, locale])\n    const modalValues = useMemo(()=>{\n        if (auth.user === undefined)\n            return []\n        return auth.user === null?[]:modals\n    }, [auth])\n    const backgroundStyle = theme=='light'?{}:{backgroundColor:'#010409'}\n    return (auth.user!==undefined?<View style={{flexDirection:'row', flex:1}}>\n        <ModalsProvider modals={modalValues}>\n            {auth.user?<DrawerNavigator auth={auth}/>:undefined}\n            <View style={[{flex:1}, backgroundStyle]}>\n                <WebSocketProvider disable={auth.user === null || auth.user === undefined}>\n                    <FirebaseProvider user={auth.user}>\n                        <Main.Navigator\n                            screenOptions={({navigation, route})=>({\n                                headerStyle:{backgroundColor:Colors[theme].header, height:isMobile?50:undefined},\n                                headerTitleStyle:{color:Colors[theme].text},\n                                headerLeft:()=>headerLeft(navigation, route, windowType, theme, isMobile),\n                                headerRight:()=><HeaderRight/>,\n                                headerLeftContainerStyle:{backgroundColor:Colors[theme].header, borderBottomWidth:1, borderColor:Colors[theme].headerBottomColor},\n                                cardStyle:[{flexShrink:1}, backgroundStyle],\n                                animationEnabled:windowType=='portrait',\n                                cardStyleInterpolator: CardStyleInterpolators.forHorizontalIOS\n                            })}\n                        >\n                            {entries.map(([key, screen])=><Main.Screen key={key} name={key} component={screen.component} options={{ title: lang(screen.title) }} />)}\n                            <Main.Screen name=\"NotFound\" component={NotFoundScreen} options={{ title: 'Oops!' }} />\n                        </Main.Navigator>\n                    </FirebaseProvider>\n                </WebSocketProvider>\n            </View>\n        </ModalsProvider>\n    </View>:<></>);\n}"],"sourceRoot":""}