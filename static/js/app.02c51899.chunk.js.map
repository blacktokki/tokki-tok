{"version":3,"sources":["src/components/CommonSection.tsx","src/hooks/lists/useMessengerChannelList.ts","src/components/ModalSection.tsx","src/components/TextButton.tsx","src/hooks/lists/useMessengerMemberList.ts","src/navigation/index.tsx","src/hooks/useWebsocketContext.tsx","src/modals/ChannelEditModal.tsx","src/components/HeaderRight.tsx","src/apis/notification.ts","src/components/ContractFooter.tsx","src/screens/main/LoginScreen.tsx","src/components/LinkPreview.tsx","src/lib/react-native-webrtc/useWebsocketContext.tsx","src/lib/react-native-webrtc/webrtc/p2p.tsx","src/lib/react-native-webrtc/webrtc/index.ts","src/lib/react-native-webrtc/LocalCam.tsx","src/lib/react-native-webrtc/RemoteCam.tsx","src/screens/main/ChatScreen/VideoCallSection.tsx","src/components/FilePreview.tsx","src/screens/main/ChatScreen/TimerTags.tsx","src/hooks/lists/useTimerMessageContent.ts","src/screens/main/ChatScreen/index.tsx","src/screens/main/HomeScreen/ConfigSections.tsx","src/screens/main/HomeScreen/index.tsx","src/screens/main/InviteeScreen.tsx","src/screens/index.ts","src/hooks/useIsMobile.ts","src/components/Themed.tsx","src/hooks/lists/useUserMembershipList.ts","src/components/TabView.tsx","src/components/CommonItem.tsx","src/components/RowField.tsx","src/components/TextField.tsx","src/hooks/lists/useMessengerContentList.ts","src/components/Calendar.tsx","src/modals/DateTimePickerModal.tsx","src/modals/GuestLogoutModal.tsx","src/components/CommonTextInput.tsx","src/components/MemberItem.tsx","src/modals/MessageModal.tsx","src/modals/ProfileModal.tsx","src/components/Profile.tsx","src/hooks/useFirebaseContext.tsx","src/hooks/useLocalSearch.ts","src/modals/InviteModal.tsx","src/hooks/lists/useExternalMembershipList.ts","src/constants/Colors.ts","src/components/CommonButton.tsx","src/apis/axios.ts","src/lang/index.ts","src/hooks/useLangContext.tsx","src/hooks/useAuthContext.tsx","src/hooks/useColorScheme.ts","src/hooks/useModalsContext.tsx","src/apis/account.ts","src/apis/messenger.ts","src/navigation/LinkingConfiguration.ts","src/screens/NotFoundScreen.tsx","src/navigation/DrawerNavigator.tsx","src/modals/index.ts","src/navigation/RootNavigator.tsx","src/components/MobileSafeAreaView.tsx","App.tsx","src/hooks/useCachedResources.ts","src/hooks/useResizeContext.tsx","node_modules/moment/locale sync /^/.*$","web/firebase-config.js","src/lib/react-native-paper/Avatar.tsx","src/components/Avatar.tsx","src/assets/fonts/SpaceMono-Regular.ttf"],"names":["CommonSection","props","React","View","style","styles","outerContainer","outerContainerStyle","container","containerStyle","withSeparator","separator","lightColor","darkColor","undefined","title","titleView","Text","titleStyle","subtitle","bodyView","bodyStyle","children","StyleSheet","create","width","maxWidth","alignItems","backgroundColor","marginHorizontal","marginVertical","flexDirection","marginBottom","flex","fontSize","textAlign","marginTop","height","padding","justifyContent","borderWidth","borderColor","Colors","borderRadius","useMessengerChannelList","auth","queryClient","useQueryClient","lastJsonMessage","useWebsocketContext","data","useQuery","_auth$user","_regeneratorRuntime","async","_context","prev","next","user","id","awrap","getMessengerChannelList","t0","sent","abrupt","stop","Promise","useEffect","setQueryData","_data","find","v","concat","_toConsumableArray","sort","a","b","map","_data2$message_set$","channel","_objectSpread","last_message","content","message_set","created","useMessengerChannelSorted","channelList","_a$last_message","_b$last_message","useMessengerChannelMutation","useMutation","postChannel","onSuccess","invalidateQueries","update","putChannel","direct","postDirectChannel","mutateAsync","windowType","useResizeContext","createElement","alignSelf","flexShrink","margin","BottomSheet","CommonButton","_extends","useMessengerMemberList","channel_id","getMessengerMemberList","useMessengerMemberMutation","invite","postBulkMessengerMember","leave","deleteMessengerMember","navigationRef","navigate","name","params","_navigationRef$curren","_navigationRef$curren2","current","Navigation","defaultColorScheme","useDefaultColorScheme","userColorScheme","useColorScheme","colorScheme","NavigationContainer","ref","documentTitle","formatter","options","route","linking","process","versions","LinkingConfiguration","theme","DarkTheme","DefaultTheme","ResizeContextProvider","RootNavigator","l","search","decoded","slice","split","s","replace","join","window","history","replaceState","pathname","hash","location","ignoreWarnings","_console","_","clone","console","warn","message","Object","forEach","value","indexOf","defaultContext","sendJsonMessage","WebSocketContext","createContext","_split","_split2","_slicedToArray","SCHEMA","DOMAIN","WebSocketInternalProvider","_ref","path","Context","useBackground","_useState","useState","_useState2","token","setToken","_useState3","AppState","currentState","_useState4","isActive","setIsActive","_useWebSocket","useWebSocket","shouldReconnect","closeEvent","protocols","onOpen","e","log","onClose","AsyncStorage","getItem","then","onChange","nextState","addEventListener","removeEventListener","Provider","WebSocketProvider","_ref2","disable","Fragment","useContext","ChannelEditModal","member_id","type","lang","useLangContext","useAuthContext","setModal","useModalsContext","channelMutation","messengerMemberMutation","setName","description","setDescription","back","ModalSection","TextField","setValue","multiline","onPress","groupId","_auth$user2","newChannel","owner","group","screen","field","_useAuthContext","dispatch","defaultButtonProps","username","endsWith","GuestLogoutModal","buttonProps","extra","filter","k","TextButton","key","textStyle","color","getNotification","user_id","axios","get","length","postNotification","notification","_context2","post","putNotification","_context3","put","openURL","Platform","OS","url","href","Linking","Styles","footer_buttons","TouchableOpacity","footer_button","AntDesign","size","paddingBottom","paddingRight","login_container","login_header","paddingTop","login_header_logo","resizeMode","login_header_text","login_header_text_bold","fontWeight","login_wrapper","borderTopRightRadius","borderTopLeftRadius","form","form_error","form_error_text","textAlignVertical","form_input","paddingHorizontal","button","button_label","login_social","login_social_separator","login_social_separator_line","login_social_separator_text","login_social_buttons","login_social_button","login_social_icon","login_social_facebook","login_footer_text","guest_footer_text","login_footer_link","link","isMobile","image","Image","source","uri","maxHeight","peerConstraints","iceServers","JSON","parse","sessionConstraints","mandatory","OfferToReceiveAudio","OfferToReceiveVideo","VoiceActivityDetection","mediaConstraints","audio","video","framerate","onICEcandidate","pc","_message","rtcMessage","candidate","RTCIceCandidate","addIceCandidate","sendICEcandidate","event","sendMessage","receiver","target","optimizeSdp","offerDescription","arr","sdp","str","i","test","RTCSessionDescription","createOffer","pcRefCurrent","stream","addStream","t1","setLocalDescription","camStyle","cam","bottonContainer","position","bottom","buttonBar","label","_props$user","_useWebsocketContext","_useLocalCam","pcRef","useRef","sender","setSender","_stream","setStream","isPlay","useMemo","CustomRTCView","useCallback","memo","RTCView","videoProps","start","mode","newStream","mediaDevices","getUserMedia","getDisplayMedia","catch","entries","_ref3","error","getTracks","track","websocketOnMessage","response","peerConnection","_peerConnection","answerDescription","_peerConnection2","channel_name","RTCPeerConnection","setRemoteDescription","useLocalCam","Button","setReceiver","_useRemoteCam","_useState5","_useState6","setUser","_useState7","_useState8","close","clearInterval","statsInterval","_pcRef$current","_pcRef$current2","_pcRef$current3","_pcRef$current4","streams","_peerConnection3","_answerDescription","_streams","_context5","iceConnectionState","activeStream","setInterval","stats","statsOutput","framePerSecond","_context4","getStats","report","kind","keys","statName","framesPerSecond","Date","toTimeString","addTransceiver","direction","getRemoteStreams","createAnswer","localDescription","useRemoteCam","TextInput","onChangeText","VideoView","scale","flexGrow","focusGuest","setFocusGuest","VideoCallContainer","setDisable","videoMode","setVideoMode","guests","setGuests","_useRtcContext","useRtcContext","Math","max","ceil","sqrt","toggleVideoMode","ThemedView","aspectRatio","borderLeftWidth","borderBottomWidth","flexWrap","RemoteCam","LocalCam","Ionicons","RtcProvider","file","showBorder","FontAwesome","filename","floor","pow","toFixed","humanFileSize","filesize","_timerFormat","m","now","year","format","month","day","TimerTag","moment","end","timer","ratio","diff","setExpand","isExpand","overflow","paddingVertical","Avatar","userId","selectable","Hyperlink","linkDefault","wordBreak","linkStyle","timerMessages","getTimerMessageContentList","HTML5_FMT","DATETIME_LOCAL","sorted","_sorted$","ms","min","Number","MAX_VALUE","timeout","setTimeout","clearTimeout","useTimerMessageContentList","setNow","expand","MessengerContentPageItem","_nextPage2","useIsMobile","nextPage","_nextPage","nextContent","index2","date","isSystem","isFirst","isSelf","ownerId","dayChanged","marginLeft","onLongPress","MessageModal","file_set","fileIndex","FilePreview","link_set","linkIndex","LinkPreview","ConfigSection","text","_useLangContext","locale","setLocale","configTheme","useConfigColorScheme","_useFirebaseContext","useFirebaseContext","noti","enable","setNoti","setEnable","n","textDecorationLine","_ref4","_ref5","_ref6","_ref7","setColorScheme","bottomTabs","OneTab","component","userList","useUserMembershipList","memberItem","item","index","MemberItem","member","ProfileModal","ScrollView","icon","MaterialCommunityIcons","TwoTab","today","toISOString","_item$last_message","_item$last_message2","_item$last_message3","_avatarFromChannel","avatarFromChannel","avatar","CommonItem","marginRight","opacity","paddingLeft","member_count","unread_count","FourTab","ConfigSections","SimpleLineIcons","InviteeScreen","_route$params","navigation","enterGuest","setEnterGuest","useLayoutEffect","setOptions","headerRight","user_ids","main","HomeScreen","_route$params2","home","setHome","HeaderRight","tab","StyledText","ContractFooter","TabView","tabs","tabBarPosition","parseInt","onTab","setParams","ChatScreen","_useMessengerChannelL","inputRef","channelAvatar","_useMessengerContentL","useMessengerContentList","fetchNextPage","memberList","_memberList$find","setTimer","autoFocus","setAutoFocus","_useState9","_useState10","bottomTab","setBottomTab","postValue","contentMutation","useMessengerContentMutation","InviteModal","datetime","renderItem","_auth$user3","canGoBack","goBack","focus","minWidth","VideoCallSection","d","FlatList","contentContainerStyle","pages","onScroll","nativeEvent","contentOffset","y","contentSize","onLayout","p","layout","TimerTags","borderBottomRightRadius","top","Entypo","DateTimePickerModal","callback","background","onSubmitEditing","blurOnSubmit","onFocus","borderBottomLeftRadius","resolve","reject","input","document","onchange","files","onabort","onerror","click","f","_auth$user4","disabled","login","LoginScreen","setUsername","password","setPassword","_login","placeholder","autoCapitalize","keyboardType","secureTextEntry","modal","useMobileDetect","useThemeColor","colorName","colorFromProps","otherProps","_objectWithoutProperties","_excluded","light","dark","DefaultText","_excluded2","DefaultView","getUserMembershipList","_React$useState","_React$useState2","setIndex","icons","assign","apply","_defineProperty","renderTabBar","TabBar","indicatorStyle","activeColor","inactiveColor","renderIcon","scene","onTabPress","findIndex","navigationState","routes","onIndexChange","renderScene","SceneMap","_ref8","_ref9","setHover","_React$useState3","_React$useState4","press","setPress","Pressable","onPressIn","onPressOut","onHoverIn","onHoverOut","minHeight","RowField","rowStyle","CommonTextInput","_useInfiniteQuery","useInfiniteQuery","pageParam","getMessengerContentList","select","getNextPageParam","lastPage","refetchOnReconnect","refetchOnWindowFocus","pageParams","page","len","newCurrent","postMessage","_delete","deleteMessengerContent","variables","mutate","delete","LocaleConfig","locales","monthNames","months","monthNamesShort","monthsShort","dayNames","weekdays","dayNamesShort","weekdaysShort","defaultLocale","Calendar","BaseCalendar","markingType","markedDates","renderArrow","monthFormat","initialDate","disableAllTouchEventsForDisabledDays","onMonthChange","onDayPress","setDate","dateString","dayComponent","dayTypes","hours","Array","toString","padStart","minutes","getDisableDays","startDate","startOf","add","endDate","endOf","result","push","DATE","_moment","restMinute","defaultMoment","dayType","setDayType","hour","setHour","minute","setMinute","disableDays","setDisableDays","reduce","c","selected","Picker","selectedValue","onValueChange","Item","contentHeight","setContentHeight","editable","onContentSizeChange","onBlur","onEndEditing","Clipboard","setString","Profile","subowner","patchUser","finally","firebaseConfig","require","messagingSenderId","apiKeyEncrypted","charCodeAt","app","firebase","initializeApp","apiKey","messaging","onMessage","payload","Notification","permission","body","alert","requestToken","serviceWorkerRegistration","currentToken","requestPermission","navigator","serviceWorker","register","scope","getToken","vapidKey","preventDefault","unregister","notiListener","_noti","_noti2","_enable","_noti3","changeEnable","localSearchReducer","initialState","action","keyword","active","Error","InviteItem","selectedRef","has","setSelected","GroupTabView","_useLocalSearch","compare","_useReducer","useReducer","_useReducer2","searchState","useLocalSearch","memberSet","Set","includes","dispatchKeyword","ExternalMembershipTabView","setKeyword","copied","setCopied","timeoutRef","externalMemberList","getExternalMembershipList","useExternalMembershipList","inviteLink","drawerTabs","external","tint","tabIconDefault","tabIconSelected","header","buttonColor","buttonBackgroundColor","buttonBorderColor","DefaultButton","hover","_props","accountURL","defaultOption","baseURL","withCredentials","headers","_axios","interceptors","request","use","config","status","r","defaults","setItem","removeItem","translations","ko","_RNLocalize$findBestL","RNLocalize","languageTag","isRTL","I18nManager","forceRTL","intl","createIntl","messages","createIntlCache","IntlContext","IntlProvider","complete","setComplete","_useContext","formatMessage","defaultMessage","AuthContext","authReducer","AuthProvider","authState","setError","_authState$user","_authState$user$membe","membership_set","g","root_group_id","checkLogin","_data$response","_data$response$data","logout","useInitColorScheme","Appearance","set","useTheme","ModalsContext","ModalsProvider","allModals","modals","setModals","animationType","setAnimationType","visible","Component","newModals","Modal","transparent","guestLogin","checkLoginToken","_await$axios$get","isOffline","code","startsWith","getUserList","group_id","_context6","_context7","patch","ids","updated","_context8","_context9","deleteChannel","id_lt","id_lt_param","results","timer_gt","_context10","formData","_context11","FormData","append","content_id","_context12","values","ROOTPATH","prefixes","screens","Main","NotFound","NotFoundScreen","linkText","DrawerTabView","MessengerTab","colors","onAddList","tabBar","card","borderTopColor","border","pointerEvents","accessibilityRole","borderTopWidth","drawerTab","Tab","elevation","borderRightWidth","Root","createStackNavigator","Navigator","headerMode","screenOptions","cardStyle","animationEnabled","cardStyleInterpolator","CardStyleInterpolators","forVerticalIOS","Screen","MainNavigator","headerShown","gestureDirection","modalValues","DrawerNavigator","headerStyle","headerTitleStyle","headerLeft","canGOBackScreen","headerLeftContainerStyle","forHorizontalIOS","innerHeight","setHeight","Dimensions","QueryClient","App","isLoadingComplete","setLoadingComplete","SplashScreen","Font","font","finish","useCachedResources","isAppearenceComplete","SafeAreaProvider","MobileSafeAreaView","QueryClientProvider","client","StatusBar","getWindowType","ResizeContextContext","detectMobile","_useWindowDimensions","useWindowDimensions","setWindowType","webpackContext","req","webpackContextResolve","__webpack_require__","o","module","exports","normalizeHash","initHash","abs","stringToHSL","toUpperCase"],"mappings":"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","file":"static/js/app.02c51899.chunk.js","sourcesContent":["import * as React from 'react';\r\nimport { View, Text } from './Themed';\r\nimport { StyleSheet, StyleProp, ViewStyle, TextStyle } from 'react-native';\r\nimport Colors from '../constants/Colors';\r\n\r\nexport type SectionParamList = {\r\n    title?: string,\r\n    titleStyle?:StyleProp<TextStyle>\r\n    outerContainerStyle?:StyleProp<TextStyle>\r\n    containerStyle?:StyleProp<ViewStyle>\r\n    bodyStyle?:StyleProp<ViewStyle>\r\n    subtitle?: string\r\n    withSeparator?: boolean\r\n    children?: React.ReactNode\r\n}\r\n\r\nexport default function CommonSection(props:SectionParamList){\r\n  return (\r\n    <View style={[styles.outerContainer, props.outerContainerStyle]}>\r\n        <View style={[styles.container, props.containerStyle]}>\r\n            {props.withSeparator?<View style={styles.separator} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />:undefined}\r\n            {props.title?<View style={styles.titleView}>\r\n              <Text style={[styles.title, props.titleStyle]}>{props.title}</Text>\r\n              <Text style={styles.subtitle}>{props.subtitle}</Text>\r\n            </View>:undefined}\r\n            <View style={[styles.bodyView, props.bodyStyle]}>\r\n            {props.children}\r\n            </View>\r\n          </View>\r\n        </View>\r\n    )\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  outerContainer:{\r\n    width:'100%',\r\n    maxWidth:1080,\r\n    alignItems:'stretch',\r\n    backgroundColor:'transparent'\r\n  },  \r\n  container: {\r\n      marginHorizontal:20,\r\n      marginVertical: 10,\r\n      backgroundColor:'transparent',\r\n    },\r\n    titleView:{\r\n      width: '100%',\r\n      flexDirection:'row',\r\n      backgroundColor:'transparent',\r\n      marginBottom:5,\r\n    },\r\n    title: {\r\n      flex:1,\r\n      fontSize: 16,\r\n    },\r\n    subtitle: {\r\n      flex:1,\r\n      fontSize: 12,\r\n      textAlign: 'right',\r\n      marginTop:4\r\n    },\r\n    separator: {\r\n      marginBottom: 20,\r\n      height: 1,\r\n      width: '100%',\r\n    },\r\n    bodyView:{\r\n      width: '100%',\r\n      padding: 20,\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      borderWidth:1,\r\n      borderColor:Colors.borderColor,\r\n      borderRadius:6\r\n    }\r\n  });\r\n  ","import { useEffect } from \"react\";\r\nimport { useMutation, useQuery, useQueryClient } from \"react-query\";\r\nimport { getMessengerChannelList, postChannel, postDirectChannel, putChannel } from \"../../apis\";\r\nimport { MessengerChannel, MessengerContent } from \"../../types\";\r\nimport { Auth } from \"../useAuthContext\";\r\nimport useWebsocketContext from \"../useWebsocketContext\";\r\n\r\nexport default function useMessengerChannelList(auth?:Auth){\r\n  const queryClient = useQueryClient()\r\n  const {lastJsonMessage} = useWebsocketContext()\r\n  const { data } = useQuery(\"MessengerChannelList\" , async()=>auth?.user?.id?(await getMessengerChannelList(auth.user.id)):[])\r\n\r\n  useEffect(()=>{\r\n    if(lastJsonMessage !=null){\r\n      if(lastJsonMessage['type']=='enter'){\r\n        queryClient.setQueryData<MessengerChannel[]>(\"MessengerChannelList\", (_data)=>{\r\n          return (_data?.find(v=>v.id==lastJsonMessage['data']['id'])?_data:[lastJsonMessage['data'] , ...(_data|| [])]).sort((a, b)=>a.id - b.id)\r\n        })\r\n      }\r\n      if (lastJsonMessage['type']=='next_message'){\r\n        const data:MessengerContent = lastJsonMessage['data']\r\n        queryClient.setQueryData<MessengerChannel[]>(\"MessengerChannelList\", (_data)=>(_data || []).map(v=>{\r\n          if (v.id == data.channel){\r\n            return {...v, last_message:{content:data.message_set[0]?.content, created:data.created}}\r\n          }\r\n          return v\r\n        }))\r\n      }\r\n      // if(lastJsonMessage['type']=='leave'){\r\n      //   queryClient.setQueryData<Channel[]>(\"MessengerChannelList\", (_data)=>_data?.filter(v=>v.id!=lastJsonMessage['data']['channel_id']) || [])\r\n      // }\r\n    }\r\n  }, [lastJsonMessage])\r\n  return data\r\n}\r\n\r\nexport function useMessengerChannelSorted(auth?:Auth){\r\n  const channelList = useMessengerChannelList(auth);\r\n  return channelList?.sort((a, b)=>(a.last_message?.created || '') < (b.last_message?.created || '')?1:-1)\r\n}\r\nexport function useMessengerChannelMutation(){\r\n  const queryClient = useQueryClient()\r\n\r\n  const create = useMutation(postChannel, {\r\n    onSuccess: ()=>queryClient.invalidateQueries(\"MessengerChannelList\")\r\n  });\r\n\r\n  const update = useMutation(putChannel, {\r\n    onSuccess: () => queryClient.invalidateQueries(\"MessengerChannelList\")\r\n  })\r\n\r\n  const direct = useMutation(postDirectChannel, {\r\n    onSuccess: () => queryClient.invalidateQueries(\"MessengerChannelList\")\r\n  })\r\n\r\n  return { create:create.mutateAsync, update:update.mutateAsync, direct:direct.mutateAsync}\r\n}","import React from 'react'\r\nimport CommonSection from \"./CommonSection\";\r\nimport useResizeContext from '../hooks/useResizeContext';\r\n\r\nexport default (props:{children?: React.ReactNode})=>{\r\n    const windowType = useResizeContext();\r\n    return <CommonSection\r\n        outerContainerStyle={{flex:1, alignSelf:'center', backgroundColor:'#8888', maxWidth:undefined, flexShrink:1}}\r\n        containerStyle={{flex:1, margin:0, justifyContent:'center', alignItems:'center'}}\r\n        bodyStyle={windowType=='landscape'?{width:'90%', height:'90%', padding:'5%'}:{width:'100%', height:'100%', maxWidth:1080}}\r\n    >\r\n        {props.children}\r\n    </CommonSection>\r\n}\r\n\r\nexport const BottomSheet = (props:{children?: React.ReactNode})=><CommonSection\r\n    outerContainerStyle={{flex:1, alignSelf:'center', backgroundColor:'#8888', maxWidth:undefined}}\r\n    containerStyle={{flex:1, margin:0, justifyContent:'flex-end'}}\r\n>\r\n    {props.children}\r\n</CommonSection>","import React, { useState } from 'react';\r\nimport { StyleSheet} from 'react-native';\r\nimport { CustomButtonProps } from '../types';\r\nimport CommonButton from './CommonButton';\r\n\r\nexport default (props:CustomButtonProps)=>{\r\n    return <CommonButton {...props} style={[styles.style, props.style]}/>\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n    style:{\r\n        borderRadius:6, \r\n        backgroundColor: 'transparent',\r\n        borderWidth:0\r\n    },\r\n});\r\n","import { useMutation, useQuery, useQueryClient } from \"react-query\";\r\nimport { postBulkMessengerMember, deleteMessengerMember, getMessengerMemberList } from \"../../apis\";\r\n\r\nexport default function useMessengerMemberList(channel_id:number){\r\n  const { data } = useQuery([\"MessengerMemberList\", channel_id] , async()=>await getMessengerMemberList(channel_id))\r\n  return data\r\n}\r\n\r\n\r\nexport function useMessengerMemberMutation(){\r\n  const queryClient = useQueryClient()\r\n  const invite = useMutation(postBulkMessengerMember, {\r\n    onSuccess: ()=>{\r\n      queryClient.invalidateQueries(\"MessengerMemberList\")\r\n    }\r\n  })\r\n\r\n  const leave = useMutation(deleteMessengerMember, {\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries(\"MessengerChannelList\")\r\n      queryClient.invalidateQueries(\"MessengerMemberList\")\r\n    }\r\n  })\r\n  return {invite:invite.mutateAsync, leave:leave.mutateAsync}\r\n}","/**\r\n * If you are not familiar with React Navigation, refer to the \"Fundamentals\" guide:\r\n * https://reactnavigation.org/docs/getting-started\r\n *\r\n */\r\nimport _ from 'lodash';\r\nimport { NavigationContainer, DefaultTheme, DarkTheme, NavigationContainerRef } from '@react-navigation/native';\r\nimport * as React from 'react';\r\n\r\nimport LinkingConfiguration from './LinkingConfiguration';\r\nimport RootNavigator from './RootNavigator';\r\n\r\nimport { useColorScheme as useDefaultColorScheme } from 'react-native';\r\nimport { useColorScheme as useColorScheme } from 'react-native-appearance';\r\nimport { ResizeContextProvider } from '../hooks/useResizeContext';\r\n\r\n\r\nconst navigationRef = React.createRef<NavigationContainerRef>();\r\n\r\nexport function navigate(name:string, params?:any) {\r\n  if (params)\r\n    navigationRef.current?.navigate(name, params);\r\n  navigationRef.current?.navigate(name);\r\n}\r\n\r\nexport default function Navigation() {\r\n  const defaultColorScheme = useDefaultColorScheme()\r\n  const userColorScheme = useColorScheme()\r\n  const colorScheme = userColorScheme =='no-preference'?defaultColorScheme:userColorScheme\r\n  return <NavigationContainer\r\n    ref={navigationRef}\r\n    documentTitle={{formatter: (options, route) => {return `TOKKI TOK`}}}\r\n    linking={(process.versions && process.versions['electron'])?undefined:LinkingConfiguration}\r\n    theme={colorScheme === 'dark' ? DarkTheme : DefaultTheme}>\r\n        <ResizeContextProvider>\r\n          <RootNavigator />\r\n        </ResizeContextProvider>\r\n  </NavigationContainer>\r\n}\r\n\r\n(function(l) {  // for github-page\r\n    if (l !== undefined && l.search[1] === '/' ) {\r\n        var decoded = l.search.slice(1).split('&').map(function(s) { \r\n        return s.replace(/~and~/g, '&')\r\n        }).join('?');\r\n        window.history.replaceState(null, '',\r\n            l.pathname.slice(0, -1) + decoded + l.hash\r\n        );\r\n    }\r\n}(window.location))\r\n    \r\nconst ignoreWarnings = ['ReactNativeFiberHostComponent'];\r\nconst _console = _.clone(console);\r\nconsole.warn = (message: string|Object) => {\r\n    var warn = true;\r\n    if (message instanceof Object)\r\n    warn = false;\r\n    else{\r\n    ignoreWarnings.forEach((value)=>{\r\n        if (message.indexOf && message.indexOf(value) <= -1) {\r\n            warn = false;\r\n        }\r\n    })\r\n    };\r\n    if (warn){\r\n        _console.warn(message);\r\n    }\r\n    else{\r\n        // console.log(message)\r\n    }\r\n};\r\n","import React, { Context, createContext,  useContext, useEffect, useState } from \"react\"\r\nimport useWebSocket from \"react-use-websocket\"\r\nimport { SendJsonMessage } from \"react-use-websocket/dist/lib/types\"\r\n// @ts-ignore\r\nimport {API_URL} from \"@env\"\r\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\r\nimport { AppState, AppStateStatus } from \"react-native\";\r\n\r\ntype WebsocketContextType = {lastJsonMessage:any, sendJsonMessage:SendJsonMessage }\r\nconst defaultContext = {lastJsonMessage:undefined, sendJsonMessage:()=>{}}\r\nconst WebSocketContext = createContext<WebsocketContextType>(defaultContext);\r\nconst [SCHEMA, DOMAIN] = `${API_URL}`.split('://')\r\n\r\nexport const WebSocketInternalProvider = ({children, path, Context, useBackground}:{children:React.ReactNode, path:string, Context:Context<WebsocketContextType>, useBackground?:boolean})=>{\r\n  const [token, setToken] = useState<string|null>(null)\r\n  const [isActive, setIsActive] = useState<boolean>(useBackground || AppState.currentState == 'active')\r\n  const { lastJsonMessage, sendJsonMessage } = useWebSocket(`${SCHEMA=='https'?'wss':'ws'}://${DOMAIN}/${path}`,{\r\n    shouldReconnect: (closeEvent) => true,\r\n    protocols: token?['Authorization',  token]:undefined,\r\n    onOpen: (e)=>{console.log(`success websocket connection(${path})`)},\r\n    onClose: (e)=> {console.log(`closed websocket connection(${path})`)},\r\n  }, isActive && token!=null)\r\n  useEffect(()=>{\r\n    AsyncStorage.getItem('Authorization').then(setToken)\r\n    const onChange = (nextState:AppStateStatus)=>setIsActive(useBackground || nextState == 'active')\r\n    AppState.addEventListener(\"change\", onChange)\r\n    return ()=>AppState.removeEventListener(\"change\", onChange)\r\n  }, [])\r\n  return <Context.Provider value={token!=null?{lastJsonMessage, sendJsonMessage}:defaultContext}>\r\n      {children}\r\n    </Context.Provider>\r\n}\r\n\r\nexport const WebSocketProvider = ({disable, children}:{disable?:boolean, children:React.ReactNode})=>{\r\n  return disable?<>{children}</>:<WebSocketInternalProvider path={'messenger/ws/'} Context={WebSocketContext}>\r\n    {children}\r\n  </WebSocketInternalProvider>\r\n}\r\n\r\nexport default ()=>{\r\n  const webSocketContext = useContext(WebSocketContext)\r\n  return webSocketContext\r\n}\r\n\r\n","import React, {useState, useEffect } from 'react';\r\nimport { StyleSheet } from 'react-native';\r\nimport { View, Text } from '../components/Themed';\r\nimport CommonButton from '../components/CommonButton';\r\n// import useBoardChannelList, { useBoardChannelMutation } from '../hooks/lists/useBoardChannelList';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport { navigate } from '../navigation';\r\nimport { Channel } from '../types';\r\nimport useMessengerChannelList, { useMessengerChannelMutation } from '../hooks/lists/useMessengerChannelList';\r\nimport TextField from '../components/TextField';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport ModalSection from '../components/ModalSection';\r\nimport { useMessengerMemberMutation } from '../hooks/lists/useMessengerMemberList';\r\n\r\nexport default function ChannelEditModal({id, member_id, type}: {id?:number, member_id?:number, type:string}) {\r\n  const { lang } = useLangContext()\r\n  const {auth} = useAuthContext()\r\n  const { setModal } = useModalsContext()\r\n  const channelList = useMessengerChannelList(auth)\r\n  const channelMutation = useMessengerChannelMutation()\r\n  const messengerMemberMutation = useMessengerMemberMutation()\r\n  const channel = channelList?.find(v=>v.id==id)\r\n  const [name, setName] = useState('')\r\n  const [description, setDescription] = useState('')\r\n  const back = ()=>{\r\n    setModal(ChannelEditModal, null)\r\n  }\r\n\r\n  useEffect(()=>{\r\n    if (channel){\r\n      setName(channel.name)\r\n      setDescription(channel?.description || '')\r\n    }\r\n  }, [channel])\r\n  return <ModalSection>\r\n    <View style={{justifyContent:'space-between', flex:1, width:'100%'}}>\r\n      <View style={{width:'100%'}}>\r\n        <Text style={{fontSize:20}}>{id?lang('Chat Setting'):lang('New chat')}</Text>\r\n        <View style={styles.separator} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n        <TextField name={lang('Channel Name')} value={name} setValue={setName} width={'60%'}/>\r\n        <TextField name={lang('Description')} value={description} setValue={setDescription} multiline width={'60%'}/>\r\n      </View>\r\n      <View style={{width:'100%', flexDirection:'row'}}>\r\n        {member_id &&<View style={{flexDirection:'row', justifyContent:'flex-start'}}>\r\n          <CommonButton title={lang('leave')} style={{marginHorizontal:5}} onPress={()=>messengerMemberMutation.leave(member_id).then(back)}/>\r\n        </View>}\r\n        <View style={{flex:1, flexDirection:'row', justifyContent:'flex-end'}}>\r\n          <CommonButton title={lang('save')} onPress={()=>{\r\n            if(auth?.user?.id && auth.groupId){\r\n              const newChannel:Channel = {id, name, description, type, owner:auth?.user?.id, group:auth.groupId};\r\n              (id?channelMutation.update(newChannel):channelMutation.create(newChannel)).then(v=>navigate(\"Main\", {\r\n                screen:v.type == 'messenger'?'ChatScreen':'BoardScreen',\r\n                params:{id:v.id}\r\n              }))\r\n            }\r\n          }}/>\r\n          <CommonButton title={lang('cancel')} style={{marginHorizontal:5}} onPress={back}/>\r\n        </View>\r\n      </View>\r\n    </View>\r\n  </ModalSection>\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  field:{\r\n    width:'50%',\r\n    flexDirection:'row',\r\n    padding:10,\r\n  },\r\n  separator: {\r\n    marginBottom: 20,\r\n    height: 1,\r\n    width: '100%',\r\n  },\r\n})","import React from 'react'\r\nimport TextButton from \"./TextButton\"\r\nimport useAuthContext from \"../hooks/useAuthContext\"\r\nimport useResizeContext from '../hooks/useResizeContext'\r\nimport { View } from 'react-native'\r\nimport useModalsContext from '../hooks/useModalsContext'\r\nimport GuestLogoutModal from '../modals/GuestLogoutModal'\r\nimport useLangContext from '../hooks/useLangContext'\r\n\r\ntype ButtonProps = {title:string, onPress:()=>void, windowType?:'landscape'|'portrait'}\r\n\r\nexport default (props:{extra?:ButtonProps[]})=>{\r\n    const { lang } = useLangContext()\r\n    const {auth, dispatch} = useAuthContext()\r\n    const { setModal } = useModalsContext()\r\n    const windowType = useResizeContext()\r\n    const defaultButtonProps:ButtonProps[] = [{title:lang('sign out'), onPress:()=>{\r\n        if (auth?.user?.username.endsWith(\".guest\")){\r\n            setModal(GuestLogoutModal, {})\r\n        }\r\n        else{\r\n            dispatch({type:\"LOGOUT_REQUEST\"})\r\n        }\r\n    }}]\r\n    const buttonProps = (props.extra?[...props.extra, ...defaultButtonProps]:defaultButtonProps).filter(v=>v.windowType==windowType || v.windowType == undefined)\r\n    return<View style={{flexDirection:'row'}}>\r\n        {buttonProps.map((v,k)=><TextButton key={k} {...v} textStyle={{color:'white'}} color='#gray'/>)}\r\n    </View>\r\n}\r\n  ","import { Notification } from '../types';\r\nimport axios from './axios';\r\n\r\nexport const getNotification = async (user_id:number)=>{\r\n    const data = (await axios.get(`/api/v1/notifications/?type=WEB&user=${user_id}`) ).data as Notification[]\r\n    return data.length?data[0]:undefined\r\n}\r\n\r\nexport const postNotification = async(notification:Notification)=>{\r\n    return (await axios.post(`/api/v1/notifications/`, notification)).data as Notification\r\n}\r\n\r\nexport const putNotification = async(notification:Notification)=>{\r\n    return (await axios.put(`/api/v1/notifications/${notification.id}/`, notification)).data as Notification\r\n}","import React from 'react'\r\nimport { View, StyleSheet, Linking, Platform } from 'react-native'\r\nimport { TouchableOpacity } from 'react-native-gesture-handler'\r\nimport { AntDesign } from '@expo/vector-icons'; \r\nimport useColorScheme from '../hooks/useColorScheme';\r\n\r\nconst openURL = Platform.OS=='web'?(url:string)=>{location.href=url}:Linking.openURL\r\n\r\nexport default ()=>{\r\n    const theme = useColorScheme()\r\n    return<View style={Styles.footer_buttons}>\r\n        <TouchableOpacity style={Styles.footer_button} onPress={()=>openURL(\"https://github.com/blacktokki/tokki-tok\")}>\r\n            <AntDesign name=\"github\" size={24} color={theme=='light'?'black':'white'} />\r\n        </TouchableOpacity>\r\n        <TouchableOpacity style={Styles.footer_button} onPress={()=>Linking.openURL(\"mailto:ydh051541@naver.com\")}>\r\n            <AntDesign name=\"mail\" size={24} color={theme=='light'?'black':'white'} />\r\n        </TouchableOpacity>\r\n    </View>\r\n}\r\n\r\nconst Styles = StyleSheet.create({\r\n      footer_buttons: {\r\n        width: '100%',\r\n        flexDirection: 'row',\r\n        justifyContent: 'flex-end',\r\n        paddingBottom: 20,\r\n        paddingRight: 20,\r\n      },\r\n      footer_button: {\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        width: 38,\r\n        height: 38,\r\n        marginHorizontal: 12,\r\n        borderWidth: 1,\r\n        borderColor: '#E7E7E7',\r\n        borderRadius: 60,\r\n      },\r\n})","import React, {useLayoutEffect, useState} from 'react';\r\nimport {\r\n  Text,\r\n  TextInput,\r\n  TouchableOpacity,\r\n  View,\r\n  StyleSheet,\r\n} from 'react-native';\r\nimport { StackScreenProps } from '@react-navigation/stack';\r\nimport useAuthContext from '../../hooks/useAuthContext';\r\nimport useLangContext from '../../hooks/useLangContext';\r\nimport ContractFooter from '../../components/ContractFooter';\r\n\r\nexport default function LoginScreen({\r\n  navigation, route\r\n}: StackScreenProps<any, 'Login'>) {\r\n  const { lang } = useLangContext()\r\n  const [username, setUsername] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const {error, dispatch} = useAuthContext()\r\n  const _login = ()=>dispatch({type:'LOGIN_REQUEST', username, password})\r\n  useLayoutEffect(() => {\r\n    navigation.setOptions({\r\n      headerRight: undefined\r\n    });\r\n  }, [navigation, route]);\r\n\r\n  return (<View style={Styles.login_container}>\r\n    <View style={Styles.login_wrapper}>\r\n      <View style={Styles.form}>\r\n        {error && <View style={Styles.form_error}>\r\n          <Text style={Styles.form_error_text}>{lang(error)}</Text>\r\n        </View>}\r\n        <TextInput\r\n          style={Styles.form_input}\r\n          value={username}\r\n          placeholder={lang('Username')}\r\n          onChangeText={(text) => setUsername(text)}\r\n          autoCapitalize={'none'}\r\n          keyboardType={'email-address'}\r\n          onSubmitEditing={_login}\r\n        />\r\n        <TextInput\r\n          style={Styles.form_input}\r\n          value={password}\r\n          placeholder={lang('Password')}\r\n          secureTextEntry\r\n          onChangeText={(text) => setPassword(text)}\r\n          onSubmitEditing={_login}\r\n        />\r\n        <TouchableOpacity onPress={_login}>\r\n          <View style={Styles.button}>\r\n            <Text style={Styles.button_label}>{lang('Sign in')}</Text>\r\n          </View>\r\n        </TouchableOpacity>\r\n        <TouchableOpacity onPress={() => dispatch({type:\"LOGIN_GUEST\"})}>\r\n          <Text style={Styles.guest_footer_text}>\r\n            {lang(\"Sign in as guest\")}\r\n          </Text>\r\n        </TouchableOpacity>\r\n      </View>\r\n      <View style={Styles.login_social}>\r\n        <View style={Styles.login_social_separator}>\r\n          <View style={Styles.login_social_separator_line} />\r\n          <Text style={Styles.login_social_separator_text}>{'*'}</Text>\r\n          <View style={Styles.login_social_separator_line} />\r\n        </View>\r\n        <View style={Styles.login_social_buttons}>\r\n        </View>\r\n      </View>\r\n      {/* <>\r\n        <TouchableOpacity onPress={() => navigate(\"RegistrationScreen\")}>\r\n          <Text style={Styles.login_footer_text}>\r\n            {\"Don't have an account? \"}\r\n            <Text style={Styles.login_footer_link}>{'Sign up'}</Text>\r\n          </Text>\r\n        </TouchableOpacity>\r\n      </> */}\r\n    </View>\r\n    <ContractFooter/>\r\n  </View>);\r\n};\r\n\r\nconst Styles = StyleSheet.create({\r\n    login_container: {\r\n      flex: 1,\r\n      backgroundColor: '#FFF',\r\n    },\r\n    login_header: {\r\n      alignItems: 'center',\r\n      paddingTop: 30,\r\n      paddingBottom: 50,\r\n      backgroundColor: '#208AEC',\r\n    },\r\n    login_header_logo: {\r\n      width: 220,\r\n      resizeMode: 'contain',\r\n    },\r\n    login_header_text: {\r\n      marginTop: 15,\r\n      color: '#f0f0f0',\r\n      fontSize: 16,\r\n    },\r\n    login_header_text_bold: {\r\n      color: '#fff',\r\n      fontWeight: 'bold',\r\n    },\r\n    login_wrapper: {\r\n      flex: 1,\r\n      justifyContent: 'space-between',\r\n      paddingTop: 40,\r\n      borderTopRightRadius: 12,\r\n      borderTopLeftRadius: 12,\r\n      backgroundColor: '#fff',\r\n      alignItems: 'center',\r\n    },\r\n    form: {\r\n      width: '100%',\r\n      maxWidth: 320,\r\n    },\r\n    form_error: {\r\n      height: 22,\r\n      width:'100%',\r\n    },\r\n    form_error_text:{\r\n      textAlignVertical:'center',\r\n      color:'red',\r\n      fontSize:13,\r\n    },\r\n    form_input: {\r\n      height: 44,\r\n      paddingHorizontal: 20,\r\n      marginBottom: 20,\r\n      backgroundColor: '#EDF0F7',\r\n      borderRadius: 50,\r\n    },\r\n    button: {\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      height: 44,\r\n      backgroundColor: '#0065A4',\r\n      borderRadius: 50,\r\n    },\r\n    button_label: {\r\n      color: '#fff',\r\n      fontSize: 16,\r\n    },\r\n    login_social: {\r\n      width: '100%',\r\n      maxWidth: 280,\r\n      marginTop: 20,\r\n    },\r\n    login_social_separator: {\r\n      flexDirection: 'row',\r\n      alignItems: 'center',\r\n    },\r\n    login_social_separator_line: {\r\n      flex: 1,\r\n      width: '100%',\r\n      height: 1,\r\n      backgroundColor: '#E0E0E0',\r\n    },\r\n    login_social_separator_text: {\r\n      marginHorizontal: 10,\r\n      color: '#808080',\r\n      fontSize: 16,\r\n    },\r\n    login_social_buttons: {\r\n      flexDirection: 'row',\r\n      justifyContent: 'center',\r\n      marginTop: 20,\r\n    },\r\n    login_social_button: {\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      width: 60,\r\n      height: 60,\r\n      marginHorizontal: 12,\r\n      borderWidth: 1,\r\n      borderColor: '#E7E7E7',\r\n      borderRadius: 60,\r\n    },\r\n    login_social_icon: {\r\n      width: 38,\r\n      height: 38,\r\n      resizeMode: 'contain',\r\n    },\r\n    login_social_facebook: {\r\n      backgroundColor: '#4267B2',\r\n      borderColor: '#4267B2',\r\n    },\r\n    login_footer_text: {\r\n      flexDirection: 'row',\r\n      alignItems: 'center',\r\n      color: '#808080',\r\n      fontSize: 14,\r\n    },\r\n    guest_footer_text: {\r\n      flexDirection: 'row',\r\n      alignSelf: 'center',\r\n      color: '#808080',\r\n      fontSize: 15,\r\n      margin: 15\r\n    },\r\n    login_footer_link: {\r\n      color: '#208AEC',\r\n      fontSize: 15,\r\n      fontWeight: 'bold',\r\n    },\r\n  });\r\n  ","import React from 'react'\r\nimport { TouchableOpacity } from \"react-native-gesture-handler\"\r\nimport CommonSection from \"./CommonSection\"\r\nimport { Image, Linking, TextStyle } from \"react-native\"\r\nimport { View, Text } from \"./Themed\"\r\nimport { Link } from \"../types\"\r\n\r\n\r\n\r\nexport default ({link, isMobile}:{link:Link, isMobile:boolean})=>{\r\n    return <CommonSection containerStyle={{marginHorizontal:0}} bodyStyle={{padding:0}}>\r\n    <TouchableOpacity onPress={()=>Linking.openURL(link.url)} style={{flexDirection:'row'}} containerStyle={{width:'100%'}}>\r\n        {link.image && <Image source={{uri:link.image}} resizeMode=\"cover\" style={{ width:'100%', maxWidth:isMobile?120:150, maxHeight:isMobile?120:150, borderWidth:1}}/>}\r\n        <View style={{flex:1, marginHorizontal:20}}>\r\n        <Text style={{fontSize:18}}>{link.title}</Text>\r\n        <Text style={{fontSize:14}}>{link.description}</Text>\r\n        <Text style={{fontSize:12}}>{link.url}</Text>\r\n        </View>\r\n    </TouchableOpacity>\r\n    </CommonSection>\r\n}","import React, { createContext, useContext } from \"react\"\r\nimport { SendJsonMessage } from \"react-use-websocket/dist/lib/types\";\r\nimport { WebSocketInternalProvider } from \"../../hooks/useWebsocketContext\";\r\n\r\nconst WebSocketContext = createContext<{lastJsonMessage:any, sendJsonMessage:SendJsonMessage }>({lastJsonMessage:undefined, sendJsonMessage:()=>{}});\r\n\r\nexport const WebSocketProvider = ({disable, children}:{disable?:boolean, children:React.ReactNode})=>{\r\n  return disable?<></>:<WebSocketInternalProvider path={'messenger/ws/rtc/'} Context={WebSocketContext} useBackground>\r\n    {children}\r\n  </WebSocketInternalProvider>\r\n}\r\n\r\nexport default ()=>{\r\n  const webSocketContext = useContext(WebSocketContext)\r\n  return webSocketContext\r\n}\r\n\r\n","import React, { useCallback, useRef, useState, useMemo } from \"react\";\r\n//@ts-ignore\r\nimport { RTCView, mediaDevices, RTCPeerConnection, MediaStream, RTCSessionDescription, RTCIceCandidate } from \"react-native-webrtc-web-shim\";\r\n// @ts-ignore\r\nimport {TURN_SERVER} from \"@env\"\r\n\r\n\r\nconsole.log(TURN_SERVER?\"use turn server\": \"use stun server\")\r\n\r\nexport const peerConstraints = {\r\n\ticeServers: [TURN_SERVER?JSON.parse(TURN_SERVER):{urls: 'stun:stun.l.google.com:19302'}]\r\n};\r\n\r\nexport const sessionConstraints = {\r\n\tmandatory: {\r\n\t\tOfferToReceiveAudio: true,\r\n\t\tOfferToReceiveVideo: true,\r\n\t\tVoiceActivityDetection: true\r\n\t}\r\n};\r\n\r\nconst mediaConstraints = {audio:true, video:{framerate:30}}\r\n\r\n//@ts-ignore\r\nexport {MediaStream, RTCPeerConnection, RTCSessionDescription} from \"react-native-webrtc-web-shim\";\r\n\r\nconst onICEcandidate = (pc:typeof RTCPeerConnection, message:any)=>{\r\n\tconst _message = message.data.rtcMessage\r\n\t\tconst candidate = new RTCIceCandidate(_message);\r\n\t\tif (pc) {\r\n\t\t\tconsole.log(\"ICE candidate Added\");\r\n\t\t\tpc.addIceCandidate(candidate);\r\n\t\t}\r\n}\r\n\r\nconst sendICEcandidate = (event:any, sendMessage:(data:any)=>void, receiver:string, target:string) => {\r\n\t// When you find a null candidate then there are no more candidates.\r\n\t// Gathering of candidates has finished.\r\n\tif ( !event.candidate ) { return; };\r\n\t// Send the event.candidate onto the person you're calling.\r\n\t// Keeping to Trickle ICE Standards, you should send the candidates immediately.\r\n\tsendMessage({type:'ICEcandidate', receiver, data:{target, rtcMessage:event.candidate}})\r\n  }\r\n\r\nconst BAND_WIDTH = 8000\r\n\r\nconst optimizeSdp = (offerDescription:RTCSessionDescription)=>{\r\n\tvar arr = offerDescription.sdp.split('\\r\\n');\r\n\tarr.forEach((str:string, i:number) => {\r\n\t\tif (/^a=fmtp:\\d*/.test(str)) {\r\n\t\t\tarr[i] = str + `;x-google-max-bitrate=${BAND_WIDTH};x-google-min-bitrate=${BAND_WIDTH};x-google-start-bitrate=${BAND_WIDTH}`;\r\n\t\t} else if (/^a=mid:(0|video)/.test(str)) { // if with audio then 0=>1\r\n\t\t\tarr[i] += `\\r\\nb=AS:${BAND_WIDTH}`;\r\n\t\t}\r\n\t});\r\n  \treturn new RTCSessionDescription({\r\n    \ttype: offerDescription.type,\r\n    \tsdp: arr.join('\\r\\n'),\r\n  \t})\r\n}\r\n\r\nconst createOffer = async(pcRefCurrent:{pc?:typeof RTCPeerConnection, receiver:string}, sendMessage:(data:any)=>void, stream:typeof MediaStream, target:string, user?:{name:string})=>{\r\n\tstream && pcRefCurrent.pc.addStream( stream );\r\n\tconst offerDescription = optimizeSdp((await pcRefCurrent.pc.createOffer( sessionConstraints )));\r\n\tawait pcRefCurrent.pc.setLocalDescription( offerDescription );\r\n\tsendMessage({type:'call', receiver:pcRefCurrent.receiver, data:{target, name:user?.name, rtcMessage:offerDescription}})\r\n}\r\n\r\nexport const useLocalCam = (sendMessage:(data:any)=>void)=>{\r\n\tconst pcRef = useRef<Record<number,{pc:typeof RTCPeerConnection, receiver:string}>>({})\r\n\tconst [sender, setSender] = useState<string>()\r\n\tconst [_stream, setStream] = useState<MediaStream>()\r\n\tconst isPlay = useMemo(()=>_stream?true:false, [_stream])\r\n\tconst CustomRTCView = useCallback(React.memo(({style}:{style:any})=>(_stream?<RTCView stream={_stream} style={style} videoProps={{height:'100%'}} />:<></>)) , [_stream])\r\n\tconst start = useCallback(async(user:{name:string}, stream?:typeof MediaStream, mode?:'camera'|'display')=>{\r\n\t\tconsole.log(\"start\");\r\n\t\tif (!_stream || mode!==undefined) {\r\n\t\t\ttry {\r\n\t\t\t\tlet newStream:typeof MediaStream;\r\n\t\t\t\tif(mode == 'camera'){\r\n\t\t\t\t\tnewStream = await mediaDevices.getUserMedia(mediaConstraints)\r\n\t\t\t\t}\r\n\t\t\t\telse if (mode == 'display'){\r\n\t\t\t\t\tnewStream = await mediaDevices.getDisplayMedia(mediaConstraints)\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tnewStream = stream || await mediaDevices.getUserMedia(mediaConstraints).catch((e:any)=>mediaDevices.getDisplayMedia(mediaConstraints));\r\n\t\t\t\t}\r\n\t\t\t\tsetStream(newStream)\r\n\t\t\t\tObject.entries(pcRef.current).map(([k, v])=>{\r\n\t\t\t\t\tcreateOffer(v, sendMessage, newStream, 'guest', user)\r\n\t\t\t\t})\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.error(e);\r\n\t\t\t}\r\n\t\t}\r\n\t}, [_stream])\r\n\tconst stop = useCallback(()=>{\r\n\t\tconsole.log(\"stop\");\r\n\t\tif(_stream){\r\n\t\t\t_stream.getTracks().map((track:any) => track.stop());\r\n\t\t\tsetStream(undefined)\r\n\t\t}\r\n\t}, [_stream])\r\n\treturn {\r\n\t\tstart,\r\n\t\tstop,\r\n\t\twebsocketOnMessage: async(response:any, user:{name:string})=>{\r\n\t\t\tlet type = response.type;\r\n\t\t\tif (type == 'connection'){\r\n\t\t\t\tsetSender(response.data.channel_name)\r\n\t\t\t}\r\n\t\t\tif (type == 'start' && response.data.target=='host'){\r\n\t\t\t  console.log('1 start')\r\n\t\t\t  const peerConnection = new RTCPeerConnection( peerConstraints );\r\n\t\t\t  peerConnection.addEventListener( 'icecandidate', (event:any) => sendICEcandidate(event, sendMessage, response.sender, 'guest'));\r\n\t\t\t  pcRef.current[response.sender] = {pc:peerConnection, receiver: response.sender}\r\n\t\t\t  createOffer(pcRef.current[response.sender], sendMessage, _stream, 'guest', user)\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (type == \"answer\" && response.data.target == 'host'){\r\n\t\t\t  console.log('3 answer')\r\n\t\t\t  const peerConnection = pcRef.current[response.sender].pc\r\n\t\t\t  const answerDescription = new RTCSessionDescription(response.data.rtcMessage);\r\n\t\t\t  await peerConnection.setRemoteDescription( answerDescription );\r\n\t\t\t  // const streams = pcRef.current.pc.getRemoteStreams()\r\n\t\t\t  // setMirrorStream(streams[streams.length - 1])\r\n\t\t\t}\r\n\t\t\tif (type == \"ICEcandidate\" && response.data.target=='host'){\r\n\t\t\t\tconst peerConnection = pcRef.current[response.sender].pc\r\n\t\t\t\tonICEcandidate(peerConnection, response)\r\n\t\t\t}\r\n\t\t},\r\n\t\tCustomRTCView,\r\n\t\tisPlay,\r\n\t\tsender,\r\n\t\t// renderMirrorView,\r\n\t}\r\n}\r\n\r\nexport const useRemoteCam = (sendMessage:(data:any)=>void)=>{\r\n\tconst pcRef = useRef<{pc?:RTCPeerConnection, receiver?:string, statsInterval?:any}>({})\r\n\tconst [user, setUser] = useState<{name:string}>()\r\n\tconst [_stream, setStream] = useState<MediaStream>()\r\n\tconst CustomRTCView = useCallback(React.memo((style:any)=>_stream?<RTCView stream={_stream} style={style} videoProps={{height:'100%'}} />:<></>), [_stream])\r\n\tconst isPlay = useMemo(()=>_stream?true:false, [_stream])\r\n\tconst start = useCallback((receiver:string)=>{\r\n\t\tconsole.log(\"start\");\r\n\t\tif (!pcRef.current.pc) {\r\n\t\t  pcRef.current.pc = new RTCPeerConnection( peerConstraints );\r\n\t\t  pcRef.current.receiver = receiver\r\n\t\t}\r\n\t\tif (!_stream){\r\n\t\t\tsendMessage({type:'start', receiver, data:{'target': 'host'}})\r\n\t\t}\r\n\t}, [_stream])\r\n\tconst stop = () => {\r\n\t\tconsole.log(\"stop\");\r\n\t\tif (pcRef.current.pc) {\r\n\t\t  // peerConnection._unregisterEvents();\r\n\t\t  setStream(undefined)\r\n\t\t  pcRef.current.pc.close();\r\n\t\t  pcRef.current.pc = undefined\r\n\t\t  pcRef.current.receiver = undefined\r\n\t\t  clearInterval(pcRef.current.statsInterval)\r\n\t\t}\r\n\t}\r\n\treturn {\r\n\t\tstart,\r\n\t\tstop,\r\n\t\twebsocketOnMessage: async(response:any)=>{\r\n\t\t\tlet type = response.type;\r\n\t\t\tif (type == 'start' && response.data.target=='guest' && response.sender == pcRef.current?.receiver){\r\n\t\t\t\tconsole.log('(remote)1 start')\r\n\t\t\t\tconst peerConnection = pcRef.current.pc\r\n\t\t\t\tsetUser({name: response.data.name})\r\n\t\t\t\tpeerConnection.addEventListener('icecandidate', (event:any) => sendICEcandidate(event, sendMessage, response.sender, 'host'));\r\n\t\t\t\tpeerConnection.addEventListener('iceconnectionstatechange', (e:any)=>{\r\n\t\t\t\t\tif (pcRef.current.pc.iceConnectionState == 'connected'){\r\n\t\t\t\t\t\tlet activeStream = false\r\n\t\t\t\t\t\tpcRef.current.statsInterval = setInterval(async()=>{\r\n\t\t\t\t\t\t\tconst stats = await pcRef.current.pc.getStats(null)\r\n\t\t\t\t\t\t\tlet statsOutput = \"\";\r\n\t\t\t\t\t\t\tlet framePerSecond = undefined\r\n\t\t\t\t\t\t\tstats.forEach((report:any) => {\r\n\t\t\t\t\t\t\t\tif (report.type === \"inbound-rtp\" && report.kind === \"video\") {\r\n\t\t\t\t\t\t\t\t\tObject.keys(report).forEach((statName) => {\r\n\t\t\t\t\t\t\t\t\t\tstatsOutput += `${statName}: ${report[statName]}\\n`;\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\tframePerSecond = report.framesPerSecond\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tconsole.log(activeStream, framePerSecond)\r\n\t\t\t\t\t\t\tif (framePerSecond != undefined){\r\n\t\t\t\t\t\t\t\tactiveStream = true\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (activeStream){\r\n\t\t\t\t\t\t\t\tstop()\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tconsole.log(new Date().toTimeString().split(' ')[0], statsOutput)\r\n\t\t\t\t\t\t}, 1000);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (pcRef.current.pc.iceConnectionState == 'failed'){\r\n\t\t\t\t\t\tstop()\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t// peerConnection.addTransceiver('audio', {\r\n\t\t\t\t// \tdirection: 'recvonly'\r\n\t\t\t\t// });\r\n\t\t\t\tpeerConnection.addTransceiver('video', {\r\n\t\t\t\t\tdirection: 'recvonly'\r\n\t\t\t\t});\r\n\t\t\t\tawait createOffer({pc:pcRef.current.pc, receiver:response.sender}, sendMessage, _stream, 'host', user)\r\n\t\t\t}  \r\n\t\t\tif (type == \"answer\" && response.data.target=='guest' && response.sender == pcRef.current?.receiver){\r\n\t\t\t\tconsole.log('(remote)3 answer')\r\n\t\t\t\tconst answerDescription = new RTCSessionDescription(response.data.rtcMessage);\r\n\t\t\t\tawait pcRef.current.pc.setRemoteDescription( answerDescription );\r\n\t\t\t\tconst streams = pcRef.current.pc.getRemoteStreams()\r\n\t\t\t\tsetStream(streams[streams.length - 1])\r\n\t\t\t\tsendMessage({type:'end', receiver:pcRef.current.receiver, data:{}})\r\n\t\t\t}\r\n\t\t\tif (type == \"call\" && response.sender == pcRef.current?.receiver){\r\n\t\t\t  console.log('2 call')\r\n\t\t\t  const peerConnection = pcRef.current.pc\r\n\t\t\t  setUser({name:response.data.name})\r\n\t\t\t  if (!peerConnection)\r\n\t\t\t\treturn\r\n\t\t\t  peerConnection.addEventListener( 'icecandidate', (event:any) => sendICEcandidate(event, sendMessage, response.sender, 'host'));\r\n\t\t\t  const offerDescription = new RTCSessionDescription(response.data.rtcMessage);\r\n\t\t\t  await peerConnection.setRemoteDescription( offerDescription );\r\n\t\t\t  const answerDescription = await peerConnection.createAnswer( sessionConstraints );\r\n\t\t\t  await peerConnection.setLocalDescription( answerDescription );\r\n\t\t\t  sendMessage({type:'answer', receiver:pcRef.current.receiver, data:{target:'host', rtcMessage:peerConnection.localDescription}})\r\n\t\t\t  // Here is a good place to process candidates.\r\n\t\t\t  const streams = pcRef.current.pc.getRemoteStreams()\r\n\t\t\t  setStream(streams[streams.length - 1])\r\n\t\t\t}\r\n\t\t\tif (type == \"ICEcandidate\" && response.data.target=='guest' && response.sender == pcRef.current?.receiver)\r\n\t\t\t  onICEcandidate(pcRef.current.pc, response)\r\n\t\t},\r\n\t\tCustomRTCView,\r\n\t\tuser,\r\n\t\tisPlay\r\n\t}\r\n}","import {StyleSheet} from \"react-native\";\r\nexport {useLocalCam, useRemoteCam} from \"./p2p\"\r\n\r\nexport const camStyle = StyleSheet.create({\r\n\tcontainer:{ flex: 1},\r\n\tcam:{ flex: 1, height:'100%'},\r\n\tbottonContainer: {position:\"absolute\", bottom:0, justifyContent:'flex-end'},\r\n\tbuttonBar: { flexDirection: \"row\", justifyContent: \"space-around\" },\r\n\tlabel: {backgroundColor:'#0008', color:'white', paddingHorizontal:5},\r\n})","import React, { useEffect } from \"react\";\r\nimport {Button, View, Text} from \"react-native\";\r\nimport useWebsocketContext from \"./useWebsocketContext\";\r\nimport { useLocalCam, camStyle} from \"./webrtc\";\r\n\r\n\r\nexport default (props:{user?:{name:string}|null, mode?:'camera'|'display'|null})=>{\r\n  const {lastJsonMessage, sendJsonMessage} = useWebsocketContext()\r\n  const {start, stop, websocketOnMessage, CustomRTCView, isPlay} = useLocalCam(sendJsonMessage)\r\n  useEffect(()=>{\r\n    props.user && lastJsonMessage && websocketOnMessage(lastJsonMessage, props.user)\r\n  }, [lastJsonMessage, props.user])\r\n  useEffect(()=>{\r\n    if(props.mode && !isPlay){\r\n      props.user && start(props.user, undefined, props.mode)\r\n    }\r\n    else if(props.mode===null && isPlay){\r\n      stop()\r\n    }\r\n    return ()=>{isPlay && stop()}\r\n  }, [isPlay, props.user, props.mode])\r\n  return (\r\n    <View style={camStyle.container}>\r\n      <CustomRTCView style={camStyle.cam}/>\r\n      <View style={camStyle.bottonContainer}>\r\n        <View style={camStyle.buttonBar}>  \r\n        </View>\r\n        <View style={{flexDirection:'row'}}><Text style={camStyle.label}>{props.user?.name}</Text></View>\r\n        <View style={camStyle.buttonBar}>\r\n          {props.mode === undefined && !isPlay && <Button title=\"Start\" onPress={()=>props.user && start(props.user)} />}\r\n          {props.mode === undefined && isPlay && <Button title=\"Stop\" onPress={stop} />}\r\n        </View>\r\n      </View>\r\n    </View>\r\n  );\r\n}\r\n","import React, { useState, useEffect, } from \"react\";\r\nimport {Button,Text, TextInput, View} from \"react-native\";\r\nimport useWebsocketContext from \"./useWebsocketContext\";\r\nimport { useRemoteCam, camStyle} from \"./webrtc\";\r\n\r\nexport default (props:{receiver?:string})=>{\r\n  const [receiver, setReceiver] = useState('')\r\n  const {lastJsonMessage, sendJsonMessage} = useWebsocketContext()\r\n  const {start, stop, websocketOnMessage, CustomRTCView, isPlay, user} = useRemoteCam(sendJsonMessage)\r\n  useEffect(()=>{\r\n    lastJsonMessage && websocketOnMessage(lastJsonMessage)\r\n  }, [lastJsonMessage])\r\n  useEffect(()=>{\r\n    if(props.receiver){\r\n      start(props.receiver)\r\n    }\r\n    return ()=>stop()\r\n  }, [props.receiver])\r\n  return (\r\n    <View style={camStyle.container}>\r\n      <CustomRTCView style={camStyle.cam}/>\r\n      <View style={camStyle.bottonContainer}>\r\n        <View style={camStyle.buttonBar}>\r\n        </View>\r\n        <View style={{flexDirection:'row'}}>{\r\n          (props.receiver || isPlay)?\r\n          <Text style={camStyle.label}>{user?.name || 'loading...'}</Text>:\r\n          <>\r\n            <Text style={{borderWidth:1}}>Receiver:&nbsp;</Text>\r\n            <TextInput style={{borderWidth:1, flex:1}} value={receiver} onChangeText={setReceiver}/>\r\n          </> \r\n        }</View>\r\n        <View style={camStyle.buttonBar}>\r\n          {props.receiver === undefined && !isPlay && <Button title=\"Start\" onPress={()=>start(receiver)} />}\r\n          {props.receiver === undefined && isPlay && <Button title=\"Stop\" onPress={stop} />}\r\n        </View>\r\n      </View>\r\n    </View>\r\n  );\r\n}\r\n\r\n","import React, {useEffect, useState} from 'react';\r\nimport { StyleSheet, View } from 'react-native';\r\nimport { View as ThemedView } from '../../../components/Themed' \r\nimport Colors from '../../../constants/Colors';\r\nimport {default as useRtcContext, WebSocketProvider as RtcProvider} from \"../../../lib/react-native-webrtc/useWebsocketContext\";\r\nimport LocalCam from '../../../lib/react-native-webrtc/LocalCam';\r\nimport RemoteCam from '../../../lib/react-native-webrtc/RemoteCam';\r\nimport useResizeContext from '../../../hooks/useResizeContext';\r\nimport useAuthContext from '../../../hooks/useAuthContext';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport CommonButton from '../../../components/CommonButton';\r\nimport { Ionicons } from '@expo/vector-icons';\r\n\r\ntype VideoType = 'camera'|'display'|null\r\ntype VideoCallProps = {channel_id:number, setDisable:(disable:boolean)=>void, disable?:boolean}\r\n\r\n\r\nconst VideoView = (props:{\r\n  scale:string,\r\n  focusGuest?:string,\r\n  setFocusGuest:(focusGuest?:string)=>void\r\n  receiver?:string\r\n  children:React.ReactNode\r\n})=>{\r\n  return <View style={[{maxWidth:props.scale, maxHeight:props.scale, borderWidth:1, borderColor:Colors.borderColor, backgroundColor:'gray', flexDirection:'row', flexGrow:1}, (props.focusGuest == undefined || props.focusGuest == props.receiver)?{height:'100%'}:{maxWidth:0, height:0}]}>\r\n    <TouchableOpacity style={{flex:1}} containerStyle={{flex:1, justifyContent:'center'}} onPress={()=>props.setFocusGuest(props.focusGuest?undefined:props.receiver)}>\r\n    {props.children}\r\n    </TouchableOpacity>\r\n  </View>\r\n    \r\n  \r\n}\r\n\r\nconst VideoCallContainer = ({channel_id, disable, setDisable}:VideoCallProps)=>{\r\n  const {auth} = useAuthContext()\r\n  const [videoMode, setVideoMode] = useState<VideoType>(null)\r\n  const [guests, setGuests] = useState<string[]>([])\r\n  const [focusGuest, setFocusGuest] = useState<string>()\r\n  const windowType = useResizeContext()\r\n  const { lastJsonMessage, sendJsonMessage } = useRtcContext()\r\n  useEffect(()=>{\r\n    if(lastJsonMessage !=null){\r\n      if(lastJsonMessage['type']=='connection'){\r\n        sendJsonMessage({'type':'broadcast', 'data':{'channel_id':channel_id}})\r\n      }\r\n      if(lastJsonMessage['type']=='broadcast_guest' || lastJsonMessage['type']=='broadcast_host'){\r\n        setGuests([...guests, lastJsonMessage['sender']])\r\n      }\r\n      if(lastJsonMessage['type']=='broadcast_disconnect'){\r\n        const channel_name = lastJsonMessage['sender']\r\n        const exist = guests.find(v=>v == channel_name)\r\n        exist && setGuests(guests.filter(v=>v != channel_name))\r\n      }\r\n    }\r\n  }, [lastJsonMessage])\r\n  const scale = focusGuest?'100%':`${100 / Math.max(2, Math.ceil(Math.sqrt(guests.length + 1)))}%`\r\n  const toggleVideoMode = (mode:VideoType)=>{\r\n    setVideoMode(videoMode!=mode?mode:null)\r\n  }\r\n  return lastJsonMessage !==undefined ?\r\n    <ThemedView style={[\r\n      {aspectRatio:!disable?16/9:0, borderColor:Colors.borderColor, borderRadius:10},\r\n      windowType=='landscape'?{flexShrink:1, flexGrow:0, height:'100%', borderLeftWidth:1, paddingBottom:65}:{maxHeight:'36%', width:'100%', borderBottomWidth:1}\r\n    ]}>\r\n      <View style={{aspectRatio:focusGuest?undefined:16/9, backgroundColor:'white', flexWrap:'wrap', flexDirection:'row', width:'100%', height:'100%'}}>\r\n        {guests.map((receiver, i)=><VideoView scale={scale} focusGuest={focusGuest} setFocusGuest={setFocusGuest} receiver={receiver}>\r\n          <RemoteCam receiver={receiver}/>\r\n        </VideoView>\r\n        )}\r\n        <VideoView scale={scale} focusGuest={focusGuest} setFocusGuest={setFocusGuest} receiver={auth.user?.name}>\r\n          <LocalCam user={auth.user} mode={videoMode}/>\r\n        </VideoView>\r\n      </View>\r\n      <ThemedView style={[\r\n          {position:'absolute', alignItems:'center', justifyContent:'flex-end', width:'100%',flexDirection:'row'},\r\n          windowType=='landscape'?{bottom:0, paddingTop:15, paddingBottom:10, paddingHorizontal:19}:{backgroundColor:'transparent'}\r\n        ]}>\r\n        <CommonButton title={''} style={{height:40, paddingTop:8}} onPress={()=>toggleVideoMode('camera')}/>\r\n        <CommonButton title={''} style={{height:40, paddingTop:8}} onPress={()=>toggleVideoMode('display')}/>\r\n        <CommonButton title={''} style={{height:40, paddingTop:8}} onPress={()=>setDisable(true)}>\r\n          <Ionicons size={20} name=\"arrow-back\" color={'deepskyblue'}/>\r\n        </CommonButton>\r\n      </ThemedView>\r\n    </ThemedView>:\r\n  <></>\r\n  }\r\n  \r\nexport default React.memo(({channel_id, disable, setDisable}:VideoCallProps)=>{\r\n  return <RtcProvider disable={disable}>\r\n    <VideoCallContainer channel_id={channel_id} disable={disable} setDisable={setDisable}/>\r\n  </RtcProvider>\r\n})\r\n","import React from 'react'\r\nimport { TouchableOpacity } from \"react-native-gesture-handler\"\r\nimport CommonSection from \"./CommonSection\"\r\nimport { Linking, TextStyle } from \"react-native\"\r\nimport { FontAwesome } from '@expo/vector-icons'; \r\nimport { View, Text } from \"./Themed\"\r\nimport { File } from \"../types\"\r\nimport useColorScheme from '../hooks/useColorScheme';\r\n\r\nfunction humanFileSize(size:number) {\r\n    var i = size == 0 ? 0 : Math.floor(Math.log(size) / Math.log(1024));\r\n    return (size / Math.pow(1024, i)).toFixed(2) + ' ' + ['B', 'kB', 'MB', 'GB', 'TB'][i];\r\n  }\r\n  \r\n\r\nexport default ({file, isMobile, showBorder}:{file:File, isMobile:boolean, showBorder:boolean})=>{\r\n    const theme = useColorScheme()\r\n    return <CommonSection containerStyle={{marginHorizontal:0}} bodyStyle={showBorder?{padding:10}:{borderWidth:0, padding:0}}>\r\n    <TouchableOpacity onPress={()=>Linking.openURL(file.file)} style={{flexDirection:'row', alignItems:'flex-start'}} containerStyle={{width:'100%'}}>\r\n        <FontAwesome name=\"file-o\" size={20} color={theme=='light'?'black':'white'} />\r\n        <View style={{flex:1, marginHorizontal:10}}>\r\n            <Text style={{fontSize:18}}>{file.filename}</Text>\r\n            <Text style={{fontSize:14}}>{humanFileSize(file.filesize)}</Text>\r\n        </View>\r\n    </TouchableOpacity>\r\n    </CommonSection>\r\n}","import React, {useState, useEffect} from \"react\"\r\nimport moment from \"moment\";\r\nimport {View, TouchableOpacity} from 'react-native'\r\nimport { Text } from \"../../../components/Themed\";\r\nimport useTimerMessageContentList from \"../../../hooks/lists/useTimerMessageContent\";\r\nimport { MessengerContent } from \"../../../types\";\r\nimport Avatar from \"../../../components/Avatar\";\r\nimport Hyperlink from \"react-native-hyperlink\";\r\n\r\nexport function timerFormat(datetime:string){\r\n    return _timerFormat(moment(datetime), moment())\r\n}\r\n\r\nfunction _timerFormat(m:moment.Moment, now:moment.Moment){\r\n    if (m.year() != now.year()){\r\n        return m.format('YYYY.MM')\r\n    }\r\n    if(m.month()!= now.month() || m.day() != now.day()){\r\n        return m.format('MM.DD')\r\n    }\r\n    return m.format('HH:mm')\r\n  }\r\n\r\nconst TimerTag = (props:{data:MessengerContent, now:moment.Moment, isExpand:boolean, setExpand:(id?:number)=>void})=>{\r\n    const start = moment(props.data.created)\r\n    const end = moment(props.data.timer)\r\n    const ratio = (start.diff(props.now)/start.diff(end))\r\n    return <TouchableOpacity onPress={()=>props.setExpand(props.isExpand?undefined:props.data.id)}>\r\n        <View style={{backgroundColor:'lightgray', borderRadius:20, overflow:'hidden', margin:5}}>\r\n            <View style={{backgroundColor:'darkgray', position:'absolute', width:`${ratio*100}%`, height:'100%'}}/>\r\n            {props.isExpand?\r\n            <View style={{paddingVertical:5, paddingHorizontal:5, maxWidth:270}}>\r\n                <View style={{flexDirection:'row'}}>\r\n                    <Avatar name={props.data.name} userId={props.data.user} size={20}/>\r\n                    <View style={{paddingHorizontal:5}}><Text>{props.data.name}</Text></View>\r\n                </View>\r\n                <View style={{flexDirection:'row', alignItems:'stretch'}}>\r\n                    <Text></Text>\r\n                    <Text selectable>{moment(props.data.timer).format('L HH:mm')}</Text>\r\n                </View>\r\n                {/* @ts-ignore */}\r\n                <Hyperlink linkDefault={ true } style={{wordBreak:\"break-word\"}} linkStyle={{color: '#12b886'}}>\r\n                    <Text selectable>{props.data.message_set[0].content}</Text>\r\n                </Hyperlink>\r\n            </View>:    \r\n            <View style={{paddingVertical:5, paddingHorizontal:5, flexDirection:'row'}}>\r\n                <Avatar name={props.data.name} userId={props.data.user} size={20}/>\r\n                <View style={{paddingHorizontal:5}}><Text>{_timerFormat(end, props.now)}</Text></View>\r\n            </View>}\r\n        </View>\r\n    </TouchableOpacity>\r\n}\r\n\r\n\r\nexport default (props:{channel_id:number})=>{\r\n    const timerMessages = useTimerMessageContentList(props.channel_id)\r\n    const [now, setNow] = useState(moment())\r\n    const [expand, setExpand] = useState<number>()\r\n    useEffect(()=>{\r\n        const timeout = setTimeout(()=>{\r\n            setNow(moment())\r\n        }, 2000)\r\n        return ()=>clearTimeout(timeout)\r\n    }, [now])\r\n    return <View style={{flexDirection:'row', paddingTop:5, paddingHorizontal:20}}>\r\n        {timerMessages?.map((v,i)=><TimerTag key={i} data={v} now={now} isExpand={v.id==expand} setExpand={setExpand}/>)}\r\n    </View>\r\n}","import { useEffect, useMemo } from \"react\"\r\nimport { useQuery, useQueryClient } from \"react-query\"\r\nimport { getTimerMessageContentList } from \"../../apis\"\r\nimport { MessengerContent } from \"../../types\"\r\nimport useWebsocketContext from \"../useWebsocketContext\"\r\nimport moment from \"moment\"\r\n\r\nexport default function useTimerMessageContentList(channel_id:number){  \r\n  const queryClient = useQueryClient()\r\n  const { data } = useQuery<MessengerContent[]>(\r\n    [\"TimerMessageContentList\", channel_id], \r\n    async()=>await getTimerMessageContentList(channel_id, moment().format(moment.HTML5_FMT.DATETIME_LOCAL)), \r\n  )\r\n  const { lastJsonMessage } = useWebsocketContext()\r\n  useEffect(()=>{\r\n    if(lastJsonMessage !=null && lastJsonMessage['data']['channel'] == channel_id){\r\n      if(lastJsonMessage['type']=='next_message'){\r\n        if(lastJsonMessage['data']['timer'] && moment() < moment(lastJsonMessage['data']['timer']))\r\n          queryClient.setQueryData<MessengerContent[]>([\"TimerMessageContentList\", channel_id], (_data)=>{\r\n            return [...(_data || []), lastJsonMessage['data']]\r\n          })\r\n      }\r\n      if(lastJsonMessage['type']=='delete_message'){\r\n        queryClient.setQueryData<MessengerContent[]>([\"TimerMessageContentList\", channel_id], (_data)=>{\r\n          return [...(_data?.filter(v=>v.id!=lastJsonMessage['data'].id) || [])]\r\n        })\r\n      }\r\n    }\r\n  }, [lastJsonMessage])\r\n  const sorted = useMemo(()=>data?.sort((a, b)=>(a.timer || '') > (b.timer || '')?1:-1), [data])\r\n  useEffect(()=>{\r\n    if (sorted?.[0]?.timer){\r\n      const id = sorted[0].id\r\n      const ms = Math.min(moment(sorted[0].timer).diff(moment()), Number.MAX_VALUE)\r\n      let timeout = setTimeout(()=>{\r\n        queryClient.setQueryData<MessengerContent[]>([\"TimerMessageContentList\", channel_id], (_data)=>{\r\n          return (_data || []).filter(v=>v.id!=id || moment(v.timer).diff(moment()) > 0)\r\n        })\r\n      }, ms)\r\n      return ()=>clearTimeout(timeout)\r\n    }\r\n  },[sorted])\r\n  return sorted\r\n}\r\n","import React, {useCallback, useEffect, useLayoutEffect, useMemo, useRef, useState} from 'react';\r\nimport { StackScreenProps } from '@react-navigation/stack';\r\nimport { Platform, StyleSheet, View, TouchableOpacity } from 'react-native';\r\nimport CommonSection from '../../../components/CommonSection';\r\nimport { FlatList, TextInput } from 'react-native-gesture-handler';\r\nimport CommonButton from '../../../components/CommonButton';\r\nimport useMessengerContentList, { MessengerContentPage, useMessengerContentMutation } from '../../../hooks/lists/useMessengerContentList';\r\nimport useAuthContext from '../../../hooks/useAuthContext';\r\nimport HeaderRight from '../../../components/HeaderRight';\r\nimport useMessengerMemberList from '../../../hooks/lists/useMessengerMemberList';\r\nimport Colors from '../../../constants/Colors';\r\nimport useColorScheme from '../../../hooks/useColorScheme';\r\nimport { Text, View as ThemedView } from '../../../components/Themed' \r\nimport Hyperlink from 'react-native-hyperlink'\r\nimport useMessengerChannelList from '../../../hooks/lists/useMessengerChannelList';\r\nimport useIsMobile from '../../../hooks/useIsMobile';\r\nimport LinkPreview from '../../../components/LinkPreview';\r\nimport Avatar, { avatarFromChannel } from '../../../components/Avatar';\r\nimport VideoCallSection from './VideoCallSection';\r\nimport useResizeContext from '../../../hooks/useResizeContext';\r\nimport FilePreview from '../../../components/FilePreview';\r\nimport useModalsContext from '../../../hooks/useModalsContext';\r\nimport InviteModal from '../../../modals/InviteModal';\r\nimport DateTimePickerModal from '../../../modals/DateTimePickerModal'\r\nimport useLangContext from '../../../hooks/useLangContext';\r\nimport { Entypo } from '@expo/vector-icons';\r\nimport TimerTags, { timerFormat } from './TimerTags';\r\nimport moment from 'moment';\r\nimport MessageModal from '../../../modals/MessageModal';\r\nimport ChannelEditModal from '../../../modals/ChannelEditModal';\r\n\r\n\r\nfunction uploadFile(){\r\n  return new Promise<Blob|undefined>((resolve, reject)=>{\r\n    if (Platform.OS == 'web'){\r\n      var input = document.createElement('input');\r\n      input.type = 'file';\r\n      input.onchange = e => { \r\n        resolve((e.target as any).files[0])\r\n      }\r\n      input.onabort = reject\r\n      input.onerror = reject\r\n      input.click();\r\n    }\r\n    else\r\n      resolve(undefined)\r\n  })\r\n}\r\n\r\nconst MessengerContentPageItem = React.memo((props:MessengerContentPage & {ownerId?:number})=>{\r\n  const isMobile = useIsMobile()\r\n  const { setModal } = useModalsContext()\r\n  let nextPage = props.next;\r\n    while(nextPage?.next && nextPage.current.length==0){\r\n      nextPage = nextPage.next\r\n    }\r\n    const nextContent = nextPage?.current[0]\r\n    return <View style={{flexDirection: 'column-reverse'}}>\r\n      \r\n      {props.current.map((content, index2)=>{\r\n        const next = index2 + 1 < props.current.length?props.current[index2+1]:nextContent\r\n        const created:string = content.created.slice(0, 16)\r\n        const date = created.slice(0, 10)\r\n        const isSystem = content.user == null\r\n        const isFirst = next==undefined || (content.user != next.user || created != next.created.slice(0, 16))\r\n        const isSelf = props.ownerId == content.user\r\n        const dayChanged = next==undefined || date != next.created.slice(0, 10)\r\n        const message = content.message_set[0]\r\n        if (isSystem)\r\n          return <View key={content.id} style={{flexDirection:'row', justifyContent:'center', width:'100%', marginVertical:5}}>\r\n            <Text>{message.content}</Text>\r\n          </View>\r\n        return <View key={content.id}>\r\n          {dayChanged?<View style={{flexDirection:'row', justifyContent:'center', width:'100%'}}><Text>{date}</Text></View>:undefined}\r\n          <View key={content.id} style={{flexDirection:'row', justifyContent:isSelf?'space-between':'flex-start', width:'100%'}}>\r\n            {isFirst && !isSelf? <View style={{marginTop:3, marginLeft:12}}><Avatar name={content.name} userId={content.user} size={36}/></View>:<View style={{width:48}}/>}\r\n            <CommonSection outerContainerStyle={{width:undefined, maxWidth:'90%'}} title={isFirst?content.name:undefined} titleStyle={{flex:undefined}} bodyStyle={{padding:10}} subtitle={`${created.slice(11)}`}>\r\n              <TouchableOpacity onLongPress={()=>setModal(MessageModal, {id:content.id, content:message.content})}>\r\n                {content.timer && <View style={{flexDirection:'row', alignItems:'stretch'}}>\r\n                  <Text style={{fontSize:12}}></Text>\r\n                  <Text style={{fontSize:12}} selectable>{moment(content.timer).format('L HH:mm')}</Text>\r\n                </View>}\r\n                <View style={{width:\"100%\"}}>\r\n                  {/* @ts-ignore */}\r\n                  <Hyperlink linkDefault={ true } style={{wordBreak:\"break-word\"}} linkStyle={{color: '#12b886'}}>\r\n                    <Text selectable style={{textAlign:isSelf?'right':'left'}}>{message.content}</Text>\r\n                  </Hyperlink>\r\n                </View>\r\n              {content.file_set.map((file, fileIndex)=><FilePreview key={fileIndex} file={file} isMobile={isMobile} showBorder={content.file_set.length>1 || message.content.length>0}/>)}\r\n              {content.link_set.map((link, linkIndex)=><LinkPreview key={linkIndex} link={link} isMobile={isMobile}/>)}\r\n              </TouchableOpacity>        \r\n            </CommonSection>\r\n          </View>\r\n        </View>\r\n      })}\r\n    </View>\r\n\r\n})\r\n\r\nexport default function ChatScreen({navigation, route}: StackScreenProps<any, 'Chat'>) {\r\n  const { lang, locale } = useLangContext()\r\n  const isMobile = useIsMobile()\r\n  const channel_id = route?.params?.id\r\n  const height = useRef(0)\r\n  const inputRef = useRef<TextInput>(null)\r\n  const {auth} = useAuthContext()\r\n  const { setModal } = useModalsContext()\r\n  const channel = useMessengerChannelList(auth)?.find(v=>v.id==parseInt(channel_id))\r\n  const channelAvatar = channel?avatarFromChannel(channel, auth.user):undefined\r\n  const {data, fetchNextPage } = useMessengerContentList(channel_id)\r\n  const memberList = useMessengerMemberList(channel_id)\r\n  const member_id = useMemo(()=>memberList?.find(v=>v.user == auth.user?.id)?.id, [auth, memberList])\r\n  const windowType = useResizeContext()\r\n  const [value, setValue] = useState('')\r\n  const [timer, setTimer] = useState<string>()\r\n  const [autoFocus, setAutoFocus] = useState<boolean|null>(null)\r\n  const [videoMode, setVideoMode] = useState<boolean>(false)\r\n  const [bottomTab, setBottomTab] = useState<boolean>(false)\r\n\r\n  const theme = useColorScheme()\r\n  const postValue = ()=>{\r\n    if (value.length>0){\r\n      contentMutation.create({channel:channel_id, user:auth.user?.id, content:value, timer})\r\n      setValue('')\r\n      setTimer(undefined)\r\n      setBottomTab(false)\r\n      setAutoFocus(true)\r\n    }\r\n  }\r\n  const contentMutation = useMessengerContentMutation()\r\n\r\n  useLayoutEffect(() => {\r\n    navigation.setOptions({\r\n      headerRight: ()=> <HeaderRight extra={[\r\n        {title:lang('invite'), onPress:()=>setModal(InviteModal, {id:channel_id})},\r\n        {title:lang('setting'), onPress:()=>setModal(ChannelEditModal, {id:channel_id, type:'messenger', member_id})}\r\n      ]}/>,\r\n      title: channelAvatar?.name\r\n    });\r\n  }, [navigation, route, member_id, locale]);\r\n\r\n  const renderItem = useCallback(({item, index}:{item:MessengerContentPage, index:number})=><MessengerContentPageItem {...item} ownerId={auth.user?.id}/>, [auth])\r\n  \r\n  const back = ()=>{\r\n    if(navigation.canGoBack())\r\n        navigation.goBack()\r\n      else{\r\n        navigation.navigate('HomeScreen', {tab:2})\r\n      }\r\n  }\r\n  useEffect(()=>{\r\n    setModal(null, null)\r\n    if (!channel_id)\r\n      back()\r\n  }, [route])\r\n  useEffect(()=>{\r\n    if (memberList===null)\r\n      back()\r\n  }, [memberList])\r\n  useEffect(()=>{\r\n    if(autoFocus){\r\n      (inputRef.current as any).focus()\r\n      setAutoFocus(false)\r\n    }\r\n  }, [autoFocus])\r\n  useEffect(()=>{\r\n    if (autoFocus==null && !isMobile){\r\n      const timeout = setTimeout(()=>setAutoFocus(true), 500)\r\n      return ()=>clearTimeout(timeout)\r\n    }\r\n  })\r\n  return <View style={[\r\n    {flex:1, alignItems:'center'},\r\n    windowType=='landscape'?{flexDirection:'row-reverse', minWidth:480}:{flexDirection:'column'}\r\n  ]}>\r\n    <VideoCallSection channel_id={channel_id} setDisable={(d)=>setVideoMode(!d)} disable={!videoMode}/>\r\n    <View style={[{flex:videoMode?undefined:1, flexShrink:1}, windowType=='landscape'?{minWidth:320, height:'100%'}:{width:'100%'}]}>\r\n      <FlatList\r\n        style={{flexDirection: 'column-reverse'}}\r\n        contentContainerStyle={{padding:10, flexGrow:1, flexDirection: 'column-reverse'}}\r\n        data={data?.pages}\r\n        renderItem={renderItem}\r\n        onScroll={(e)=>{\r\n          if (e.nativeEvent.contentOffset.y + e.nativeEvent.contentSize.height - height.current < 1)\r\n            fetchNextPage()\r\n        }}\r\n        onLayout={(p)=>{height.current = p.nativeEvent.layout.height}}\r\n      />\r\n      <View style={{position:'absolute'}}>\r\n        <TimerTags channel_id={channel_id}/>\r\n      </View>\r\n      <ThemedView style={{bottom:0, width:'100%', paddingTop:15, paddingBottom:10, paddingHorizontal:19}}>\r\n        <View style={{alignItems:'center', width:'100%',flexDirection:'row'}}>\r\n          <CommonButton title={''} style={{height:40, paddingTop:8, borderTopRightRadius:0, borderBottomRightRadius:0}} onPress={()=>setBottomTab(!bottomTab)}>\r\n            <View style={{top:-2}}>\r\n              <Entypo name={bottomTab?\"cross\":\"plus\"} size={24} color={Colors[theme].text}/>\r\n            </View>\r\n          </CommonButton>\r\n          {timer && <CommonButton style={{height:40, paddingTop:8, borderRadius:0}} title={`${timerFormat(timer)}`} onPress={()=>{setModal(DateTimePickerModal, {datetime:timer, callback:(datetime:string)=>setTimer(datetime)});setBottomTab(false)}}/>}\r\n          <TextInput ref={inputRef} value={value} onChangeText={setValue} style={{\r\n            flex:1, borderWidth:1, height:40, borderColor:Colors.borderColor, backgroundColor:Colors[theme].background, color:Colors[theme].text\r\n          }} onSubmitEditing={postValue} blurOnSubmit={true} onFocus={()=>setBottomTab(false)}/>\r\n          <CommonButton style={{height:40, paddingTop:8, borderTopLeftRadius:0, borderBottomLeftRadius:0}} title={''} onPress={postValue}/>\r\n        </View>\r\n\r\n        {bottomTab && <View style={{alignItems:'center', width:'100%', flexDirection:'row', paddingTop:15, paddingBottom:5}}>\r\n          <CommonButton style={{height:80, flex:1, justifyContent:'center', marginRight:15}} title={`\\n ${lang('Upload File')}`} onPress={()=>uploadFile().then(f=>{contentMutation.create({channel:channel_id, user:auth.user?.id, content:'', file:f});setBottomTab(false)})}/>\r\n          <CommonButton style={{height:80, flex:1, justifyContent:'center', marginRight:15}} title={`\\n ${lang('Timer Message')}`} onPress={()=>{setModal(DateTimePickerModal, {datetime:timer, callback:(datetime:string)=>setTimer(datetime)});setBottomTab(false)}}/>\r\n          <CommonButton style={{height:80, flex:1, justifyContent:'center'}} title={`\\n ${lang('Video Call')}`} onPress={()=>{setVideoMode(!videoMode);setBottomTab(false)}} disabled={videoMode}/>\r\n        </View>}\r\n      </ThemedView>\r\n    </View>\r\n  </View>\r\n}","import React from \"react\"\r\nimport CommonSection from \"../../../components/CommonSection\"\r\nimport Colors from \"../../../constants/Colors\"\r\nimport useColorScheme, { setColorScheme } from \"../../../hooks/useColorScheme\"\r\nimport { StyleSheet, Text, View} from 'react-native';\r\nimport useLangContext from \"../../../hooks/useLangContext\";\r\nimport { useColorScheme as useConfigColorScheme} from 'react-native-appearance';\r\nimport useAuthContext from \"../../../hooks/useAuthContext\";\r\nimport useFirebaseContext from \"../../../hooks/useFirebaseContext\";\r\nimport TextButton from \"../../../components/TextButton\";\r\n\r\n\r\nconst ConfigSection = ({title, children}:{title:string, children?: React.ReactNode})=>{\r\n  const theme = useColorScheme()\r\n  const color = Colors[theme].text\r\n  return <CommonSection bodyStyle={{alignItems:'flex-start', backgroundColor:theme=='light'?'transparent':\"black\"}}>\r\n    <Text style={{fontSize:20, color, fontWeight:'600'}}>{title}</Text>\r\n    {children}\r\n  </CommonSection>\r\n}\r\n\r\nexport default ()=>{\r\n  const { lang, locale, setLocale } = useLangContext()\r\n  const theme = useColorScheme()\r\n  const configTheme = useConfigColorScheme()\r\n  const { auth } = useAuthContext()\r\n  const {enable:noti, setEnable:setNoti} = useFirebaseContext(auth)\r\n  const color = Colors[theme].text\r\n  return <>\r\n    <ConfigSection title={lang('* Notification Settings')}>\r\n      <View style={{flexDirection:'row'}}>\r\n        {[[lang('On'), true], [lang('Off'), false]].map(([title, n])=><TextButton\r\n          key={title} title={title || ''} textStyle={{fontSize:16, color, textDecorationLine:noti==n?'underline':'none'}} style={{borderRadius:20}} onPress={()=>{setNoti(n)}}/>)}\r\n      </View>\r\n    </ConfigSection>\r\n    <ConfigSection title={lang('* Language Settings')}>\r\n    <View style={{flexDirection:'row'}}>\r\n        {[[lang('Auto'), 'auto'], ['', 'ko'], ['English', 'en']].map(([title, l])=><TextButton \r\n          key={title} title={title || ''} textStyle={{fontSize:16, color, textDecorationLine:locale==l?'underline':'none'}} style={{borderRadius:20}} onPress={()=>setLocale(l)}/>)}\r\n      </View>\r\n    </ConfigSection>\r\n    <ConfigSection title={lang('* Skin Settings')}>\r\n      <View style={{flexDirection:'row'}}>\r\n        {[[lang('Auto'), 'no-preference'], [lang('Light'), 'light'], [lang('Dark'), 'dark']].map(([title, colorScheme])=><TextButton \r\n          key={title} title={title} textStyle={{fontSize:16, color, textDecorationLine:configTheme==colorScheme?'underline':'none'}} style={{borderRadius:20}} onPress={(\r\n            )=>setColorScheme(colorScheme)}/>)}\r\n      </View>\r\n    </ConfigSection>\r\n  </>\r\n}","import React, {useState, useEffect, useLayoutEffect, useMemo} from 'react';\r\nimport { StackScreenProps } from '@react-navigation/stack';\r\nimport { StyleSheet, Text, View} from 'react-native';\r\nimport { Text as StyledText } from 'react-native-paper';\r\nimport useResizeContext from '../../../hooks/useResizeContext';\r\nimport TabView from '../../../components/TabView';\r\nimport HeaderRight from '../../../components/HeaderRight';\r\nimport TextButton from '../../../components/TextButton';\r\nimport Colors from '../../../constants/Colors';\r\nimport useColorScheme  from '../../../hooks/useColorScheme';\r\nimport useModalsContext from '../../../hooks/useModalsContext';\r\nimport ChannelEditModal from '../../../modals/ChannelEditModal';\r\nimport useLangContext from '../../../hooks/useLangContext';\r\nimport ContractFooter from '../../../components/ContractFooter';\r\nimport { TabViewRecord } from '../../../types';\r\nimport useAuthContext from '../../../hooks/useAuthContext';\r\nimport useUserMembershipList from '../../../hooks/lists/useUserMembershipList';\r\nimport { FontAwesome, Ionicons, MaterialCommunityIcons, SimpleLineIcons } from '@expo/vector-icons';\r\nimport { useMessengerChannelSorted } from '../../../hooks/lists/useMessengerChannelList';\r\nimport { ScrollView } from 'react-native-gesture-handler';\r\nimport CommonItem from '../../../components/CommonItem';\r\nimport MemberItem from '../../../components/MemberItem';\r\nimport ProfileModal from '../../../modals/ProfileModal';\r\nimport { navigate } from '../../../navigation';\r\nimport CommonSection from '../../../components/CommonSection';\r\nimport ConfigSections from './ConfigSections';\r\nimport Avatar, { avatarFromChannel } from '../../../components/Avatar';\r\n\r\nconst MemberTabView = ()=>{\r\n  const {auth} = useAuthContext()\r\n  const { setModal } = useModalsContext()\r\n  const userList = useUserMembershipList(auth)\r\n  const memberItem = React.useMemo(\r\n      ()=>userList && userList.map((item, index)=><MemberItem key={index} member={item} onPress={()=>setModal(ProfileModal, {id:item.id})}/>), [userList])\r\n  return <ScrollView style={{flex:1, backgroundColor:'white'}}>\r\n      {memberItem}\r\n  </ScrollView>\r\n}\r\n\r\nconst MessengerTabView = ()=>{\r\n  const {auth} = useAuthContext()\r\n  const channelList = useMessengerChannelSorted(auth)\r\n  \r\n  const today = (new Date()).toISOString().slice(0, 10)\r\n  return <ScrollView style={{flex:1, backgroundColor:'white'}}>\r\n      {channelList?.map((item, index)=>{\r\n          const {avatar, name} = avatarFromChannel(item, auth.user)\r\n          const date = item.last_message?.created.slice(0,10)\r\n          return <CommonItem key={index} bodyStyle={{flexDirection:'row', justifyContent:'space-between'}} onPress={()=>navigate(\"ChatScreen\", {id:item.id})}>\r\n              <View style={{flexDirection:'row'}}>\r\n                  {avatar?\r\n                    <View style={{ marginRight:20}}>\r\n                      <Avatar name={avatar.name} size={44} userId={avatar.id}/>\r\n                    </View>:\r\n                    <FontAwesome size={40} style={{ marginBottom: -3, marginRight:20 }} name='users'/>}\r\n                  <View>\r\n                      <View style={{flexDirection:'row'}}>\r\n                          <Text style={{fontSize:18}}>{name}</Text>\r\n                          <Text style={{fontSize:18, opacity: 0.4, paddingLeft:5}}>{item.member_count}</Text>\r\n                      </View>\r\n                      <Text style={{fontSize:16, opacity: 0.4}}>{item.last_message?.content}</Text>\r\n                  </View>\r\n              </View>\r\n              <View>\r\n                  <Text style={{fontSize:14, opacity: 0.4, textAlign:'right'}}>{date==today?item.last_message?.created.slice(11,16):date}</Text>\r\n                  <Text style={{fontSize:14, textAlign:'right'}}>{item.unread_count?item.unread_count:' '}</Text>\r\n              </View>\r\n          </CommonItem>\r\n      })}\r\n  </ScrollView>\r\n}\r\n\r\n\r\nconst ConfigTabView = ()=>{\r\n  return <View style={{flex:1, backgroundColor:'white'}}>\r\n    <ConfigSections/>\r\n  </View>\r\n}\r\n\r\nconst bottomTabs:TabViewRecord = {\r\n  OneTab:{\r\n      title:'member',\r\n      component:MemberTabView,\r\n      icon:<MaterialCommunityIcons size={32} style={{ marginBottom: -3 }} name='account'/>,\r\n  },\r\n  TwoTab:{\r\n      title:'chat',\r\n      component:MessengerTabView,\r\n      icon:<Ionicons size={30} style={{ marginBottom: -3 }} name='chatbox'/>\r\n  },\r\n  // ThreeTab:{\r\n  //     title:'board',\r\n  //     component:()=><></>,\r\n  //     icon:<></>\r\n  // },\r\n  FourTab:{\r\n      title:'config',\r\n      component:ConfigTabView,\r\n      icon:<SimpleLineIcons size={30} style={{ marginBottom: -3 }} name='options'/>\r\n  }\r\n}\r\n\r\n\r\nexport default function HomeScreen({navigation, route}: StackScreenProps<any, 'Home'>) {\r\n  const { lang, locale } = useLangContext()\r\n  const windowType = useResizeContext();\r\n  const theme = useColorScheme()\r\n  const { setModal } = useModalsContext()\r\n  const [ home, setHome ] = useState(windowType == 'landscape')\r\n  const color = Colors[theme].text\r\n  const options = [\r\n    {title:lang('member'), headerRight:()=><HeaderRight/>},\r\n    {title:lang('chat'), headerRight:()=><HeaderRight extra={[{title:lang('create'), onPress:()=>setModal(ChannelEditModal, {type:'messenger'})}]}/>},\r\n    // {title:'board', headerRight:()=><HeaderRight extra={[{title:'create', onPress:()=>setModal(ChannelEditModal, props:{type:'board'}}) }]}/>},\r\n    {title:'config', headerRight:()=><HeaderRight/>}\r\n  ]\r\n  \r\n  useLayoutEffect(() => {\r\n    const index = route?.params?.tab | 0\r\n    navigation.setOptions(windowType == 'portrait'?options[index]:{\r\n      title: lang('home'),\r\n      headerRight: ()=><HeaderRight/>\r\n    });\r\n  }, [navigation, route, windowType, locale]);\r\n  useEffect(()=>{\r\n    setHome(windowType == 'landscape')\r\n  }, [windowType])\r\n  return home?\r\n    <View style={{flex:1, justifyContent:'center', alignItems:'center'}}>\r\n      <View style={{width:'80%', flex:1, marginTop:72}}>\r\n        <StyledText style={{fontSize:32, color}}>Tokki Tok</StyledText>\r\n        <View style={{backgroundColor:Colors.borderColor, height:1, width:'100%'}}/>\r\n        {/* <Text style={{fontSize:20, color:'gray'}}>Welcome! This is a messenger for teams.</Text>*/}\r\n        <View style={{height:24}}/>\r\n        <CommonSection bodyStyle={{alignItems:'flex-start', backgroundColor:'transparent'}}>\r\n          <TextButton title={lang('+ New chat')} textStyle={{fontSize:20, color}} style={{paddingLeft:0, borderRadius:20}} onPress={()=>setModal(ChannelEditModal, {type:'messenger'})}/>\r\n        </CommonSection>\r\n        <ConfigSections/>\r\n      </View>\r\n      <ContractFooter/>\r\n    </View>:\r\n    <TabView tabs={bottomTabs} tabBarPosition=\"bottom\" index={parseInt(route.params?.['tab'] || 0)} onTab={(index)=>{navigation.setParams({tab:index})}}/>\r\n}\r\n\r\n","import React, {useEffect, useLayoutEffect, useState} from 'react';\r\n\r\nimport { StackScreenProps } from '@react-navigation/stack';\r\nimport useAuthContext from '../../hooks/useAuthContext';\r\nimport useMessengerChannelList from '../../hooks/lists/useMessengerChannelList';\r\nimport { Text } from '../../components/Themed';\r\nimport { useMessengerMemberMutation } from '../../hooks/lists/useMessengerMemberList';\r\n\r\nexport default function InviteeScreen({navigation, route}: StackScreenProps<any, 'Invitee'>) {\r\n    const id = route?.params?.id\r\n    const {auth, dispatch} = useAuthContext()\r\n    const [enterGuest, setEnterGuest] = useState(false)\r\n    const channelList = useMessengerChannelList(auth)\r\n    const messengerMemberMutation = useMessengerMemberMutation()\r\n    useLayoutEffect(() => {\r\n        navigation.setOptions({headerRight: undefined});\r\n    }, []);\r\n    useEffect(()=>{\r\n        if(auth.user==null && enterGuest==false){\r\n            dispatch({type:\"LOGIN_GUEST\"})\r\n            setEnterGuest(true)\r\n        }\r\n        else if(auth.user && channelList!==undefined){\r\n            if(channelList.find(v=>v.id==id) === undefined){\r\n                console.log(`invite processing (channel:${id})`)\r\n                messengerMemberMutation.invite({\r\n                    channel_id:id,\r\n                    user_ids:[auth.user.id]\r\n                }).then(()=>navigation.replace(\"ChatScreen\", {id}))\r\n            }\r\n            else{\r\n                console.log('already invite')\r\n                navigation.replace(\"ChatScreen\", {id})\r\n            }\r\n        }\r\n    }, [auth, channelList, enterGuest])\r\n  return <Text>{''}</Text>\r\n};\r\n","import LoginScreen from \"./main/LoginScreen\";\r\nimport ChatScreen from \"./main/ChatScreen\";\r\nimport HomeScreen from \"./main/HomeScreen\";\r\nimport TabOneScreen from \"./main/TabOneScreen\";\r\nimport InviteeScreen from \"./main/InviteeScreen\";\r\n// import BoardScreen from \"../lib/blacktokki-board/BoardScreen\";\r\n// import BoardEditScreen from \"../lib/blacktokki-board/BoardEditScreen\";\r\nimport { Screens } from \"../types\";\r\n\r\nexport const main = {\r\n    HomeScreen:{\r\n        title:'home',\r\n        component:HomeScreen,\r\n        path:'home',\r\n    },\r\n    ChatScreen:{\r\n        title:'chat',\r\n        component:ChatScreen,\r\n        path:'chat'\r\n    },\r\n    // BoardScreen:{\r\n    //     title:'board',\r\n    //     component:BoardScreen,\r\n    //     path:'board'\r\n    // },\r\n    // TabOneScreen:{\r\n    //     title:'tab one',\r\n    //     component:TabOneScreen,\r\n    //     path:'one'\r\n    // },\r\n    InviteeScreen:{\r\n        title: '',        \r\n        component:InviteeScreen,\r\n        path:'invitee'\r\n    }\r\n} as Screens\r\n\r\nexport const login = {\r\n    LoginScreen:{\r\n        path: 'login',\r\n        title: 'Sign in',\r\n        component:LoginScreen\r\n    },\r\n    InviteeScreen:{\r\n        path:'invitee',\r\n        title: '',\r\n        component:InviteeScreen\r\n    }\r\n} as Screens\r\n\r\nexport const modal = {\r\n    // BoardEditScreen:{\r\n    //     title:'board',\r\n    //     component:BoardEditScreen,\r\n    //     path:'modal/board'\r\n    // },\r\n} as Screens","import { Platform } from 'react-native';\r\n//@ts-ignore\r\nimport useMobileDetect from 'use-mobile-detect-hook';\r\n\r\nexport default ()=>{\r\n    const detectMobile = useMobileDetect();\r\n    return (detectMobile.isMobile() || Platform.OS == 'android' || Platform.OS == 'ios') as boolean\r\n}","/**\r\n * Learn more about Light and Dark modes:\r\n * https://docs.expo.io/guides/color-schemes/\r\n */\r\n\r\nimport * as React from 'react';\r\nimport { Text as DefaultText, View as DefaultView } from 'react-native';\r\n\r\nimport Colors from '../constants/Colors'\r\nimport useColorScheme from '../hooks/useColorScheme';\r\n\r\nexport function useThemeColor(\r\n  props: { light?: string; dark?: string },\r\n  colorName: keyof typeof Colors.light & keyof typeof Colors.dark\r\n) {\r\n  const theme = useColorScheme();\r\n  const colorFromProps = props[theme];\r\n\r\n  if (colorFromProps) {\r\n    return colorFromProps;\r\n  } else {\r\n    return Colors[theme][colorName];\r\n  }\r\n}\r\n\r\ntype ThemeProps = {\r\n  lightColor?: string;\r\n  darkColor?: string;\r\n};\r\n\r\nexport type TextProps = ThemeProps & DefaultText['props'];\r\nexport type ViewProps = ThemeProps & DefaultView['props'];\r\n\r\nexport function Text(props: TextProps) {\r\n  const { style, lightColor, darkColor, ...otherProps } = props;\r\n  const color = useThemeColor({ light: lightColor, dark: darkColor }, 'text');\r\n\r\n  return <DefaultText style={[{ color }, style]} {...otherProps} />;\r\n}\r\n\r\nexport function View(props: ViewProps) {\r\n  const { style, lightColor, darkColor, ...otherProps } = props;\r\n  const backgroundColor = useThemeColor({ light: lightColor, dark: darkColor }, 'background');\r\n\r\n  return <DefaultView style={[{ backgroundColor }, style]} {...otherProps} />;\r\n}\r\n","import { useQuery } from \"react-query\";\r\nimport { getUserMembershipList } from \"../../apis\";\r\nimport { Auth } from \"../useAuthContext\";\r\n\r\nexport default function useUserMembershipList(auth?:Auth){\r\n  const { data } = useQuery([\"UserMembershipList\", auth?.groupId] , async()=>auth?.groupId?(await getUserMembershipList(auth?.groupId)):[])\r\n  return data\r\n}","import React from 'react';\r\nimport { TabView, SceneMap,NavigationState, SceneRendererProps, TabBar } from 'react-native-tab-view';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport { TabViewRecord } from '../types';\r\n\r\n\r\nexport default (props:{tabs:TabViewRecord, tabBarPosition:\"top\"|\"bottom\", index?:number, onTab?:(index:number)=>void})=>{\r\n  const { lang } = useLangContext()\r\n  const [index, setIndex] = React.useState(props.index || 0);\r\n  const entries = Object.entries(props.tabs)\r\n  const onTab = props.onTab\r\n  const icons = Object.assign({}, ...entries.map(([k, v])=>({[k]:v.icon})))\r\n  return <TabView\r\n    renderTabBar={(props:SceneRendererProps & {navigationState: NavigationState<any>})=>{\r\n      return <TabBar\r\n        {...props}\r\n        indicatorStyle={{ backgroundColor: \"#2196F3\" }}\r\n        style={{ backgroundColor:'white' }}\r\n        activeColor={'black'}\r\n        inactiveColor={'black'}\r\n        renderIcon={(scene)=>icons[scene.route.key]}\r\n        onTabPress={(scene)=>onTab?.(entries.findIndex(([k, v])=>k == scene.route.key))}\r\n      />\r\n    }}\r\n    navigationState={{ index, routes: entries.map(([k, v])=>({key:k, title:lang(v.title)}))}}\r\n    onIndexChange={setIndex}\r\n    renderScene={SceneMap(Object.assign({}, ...entries.map(([k, v])=>({[k]:v.component}))))}\r\n    tabBarPosition={props.tabBarPosition}\r\n  />\r\n}\r\n\r\n","import * as React from 'react';\r\nimport { View } from './Themed';\r\nimport { StyleSheet, StyleProp, ViewStyle, TextStyle, Pressable } from 'react-native';\r\nimport Colors from '../constants/Colors';\r\n\r\nexport type ItemParamList = {\r\n    outerContainerStyle?:StyleProp<TextStyle>\r\n    containerStyle?:StyleProp<ViewStyle>\r\n    bodyStyle?:StyleProp<ViewStyle>\r\n    children?: React.ReactNode\r\n    onPress?: ()=>void\r\n}\r\n\r\nexport default function CommonItem(props:ItemParamList){\r\n  const [hover, setHover] = React.useState(false)\r\n  const [press, setPress] = React.useState(false)\r\n  return (\r\n    <Pressable\r\n      style={[styles.outerContainer ,props.outerContainerStyle, (press)?{backgroundColor:'rgb(242,242,242)'}:{}]}\r\n      onPressIn={()=>{setPress(true)}}\r\n      onPressOut={()=>{setPress(false);props.onPress?.()}}\r\n       //@ts-ignore\r\n       onHoverIn={()=>setHover(true)}\r\n       onHoverOut={()=>setHover(false)}\r\n    >\r\n        <View style={[styles.container ,props.containerStyle]}>\r\n            <View style={[styles.bodyView, props.bodyStyle]}>\r\n                <>{props.children}</>\r\n            </View>\r\n      </View>\r\n    </Pressable>\r\n    )\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  outerContainer:{\r\n    width:'100%',\r\n    maxWidth:1080,\r\n    alignItems:'stretch',\r\n  },  \r\n  container: {\r\n      marginHorizontal:20,\r\n      backgroundColor:'transparent'\r\n    },\r\n    bodyView:{\r\n      width: '100%',\r\n      padding: 10,\r\n      minHeight: 40,\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      borderBottomWidth:1,\r\n      borderColor:Colors.borderColor,\r\n      backgroundColor:'transparent'\r\n    }\r\n  });\r\n  ","import React, { useMemo } from 'react';\r\n\r\nimport { TextProps, StyleProp } from 'react-native';\r\nimport {View, Text } from './Themed'\r\nimport useResizeContext from '../hooks/useResizeContext';\r\n\r\ntype Props = {\r\n  name: string,\r\n  width?:number,\r\n  children: React.ReactNode\r\n  textStyle?: StyleProp<TextProps>\r\n}\r\n\r\nexport default function RowField(props:Props) {\r\n  const windowType = useResizeContext()\r\n  const rowStyle = useMemo(()=>windowType=='landscape'?\r\n    {flexDirection:'row', alignItems: 'center', justifyContent:'space-between'}:\r\n    {flexDirection:'column', alignItems:'flex-start'} as any\r\n  , [windowType])\r\n  return (\r\n    <View style={[{paddingVertical:5, width:'100%'}, rowStyle]}>\r\n        <Text style={[windowType=='landscape'?{flex:1}:{width:'100%'},{paddingHorizontal: 15, fontSize:16}, props.textStyle]}>{props.name}</Text>\r\n        <View style={[windowType=='landscape'?{flex:6}:{width:'100%'},{paddingHorizontal: 15}]}>\r\n          <View style={{width:props.width}}>\r\n            {props.children}\r\n          </View>\r\n        </View>\r\n    </View>\r\n  )\r\n}","import React from 'react';\r\nimport { StyleProp, TextStyle } from 'react-native';\r\nimport { CustomTextInputProps } from '../types';\r\nimport CommonTextInput from './CommonTextInput';\r\nimport RowField from './RowField';\r\n\r\nexport default function TextField(props:CustomTextInputProps & {name: string, width?:any, textStyle?:StyleProp<TextStyle>}) {\r\n  return (\r\n    <RowField name={props.name} width={props.width} textStyle={props.textStyle}>\r\n      <CommonTextInput {...props} />\r\n   </RowField>\r\n  )\r\n}","import { useCallback, useEffect, useState } from \"react\"\r\nimport { InfiniteData, useInfiniteQuery, useMutation, useQueryClient } from \"react-query\"\r\nimport { getMessengerContentList, postMessage, deleteMessengerContent } from \"../../apis\"\r\nimport { MessengerContent } from \"../../types\"\r\nimport useWebsocketContext from \"../useWebsocketContext\"\r\n\r\nexport type MessengerContentPage = {\r\n  next?:MessengerContentPage\r\n  current:MessengerContent[]\r\n}\r\n\r\nexport default function useMessengerContentList(channel_id:number){  \r\n  const queryClient = useQueryClient()\r\n  const { data, fetchNextPage } = useInfiniteQuery<MessengerContentPage>(\r\n    [\"MessengerContentList\", channel_id], \r\n    async({pageParam})=>getMessengerContentList(channel_id, pageParam).then(current=>({current})), \r\n    {\r\n      select:data=>{\r\n        if(data.pages.length > 1)\r\n          data.pages[data.pages.length - 2].next = data.pages[data.pages.length - 1]\r\n        return data;\r\n      },\r\n      getNextPageParam:(lastPage)=>lastPage?.current.length?lastPage.current[lastPage.current.length - 1].id:undefined,\r\n      refetchOnReconnect:false,\r\n      refetchOnWindowFocus:true\r\n    }\r\n  )\r\n  const { lastJsonMessage } = useWebsocketContext()\r\n  useEffect(()=>{\r\n    if(lastJsonMessage !=null && lastJsonMessage['data']['channel'] == channel_id){\r\n      if(lastJsonMessage['type']=='next_message'){\r\n        queryClient.setQueryData<InfiniteData<MessengerContentPage>>([\"MessengerContentList\", channel_id], (_data)=>{\r\n          if(_data?.pages[0].current && _data?.pages[0].current[0].id != lastJsonMessage['data'].id)\r\n            _data.pages[0].current = [lastJsonMessage['data'], ..._data?.pages[0].current]\r\n          return {...(_data || {pages:[], pageParams:[]})}\r\n        })\r\n      }\r\n      if(lastJsonMessage['type']=='delete_message'){\r\n        queryClient.setQueryData<InfiniteData<MessengerContentPage>>([\"MessengerContentList\", channel_id], (_data)=>{\r\n          console.log(_data?.pages)\r\n          _data?.pages.forEach(page=>{\r\n            const len = page.current.length\r\n            const newCurrent = page.current.filter(v=>v.id!=lastJsonMessage['data'].id)\r\n            console.log(len, newCurrent)\r\n            if (len != newCurrent.length){\r\n              page.current = newCurrent\r\n            }\r\n          })\r\n          return {...(_data || {pages:[], pageParams:[]})}\r\n        })\r\n      }\r\n    }\r\n  }, [lastJsonMessage])\r\n  return { data, fetchNextPage }\r\n}\r\n\r\nexport function useMessengerContentMutation(){\r\n  // const queryClient = useQueryClient()\r\n  const create = useMutation(postMessage, {\r\n    onSuccess: () => {\r\n      // queryClient.setQueryData(['MessengerContentList'], (data:any) => ({\r\n      //   pages: data.pages.slice(0, 1),\r\n      //   pageParams: data.pageParams.slice(0, 1),\r\n      // }))\r\n      // queryClient.invalidateQueries(\"MessengerContentList\")\r\n    }\r\n  });\r\n  const _delete = useMutation(deleteMessengerContent, {\r\n    onSuccess: (d, variables) => {\r\n      // queryClient.setQueryData(['MessengerContentList'], (data:any) => ({\r\n      //   pages: (data.pages as MessengerContent[][]).map(v=>v.filter(v2=>v2.id != variables)),\r\n      //   pageParams: data.pageParams,\r\n      // }))\r\n    }\r\n  })\r\n  return { create:create.mutate, delete:_delete.mutate }\r\n}","import React from 'react';\r\nimport moment from 'moment';\r\nimport { StyleSheet, Text, View,StyleProp, ViewStyle } from 'react-native';\r\nimport {LocaleConfig, Calendar as BaseCalendar} from 'react-native-calendars';\r\nimport { DateData, DayState, MarkedDates, MarkingTypes } from 'react-native-calendars/src/types';\r\n\r\nmoment.locale('ko')\r\n\r\nLocaleConfig.locales['ko'] = {\r\n  monthNames: moment.months(),\r\n  monthNamesShort: moment.monthsShort(),\r\n  dayNames: moment.weekdays(),\r\n  dayNamesShort: moment.weekdaysShort(),\r\n  today: \"\"\r\n};\r\nLocaleConfig.defaultLocale = 'ko';\r\n\r\nexport const defaultWidth = 400\r\n\r\nexport type CalendarProps = {\r\n  date?:string,\r\n  setDate?:(date:string)=>void,\r\n  style:StyleProp<ViewStyle>\r\n  markingType?:MarkingTypes\r\n  markedDates?:MarkedDates\r\n  onMonthChange?:(date:DateData)=>void\r\n  disableAllTouchEventsForDisabledDays?:boolean\r\n  dayComponent?:React.ComponentType<{date:DateData, state:DayState}>\r\n}\r\n\r\nexport default function Calendar(props:CalendarProps) {\r\n  return (\r\n    <View>\r\n      <BaseCalendar\r\n        markingType={props.markingType}\r\n        markedDates={props.markedDates}\r\n        renderArrow={direction => <Text>{direction == 'left'?\"\":\"\"}</Text>}\r\n        monthFormat={'yyyy MM'}\r\n        initialDate={props.date}\r\n        disableAllTouchEventsForDisabledDays={props.disableAllTouchEventsForDisabledDays}\r\n        onMonthChange={props.onMonthChange}\r\n        onDayPress={(date)=> props.setDate?.(date.dateString)}\r\n        current={props.date}\r\n        style={[{width:defaultWidth }, props.style]}\r\n        dayComponent={props.dayComponent as any}\r\n      />\r\n      {/* <Text style={styles.dateText}>: {props.date}</Text> */}\r\n    </View>\r\n  );\r\n}\r\n","import React, { useState } from 'react';\r\nimport CommonButton from '../components/CommonButton';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport {Picker} from '@react-native-picker/picker';\r\nimport { Text, View } from '../components/Themed';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport { Ionicons } from '@expo/vector-icons';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport Colors from '../constants/Colors';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { BottomSheet } from '../components/ModalSection';\r\nimport Calendar from '../components/Calendar';\r\nimport moment from 'moment';\r\n\r\nconst dayTypes = ['AM', 'PM'].map(value=>({label:value, value}))\r\nconst hours = [...Array(12).keys()].map((value, index)=>(index + 1).toString().padStart(2, '0')).map(value=>({label:value, value}))\r\nconst minutes = [...Array(12).keys()].map((value, index)=>(index * 5).toString().padStart(2, '0')).map(value=>({label:value, value}))\r\n\r\n\r\nconst getDisableDays=(date:moment.Moment)=>{\r\n  const startDate = date.clone().startOf('month').add(-1, 'month')\r\n  const endDate = date.clone().endOf('month').add(1, 'month')\r\n  const today = moment().startOf('day')\r\n  const result = []\r\n  while(startDate<=endDate && startDate<today){\r\n    result.push(startDate.format(moment.HTML5_FMT.DATE))\r\n    startDate.add(1, 'day')\r\n  }\r\n  return result\r\n}\r\n\r\nconst defaultMoment = ()=>{\r\n  const m = moment()\r\n  const restMinute = parseInt(m.format('mm')) % 5\r\n  m.add(5-restMinute, 'minute')\r\n  return m\r\n}\r\n\r\nexport default function DateTimePickerModal({datetime, callback}:{datetime?:string, callback:(datetime?:string)=>void}) {\r\n  const _moment = datetime?moment(datetime):defaultMoment()\r\n  const { lang } = useLangContext()\r\n  const theme = useColorScheme()\r\n  const [date, setDate] = useState(_moment.format(moment.HTML5_FMT.DATE));\r\n  const [dayType, setDayType] = useState(_moment.locale('en').format('A'))\r\n  const [hour, setHour] = useState(_moment.format('hh'))\r\n  const [minute, setMinute] = useState(_moment.format('mm'))\r\n  const [disableDays, setDisableDays] = useState<string[]>(getDisableDays(_moment))\r\n  const { setModal } = useModalsContext()\r\n  const back = ()=>{\r\n    setModal(DateTimePickerModal, null)\r\n  }\r\n  return <BottomSheet>\r\n    <View style={{flexDirection:'row', width:'100%'}}>\r\n      <View style={{flex:1, flexDirection:'row'}}>\r\n        <TouchableOpacity onPress={back}>\r\n          <Ionicons size={20} name=\"arrow-back\" color={Colors[theme].text}/>\r\n        </TouchableOpacity>\r\n      </View>\r\n      <View style={{flex:1}}>\r\n        <Text style={{fontSize:20, textAlign:'center'}}>{lang('Date & Time')}</Text>\r\n      </View>\r\n      <View style={{flex:1}}/>\r\n    </View>\r\n    <View style={{marginBottom: 20, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n    <Calendar \r\n      style={undefined} \r\n      setDate={setDate}\r\n      disableAllTouchEventsForDisabledDays={true}\r\n      onMonthChange={(v)=>setDisableDays(getDisableDays(moment(v.dateString)))}\r\n      markedDates={{\r\n        ...disableDays.reduce((p, c)=>{p[c]={disabled:true};return p}, {} as Record<string, any>),\r\n        ...(date?[date]:[]).reduce((p, c)=>{p[c]={selected:true};return p}, {} as Record<string, any>)\r\n      }}\r\n    \r\n    />\r\n    <View style={{flexDirection:'row', padding:5}}>\r\n      <Picker\r\n        selectedValue={dayType}\r\n        onValueChange={setDayType}>\r\n        {dayTypes.map(v=><Picker.Item key={v.value} label={v.label} value={v.value} />)}\r\n      </Picker>\r\n      <Text> </Text>\r\n      <Picker\r\n        selectedValue={hour}\r\n        onValueChange={setHour}>\r\n        {hours.map(v=><Picker.Item key={v.value} label={v.label} value={v.value} />)}\r\n      </Picker>\r\n      <Text> : </Text>\r\n      <Picker\r\n        selectedValue={minute}\r\n        onValueChange={setMinute}>\r\n        {minutes.map(v=><Picker.Item key={v.value} label={v.label} value={v.value} />)}\r\n      </Picker>\r\n    </View>\r\n    <View style={{flexDirection:'row'}}>\r\n      <CommonButton title={lang('save')} onPress={()=>{\r\n        callback?.(moment(`${date} ${hour}:${minute} ${dayType}`).format(moment.HTML5_FMT.DATETIME_LOCAL))\r\n        back()\r\n      }}/>\r\n      <CommonButton title={lang('cancel')} onPress={()=>{\r\n        callback?.(undefined)\r\n        back()\r\n      }}/>\r\n      \r\n    </View>\r\n  </BottomSheet>\r\n}\r\n","import React from 'react';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport CommonButton from '../components/CommonButton';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport { Text, View } from '../components/Themed';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport { BottomSheet } from '../components/ModalSection';\r\n\r\nexport default function GuestLogoutModal({id}:{id:number}) {\r\n  const { lang } = useLangContext()\r\n  const { setModal } = useModalsContext()\r\n  const {dispatch} = useAuthContext()\r\n  const back = ()=>{\r\n    setModal(GuestLogoutModal, null)\r\n  }\r\n  return <BottomSheet>\r\n    <Text>{lang('Guest users cannot reconnect after logging out. Please create an account or log in.')}</Text>\r\n    <View style={{width:'100%', flexDirection:'row', justifyContent:'flex-end'}}>\r\n      <CommonButton title={lang('sign out')} onPress={()=>dispatch({type:\"LOGOUT_REQUEST\"})}/>\r\n      <CommonButton title={lang('cancel')} onPress={()=>back()}/>\r\n    </View>\r\n  </BottomSheet>\r\n}\r\n","import React, { useState } from 'react';\r\nimport { TextInput } from 'react-native';\r\nimport Colors from '../constants/Colors';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { CustomTextInputProps } from '../types';\r\n\r\nexport default (props:CustomTextInputProps)=>{\r\n    const [contentHeight, setContentHeight] = useState<number>()\r\n    const minHeight = props.minHeight || 30\r\n    const theme = useColorScheme()\r\n    return <TextInput style={[{\r\n            borderColor:'#d0d7de', \r\n            fontSize:16, \r\n            borderWidth:1, \r\n            borderRadius:6, \r\n            paddingHorizontal:10, \r\n            paddingVertical:3, \r\n            backgroundColor:Colors[theme].background,\r\n            color:Colors[theme].text,\r\n            height:props.multiline?contentHeight:minHeight,\r\n        }, props.style]} \r\n        editable={!props.disabled} \r\n        value={props.value} \r\n        onChangeText={props.setValue}\r\n        onContentSizeChange={props.multiline?(e) => setContentHeight(Math.max(e.nativeEvent.contentSize.height, minHeight) + 2):undefined}\r\n        onBlur={()=>props.onBlur?.(props.value)}\r\n        onEndEditing={()=>props.onEndEditing?.(props.value)}\r\n        multiline={props.multiline}\r\n    />\r\n}","import React from \"react\"\r\nimport { Text, View } from \"react-native\"\r\nimport CommonItem from \"./CommonItem\"\r\nimport { UserMembership } from \"../types\"\r\nimport Avatar from \"./Avatar\"\r\n\r\nexport default ({member:item, onPress}:{member:UserMembership, onPress?:()=>void})=> {\r\n    return <CommonItem key={item.id} bodyStyle={{backgroundColor:'white', flexDirection:'row', justifyContent:'flex-start'}} onPress={onPress}>\r\n        <View style={{marginTop:4, marginRight:12}}><Avatar name={item.name} userId={item.id} size={44}/></View>\r\n        <Text style={{fontSize:20, fontWeight:'400'}}>{item.name}</Text>\r\n    </CommonItem>\r\n}","import React from 'react';\r\nimport Clipboard from '@react-native-clipboard/clipboard/dist';\r\nimport CommonButton from '../components/CommonButton';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport { Text, View } from '../components/Themed';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport { BottomSheet } from '../components/ModalSection';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport Colors from '../constants/Colors';\r\nimport { Ionicons } from '@expo/vector-icons';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { useMessengerContentMutation } from '../hooks/lists/useMessengerContentList';\r\n\r\nexport default function MessageModal({id, content}:{id:number, content:string}) {\r\n  const { lang } = useLangContext()\r\n  const { setModal } = useModalsContext()\r\n  const theme = useColorScheme()\r\n  const contentMutation = useMessengerContentMutation()\r\n  const back = ()=>{\r\n    setModal(MessageModal, null)\r\n  }\r\n  return <BottomSheet>\r\n    <View style={{flexDirection:'row', width:'100%'}}>\r\n      <View style={{flex:1, flexDirection:'row'}}>\r\n        <TouchableOpacity onPress={back}>\r\n          <Ionicons size={20} name=\"arrow-back\" color={Colors[theme].text}/>\r\n        </TouchableOpacity>\r\n      </View>\r\n      <View style={{flex:1}}>\r\n        <Text style={{fontSize:20, textAlign:'center'}}>{lang('Message')}</Text>\r\n      </View>\r\n      <View style={{flex:1}}/>\r\n    </View>\r\n    <View style={{marginBottom: 20, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n      <CommonButton style={{height:40, width:'100%', maxWidth:320, justifyContent:'center'}} title={lang('copy')} onPress={()=>{Clipboard.setString(content);back()}}/>\r\n      <CommonButton style={{height:40, width:'100%', maxWidth:320, justifyContent:'center'}} textStyle={{color:'red'}} title={lang('delete')} onPress={()=>{contentMutation.delete(id);back()}}/>\r\n  </BottomSheet>\r\n}\r\n","import React, { useEffect } from 'react';\r\nimport Profile from '../components/Profile';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport useUserMembershipList from '../hooks/lists/useUserMembershipList';\r\nimport { useMessengerChannelMutation } from '../hooks/lists/useMessengerChannelList';\r\nimport CommonButton from '../components/CommonButton';\r\nimport { Channel } from '../types';\r\nimport { navigate } from '../navigation';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport { Text, View } from '../components/Themed';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport { Ionicons } from '@expo/vector-icons';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport Colors from '../constants/Colors';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { BottomSheet } from '../components/ModalSection';\r\n\r\nexport default function ProfileModal({id}:{id:number}) {\r\n  const { lang } = useLangContext()\r\n  const theme = useColorScheme()\r\n  const {auth} = useAuthContext()\r\n  const { setModal } = useModalsContext()\r\n  const userList = useUserMembershipList(auth)\r\n  const user = userList?.find(v=>v.id==id)\r\n  const channelMutation = useMessengerChannelMutation()\r\n  const back = ()=>{\r\n    setModal(ProfileModal, null)\r\n  }\r\n  useEffect(()=>{\r\n    if (!(id && user) && userList)\r\n      back()\r\n  }, [userList])\r\n  return user?<BottomSheet>\r\n    <View style={{flexDirection:'row', width:'100%'}}>\r\n      <View style={{flex:1, flexDirection:'row'}}>\r\n        <TouchableOpacity onPress={back}>\r\n          <Ionicons size={20} name=\"arrow-back\" color={Colors[theme].text}/>\r\n        </TouchableOpacity>\r\n      </View>\r\n      <View style={{flex:1}}>\r\n        <Text style={{fontSize:20, textAlign:'center'}}>{lang('profile')}</Text>\r\n      </View>\r\n      <View style={{flex:1}}/>\r\n    </View>\r\n    <View style={{marginBottom: 20, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n    \r\n    <Profile username={user.username} name={user.name} userId={user.id} />\r\n    <CommonButton title={lang('1:1 Chat')} onPress={()=>{\r\n      if(auth?.user?.id && auth.groupId){\r\n        const newChannel:Channel = {name:\"\", type:'messenger', owner:auth?.user?.id, group:auth.groupId, subowner:user.id};\r\n        channelMutation.direct(newChannel).then(v=>navigate(\"Main\", {screen:\"ChatScreen\", params: {id:v.id}}))\r\n      }\r\n    }}/>\r\n  </BottomSheet>:<></>\r\n}\r\n","import React from 'react';\r\nimport {View} from 'react-native'\r\nimport {Text} from './Themed';\r\nimport { ProfileProps } from '../types';\r\nimport Avatar from './Avatar';\r\nimport TextButton from './TextButton';\r\nimport CommonTextInput from './CommonTextInput';\r\nimport { patchUser } from '../apis';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\n\r\nexport default (props:ProfileProps)=>{\r\n    const [name, setName] = React.useState<string>()\r\n    const { auth, dispatch } = useAuthContext()\r\n    const isSelf = auth.user?.id == props.userId\r\n    const onChange = ()=>{\r\n        isSelf && patchUser({id:props.userId, name:name || ''}).finally(()=>{\r\n            setName(undefined)\r\n            dispatch({type:\"REFRESH\"})\r\n        })\r\n    }\r\n    return <View style={{width:'100%', height:135, justifyContent:'space-evenly', alignItems:'center'}}>\r\n        <Avatar {...props} size={75}/>\r\n        {name===undefined?\r\n            <TextButton textStyle={{fontWeight:'bold', fontSize:15}} onPress={()=>isSelf && setName(props.name)} title={props.name} disabled={!isSelf}/>:\r\n            <CommonTextInput value={name} style={{textAlign:'center'}} setValue={setName} onBlur={onChange} onEndEditing={onChange} />}\r\n        <Text style={{fontWeight:'normal', fontSize:14}}>{props.username}</Text>\r\n    </View>\r\n}","import { useState,  useEffect } from \"react\"\r\nimport firebase from \"firebase/app\";\r\nimport \"firebase/messaging\";\r\n//@ts-ignore\r\nimport {FCM_PUBLIC_VAPID_KEY, FCM_API_KEY} from \"@env\"\r\nimport { Notification as NotificationType, UserMembership } from \"../types\";\r\nimport { getNotification, postNotification, putNotification } from \"../apis/notification\";\r\nimport { Auth } from \"./useAuthContext\";\r\nconst firebaseConfig = require(\"../../web/firebase-config.js\")\r\n// Initialize Firebase\r\nconst key = firebaseConfig.messagingSenderId\r\nconst apiKeyEncrypted = (FCM_API_KEY as string).split('').map((v, i)=> (v.charCodeAt(0) ^ key.charCodeAt(i)).toString(16).padStart(2, '0')).join('')\r\nconst app = firebase.initializeApp({...firebaseConfig, apiKey:FCM_API_KEY});\r\n// const analytics = getAnalytics(app);\r\nconst messaging = firebase.messaging(app);\r\n\r\nmessaging.onMessage((payload) => {\r\n  if (!(\"Notification\" in window)) {\r\n    alert(\"This browser does not support desktop notification\");\r\n  }\r\n  else if (Notification.permission === \"granted\") {\r\n    const message_set = JSON.parse(payload.data['message_set'])[0]\r\n    new Notification(payload.data.channel_name, { body: `${payload.data.name}: ${message_set.content}` });\r\n  }\r\n});\r\n\r\nconst requestToken = async()=>{\r\n  const permission = await Notification.requestPermission();\r\n  if (permission === 'granted') {\r\n    const serviceWorkerRegistration = await navigator.serviceWorker.register(`${process.env.PUBLIC_URL}/firebase-messaging-sw.js?${apiKeyEncrypted}`)\r\n    console.log('[SW]: SCOPE: ', serviceWorkerRegistration.scope);\r\n    const currentToken = await messaging.getToken({serviceWorkerRegistration, vapidKey: FCM_PUBLIC_VAPID_KEY })\r\n    window.addEventListener('beforeunload', (event:any) => {\r\n      event.preventDefault();\r\n      serviceWorkerRegistration.unregister()\r\n    });\r\n    if (currentToken)\r\n      return currentToken\r\n  }\r\n  return undefined\r\n}\r\n\r\n\r\nlet noti:NotificationType|undefined\r\nlet notiListener:((enable:boolean)=>void)[] = []\r\n\r\nconst initEnable = async(user:UserMembership, callback:(enable:boolean)=>void)=>{\r\n  notiListener.push(callback)\r\n  if (notiListener.length == 1){  \r\n    noti = await getNotification(user.id)\r\n    if (noti === undefined){\r\n      noti = await postNotification({user:user.id, type:'WEB', token:null})\r\n    }\r\n    else if(noti.token){\r\n      requestToken().then(async token=>{\r\n        if(noti)\r\n          noti = await putNotification({...noti, token:(token||null)})\r\n        notiListener.map(c=>c(noti?.token?true:false))\r\n      })\r\n    }\r\n    notiListener.map(c=>c(noti?.token?true:false))\r\n  }\r\n}\r\n\r\nconst changeEnable = async(enable:boolean)=>{\r\n  if (noti){\r\n    if(enable){\r\n      const token = await requestToken() || null\r\n      noti = await putNotification({...noti, token})\r\n    }\r\n    else{\r\n      noti = await putNotification({...noti, token:null})\r\n    }\r\n  }\r\n  return noti?.token?true:false\r\n}\r\n\r\nexport default (auth:Auth)=>{\r\n  const [enable, setEnable] = useState<boolean|null>(null)\r\n  useEffect(()=>{\r\n    if (auth.user){\r\n      if(noti === undefined)\r\n        initEnable(auth.user, setEnable)\r\n      else{\r\n        setEnable(noti.token?true:false)\r\n        noti = undefined\r\n        notiListener = []\r\n      }\r\n    }else{\r\n      setEnable(false)\r\n    }\r\n  }, [auth.user])\r\n  return {\r\n    enable,\r\n    setEnable:(_enable:boolean)=>changeEnable(_enable).then(setEnable)\r\n  }\r\n}\r\n","import { useMemo, useReducer } from \"react\"\r\n\r\ntype LocalSearchAction = {type:string, keyword?:string}\r\n\r\ntype LocalSearchState ={active:boolean, keyword:string}\r\n\r\n\r\n\r\nconst localSearchReducer =(initialState:LocalSearchState, action:LocalSearchAction)=>{\r\n    switch (action.type){\r\n        case 'SEARCH':\r\n          return {\r\n            ...initialState,\r\n            keyword: action.keyword\r\n          } as LocalSearchState\r\n        case 'ENABLE_SEARCH':\r\n          return {\r\n            ...initialState,\r\n            active:true,\r\n          }\r\n        case 'DISABLE_SEARCH':\r\n            return{\r\n                ...initialState,\r\n                active:false,\r\n                keyword: ''\r\n            }\r\n        default:\r\n            throw new Error( `Unhandled action type: ${action.type}`)\r\n    }\r\n  }\r\n\r\n\r\nexport default function useLocalSearch<T>(target:T[], compare:(value:T, keyword:string)=>boolean) {\r\n  const [searchState, dispatch] = useReducer(localSearchReducer, {active:false, keyword:''})\r\n  const data = useMemo(()=>searchState.active?target.filter(v=>compare(v, searchState.keyword)):target, [searchState, target])\r\n  return {searchState, dispatch, data}\r\n}","import React, {useRef,MutableRefObject, useMemo, useState, useEffect } from 'react';\r\nimport Clipboard from '@react-native-clipboard/clipboard/dist';\r\nimport { View, Text } from '../components/Themed';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport useUserMembershipList from '../hooks/lists/useUserMembershipList';\r\nimport { TabViewRecord, UserMembership } from '../types';\r\nimport CommonButton from '../components/CommonButton';\r\nimport useMessengerMemberList, { useMessengerMemberMutation } from '../hooks/lists/useMessengerMemberList';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport useExternalMembershipList from '../hooks/lists/useExternalMembershipList';\r\nimport TextField from '../components/TextField';\r\nimport useLocalSearch from '../hooks/useLocalSearch';\r\nimport TabView from '../components/TabView';\r\nimport { FlatList, TouchableOpacity } from 'react-native-gesture-handler';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport MemberItem from '../components/MemberItem';\r\nimport ModalSection from '../components/ModalSection';\r\n\r\nconst InviteItem = (props:{item:UserMembership, selectedRef:MutableRefObject<Set<number>>})=>{\r\n  const [selected, setSelected] = useState(props.selectedRef.current.has(props.item.id))\r\n  return <View style={selected?{borderWidth:1, borderColor:'blue'}:{}}>\r\n    <MemberItem member={props.item} onPress={()=>{\r\n      if (selected){\r\n        setSelected(false)\r\n        props.selectedRef.current.delete(props.item.id)\r\n      }\r\n      else{\r\n        setSelected(true)\r\n        props.selectedRef.current.add(props.item.id)\r\n      }\r\n    }}/>\r\n  </View>\r\n\r\n}\r\ntype InviteTabViewProps = {\r\n  id:number,\r\n  selectedRef:MutableRefObject<Set<number>>\r\n}\r\n\r\nconst GroupTabView = ({id, selectedRef}:InviteTabViewProps)=>{\r\n  const { lang } = useLangContext()\r\n  const {auth} = useAuthContext()\r\n  const { setModal } = useModalsContext()\r\n  const userList = useUserMembershipList(auth)\r\n  const memberList = useMessengerMemberList(id)\r\n  const messengerMemberMutation = useMessengerMemberMutation()\r\n  const rawData = useMemo(()=>{\r\n    const memberSet = new Set(memberList?.map(v=>v.user))\r\n    return userList?.filter(v=>!memberSet.has(v.id)) || []\r\n  }, [userList, memberList])\r\n  const {data, dispatch:dispatchKeyword, searchState} = useLocalSearch(rawData, (v, keyword)=>(v.username.includes(keyword) || v.name.includes(keyword)))\r\n  const search = (k:string)=>{\r\n    if (k?.length>0){\r\n      dispatchKeyword({type:'ENABLE_SEARCH'})\r\n      dispatchKeyword({type:'SEARCH', keyword:k})\r\n    }\r\n    else{\r\n      dispatchKeyword({type:'DISABLE_SEARCH'})\r\n    }\r\n  }\r\n  const back = ()=>{\r\n    setModal(InviteModal, null)\r\n  }\r\n  return <View style={{alignItems:'center', flex:1}}>\r\n    <View style={{'width': '100%', flex:1}}>\r\n      <TextField name={`${lang('Username')} & ${lang('Name')}`} value={searchState.keyword} setValue={search} width={'80%'}/>\r\n      {id && data && <FlatList contentContainerStyle={{flexGrow:1}} data={data} renderItem={({item})=><InviteItem item={item} selectedRef={selectedRef}/>}/>}\r\n    </View>\r\n    <View style={[{width:'100%', flexDirection:'row', padding:10,}, {justifyContent:'flex-end'}]}>\r\n      <CommonButton title={lang('invite')} onPress={()=>{\r\n        messengerMemberMutation.invite({\r\n          channel_id:id,\r\n          user_ids:[...selectedRef.current]\r\n        }).then(back)\r\n      }}/>\r\n      <CommonButton title={lang('cancel')} onPress={back}/>\r\n    </View>\r\n  </View>\r\n}\r\n\r\nconst DELAY = 500\r\n\r\nconst ExternalMembershipTabView = ({id, selectedRef}:InviteTabViewProps)=>{\r\n  const { lang } = useLangContext()\r\n  const [value, setValue] = useState('')\r\n  const [keyword, setKeyword] = useState('')\r\n  const [copied, setCopied] = useState(false)\r\n  const timeoutRef = useRef<NodeJS.Timeout>()\r\n  const { setModal } = useModalsContext()\r\n  const memberList = useMessengerMemberList(id)\r\n  const externalMemberList = useExternalMembershipList(keyword)\r\n  const data = useMemo(()=>{\r\n    const memberSet = new Set(memberList?.map(v=>v.user))\r\n    return externalMemberList?.filter(v=>!memberSet.has(v.id)) || []\r\n  }, [externalMemberList, memberList])\r\n  const messengerMemberMutation = useMessengerMemberMutation()\r\n  useEffect(()=>{\r\n    timeoutRef.current = setTimeout(()=>{\r\n      setKeyword(value)\r\n    }, DELAY)\r\n    return ()=>{timeoutRef.current && clearTimeout(timeoutRef.current)}\r\n  }, [value])\r\n  const back = ()=>{\r\n    setModal(InviteModal, null)\r\n  }\r\n  const inviteLink = location.href.replace('chat', 'invitee')\r\n  return <View style={{alignItems:'center', flex:1}}>\r\n  <TouchableOpacity style={{paddingVertical:10, flexDirection:\"row\"}} onPress={()=>{Clipboard.setString(inviteLink);setCopied(true)}}>\r\n    <Text style={{fontSize:14}}>{lang('invite link')}{\": \"}</Text>\r\n    <Text style={{fontSize:14, color:'#12b886'}}>{inviteLink}{\" \"}</Text>\r\n    {copied && <Text style={{fontSize:12, color:'red'}}>{lang(\"copied\")}</Text>}\r\n  </TouchableOpacity>\r\n  <View style={{'width': '100%', flex:1}}>\r\n    <TextField name={lang('Username')} value={value} setValue={setValue} width={'80%'}/>\r\n    {id && data && <FlatList contentContainerStyle={{flexGrow:1}} data={data} renderItem={({item})=><InviteItem item={item} selectedRef={selectedRef}/>}/>}\r\n  </View>\r\n  <View style={[{width:'100%', flexDirection:'row', padding:10,}, {justifyContent:'flex-end'}]}>\r\n    <CommonButton title={lang('invite')} onPress={()=>{\r\n      messengerMemberMutation.invite({\r\n        channel_id:id,\r\n        user_ids:[...selectedRef.current]\r\n      }).then(back)\r\n    }}/>\r\n    <CommonButton title={lang('cancel')} onPress={back}/>\r\n  </View>\r\n</View>\r\n}\r\n\r\nexport default function InviteModal({id}:{id:number}) {\r\n  const { lang } = useLangContext()\r\n  const selectedRef = useRef<Set<number>>(new Set())\r\n  const drawerTabs:TabViewRecord = {\r\n    group:{\r\n      title: 'Group',\r\n      component: ()=><GroupTabView id={id} selectedRef={selectedRef}/>,\r\n      icon: <></>\r\n    },\r\n    external:{\r\n      title: 'External members',\r\n      component: ()=><ExternalMembershipTabView id={id} selectedRef={selectedRef}/>,\r\n      icon: <></>\r\n    }\r\n  }\r\n  return <ModalSection>\r\n    <View style={{flex:1, width:'100%'}}>\r\n      <View style={{width:'100%'}}>\r\n        <Text style={{fontSize:20}}>{lang('invite')}</Text>\r\n        <View style={{marginBottom: 20, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n      </View>\r\n      <TabView tabs={drawerTabs} tabBarPosition={\"top\"}/>\r\n    </View>\r\n  </ModalSection>\r\n}\r\n\r\n","import { useQuery } from \"react-query\";\r\nimport { getExternalMembershipList } from \"../../apis\";\r\n\r\nexport default function useExternalMembershipList(keyword?:string){\r\n  const { data } = useQuery([\"UserMembershipList\", keyword] , async()=>keyword?(await getExternalMembershipList(keyword)):[])\r\n  return data\r\n}","const tintColorLight = '#2f95dc';\r\nconst tintColorDark = '#fff';\r\n\r\nexport default {\r\n  light: {\r\n    text: '#000',\r\n    background: '#fff',\r\n    tint: tintColorLight,\r\n    tabIconDefault: '#ccc',\r\n    tabIconSelected: tintColorLight,\r\n    header:'#24292f',\r\n    buttonColor:'rgb(242,242,242)',\r\n    buttonBackgroundColor: '#f6f8fa', //'rgba(9,30,66,0.08)',//rgb(242,242,242)\\\r\n    buttonBorderColor:'rgba(27,31,36,0.15)'\r\n  },\r\n  dark: {\r\n    text: '#fff',\r\n    background: '#000',\r\n    tint: tintColorDark,\r\n    tabIconDefault: '#ccc',\r\n    tabIconSelected: tintColorDark,\r\n    header:'#dbd6d1',\r\n    buttonColor:'rgb(14,14,14)',\r\n    buttonBackgroundColor: '#282624',\r\n    buttonBorderColor:'rgba(229,225,220,0.15)'\r\n  },\r\n  borderColor:'#d0d7de',\r\n  \r\n  focus:'#0065A4',\r\n};\r\n","import React, { useState } from 'react';\r\nimport { Text, StyleSheet, Pressable, StyleProp, ViewStyle} from 'react-native';\r\nimport Colors from '../constants/Colors';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { CustomButtonProps } from '../types';\r\n\r\nconst DefaultButton = (props:CustomButtonProps)=>{\r\n    const [hover, setHover] = useState(false)\r\n    return <Pressable\r\n        onPress={()=>props.onPress()}\r\n        //@ts-ignore\r\n        onHoverIn={()=>setHover(true)}\r\n        onHoverOut={()=>setHover(false)}\r\n        disabled={props.disabled}\r\n        style={[\r\n            {\r\n                paddingVertical:5, \r\n                paddingHorizontal:16\r\n            },\r\n            props.style,\r\n            (hover || props.disabled)?{backgroundColor:props.color}:{}\r\n        ]}>\r\n            {props.children?props.children:\r\n            <Text selectable={false} style={[{fontSize:14}, props.textStyle]}>{props.title}</Text>}\r\n        </Pressable>\r\n}\r\n\r\nexport default (props:CustomButtonProps)=>{\r\n    const theme = useColorScheme()\r\n    const _props = {\r\n        color:Colors[theme].buttonColor,\r\n        ...props,\r\n        style:[\r\n            styles.style,\r\n            {\r\n                backgroundColor:Colors[theme].buttonBackgroundColor,\r\n                borderColor:Colors[theme].buttonBorderColor\r\n            },\r\n            props.style,\r\n        ] as StyleProp<ViewStyle>,\r\n        textStyle:[\r\n            styles.text, \r\n            {color:Colors[theme].text},\r\n            props.textStyle\r\n        ]\r\n    }\r\n    return <DefaultButton {..._props}/>\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n    style:{\r\n        borderRadius:6, \r\n        borderWidth:1, \r\n    },\r\n    text:{\r\n        textAlign:'center', \r\n        fontWeight:'600'\r\n    }\r\n});\r\n","import axios, { AxiosRequestConfig } from 'axios';\r\n// @ts-ignore\r\nimport {API_URL} from \"@env\"\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\nexport const accountURL =  `${API_URL}/account/`\r\nconst baseURL =  `${API_URL}/messenger/`\r\nconst defaultOption:AxiosRequestConfig = {\r\n    baseURL,\r\n    withCredentials: true,\r\n    headers: {}\r\n};\r\nconst _axios = axios.create(defaultOption);\r\n\r\n_axios.interceptors.request.use(\r\n    config => {\r\n        return config;\r\n    },\r\n    error => {\r\n        return Promise.reject(error);\r\n    }\r\n)\r\n\r\n_axios.interceptors.response.use(\r\n    response => {\r\n        // if((response.request.responseURL as string).indexOf('/task/login')>=0 && response.data.length != 0){\r\n        //     // redirect login\r\n        // }\r\n        return response;\r\n    },\r\n    error => {\r\n        if (error.response.status === 401) {\r\n            return getToken().then(async(token)=>{\r\n                if (token){\r\n                    const r = await _axios.post(\"/api/v1/user/sso/refresh/\", {token}, {headers:{'Authorization':''}, baseURL: accountURL})\r\n                    if (r.status == 200 && r.data !== ''){\r\n                        setToken(r.data)\r\n                    }\r\n                }\r\n            }).finally(()=>{\r\n                return Promise.reject(error)\r\n            })\r\n        }\r\n        return Promise.reject(error)\r\n    }\r\n)\r\n\r\nexport const setToken = async (token:string|null)=>{\r\n    _axios.defaults.headers['Authorization'] = `JWT ${token}`\r\n    if (token)\r\n        await AsyncStorage.setItem(\"Authorization\", token)\r\n    else\r\n        AsyncStorage.removeItem(\"Authorization\")\r\n}\r\nexport const getToken = async ()=>{\r\n    const token = await AsyncStorage.getItem(\"Authorization\")\r\n    _axios.defaults.headers['Authorization'] = token?`JWT ${token}`:null\r\n    return token\r\n}\r\n\r\nexport default _axios\r\n","import { createIntl, createIntlCache } from \"@formatjs/intl\";\r\nimport {I18nManager} from \"react-native\";\r\nimport * as RNLocalize from \"react-native-localize\";\r\n\r\nexport const translations = {\r\n  ko: require(\"./ko.json\"),\r\n} as const;\r\n\r\ntype Translation = keyof typeof translations;\r\n\r\n// fallback if no available language fits\r\nconst fallback = { languageTag: \"en\", isRTL: false };\r\n\r\nconst { languageTag, isRTL } =\r\n  RNLocalize.findBestLanguageTag(Object.keys(translations)) ?? fallback;\r\n\r\n// update layout direction\r\nI18nManager.forceRTL(isRTL);\r\n\r\n// console.log(languageTag)\r\nconst intl = createIntl(\r\n  {\r\n    defaultLocale: \"en\",\r\n    locale: languageTag,\r\n    messages: translations[languageTag as Translation],\r\n  },\r\n  createIntlCache(),\r\n);\r\n\r\nexport default intl","import React, { createContext, useContext, useState, useEffect } from \"react\";\r\nimport { IntlShape } from \"@formatjs/intl\";\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport intl, { translations } from \"../lang\";\r\n\r\nconst IntlContext = createContext<{locale?:string, setLocale:(locale:string|undefined)=>void}>({setLocale:()=>{}});\r\n\r\nexport const IntlProvider = ({children}:{children:React.ReactNode})=>{\r\n  const [complete, setComplete] = useState(false)\r\n  const [locale, setLocale] = useState<string>()\r\n  useEffect(()=>{\r\n    AsyncStorage.getItem(\"locale\").then(v=>{\r\n      setLocale(v || undefined)\r\n      setComplete(true)\r\n    })\r\n  }, [])\r\n  return complete?<IntlContext.Provider value={{locale, setLocale}}>\r\n      {children}\r\n    </IntlContext.Provider>:<></>\r\n}\r\n\r\n\r\n\r\ntype TranslationParams = Parameters<IntlShape<string>[\"formatMessage\"]>[1];\r\n\r\nexport default ()=>{\r\n  const { locale, setLocale } = useContext(IntlContext)\r\n  return {\r\n    lang:(key: string, params?: TranslationParams) => {\r\n      if (locale == 'en' || key.length==0)\r\n        return key\r\n      if (locale != undefined && locale !='auto')\r\n        return translations[locale as 'ko'][key]\r\n      return intl\r\n        .formatMessage({ id: key, defaultMessage: key }, params)\r\n        .toString()\r\n    },\r\n    locale,\r\n    setLocale: (locale:string)=>{AsyncStorage.setItem('locale', locale).then(()=>setLocale(locale))}\r\n  }\r\n}\r\n","import React, { createContext, useContext, useEffect, useReducer, useMemo, Dispatch, useState } from \"react\"\r\nimport { checkLogin, login, logout } from \"../apis\"\r\nimport { getNotification, putNotification } from \"../apis/notification\"\r\nimport { UserMembership } from \"../types\"\r\n\r\ntype AuthAction = {type:string, username?:string, password?:string, user?:UserMembership|null}\r\n\r\nexport type Auth = {user?:UserMembership|null, groupId?:number}\r\n\r\ntype AuthState ={user?:UserMembership|null, request?:{username:string, password:string}|null}\r\n\r\nconst AuthContext = createContext<{auth:Auth, error?:string, dispatch:Dispatch<AuthAction>}>({auth:{}, dispatch:()=>{}});\r\n\r\nconst authReducer =(initialState:AuthState, action:AuthAction)=>{\r\n  switch (action.type){\r\n      case 'LOGIN_REQUEST':\r\n        return {\r\n          ...initialState,\r\n          request:{username:action.username, password:action.password},\r\n        } as AuthState\r\n      case 'LOGIN_GUEST':\r\n        return {\r\n          ...initialState,\r\n          request:{username:'guest', password:'guest'},\r\n        } as AuthState\r\n      case 'LOGIN_SUCCESS':\r\n          return{\r\n              ...initialState,\r\n              user:action.user,\r\n              request:undefined\r\n          }\r\n      case 'LOGIN_FAILED':\r\n          return{\r\n              ...initialState,\r\n              request:undefined\r\n          }\r\n      case 'LOGOUT_REQUEST':\r\n          return{\r\n              ...initialState,\r\n              request:null\r\n          }\r\n      case 'LOGOUT_SUCCESS':\r\n          return {\r\n            ...initialState,\r\n            user:null,\r\n            request:undefined\r\n          }\r\n      case 'REFRESH':\r\n        return {\r\n          ...initialState,\r\n          user:undefined\r\n        }\r\n      default:\r\n          throw new Error( `Unhandled action type: ${action.type}`)\r\n  }\r\n}\r\n\r\n\r\nexport const AuthProvider = ({children}:{children:React.ReactNode})=>{\r\n  const [authState, dispatch] = useReducer(authReducer, {} as Auth)\r\n  const [error, setError] = useState<string>()\r\n  const auth = useMemo(()=>({\r\n    user:authState.user,\r\n    groupId: authState.user?.membership_set.find(g=>g.root_group_id==null)?.group\r\n  }), [authState])\r\n  useEffect(()=>{\r\n    if(authState.user===undefined){\r\n      checkLogin().then((user)=>{\r\n        dispatch({type:\"LOGIN_SUCCESS\", user})\r\n      }).catch((e)=>{\r\n        console.log(e)\r\n        dispatch({type:\"LOGOUT_SUCCESS\"})\r\n      })\r\n    }\r\n    else if(authState.user===null && authState.request){\r\n      login(authState.request.username, authState.request.password).then(user=>{\r\n        dispatch({type:\"LOGIN_SUCCESS\", user})\r\n      }).catch((data)=>{\r\n        dispatch({type:\"LOGIN_FAILED\"})\r\n        setError(data.response?.data?.message)\r\n      })\r\n    }\r\n    else if(authState.user && authState.request===null){\r\n      getNotification(authState.user.id).then(noti=>{\r\n        noti && putNotification({...noti, token:''}).then(()=>{\r\n          logout().then(()=>dispatch({type:\"LOGOUT_SUCCESS\"}))\r\n        })\r\n      })\r\n    }\r\n  }, [authState])\r\n  return <AuthContext.Provider value={{auth, error, dispatch}}>\r\n    {children}\r\n  </AuthContext.Provider>\r\n}\r\n\r\nexport default ()=>{\r\n  const authContext = useContext(AuthContext)\r\n  return authContext\r\n}\r\n","import AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport { useTheme } from '@react-navigation/native';\r\nimport { useMemo, useEffect, useState } from 'react';\r\nimport { ColorSchemeName } from 'react-native';\r\nimport { Appearance, ColorSchemeName as UserColorSchemeName } from 'react-native-appearance';\r\n\r\n// The useColorScheme value is always either light or dark, but the built-in\r\n// type suggests that it can be null. This will not happen in practice, so this\r\n// makes it a bit easier to work with.\r\n\r\nexport function useInitColorScheme(){\r\n  const [complete, setComplete] = useState(false)\r\n  useEffect(()=>{\r\n    if (!complete){\r\n      AsyncStorage.getItem(\"color\").then(v=>{\r\n        Appearance.set({colorScheme:(v==null)?'no-preference':(v as any)})\r\n        setComplete(true)\r\n      })\r\n    }\r\n  }, [complete])\r\n  return complete\r\n}\r\n\r\nexport function setColorScheme(colorScheme:UserColorSchemeName){\r\n  AsyncStorage.setItem('color',colorScheme as string).then(()=>Appearance.set({colorScheme}))\r\n}\r\n\r\nexport default function useColorScheme(): NonNullable<ColorSchemeName> {\r\n  const { dark } = useTheme()\r\n  const colorScheme = useMemo(()=> dark?'dark':'light', [dark]) as NonNullable<ColorSchemeName>;\r\n  return colorScheme\r\n}\r\n","import React, { useState, createContext, useContext, useEffect } from \"react\";\r\nimport { Modal } from \"react-native\";\r\nimport useResizeContext from \"./useResizeContext\";\r\n\r\ntype ModalProps = any\r\n\r\ntype ModalState = {\r\n  Component:React.ComponentType<ModalProps>,\r\n  props:any\r\n  visible:boolean\r\n}\r\ntype SetModal = (Component:ModalState[\"Component\"]|null, props:ModalProps|null)=>void\r\n\r\nconst ModalsContext = createContext<{setModal: SetModal}>({\r\n    setModal: () => {}\r\n});\r\n\r\nexport const ModalsProvider = ({children, modals:allModals}:{children:React.ReactNode, modals:React.ComponentType<ModalProps>[]}) => {\r\n    const [modals, setModals] = useState<ModalState[]>([]);\r\n    const windowType = useResizeContext();\r\n    const [animationType, setAnimationType] = useState('none')\r\n    const setModal:SetModal = (Component, props) => {\r\n        const newModals = modals.map(m=>{\r\n            if(Component==null){\r\n                return {\r\n                    ...m,\r\n                    visible:false\r\n                }\r\n            }\r\n            else if(m.Component == Component){\r\n                return {\r\n                    Component, \r\n                    props:props!==null?props:m.props,\r\n                    visible:props!==null\r\n                }\r\n            }\r\n            return m        \r\n        })\r\n        setModals(newModals);\r\n    }\r\n    useEffect(()=>{\r\n        if (modals.filter(v=>v.visible).length == 0)\r\n            setAnimationType(windowType == 'landscape'?'fade':'slide')\r\n    }, [windowType])\r\n    useEffect(()=>{\r\n        setModals(allModals.map((Component)=>({Component, props:null, visible:false})))\r\n    }, [allModals])\r\n    return <ModalsContext.Provider value={{setModal}}>\r\n        {children}\r\n        {modals.map((modal, index)=>{\r\n            const { Component, props, visible } = modal;\r\n            return <Modal key={index} animationType={animationType as any} visible={visible} transparent>\r\n                <Component {...props}/>\r\n            </Modal>\r\n        })}\r\n    </ModalsContext.Provider>\r\n}\r\n\r\nexport default ()=>{\r\n    const modalsContext = useContext(ModalsContext)\r\n    return modalsContext\r\n}\r\n\r\n","\r\nimport { User, UserMembership } from '../types';\r\nimport axios, { getToken, setToken, accountURL as baseURL } from './axios';\r\n\r\nexport const login = async(username:string, password:string) => {\r\n    if(username.endsWith('.guest') && password.length == 0)\r\n        password = 'guest'\r\n    const r = await axios.post(\"/api-token-auth/\", {username, password});\r\n    if(r.status == 200){\r\n        await setToken(r.data)\r\n        return await checkLogin()\r\n    }\r\n}\r\n\r\nexport const logout = async() => {\r\n    await setToken(null)\r\n    return await axios.get(\"/api-auth/logout/\")\r\n}\r\n\r\nexport const guestLogin =  async() => {\r\n    return await login('guest', 'guest')\r\n}\r\n\r\nconst checkLoginToken = async ()=>{\r\n    const value = (await axios.get(\"/api/v1/users/memberships/?_self=true\"))?.data\r\n    if (value && value.length){\r\n        return value[0] as UserMembership\r\n    }\r\n    return null\r\n}\r\n\r\nexport const checkLogin = async() => {\r\n    const token = await getToken()\r\n    if (token === null)\r\n        return null\r\n    try{\r\n       return await checkLoginToken()\r\n    }\r\n    catch(e:any){\r\n        let error = e\r\n        if(e.response !== undefined && e.response.status==401){\r\n            try{\r\n                return await checkLoginToken()\r\n            }\r\n            catch(e2){\r\n                error = e2\r\n            }\r\n        }\r\n        const isOffline = ((error as any).code == \"ERR_NETWORK\" || (error as any).message && ((error as any).message as string).startsWith(\"Cannot read\"))\r\n        throw {error, isOffline}\r\n    }\r\n}\r\n\r\nexport const getUserList = async (group_id:number)=>{\r\n    return (await axios.get(`/api/v1/users/?group_id=${group_id}`) ).data as User[]\r\n}\r\n\r\nexport const patchUser = async (user:{id:number, name:string})=>{\r\n    await axios.patch(`/api/v1/user/`, {ids:[user.id], updated: {name:user.name}}, {baseURL})\r\n}\r\n\r\nexport const getUserMembershipList = async (group_id:number)=>{\r\n    return (await axios.get(`/api/v1/users/memberships/?group_id=${group_id}`) ).data as UserMembership[]\r\n}\r\n\r\nexport const getExternalMembershipList = async (username:string)=>{\r\n    return (await axios.get(`/api/v1/users/memberships/?username=${username}`) ).data as UserMembership[]\r\n}","import { Channel, MessengerMember, MessengerContent, EditMessage, MessengerChannel } from '../types';\r\nimport axios from './axios';\r\n\r\nexport const getMessengerChannelList = async (user_id:number)=>{\r\n    return (await axios.get(`/api/v1/channels/messenger/?type=messenger&messenger_user_id=${user_id}`) ).data as MessengerChannel[]\r\n}\r\n\r\nexport const postChannel = async(channel:Channel)=>{\r\n    return (await axios.post(`/api/v1/channels/`, channel)).data as Channel\r\n}\r\n\r\nexport const postDirectChannel = async(channel:Channel)=>{\r\n    return (await axios.post(`/api/v1/channels/direct/`, channel)).data as Channel\r\n}\r\n\r\nexport const putChannel = async(channel:Channel)=>{\r\n    return (await axios.put(`/api/v1/channels/${channel.id}/`, channel)).data as Channel\r\n}\r\n\r\nexport const deleteChannel = async(channel_id:number)=>{\r\n    await axios.delete(`/api/v1/channels/${channel_id}/`)\r\n}\r\n\r\nexport const getMessengerMemberList = async(channel_id:number)=>{\r\n    try{\r\n        return (await axios.get(`/api/v1/messengermembers/?channel=${channel_id}`) ).data as MessengerMember[]\r\n    }\r\n    catch(e){\r\n        return Promise.resolve(null)\r\n    }\r\n}\r\n\r\nexport const postBulkMessengerMember = async(data:{channel_id:number, user_ids:number[]})=>{\r\n    await axios.post(`/api/v1/messengermembers/bulk/`, {channel:data.channel_id, user_ids:data.user_ids})\r\n}\r\n\r\nexport const deleteMessengerMember = async(member_id:number)=>{\r\n    await axios.delete(`/api/v1/messengermembers/${member_id}/`)\r\n}\r\n\r\nexport const getMessengerContentList = async (channel_id:number, id_lt?:number)=>{\r\n    const id_lt_param = id_lt?`&id_lt=${id_lt}`:''\r\n    return (await axios.get(`/api/v1/messengercontents/?limit=30&channel=${channel_id}${id_lt_param}`)).data.results as MessengerContent[]\r\n}\r\n\r\nexport const getTimerMessageContentList = async (channel_id:number, timer_gt:string)=>{\r\n    return (await axios.get(`/api/v1/messengercontents/?channel=${channel_id}&timer_gt=${timer_gt}`)).data as MessengerContent[]\r\n}\r\n\r\nexport const postMessage = async (message:EditMessage)=>{\r\n    if (message.file){\r\n        const formData = new FormData(); // formData  .\r\n        formData.append(\"file\", message.file)\r\n        Object.entries(message).forEach(value=>{\r\n            formData.append(value[0], `${value[1]}`)\r\n        })\r\n        await axios.post(`/api/v1/messengercontents/messages/`, formData, {headers:{\r\n            ...(axios.defaults.headers as any), \"Content-Type\": \"multipart/form-data\",\r\n        }})\r\n    }\r\n    else{\r\n        await axios.post(`/api/v1/messengercontents/messages/`, message)\r\n    }\r\n}\r\n\r\nexport const deleteMessengerContent = async (content_id:number)=>{\r\n    await axios.delete(`/api/v1/messengercontents/${content_id}/`)\r\n}","/**\r\n * Learn more about deep linking with React Navigation\r\n * https://reactnavigation.org/docs/deep-linking\r\n * https://reactnavigation.org/docs/configuring-links\r\n */\r\n\r\nimport { LinkingOptions } from '@react-navigation/native';\r\nimport * as Linking from 'expo-linking';\r\nimport {main, login, modal} from '../screens';\r\n\r\nconst ROOTPATH = 'tokki-tok'  // github repository name\r\n\r\nObject.values(modal).forEach(v=>v.path = ROOTPATH + '/' + v.path)\r\n\r\nexport default  {\r\n  prefixes: [Linking.makeUrl('/')],\r\n  config: {\r\n    screens: {\r\n      Main: {\r\n        screens:{\r\n          ...main,\r\n          ...login,\r\n          NotFound: '*',\r\n        },\r\n        path: ROOTPATH\r\n      },\r\n      ...modal\r\n    },\r\n  },\r\n} as LinkingOptions;\r\n","import { StackScreenProps } from '@react-navigation/stack';\r\nimport * as React from 'react';\r\nimport { StyleSheet, Text, TouchableOpacity, View } from 'react-native';\r\nimport useLangContext from '../hooks/useLangContext';\r\n\r\nexport default function NotFoundScreen({\r\n  navigation,\r\n}: StackScreenProps<any, 'NotFound'>) {\r\n  const { lang } = useLangContext()\r\n  return (\r\n    <View style={styles.container}>\r\n      <Text style={styles.title}>{lang(\"This screen doesn't exist.\")}</Text>\r\n      <TouchableOpacity onPress={() => navigation.replace('HomeScreen')} style={styles.link}>\r\n        <Text style={styles.linkText}>{lang(\"Go to home screen!\")}</Text>\r\n      </TouchableOpacity>\r\n    </View>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: '#fff',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    padding: 20,\r\n  },\r\n  title: {\r\n    fontSize: 20,\r\n    fontWeight: 'bold',\r\n  },\r\n  link: {\r\n    marginTop: 15,\r\n    paddingVertical: 15,\r\n  },\r\n  linkText: {\r\n    fontSize: 14,\r\n    color: '#2e78b7',\r\n  },\r\n});\r\n","import { useTheme } from '@react-navigation/native';\r\nimport React, { useState } from 'react';\r\nimport { View, StyleSheet } from 'react-native';\r\nimport Profile from '../components/Profile';\r\nimport TextButton from '../components/TextButton';\r\nimport Colors from '../constants/Colors';\r\nimport useResizeContext from '../hooks/useResizeContext';\r\nimport TabView from '../components/TabView';\r\nimport { MessengerChannel, TabViewRecord, User, UserMembership } from '../types';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport ChannelEditModal from '../modals/ChannelEditModal';\r\nimport CommonItem from '../components/CommonItem';\r\nimport { Text } from '../components/Themed';\r\nimport useAuthContext, { Auth } from '../hooks/useAuthContext';\r\nimport { useMessengerChannelSorted } from '../hooks/lists/useMessengerChannelList';\r\nimport { navigate } from '.'\r\nimport { avatarFromChannel } from '../components/Avatar';\r\n\r\nconst DrawerTabView = (props:{auth:Auth, data:(MessengerChannel & {onPress?:()=>void})[]})=><View style={{flex:1}}>\r\n    {props.data.map((item, index)=>{\r\n      const {name} = avatarFromChannel(item, props.auth.user)\r\n      return <CommonItem key={index} containerStyle={{marginHorizontal:0}} bodyStyle={{alignItems:'flex-start'}} onPress={item.onPress}>\r\n        <Text style={{marginLeft:20}}>{name}</Text>\r\n      </CommonItem>\r\n    })}\r\n</View>\r\n\r\nconst MessengerTabView = ()=>{\r\n  const {auth} = useAuthContext()\r\n  const channelList = useMessengerChannelSorted(auth);\r\n  return <DrawerTabView auth={auth} data={(channelList || []).map(item=>({...item, onPress:()=>navigate(\"ChatScreen\", {id:item.id})}))}/>\r\n}\r\n\r\nconst drawerTabs:TabViewRecord = {\r\n  MessengerTab:{\r\n      title:'messenger',\r\n      component:MessengerTabView,\r\n      icon:<></>\r\n  },\r\n}\r\n\r\nexport default ({user}:{user:UserMembership})=> {\r\n  const { colors } = useTheme();\r\n  const windowType = useResizeContext();\r\n  const [index, setIndex] = useState(0);\r\n  const { setModal } = useModalsContext()\r\n  const onAddList = [\r\n    ()=>setModal(ChannelEditModal, {type:'messenger'}),\r\n    ()=>setModal(ChannelEditModal, {type:'board'})\r\n  ]\r\n  return <View style={windowType=='landscape'?[\r\n      styles.tabBar,\r\n      {\r\n        backgroundColor: colors.card,\r\n        borderTopColor: colors.border,\r\n      },\r\n      // tabBarStyle,\r\n    ]:{width:0}}\r\n    pointerEvents={false ? 'none' : 'auto'}\r\n  >\r\n    <Profile userId={user.id} username={user.username} name={user.name}/>\r\n    {windowType=='landscape' && <>\r\n      <View style={{flexDirection:'row-reverse'}}>\r\n          <TextButton title='+' textStyle={{fontSize:20}} style={{borderRadius:20}} onPress={onAddList[index]}/>\r\n      </View>\r\n      <View accessibilityRole=\"tablist\" style={styles.content}>\r\n        {Object.keys(drawerTabs).length>1 ? \r\n          <TabView tabs={drawerTabs} tabBarPosition={\"top\"} onTab={setIndex}/>: \r\n          <View style={{borderTopWidth:1, flex:1, borderColor:colors.border}}>            \r\n            {Object.values(drawerTabs).map(drawerTab=>{const Tab = drawerTab.component; return <Tab key={drawerTab.title}/>})}\r\n          </View>\r\n        }\r\n      </View>\r\n    </>}\r\n  </View>\r\n}\r\n\r\n{/*<Text style={[styles.label, { color: d.isFocused ? colors.primary : '#222' }]}></Text> */}\r\n\r\nconst styles = StyleSheet.create({\r\n    tabBar: {\r\n      width:240,\r\n      elevation: 8,\r\n      borderRightWidth:1,\r\n      borderColor:Colors.borderColor\r\n    },\r\n    content: {\r\n      flex: 1,\r\n      flexDirection: 'row',\r\n    },\r\n    tab: {\r\n        flex: 1,\r\n        alignItems: 'center',\r\n    },\r\n    label: {\r\n        textAlign: 'center',\r\n        backgroundColor: 'transparent',\r\n      },\r\n  });","import InviteModal from \"./InviteModal\";\r\nimport ProfileModal from \"./ProfileModal\";\r\nimport ChannelEditModal from \"./ChannelEditModal\"\r\nimport GuestLogoutModal from \"./GuestLogoutModal\";\r\nimport DateTimePickerModal from \"./DateTimePickerModal\"\r\nimport MessageModal from \"./MessageModal\";\r\n\r\nexport default [\r\n    InviteModal,\r\n    ProfileModal,\r\n    ChannelEditModal,\r\n    GuestLogoutModal,\r\n    DateTimePickerModal,\r\n    MessageModal\r\n]","import { CardStyleInterpolators, createStackNavigator } from '@react-navigation/stack';\r\nimport React, {useMemo} from 'react';\r\nimport { View } from 'react-native';\r\nimport { Ionicons } from '@expo/vector-icons';\r\nimport useResizeContext from '../hooks/useResizeContext';\r\nimport NotFoundScreen from '../screens/NotFoundScreen';\r\nimport {main, login, modal} from '../screens';\r\nimport DrawerNavigator from './DrawerNavigator';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport { WebSocketProvider } from '../hooks/useWebsocketContext';\r\nimport HeaderRight from '../components/HeaderRight'\r\nimport Colors from '../constants/Colors';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport useFirebaseContext from '../hooks/useFirebaseContext';\r\nimport useIsMobile from '../hooks/useIsMobile';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { ModalsProvider } from '../hooks/useModalsContext';\r\nimport modals from '../modals';\r\nimport useLangContext from '../hooks/useLangContext';\r\n\r\nconst Root = createStackNavigator();\r\n\r\nexport default function RootNavigator() {\r\n    const windowType = useResizeContext();\r\n    return <Root.Navigator\r\n        mode= 'modal'\r\n        headerMode= 'screen'\r\n        screenOptions={{\r\n            cardStyle:{backgroundColor:\"white\"},\r\n            animationEnabled: true,\r\n            cardStyleInterpolator: CardStyleInterpolators.forVerticalIOS,\r\n        }}\r\n    >\r\n        <Root.Screen name=\"Main\" component={MainNavigator} options={{headerShown:false}}/>\r\n        {Object.entries(modal).map(([key, screen])=><Root.Screen key={key} name={key} component={screen.component} options={{\r\n            title: screen.title,\r\n            gestureDirection: windowType == 'landscape'?'vertical-inverted':'vertical'\r\n        }} />)}\r\n    </Root.Navigator>\r\n}\r\n\r\nconst Main = createStackNavigator();\r\n\r\nfunction headerLeft(navigation:any, route:any, windowType:string, isMobile:boolean){\r\n    const canGOBackScreen = ['HomeScreen', 'LoginScreen'].findIndex(v=>v == route.name) == -1\r\n    const goBack = ()=>{\r\n        if (navigation.canGoBack())\r\n            navigation.goBack()\r\n        else if (canGOBackScreen)\r\n            navigation.replace('HomeScreen')\r\n    }\r\n    if (windowType=='portrait' && canGOBackScreen)\r\n        return <TouchableOpacity onPress={goBack}><Ionicons size={isMobile?20:24} style={{marginHorizontal:isMobile?16:20 }} name=\"arrow-back\"/></TouchableOpacity>\r\n    return null\r\n}\r\n\r\nconst MainNavigator = ()=>{\r\n    const windowType = useResizeContext();\r\n    const isMobile = useIsMobile()\r\n    const {auth} = useAuthContext()\r\n    const theme = useColorScheme()\r\n    const {lang, locale} = useLangContext()\r\n    const entries = useMemo(()=>{\r\n        if (auth.user === undefined)\r\n            return []\r\n        console.log('current user: ', auth.user)\r\n        return Object.entries(auth.user === null?login:main)\r\n    }, [auth, locale])\r\n    const modalValues = useMemo(()=>{\r\n        if (auth.user === undefined)\r\n            return []\r\n        return auth.user === null?[]:modals\r\n    }, [auth])\r\n\r\n    const {enable:noti} = useFirebaseContext(auth)\r\n    return (auth.user!==undefined && noti!=null?<View style={{flexDirection:'row', flex:1}}>\r\n        <ModalsProvider modals={modalValues}>\r\n            {auth.user?<DrawerNavigator user={auth.user}/>:undefined}\r\n            <View style={{flex:1}}>\r\n                <WebSocketProvider disable={auth.user === null || auth.user === undefined}>\r\n                        <Main.Navigator\r\n                            screenOptions={({navigation, route})=>({\r\n                                headerStyle:{backgroundColor:Colors[theme].header, height:isMobile?50:undefined},\r\n                                headerTitleStyle:{color:'white'},\r\n                                headerLeft:()=>headerLeft(navigation, route, windowType, isMobile),\r\n                                headerRight:()=><HeaderRight/>,\r\n                                headerLeftContainerStyle:{backgroundColor:'white', borderBottomWidth:1, borderColor:Colors.borderColor},\r\n                                cardStyle:{flexShrink:1},\r\n                                animationEnabled:windowType=='portrait',\r\n                                cardStyleInterpolator: CardStyleInterpolators.forHorizontalIOS\r\n                            })}\r\n                        >\r\n                            {entries.map(([key, screen])=><Main.Screen key={key} name={key} component={screen.component} options={{ title: lang(screen.title) }} />)}\r\n                            <Main.Screen name=\"NotFound\" component={NotFoundScreen} options={{ title: 'Oops!' }} />\r\n                        </Main.Navigator>\r\n                </WebSocketProvider>\r\n            </View>\r\n        </ModalsProvider>\r\n    </View>:<></>);\r\n}","import React, { useEffect, useState } from 'react'\r\nimport { Dimensions, Platform, View } from 'react-native'\r\nimport useIsMobile from '../hooks/useIsMobile'\r\n\r\n\r\nexport default (props:{children:React.ReactNode})=>{\r\n    const isMobile = useIsMobile()\r\n    const [height, setHeight] = useState(window.innerHeight + 1)\r\n    useEffect(()=>{\r\n        if(isMobile && Platform.OS == 'web'){\r\n            const onChange = (e:any)=>{\r\n                setHeight(window.innerHeight + 1)\r\n            }\r\n            Dimensions.addEventListener(\"change\",onChange)\r\n            return () => Dimensions.removeEventListener(\"change\", onChange)\r\n            \r\n        }\r\n    },[ isMobile])\r\n    return <View style={{height:isMobile&&Platform.OS == 'web'?height:'100%'}}>\r\n        {props.children}\r\n    </View>\r\n\r\n}\r\n  ","import React from 'react';\r\nimport { StatusBar } from 'expo-status-bar';\r\nimport { SafeAreaProvider } from 'react-native-safe-area-context';\r\nimport Navigation from './src/navigation';\r\nimport useCachedResources from './src/hooks/useCachedResources';\r\nimport { useInitColorScheme } from './src/hooks/useColorScheme';\r\nimport MobileSafeAreaView from './src/components/MobileSafeAreaView';\r\nimport { AuthProvider } from './src/hooks/useAuthContext';\r\nimport { QueryClient, QueryClientProvider } from 'react-query';\r\nimport { IntlProvider } from './src/hooks/useLangContext';\r\n\r\nconst queryClient = new QueryClient();\r\n\r\nexport default function App() {\r\n  const isLoadingComplete = useCachedResources();\r\n  const isAppearenceComplete = useInitColorScheme()\r\n  if (!isLoadingComplete || !isAppearenceComplete) {\r\n    return null;\r\n  } else {\r\n    return (\r\n      <SafeAreaProvider>\r\n        <MobileSafeAreaView>\r\n          <AuthProvider>\r\n            <QueryClientProvider client={queryClient}>\r\n              <IntlProvider>\r\n                {/* devtools */}\r\n                {/* <ReactQueryDevtools initialIsOpen={true} /> */}\r\n                <Navigation/>\r\n                <StatusBar />\r\n              </IntlProvider>\r\n            </QueryClientProvider>\r\n          </AuthProvider>\r\n        </MobileSafeAreaView>\r\n      </SafeAreaProvider>\r\n    );\r\n  }\r\n}\r\n","import { Ionicons } from '@expo/vector-icons';\r\nimport * as Font from 'expo-font';\r\nimport * as SplashScreen from 'expo-splash-screen';\r\nimport * as React from 'react';\r\n\r\nexport default function useCachedResources() {\r\n  const [isLoadingComplete, setLoadingComplete] = React.useState(false);\r\n\r\n  // Load any resources or data that we need prior to rendering the app\r\n  React.useEffect(() => {\r\n    async function loadResourcesAndDataAsync() {\r\n      try {\r\n        SplashScreen.preventAutoHideAsync();\r\n\r\n        // Load fonts\r\n        await Font.loadAsync({\r\n          ...Ionicons.font,\r\n          'space-mono': require('../assets/fonts/SpaceMono-Regular.ttf'),\r\n        });\r\n      } catch (e) {\r\n        // We might want to provide this error information to an error reporting service\r\n        console.warn(e);\r\n      } finally {\r\n        setLoadingComplete(true);\r\n        SplashScreen.hideAsync();\r\n      }\r\n    }\r\n\r\n    loadResourcesAndDataAsync();\r\n  }, []);\r\n\r\n  return isLoadingComplete;\r\n}\r\n","import React, { useState, useEffect, createContext, useContext, useMemo } from 'react';\r\nimport { Dimensions, ScaledSize, useWindowDimensions } from 'react-native';\r\n//@ts-ignore\r\nimport useMobileDetect from 'use-mobile-detect-hook';\r\n\r\ntype WindowType = 'portrait' | 'landscape'\r\n\r\nconst getWindowType = (window:{width:number, height:number})=> window.height >= window.width?'portrait':'landscape' as WindowType;\r\n\r\nconst ResizeContextContext = createContext<WindowType>(getWindowType(Dimensions.get('window')));\r\n\r\nexport const ResizeContextProvider = ({children}:{children:React.ReactNode})=>{\r\n  const detectMobile = useMobileDetect();\r\n  const {width, height} = useWindowDimensions()\r\n  const [windowType, setWindowType] = useState(getWindowType({width, height}))\r\n  useEffect(()=>{\r\n    setWindowType(getWindowType({width, height}))\r\n  }, [width, height])\r\n  return <ResizeContextContext.Provider value={detectMobile.isMobile()?'portrait':windowType}>\r\n    {children}\r\n  </ResizeContextContext.Provider>\r\n}\r\n\r\nexport default function useResizeContext() {\r\n  const windowType = useContext(ResizeContextContext)\r\n  return windowType\r\n}","var map = {\n\t\"./af\": 451,\n\t\"./af.js\": 451,\n\t\"./ar\": 452,\n\t\"./ar-dz\": 453,\n\t\"./ar-dz.js\": 453,\n\t\"./ar-kw\": 454,\n\t\"./ar-kw.js\": 454,\n\t\"./ar-ly\": 455,\n\t\"./ar-ly.js\": 455,\n\t\"./ar-ma\": 456,\n\t\"./ar-ma.js\": 456,\n\t\"./ar-sa\": 457,\n\t\"./ar-sa.js\": 457,\n\t\"./ar-tn\": 458,\n\t\"./ar-tn.js\": 458,\n\t\"./ar.js\": 452,\n\t\"./az\": 459,\n\t\"./az.js\": 459,\n\t\"./be\": 460,\n\t\"./be.js\": 460,\n\t\"./bg\": 461,\n\t\"./bg.js\": 461,\n\t\"./bm\": 462,\n\t\"./bm.js\": 462,\n\t\"./bn\": 463,\n\t\"./bn-bd\": 464,\n\t\"./bn-bd.js\": 464,\n\t\"./bn.js\": 463,\n\t\"./bo\": 465,\n\t\"./bo.js\": 465,\n\t\"./br\": 466,\n\t\"./br.js\": 466,\n\t\"./bs\": 467,\n\t\"./bs.js\": 467,\n\t\"./ca\": 468,\n\t\"./ca.js\": 468,\n\t\"./cs\": 469,\n\t\"./cs.js\": 469,\n\t\"./cv\": 470,\n\t\"./cv.js\": 470,\n\t\"./cy\": 471,\n\t\"./cy.js\": 471,\n\t\"./da\": 472,\n\t\"./da.js\": 472,\n\t\"./de\": 473,\n\t\"./de-at\": 474,\n\t\"./de-at.js\": 474,\n\t\"./de-ch\": 475,\n\t\"./de-ch.js\": 475,\n\t\"./de.js\": 473,\n\t\"./dv\": 476,\n\t\"./dv.js\": 476,\n\t\"./el\": 477,\n\t\"./el.js\": 477,\n\t\"./en-au\": 478,\n\t\"./en-au.js\": 478,\n\t\"./en-ca\": 479,\n\t\"./en-ca.js\": 479,\n\t\"./en-gb\": 480,\n\t\"./en-gb.js\": 480,\n\t\"./en-ie\": 481,\n\t\"./en-ie.js\": 481,\n\t\"./en-il\": 482,\n\t\"./en-il.js\": 482,\n\t\"./en-in\": 483,\n\t\"./en-in.js\": 483,\n\t\"./en-nz\": 484,\n\t\"./en-nz.js\": 484,\n\t\"./en-sg\": 485,\n\t\"./en-sg.js\": 485,\n\t\"./eo\": 486,\n\t\"./eo.js\": 486,\n\t\"./es\": 487,\n\t\"./es-do\": 488,\n\t\"./es-do.js\": 488,\n\t\"./es-mx\": 489,\n\t\"./es-mx.js\": 489,\n\t\"./es-us\": 490,\n\t\"./es-us.js\": 490,\n\t\"./es.js\": 487,\n\t\"./et\": 491,\n\t\"./et.js\": 491,\n\t\"./eu\": 492,\n\t\"./eu.js\": 492,\n\t\"./fa\": 493,\n\t\"./fa.js\": 493,\n\t\"./fi\": 494,\n\t\"./fi.js\": 494,\n\t\"./fil\": 495,\n\t\"./fil.js\": 495,\n\t\"./fo\": 496,\n\t\"./fo.js\": 496,\n\t\"./fr\": 497,\n\t\"./fr-ca\": 498,\n\t\"./fr-ca.js\": 498,\n\t\"./fr-ch\": 499,\n\t\"./fr-ch.js\": 499,\n\t\"./fr.js\": 497,\n\t\"./fy\": 500,\n\t\"./fy.js\": 500,\n\t\"./ga\": 501,\n\t\"./ga.js\": 501,\n\t\"./gd\": 502,\n\t\"./gd.js\": 502,\n\t\"./gl\": 503,\n\t\"./gl.js\": 503,\n\t\"./gom-deva\": 504,\n\t\"./gom-deva.js\": 504,\n\t\"./gom-latn\": 505,\n\t\"./gom-latn.js\": 505,\n\t\"./gu\": 506,\n\t\"./gu.js\": 506,\n\t\"./he\": 507,\n\t\"./he.js\": 507,\n\t\"./hi\": 508,\n\t\"./hi.js\": 508,\n\t\"./hr\": 509,\n\t\"./hr.js\": 509,\n\t\"./hu\": 510,\n\t\"./hu.js\": 510,\n\t\"./hy-am\": 511,\n\t\"./hy-am.js\": 511,\n\t\"./id\": 512,\n\t\"./id.js\": 512,\n\t\"./is\": 513,\n\t\"./is.js\": 513,\n\t\"./it\": 514,\n\t\"./it-ch\": 515,\n\t\"./it-ch.js\": 515,\n\t\"./it.js\": 514,\n\t\"./ja\": 516,\n\t\"./ja.js\": 516,\n\t\"./jv\": 517,\n\t\"./jv.js\": 517,\n\t\"./ka\": 518,\n\t\"./ka.js\": 518,\n\t\"./kk\": 519,\n\t\"./kk.js\": 519,\n\t\"./km\": 520,\n\t\"./km.js\": 520,\n\t\"./kn\": 521,\n\t\"./kn.js\": 521,\n\t\"./ko\": 522,\n\t\"./ko.js\": 522,\n\t\"./ku\": 523,\n\t\"./ku.js\": 523,\n\t\"./ky\": 524,\n\t\"./ky.js\": 524,\n\t\"./lb\": 525,\n\t\"./lb.js\": 525,\n\t\"./lo\": 526,\n\t\"./lo.js\": 526,\n\t\"./lt\": 527,\n\t\"./lt.js\": 527,\n\t\"./lv\": 528,\n\t\"./lv.js\": 528,\n\t\"./me\": 529,\n\t\"./me.js\": 529,\n\t\"./mi\": 530,\n\t\"./mi.js\": 530,\n\t\"./mk\": 531,\n\t\"./mk.js\": 531,\n\t\"./ml\": 532,\n\t\"./ml.js\": 532,\n\t\"./mn\": 533,\n\t\"./mn.js\": 533,\n\t\"./mr\": 534,\n\t\"./mr.js\": 534,\n\t\"./ms\": 535,\n\t\"./ms-my\": 536,\n\t\"./ms-my.js\": 536,\n\t\"./ms.js\": 535,\n\t\"./mt\": 537,\n\t\"./mt.js\": 537,\n\t\"./my\": 538,\n\t\"./my.js\": 538,\n\t\"./nb\": 539,\n\t\"./nb.js\": 539,\n\t\"./ne\": 540,\n\t\"./ne.js\": 540,\n\t\"./nl\": 541,\n\t\"./nl-be\": 542,\n\t\"./nl-be.js\": 542,\n\t\"./nl.js\": 541,\n\t\"./nn\": 543,\n\t\"./nn.js\": 543,\n\t\"./oc-lnc\": 544,\n\t\"./oc-lnc.js\": 544,\n\t\"./pa-in\": 545,\n\t\"./pa-in.js\": 545,\n\t\"./pl\": 546,\n\t\"./pl.js\": 546,\n\t\"./pt\": 547,\n\t\"./pt-br\": 548,\n\t\"./pt-br.js\": 548,\n\t\"./pt.js\": 547,\n\t\"./ro\": 549,\n\t\"./ro.js\": 549,\n\t\"./ru\": 550,\n\t\"./ru.js\": 550,\n\t\"./sd\": 551,\n\t\"./sd.js\": 551,\n\t\"./se\": 552,\n\t\"./se.js\": 552,\n\t\"./si\": 553,\n\t\"./si.js\": 553,\n\t\"./sk\": 554,\n\t\"./sk.js\": 554,\n\t\"./sl\": 555,\n\t\"./sl.js\": 555,\n\t\"./sq\": 556,\n\t\"./sq.js\": 556,\n\t\"./sr\": 557,\n\t\"./sr-cyrl\": 558,\n\t\"./sr-cyrl.js\": 558,\n\t\"./sr.js\": 557,\n\t\"./ss\": 559,\n\t\"./ss.js\": 559,\n\t\"./sv\": 560,\n\t\"./sv.js\": 560,\n\t\"./sw\": 561,\n\t\"./sw.js\": 561,\n\t\"./ta\": 562,\n\t\"./ta.js\": 562,\n\t\"./te\": 563,\n\t\"./te.js\": 563,\n\t\"./tet\": 564,\n\t\"./tet.js\": 564,\n\t\"./tg\": 565,\n\t\"./tg.js\": 565,\n\t\"./th\": 566,\n\t\"./th.js\": 566,\n\t\"./tk\": 567,\n\t\"./tk.js\": 567,\n\t\"./tl-ph\": 568,\n\t\"./tl-ph.js\": 568,\n\t\"./tlh\": 569,\n\t\"./tlh.js\": 569,\n\t\"./tr\": 570,\n\t\"./tr.js\": 570,\n\t\"./tzl\": 571,\n\t\"./tzl.js\": 571,\n\t\"./tzm\": 572,\n\t\"./tzm-latn\": 573,\n\t\"./tzm-latn.js\": 573,\n\t\"./tzm.js\": 572,\n\t\"./ug-cn\": 574,\n\t\"./ug-cn.js\": 574,\n\t\"./uk\": 575,\n\t\"./uk.js\": 575,\n\t\"./ur\": 576,\n\t\"./ur.js\": 576,\n\t\"./uz\": 577,\n\t\"./uz-latn\": 578,\n\t\"./uz-latn.js\": 578,\n\t\"./uz.js\": 577,\n\t\"./vi\": 579,\n\t\"./vi.js\": 579,\n\t\"./x-pseudo\": 580,\n\t\"./x-pseudo.js\": 580,\n\t\"./yo\": 581,\n\t\"./yo.js\": 581,\n\t\"./zh-cn\": 582,\n\t\"./zh-cn.js\": 582,\n\t\"./zh-hk\": 583,\n\t\"./zh-hk.js\": 583,\n\t\"./zh-mo\": 584,\n\t\"./zh-mo.js\": 584,\n\t\"./zh-tw\": 585,\n\t\"./zh-tw.js\": 585\n};\n\n\nfunction webpackContext(req) {\n\tvar id = webpackContextResolve(req);\n\treturn __webpack_require__(id);\n}\nfunction webpackContextResolve(req) {\n\tif(!__webpack_require__.o(map, req)) {\n\t\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\t\te.code = 'MODULE_NOT_FOUND';\n\t\tthrow e;\n\t}\n\treturn map[req];\n}\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 781;","firebaseConfig = {\n    \"authDomain\": \"virtual-metrics-355712.firebaseapp.com\",\n    \"projectId\": \"virtual-metrics-355712\",\n    \"storageBucket\": \"virtual-metrics-355712.appspot.com\",\n    \"messagingSenderId\": \"76003576924\",\n    \"appId\": \"1:76003576924:web:c8c8a006d07918bbc02a99\",\n    \"measurementId\": \"G-SEL35L4N5R\"\n}\nif (typeof module !== 'undefined') {\n    module.exports = firebaseConfig\n}\n","import * as React from 'react';\r\nimport { Avatar } from 'react-native-paper';\r\nimport { AvatarProps } from '../../types';\r\n\r\nconst normalizeHash = (hash: number, min: number, max: number) => {\r\n    return Math.floor((hash % (max - min)) + min);\r\n};\r\n\r\nconst stringToHSL = (str: string, initHash?:number) => {\r\n    let hash = initHash || 0;\r\n    for (let i = 0; i < str.length; i++) {\r\n      hash = str.charCodeAt(i) + ((hash << 5) - hash);\r\n    }\r\n    hash = Math.abs(hash);\r\n    return `hsl(${normalizeHash(hash, 0, 360)}, ${normalizeHash(hash, 0, 100)}%, ${normalizeHash(hash, 25, 75)}%)`;\r\n};\r\n\r\nexport default (props:AvatarProps) => {\r\n    const backgroundColor = stringToHSL(props.name, props.userId)\r\n    return <Avatar.Text style={{backgroundColor}} size={props.size} label={props.name.split(' ').map(v=>v[0]).join().toUpperCase()} />\r\n};","import React from 'react';\r\n// import { MaterialIcons } from \"@expo/vector-icons\"\r\nimport Avatar from '../lib/react-native-paper/Avatar';\r\nimport { AvatarProps, MessengerChannel, User } from '../types';\r\n\r\nexport function avatarFromChannel(item:MessengerChannel, user?:User|null){\r\n    let avatar;\r\n    let name = item.name\r\n    if (item.member_count<3){\r\n        avatar = (item.member_count==1 || user?.id == item.subowner.id)?item.owner:item.subowner\r\n        name = name.length>0?name:avatar.name \r\n    }\r\n    return {avatar, name}\r\n}\r\n\r\nexport default (props:AvatarProps)=>{\r\n    // return <MaterialIcons size={38} style={{ marginBottom: -3, marginRight:10 }} name='account-circle'/>\r\n    return <Avatar {...props}/>\r\n}\r\n\r\n","module.exports = __webpack_public_path__ + \"./fonts/SpaceMono-Regular.ttf\";"],"sourceRoot":""}