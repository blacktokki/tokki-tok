{"version":3,"sources":["src/screens/NotFoundScreen.tsx","src/navigation/Drawer.tsx","src/modals/index.ts","src/navigation/MainNavigator.tsx","src/hooks/lists/useMessengerChannelList.ts","src/navigation/index.tsx","src/hooks/lists/useUserMembershipList.ts","src/hooks/lists/useMessengerMemberList.ts","src/components/TextButton.tsx","src/modals/ChannelEditModal.tsx","src/modals/RegistrationModal.tsx","src/components/RowField.tsx","src/components/TabView.tsx","src/components/CommonItem.tsx","src/components/HeaderRight.tsx","src/modals/ProfileModal.tsx","src/components/ContractFooter.tsx","src/screens/login/LoginScreen.tsx","src/lib/react-native-webrtc/useWebsocketContext.tsx","src/lib/react-native-webrtc/webrtc/p2p.tsx","src/lib/react-native-webrtc/webrtc/index.ts","src/lib/react-native-webrtc/LocalCam.tsx","src/lib/react-native-webrtc/RemoteCam.tsx","src/screens/main/ChatScreen/VideoCallSection.tsx","src/components/Messages/UploadTags.tsx","src/lib/tinymce/Editor.tsx","src/components/Editor.tsx","src/screens/main/ChatSection.tsx","src/hooks/useChatSection.tsx","src/screens/main/HomeScreen/ConfigSections.tsx","src/screens/main/HomeScreen/index.tsx","src/screens/index.ts","src/screens/main/ChatScreen/index.tsx","src/screens/main/MyMessageScreen.tsx","src/screens/login/DemoScreen.tsx","src/modals/DateTimePickerModal.tsx","src/hooks/lists/useExternalMembershipList.ts","src/components/TextField.tsx","src/components/CommonTextInput.tsx","src/components/MemberItem.tsx","src/modals/AlertModal.tsx","src/components/Profile.tsx","src/hooks/useFirebaseContext.tsx","src/hooks/useLocalSearch.ts","src/components/CopyField.tsx","src/modals/InviteModal.tsx","src/hooks/useInvitee.ts","web/editor-config.js","web/firebase-config.js","src/navigation/LinkingConfiguration.ts"],"names":["NotFoundScreen","_ref","navigation","lang","useLangContext","auth","useAuthContext","_jsxs","View","style","styles","container","children","_jsx","Text","title","TouchableOpacity","onPress","replace","user","link","linkText","StyleSheet","create","flex","backgroundColor","alignItems","justifyContent","padding","fontSize","fontWeight","marginTop","paddingVertical","color","MemberTabView","setModal","useModalsContext","userList","useUserMembershipList","map","item","index","CommonItem","containerStyle","marginHorizontal","bodyStyle","ProfileModal","id","marginLeft","name","MessengerTabView","channelList","useMessengerChannelSorted","avatarFromChannel","navigate","MyMessageTabView","colors","useTheme","theme","useColorScheme","windowType","useResizeContext","_useState","useState","_useState2","_slicedToArray","setIndex","onAddList","_auth$user","RegistrationModal","is_guest","ChannelEditModal","type","drawerTabs","Colors","iconColor","MemberTab","component","icon","MaterialCommunityIcons","size","marginBottom","ChatTab","Ionicons","MyMessageTab","getDrawerTabs","useEffect","undefined","tabBar","background","borderTopColor","border","width","pointerEvents","_Fragment","Profile","userId","username","flexDirection","TextButton","textStyle","borderRadius","accessibilityRole","content","Object","keys","length","TabView","tabs","tabBarPosition","onTab","borderTopWidth","borderColor","values","drawerTab","Tab","elevation","borderRightWidth","tab","label","textAlign","InviteModal","AlertModal","DateTimePickerModal","MessageModal","Main","createStackNavigator","isMobile","useIsMobile","_useLangContext","locale","entries","useMemo","console","log","login","main","modalValues","modals","backgroundStyle","UploadContextProvider","ModalsProvider","Drawer","WebSocketProvider","disable","FirebaseProvider","Navigator","screenOptions","route","headerStyle","header","height","headerTitleStyle","text","headerLeft","canGOBackScreen","findIndex","v","goBack","canGoBack","disabled","CommonButton","buttonBackgroundColor","hoverColor","margin","paddingHorizontal","headerRight","HeaderRight","headerLeftContainerStyle","borderBottomWidth","headerBottomColor","cardStyle","flexShrink","animationEnabled","cardStyleInterpolator","CardStyleInterpolators","forHorizontalIOS","_ref2","_ref3","key","screen","Screen","options","useMessengerChannelList","queryClient","useQueryClient","lastJsonMessage","useWebsocketContext","data","useQuery","_asyncToGenerator","getChannelList","setQueryData","_data","find","concat","_toConsumableArray","sort","a","b","_data2$message_set$","channel","_objectSpread","last_message","message_set","created","_a$last_message","_b$last_message","useMessengerChannelMutation","useMutation","postChannel","onSuccess","invalidateQueries","update","putChannel","direct","postDirectChannel","mutateAsync","enableScreens","electronVersion","navigationRef","React","params","_navigationRef$curren","_navigationRef$curren2","current","_process","_process$versions","process","versions","e","Navigation","defaultColorScheme","useDefaultColorScheme","userColorScheme","colorScheme","NavigationContainer","ref","documentTitle","formatter","linking","LinkingConfiguration","DarkTheme","DefaultTheme","ResizeContextProvider","RootNavigator","Root","useInvitee","mode","headerMode","forVerticalIOS","MainNavigator","headerShown","modal","gestureDirection","replaceInviteeState","window","location","IGNORE_WERNINGS","warnLogger","warn","message","some","includes","groupId","getUserMembershipList","useUserMembershipMutation","_useAuthContext","dispatch","_create","postUser","_update","patchUser","password","_delete","deleteUser","_auth$user2","delete","useMessengerMemberList","channel_id","getMessengerMemberList","useMessengerMemberMutation","invite","postBulkMessengerMember","leave","deleteMessengerMember","props","borderWidth","member_id","channelMutation","messengerMemberMutation","setName","_useState3","_useState4","description","setDescription","back","_name","useModalEffect","ModalSection","separator","lightColor","darkColor","TextField","value","setValue","multiline","then","newChannel","owner","group","field","ErrorView","form_error","form_error_text","setUsername","_useState5","_useState6","setPassword","_useState7","_useState8","checkPassword","setCheckPassword","_useState9","_useState10","isStaff","_useState11","_useState12","error","setError","externalMemberList","useExternalMembershipList","userMembershipMutation","usernameDisable","RowField","CommonTextInput","keyboardType","secureTextEntry","newError","test","is_staff","inviteGroupId","textAlignVertical","rowStyle","icons","assign","apply","k","_defineProperty","renderTabBar","TabBar","indicatorStyle","labelStyle","whiteSpace","activeColor","inactiveColor","renderIcon","scene","onTabPress","_ref4","_ref5","navigationState","routes","_ref6","_ref7","onIndexChange","onSwipeStart","Platform","OS","getSelection","sel","removeAllRanges","renderScene","SceneMap","_ref8","_ref9","_React$useState","_React$useState2","press","setPress","Pressable","outerContainer","outerContainerStyle","onPressIn","onPressOut","bodyView","maxWidth","minHeight","defaultButtonProps","buttonProps","extra","filter","isSelf","BottomSheet","_auth$user3","_auth$user4","_auth$user5","subowner","openURL","url","href","Linking","Styles","footer_buttons","footer_button","AntDesign","paddingBottom","paddingRight","login_container","login_header","paddingTop","login_header_logo","resizeMode","login_header_text","login_header_text_bold","login_wrapper","borderTopRightRadius","borderTopLeftRadius","form","form_input","button","button_label","login_social","login_social_separator","login_social_separator_line","login_social_separator_text","login_social_buttons","login_social_button","login_social_icon","login_social_facebook","login_footer_text","guest_footer_text","alignSelf","login_footer_link","WebSocketContext","createContext","sendJsonMessage","WebSocketInternalProvider","path","Context","useBackground","useContext","TURN_SERVER","peerConstraints","iceServers","JSON","parse","urls","sessionConstraints","mandatory","OfferToReceiveAudio","OfferToReceiveVideo","VoiceActivityDetection","mediaConstraints","audio","video","framerate","onICEcandidate","pc","_message","rtcMessage","candidate","RTCIceCandidate","addIceCandidate","sendICEcandidate","event","sendMessage","receiver","target","createOffer","pcRefCurrent","stream","addStream","offerDescription","arr","sdp","split","forEach","str","i","RTCSessionDescription","join","optimizeSdp","setLocalDescription","_x","_x2","_x3","_x4","_x5","arguments","camStyle","cam","bottonContainer","position","bottom","buttonBar","_props$user","_useWebsocketContext","_useLocalCam","pcRef","useRef","sender","setSender","_stream","setStream","isPlay","CustomRTCView","useCallback","memo","RTCView","videoProps","start","newStream","mediaDevices","getUserMedia","getDisplayMedia","catch","_x6","_x7","_x8","stop","getTracks","track","websocketOnMessage","_websocketOnMessage","response","channel_name","peerConnection","RTCPeerConnection","addEventListener","answerDescription","setRemoteDescription","_x9","_x10","useLocalCam","Button","setReceiver","_useRemoteCam","setUser","close","clearInterval","statsInterval","_websocketOnMessage2","_pcRef$current","_pcRef$current2","_pcRef$current3","_pcRef$current4","iceConnectionState","activeStream","setInterval","stats","getStats","statsOutput","framePerSecond","report","kind","statName","framesPerSecond","Date","toTimeString","addTransceiver","direction","streams","getRemoteStreams","createAnswer","localDescription","_x11","useRemoteCam","TextInput","onChangeText","VideoView","scale","maxHeight","flexGrow","focusGuest","setFocusGuest","VideoCallContainer","setDisable","videoMode","setVideoMode","guests","setGuests","_useRtcContext","useRtcContext","Math","max","ceil","sqrt","toggleVideoMode","ThemedView","aspectRatio","borderLeftWidth","flexWrap","RemoteCam","LocalCam","RtcProvider","UploadTag","overflow","progress","filename","upload","useUploadContext","expand","setExpand","uploadData","f","isExpand","INIT","require","Editor","tinymceScriptSrc","onInit","editor","onReady","onEditorChange","init","setup","plugins","toolbar","skin","content_css","menubar","branding","statusbar","block_formats","fontsize_formats","ready","setReady","active","isEditor","setIsEditor","extraButtons","inputRef","editorValue","setEditorValue","timer","setTimer","messageEvent","sendToScreen","bottomTab","setBottomTab","autoFocus","setAutoFocus","valueLines","contentMutation","useMessengerContentMutation","postValue","focus","Messages","reverse","UploadTags","TimerTags","borderBottomRightRadius","top","Entypo","timerFormat","datetime","callback","onKeyPress","shiftKey","preventDefault","onFocus","numberOfLines","borderBottomLeftRadius","marginRight","Promise","resolve","reject","input","document","createElement","onchange","files","onabort","onerror","click","file","parseInt","channelAvatar","memberList","_memberList$find","useLayoutEffect","setOptions","ConfigSection","CommonSection","setLocale","configTheme","useConfigColorScheme","_useFirebaseContext","useFirebaseContext","noti","enable","setNoti","setEnable","n","textDecorationLine","l","setColorScheme","memberItem","MemberItem","member","ScrollView","today","toISOString","slice","_item$last_message","_item$last_message2","_item$last_message3","_item$last_message4","_avatarFromChannel","avatar","date","preview_content","Avatar","FontAwesome","opacity","paddingLeft","member_count","replaceAll","unread_count","contentContainerStyle","_item$last_message5","_item$last_message6","_item$last_message7","_item$last_message8","flexBasis","wordBreak","ConfigTabView","ConfigSections","getBottomTabs","headerSetter","Component","headerIndexRef","OneTab","TwoTab","ThreeTab","FourTab","SimpleLineIcons","HomeScreen","_route$params2","home","setHome","tempref","indexRef","useWindowDimensions","useNavigation","measure","fx","fy","_","px","py","round","useHeaderSetter","_route$params","StyledText","ContractFooter","setParams","ChatScreen","useChatSection","minWidth","VideoCallSection","d","ChatSection","MyMessageScreen","LoginScreen","_login","placeholder","autoCapitalize","onSubmitEditing","DemoScreen","dayTypes","hours","Array","toString","padStart","minutes","getDisableDays","startDate","clone","startOf","add","endDate","endOf","dayjs","result","push","format","Calendar","lazy","CommonPicker","_dayjs","m","restMinute","defaultDayjs","setDate","dayType","setDayType","hour","setHour","minute","setMinute","disableDays","setDisableDays","Suspense","fallback","disableAllTouchEventsForDisabledDays","onMonthChange","dateString","markedDates","reduce","p","c","selected","keyword","getExternalMembershipList","contentHeight","setContentHeight","editable","onContentSizeChange","nativeEvent","contentSize","onBlur","onEndEditing","messages","firebaseConfig","messagingSenderId","apiKeyEncrypted","FCM_API_KEY","charCodeAt","app","firebase","initializeApp","apiKey","messaging","onMessage","payload","Notification","permission","body","alert","requestToken","requestPermission","serviceWorkerRegistration","navigator","serviceWorker","register","scope","currentToken","getToken","vapidKey","FCM_PUBLIC_VAPID_KEY","unregister","FirebaseContext","tokenRef","notification","setNotification","token","isMount","t","putNotification","getNotification","postNotification","Provider","_useContext","localSearchReducer","initialState","action","Error","CopyField","copied","setCopied","Clipboard","setString","InviteItem","selectedRef","has","setSelected","GroupTabView","_useLocalSearch","compare","_useReducer","useReducer","_useReducer2","searchState","useLocalSearch","memberSet","Set","dispatchKeyword","FlatList","renderItem","user_ids","ExternalMembershipTabView","setKeyword","timeoutRef","setTimeout","clearTimeout","inviteLink","marginVertical","external","invitee_id","invitee_state","pathname","endsWith","search","startsWith","history","replaceState","redirect","editorConfig","module","exports","ROOTPATH","prefixes","config","screens","NotFound"],"mappings":"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","file":"static/js/10.0a8747ce.chunk.js","sourcesContent":["import { StackScreenProps } from '@react-navigation/stack';\r\nimport * as React from 'react';\r\nimport { StyleSheet, Text, TouchableOpacity, View } from 'react-native';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport useLangContext from '../hooks/useLangContext';\r\n\r\nexport default function NotFoundScreen({\r\n  navigation,\r\n}: StackScreenProps<any, 'NotFound'>) {\r\n  const { lang } = useLangContext()\r\n  const { auth } = useAuthContext()\r\n  return (\r\n    <View style={styles.container}>\r\n      <Text style={styles.title}>{lang(\"This screen doesn't exist.\")}</Text>\r\n      <TouchableOpacity onPress={() => navigation.replace(auth.user?'HomeScreen':'LoginScreen')} style={styles.link}>\r\n        <Text style={styles.linkText}>{lang(\"Go to home screen!\")}</Text>\r\n      </TouchableOpacity>\r\n    </View>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: '#fff',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    padding: 20,\r\n  },\r\n  title: {\r\n    fontSize: 20,\r\n    fontWeight: 'bold',\r\n  },\r\n  link: {\r\n    marginTop: 15,\r\n    paddingVertical: 15,\r\n  },\r\n  linkText: {\r\n    fontSize: 14,\r\n    color: '#2e78b7',\r\n  },\r\n});\r\n","import { useTheme } from '@react-navigation/native';\r\nimport React, { useEffect, useState } from 'react';\r\nimport { View, StyleSheet } from 'react-native';\r\nimport Profile from '../components/Profile';\r\nimport TextButton from '../components/TextButton';\r\nimport Colors from '../constants/Colors';\r\nimport useResizeContext from '../hooks/useResizeContext';\r\nimport TabView from '../components/TabView';\r\nimport { TabViewRecord, UserMembership } from '../types';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport ChannelEditModal from '../modals/ChannelEditModal';\r\nimport CommonItem from '../components/CommonItem';\r\nimport { Text } from '../components/Themed';\r\nimport useAuthContext, { Auth } from '../hooks/useAuthContext';\r\nimport { useMessengerChannelSorted } from '../hooks/lists/useMessengerChannelList';\r\nimport { navigate } from '.'\r\nimport { avatarFromChannel } from '../components/Avatar';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { Ionicons, MaterialCommunityIcons } from '../lib/@expo/vector-icons';\r\nimport RegistrationModal from '../modals/RegistrationModal';\r\nimport useUserMembershipList from '../hooks/lists/useUserMembershipList';\r\nimport ProfileModal from '../modals/ProfileModal';\r\n\r\n\r\nconst MemberTabView = ()=>{\r\n  const {auth} = useAuthContext()\r\n  const { setModal } = useModalsContext()\r\n  const userList = useUserMembershipList(auth)\r\n  return <View style={{flex:1}}>\r\n    {userList?.map((item, index)=>{\r\n      return <CommonItem key={index} containerStyle={{marginHorizontal:0}} bodyStyle={{alignItems:'flex-start'}} onPress={()=>setModal(ProfileModal, {id:item.id})}>\r\n        <Text style={{marginLeft:20}}>{item.name}</Text>\r\n      </CommonItem>\r\n    })}\r\n  </View>\r\n}\r\n\r\nconst MessengerTabView = ()=>{\r\n  const {auth} = useAuthContext()\r\n  const channelList = useMessengerChannelSorted('messenger', auth);\r\n  return <View style={{flex:1}}>\r\n    {channelList?.map((item, index)=>{\r\n      const {name} = avatarFromChannel(item, auth.user)\r\n      return <CommonItem key={index} containerStyle={{marginHorizontal:0}} bodyStyle={{alignItems:'flex-start'}} onPress={()=>navigate(\"ChatScreen\", {id:item.id})}>\r\n        <Text style={{marginLeft:20}}>{name}</Text>\r\n      </CommonItem>\r\n    })}\r\n  </View>\r\n}\r\n\r\nconst MyMessageTabView = ()=>{\r\n  const {auth} = useAuthContext()\r\n  const channelList = useMessengerChannelSorted('mycontent', auth);\r\n  return <View style={{flex:1}}>\r\n    {channelList?.map((item, index)=>{\r\n      const {name} = avatarFromChannel(item, auth.user)\r\n      return <CommonItem key={index} containerStyle={{marginHorizontal:0}} bodyStyle={{alignItems:'flex-start'}} onPress={()=>navigate(\"MyMessageScreen\", {id:item.id})}>\r\n        <Text style={{marginLeft:20}}>{name}</Text>\r\n      </CommonItem>\r\n    })}\r\n  </View>\r\n}\r\nconst getDrawerTabs = (theme:'light'|'dark')=>{\r\n  const color = Colors[theme].iconColor\r\n  return {\r\n    MemberTab:{\r\n      title:'member',\r\n      component:MemberTabView,\r\n      icon:<MaterialCommunityIcons size={32} color={color} style={{ marginBottom: -3 }} name='account'/>,\r\n    },\r\n    ChatTab:{\r\n        title:'chat',\r\n        component:MessengerTabView,\r\n        icon:<Ionicons size={30} color={color} style={{ marginBottom: -3 }} name='chatbox'/>\r\n    },\r\n    MyMessageTab:{\r\n        title:'my messages',\r\n        component:MyMessageTabView,\r\n        icon:<MaterialCommunityIcons size={32} color={color} style={{ marginBottom: -3 }} name='pencil-box'/>\r\n    }\r\n  } as TabViewRecord\r\n}\r\n\r\nexport default ({auth}:{auth:Auth})=> {\r\n  const { colors } = useTheme();\r\n  const theme = useColorScheme();\r\n  const windowType = useResizeContext();\r\n  const [index, setIndex] = useState<number>();\r\n  const { setModal } = useModalsContext()\r\n  \r\n  const onAddList = [\r\n    ()=>setModal(RegistrationModal, auth.user?.is_guest?{id:auth.user.id}:{}),\r\n    ()=>setModal(ChannelEditModal, {type:'messenger'}),\r\n    ()=>setModal(ChannelEditModal, {type:'mycontent'}),\r\n  ]\r\n  const drawerTabs = getDrawerTabs(theme)\r\n\r\n  useEffect(()=>{\r\n    if(index===undefined){\r\n      setIndex(0)\r\n    }\r\n  }, [])\r\n  return <View style={windowType=='landscape'?[\r\n      styles.tabBar,\r\n      {\r\n        backgroundColor: Colors[theme].background,\r\n        borderTopColor: colors.border,\r\n      },\r\n      // tabBarStyle,\r\n    ]:{width:0}}\r\n    pointerEvents={false ? 'none' : 'auto'}\r\n  >\r\n    {windowType=='landscape' && auth.user && index!==undefined && <>\r\n      <Profile userId={auth.user.id} username={auth.user.username} name={auth.user.name}/>\r\n      <View style={{flexDirection:'row-reverse'}}>\r\n          <TextButton title='+' textStyle={{fontSize:20}} style={{borderRadius:20}} onPress={onAddList[index]}/>\r\n      </View>\r\n      <View accessibilityRole=\"tablist\" style={styles.content}>\r\n        {Object.keys(drawerTabs).length>1 ? \r\n          <TabView tabs={drawerTabs} tabBarPosition={\"top\"} onTab={setIndex} index={index}/>: \r\n          <View style={{borderTopWidth:1, flex:1, borderColor:colors.border}}>            \r\n            {Object.values(drawerTabs).map(drawerTab=>{const Tab = drawerTab.component; return <Tab key={drawerTab.title}/>})}\r\n          </View>\r\n        }\r\n      </View>\r\n    </>}\r\n  </View>\r\n}\r\n\r\n{/*<Text style={[styles.label, { color: d.isFocused ? colors.primary : '#222' }]}></Text> */}\r\n\r\nconst styles = StyleSheet.create({\r\n    tabBar: {\r\n      width:240,\r\n      elevation: 8,\r\n      borderRightWidth:1,\r\n      borderColor:Colors.borderColor\r\n    },\r\n    content: {\r\n      flex: 1,\r\n      flexDirection: 'row',\r\n    },\r\n    tab: {\r\n        flex: 1,\r\n        alignItems: 'center',\r\n    },\r\n    label: {\r\n        textAlign: 'center',\r\n        backgroundColor: 'transparent',\r\n      },\r\n  });","import InviteModal from \"./InviteModal\";\r\nimport ProfileModal from \"./ProfileModal\";\r\nimport ChannelEditModal from \"./ChannelEditModal\"\r\nimport AlertModal from \"./AlertModal\";\r\nimport DateTimePickerModal from \"./DateTimePickerModal\"\r\nimport MessageModal from \"./MessageModal\";\r\nimport RegistrationModal from \"./RegistrationModal\";\r\n\r\nexport default [\r\n    InviteModal,\r\n    ProfileModal,\r\n    ChannelEditModal,\r\n    AlertModal,\r\n    DateTimePickerModal,\r\n    MessageModal,\r\n    RegistrationModal\r\n]","import { CardStyleInterpolators, createStackNavigator } from '@react-navigation/stack';\r\nimport React, {useMemo} from 'react';\r\nimport { View } from 'react-native';\r\nimport { Ionicons } from '../lib/@expo/vector-icons';\r\nimport useResizeContext from '../hooks/useResizeContext';\r\nimport NotFoundScreen from '../screens/NotFoundScreen';\r\nimport {main, login} from '../screens';\r\nimport Drawer from './Drawer';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport { WebSocketProvider } from '../hooks/useWebsocketContext';\r\nimport HeaderRight from '../components/HeaderRight'\r\nimport Colors from '../constants/Colors';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport { FirebaseProvider } from '../hooks/useFirebaseContext';\r\nimport useIsMobile from '../hooks/useIsMobile';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { ModalsProvider } from '../hooks/useModalsContext';\r\nimport modals from '../modals';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport CommonButton from '../components/CommonButton';\r\nimport { UploadContextProvider } from '../hooks/useUploadContext';\r\n\r\nconst Main = createStackNavigator();\r\n\r\nfunction headerLeft(navigation:any, route:any, windowType:string, theme:'light'|'dark', isMobile:boolean){\r\n    const canGOBackScreen = ['HomeScreen', 'LoginScreen'].findIndex(v=>v == route.name) == -1\r\n    const goBack = ()=>{\r\n        if (navigation.canGoBack())\r\n            navigation.goBack()\r\n        else if (canGOBackScreen)\r\n            navigation.replace('HomeScreen')\r\n    }\r\n    if (windowType=='portrait' && canGOBackScreen)\r\n        return <TouchableOpacity onPress={goBack} disabled={!isMobile}>\r\n            <CommonButton title={''} color={isMobile?Colors[theme].buttonBackgroundColor:Colors[theme].hoverColor} onPress={goBack} disabled={isMobile} style={{width:32, height:32, margin:16, paddingVertical:1, paddingHorizontal:4}}>\r\n                <Ionicons size={24} color={Colors[theme].iconColor} name=\"arrow-back\"/>\r\n            </CommonButton>\r\n        </TouchableOpacity>\r\n    return null\r\n}\r\n\r\nexport default ()=>{\r\n    const windowType = useResizeContext();\r\n    const isMobile = useIsMobile()\r\n    const {auth} = useAuthContext()\r\n    const theme = useColorScheme()\r\n    const {lang, locale} = useLangContext()\r\n    const entries = useMemo(()=>{\r\n        if (auth.user === undefined)\r\n            return []\r\n        console.log('current user: ', auth.user)\r\n        return Object.entries(auth.user === null?login:main)\r\n    }, [auth, locale])\r\n    const modalValues = useMemo(()=>{\r\n        if (auth.user === undefined)\r\n            return []\r\n        return auth.user === null?[]:modals\r\n    }, [auth])\r\n    const backgroundStyle = theme=='light'?{}:{backgroundColor:'#010409'}\r\n    return (auth.user!==undefined?<View style={{flexDirection:'row', flex:1}}>\r\n        <UploadContextProvider>\r\n            <ModalsProvider modals={modalValues}>\r\n                {auth.user?<Drawer auth={auth}/>:undefined}\r\n                <View style={[{flex:1}, backgroundStyle]}>\r\n                    <WebSocketProvider disable={auth.user === null || auth.user === undefined}>\r\n                        <FirebaseProvider user={auth.user}>\r\n                            <Main.Navigator\r\n                                screenOptions={({navigation, route})=>({\r\n                                    headerStyle:{backgroundColor:Colors[theme].header, height:isMobile?50:undefined},\r\n                                    headerTitleStyle:{color:Colors[theme].text},\r\n                                    headerLeft:()=>headerLeft(navigation, route, windowType, theme, isMobile),\r\n                                    headerRight:()=><HeaderRight/>,\r\n                                    headerLeftContainerStyle:{backgroundColor:Colors[theme].header, borderBottomWidth:1, borderColor:Colors[theme].headerBottomColor},\r\n                                    cardStyle:[{flexShrink:1}, backgroundStyle],\r\n                                    animationEnabled:windowType=='portrait',\r\n                                    cardStyleInterpolator: CardStyleInterpolators.forHorizontalIOS\r\n                                })}\r\n                            >\r\n                                {entries.map(([key, screen])=><Main.Screen key={key} name={key} component={screen.component} options={{ title: lang(screen.title) }} />)}\r\n                                <Main.Screen name=\"NotFound\" component={NotFoundScreen} options={{ title: 'Oops!' }} />\r\n                            </Main.Navigator>\r\n                        </FirebaseProvider>\r\n                    </WebSocketProvider>\r\n                </View>\r\n            </ModalsProvider>\r\n        </UploadContextProvider>\r\n    </View>:<></>);\r\n}","import { useEffect } from \"react\";\r\nimport { useMutation, useQuery, useQueryClient } from \"react-query\";\r\nimport { getChannelList, postChannel, postDirectChannel, putChannel } from \"../../services\";\r\nimport { MessengerChannel, MessengerContent } from \"../../types\";\r\nimport { Auth } from \"../useAuthContext\";\r\nimport useWebsocketContext from \"../useWebsocketContext\";\r\n\r\nexport default function useMessengerChannelList(type:string, auth?:Auth){\r\n  const queryClient = useQueryClient()\r\n  const {lastJsonMessage} = useWebsocketContext()\r\n  const { data } = useQuery([\"ChannelList\", type] , async()=>await getChannelList(type, auth?.user?.id))\r\n\r\n  useEffect(()=>{\r\n    if(lastJsonMessage !=null){\r\n      if(lastJsonMessage['type']=='enter'){\r\n        queryClient.setQueryData<MessengerChannel[]>([\"ChannelList\", type], (_data)=>{\r\n          return (_data?.find(v=>v.id==lastJsonMessage['data']['id'])?_data:[lastJsonMessage['data'] , ...(_data|| [])]).sort((a, b)=>a.id - b.id)\r\n        })\r\n      }\r\n      if (lastJsonMessage['type']=='next_message'){\r\n        const data:MessengerContent = lastJsonMessage['data']\r\n        queryClient.setQueryData<MessengerChannel[]>([\"ChannelList\", type], (_data)=>(_data || []).map(v=>{\r\n          if (v.id == data.channel){\r\n            return {...v, last_message:{content:data.message_set[0]?.content, created:data.created}}\r\n          }\r\n          return v\r\n        }))\r\n      }\r\n      // if(lastJsonMessage['type']=='leave'){\r\n      //   queryClient.setQueryData<Channel[]>([\"MessengerChannelList\", type], (_data)=>_data?.filter(v=>v.id!=lastJsonMessage['data']['channel_id']) || [])\r\n      // }\r\n    }\r\n  }, [lastJsonMessage])\r\n  return data\r\n}\r\n\r\nexport function useMessengerChannelSorted(type:string, auth?:Auth){\r\n  const channelList = useMessengerChannelList(type, auth);\r\n  return channelList?.sort((a, b)=>(a.last_message?.created || '') < (b.last_message?.created || '')?1:-1)\r\n}\r\nexport function useMessengerChannelMutation(type:string){\r\n  const queryClient = useQueryClient()\r\n\r\n  const create = useMutation(postChannel, {\r\n    onSuccess: ()=>queryClient.invalidateQueries([\"ChannelList\", type])\r\n  });\r\n\r\n  const update = useMutation(putChannel, {\r\n    onSuccess: () => queryClient.invalidateQueries([\"ChannelList\", type])\r\n  })\r\n\r\n  const direct = useMutation(postDirectChannel, {\r\n    onSuccess: () => queryClient.invalidateQueries([\"ChannelList\", type])\r\n  })\r\n\r\n  return { create:create.mutateAsync, update:update.mutateAsync, direct:direct.mutateAsync}\r\n}","/**\r\n * If you are not familiar with React Navigation, refer to the \"Fundamentals\" guide:\r\n * https://reactnavigation.org/docs/getting-started\r\n *\r\n */\r\nimport * as React from 'react';\r\nimport { useColorScheme as useDefaultColorScheme } from 'react-native';\r\nimport { useColorScheme as useColorScheme } from 'react-native-appearance';\r\nimport { enableScreens } from 'react-native-screens';\r\nimport { NavigationContainer, DefaultTheme, DarkTheme, NavigationContainerRef } from '@react-navigation/native';\r\nimport { CardStyleInterpolators, createStackNavigator } from '@react-navigation/stack';\r\n\r\nimport useResizeContext, { ResizeContextProvider } from '../hooks/useResizeContext';\r\nimport useInvitee, { replaceInviteeState } from '../hooks/useInvitee';\r\nimport { modal } from '../screens';\r\nimport LinkingConfiguration from './LinkingConfiguration';\r\nimport MainNavigator from './MainNavigator';\r\n\r\n\r\nenableScreens();\r\n\r\nconst navigationRef = React.createRef<NavigationContainerRef>();\r\n\r\nexport function navigate(name:string, params?:any) {\r\n  if (params)\r\n    navigationRef.current?.navigate(name, params);\r\n  navigationRef.current?.navigate(name);\r\n}\r\n\r\nlet electronVersion:string|undefined;\r\ntry{\r\n  electronVersion = process?.versions?.['electron']\r\n}\r\ncatch(e){\r\n  electronVersion = undefined\r\n}\r\n\r\nexport default function Navigation() {\r\n  const defaultColorScheme = useDefaultColorScheme()\r\n  const userColorScheme = useColorScheme()\r\n  const colorScheme = userColorScheme =='no-preference'?defaultColorScheme:userColorScheme\r\n  return <NavigationContainer\r\n    ref={navigationRef}\r\n    documentTitle={{formatter: (options, route) => {return `TOKKI TOK`}}}\r\n    linking={electronVersion?undefined:LinkingConfiguration}\r\n    theme={colorScheme === 'dark' ? DarkTheme : DefaultTheme}>\r\n        <ResizeContextProvider>\r\n          <RootNavigator />\r\n        </ResizeContextProvider>\r\n  </NavigationContainer>\r\n}\r\n\r\n\r\n// A root stack navigator is often used for displaying modals on top of all other content\r\n// Read more here: https://reactnavigation.org/docs/modal\r\nconst Root = createStackNavigator();\r\n\r\nfunction RootNavigator() {\r\n    const windowType = useResizeContext();\r\n    useInvitee()\r\n    return <Root.Navigator\r\n        mode= 'modal'\r\n        headerMode= 'screen'\r\n        screenOptions={{\r\n            cardStyle:{backgroundColor:\"white\"},\r\n            animationEnabled: true,\r\n            cardStyleInterpolator: CardStyleInterpolators.forVerticalIOS,\r\n        }}\r\n    >\r\n        <Root.Screen name=\"Main\" component={MainNavigator} options={{headerShown:false}}/>\r\n        {Object.entries(modal).map(([key, screen])=><Root.Screen key={key} name={key} component={screen.component} options={{\r\n            title: screen.title,\r\n            gestureDirection: windowType == 'landscape'?'vertical-inverted':'vertical'\r\n        }} />)}\r\n    </Root.Navigator>\r\n}\r\n\r\nreplaceInviteeState(window.location)\r\n\r\nconst IGNORE_WERNINGS:string[] = ['setNativeProps', 'useNativeDriver'];\r\n\r\nconst warnLogger = console.warn\r\n\r\nconsole.warn = (message: string|Object) => {\r\n    var warn = true;\r\n    if (message instanceof Object){\r\n      warn = false;\r\n    }\r\n    else if (IGNORE_WERNINGS.some(log=>message.includes(log))){\r\n      warn = false\r\n    };\r\n    if (warn){\r\n      warnLogger(message);\r\n    }\r\n    else{\r\n        // console.log(message)\r\n    }\r\n};\r\n","import { useMutation, useQuery, useQueryClient } from \"react-query\";\r\nimport { deleteUser, getUserMembershipList, patchUser, postUser } from \"../../services\";\r\nimport useAuthContext, { Auth } from \"../useAuthContext\";\r\n\r\nexport default function useUserMembershipList(auth?:Auth){\r\n  const { data } = useQuery([\"UserMembershipList\", auth?.groupId] , async()=>auth?.groupId?(await getUserMembershipList(auth?.groupId)):[])\r\n  return data\r\n}\r\n\r\nexport function useUserMembershipMutation(){\r\n  const queryClient = useQueryClient()\r\n  const { auth, dispatch } = useAuthContext()\r\n  const _create = useMutation(postUser, {\r\n    onSuccess: ()=>{\r\n      queryClient.invalidateQueries(\"UserMembershipList\")\r\n    }\r\n  })\r\n  const _update = useMutation(patchUser, {\r\n    onSuccess: (data, user)=>{\r\n      if (user.id == auth.user?.id)\r\n        if(user.username && user.password){\r\n          dispatch({type:'LOGIN_REQUEST', username:user.username, password:user.password})\r\n        }\r\n        else{\r\n          dispatch({type:\"REFRESH\"})\r\n        }\r\n      else{\r\n        queryClient.invalidateQueries(\"UserMembershipList\")\r\n      }\r\n    }\r\n  })\r\n  const _delete = useMutation(deleteUser, {\r\n    onSuccess: (data, id)=>{\r\n      queryClient.invalidateQueries(\"UserMembershipList\")\r\n      if (id == auth.user?.id)\r\n        dispatch({type:\"LOGOUT_REQUEST\"})\r\n    }\r\n  })\r\n  return {create:_create.mutateAsync, update:_update.mutateAsync, delete:_delete.mutateAsync}\r\n}","import { useMutation, useQuery, useQueryClient } from \"react-query\";\r\nimport { postBulkMessengerMember, deleteMessengerMember, getMessengerMemberList } from \"../../services\";\r\n\r\nexport default function useMessengerMemberList(channel_id:number){\r\n  const { data } = useQuery([\"MessengerMemberList\", channel_id] , async()=>await getMessengerMemberList(channel_id))\r\n  return data\r\n}\r\n\r\n\r\nexport function useMessengerMemberMutation(){\r\n  const queryClient = useQueryClient()\r\n  const invite = useMutation(postBulkMessengerMember, {\r\n    onSuccess: ()=>{\r\n      queryClient.invalidateQueries(\"MessengerMemberList\")\r\n    }\r\n  })\r\n\r\n  const leave = useMutation(deleteMessengerMember, {\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries(\"ChannelList\")\r\n      queryClient.invalidateQueries(\"MessengerMemberList\")\r\n    }\r\n  })\r\n  return {invite:invite.mutateAsync, leave:leave.mutateAsync}\r\n}","import React, { useState } from 'react';\r\nimport { StyleSheet} from 'react-native';\r\nimport { CustomButtonProps } from '../types';\r\nimport CommonButton from './CommonButton';\r\n\r\nexport default (props:CustomButtonProps)=>{\r\n    return <CommonButton {...props} style={[styles.style, props.style]}/>\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n    style:{\r\n        borderRadius:6, \r\n        backgroundColor: 'transparent',\r\n        borderWidth:0\r\n    },\r\n});\r\n","import React, {useState, useEffect } from 'react';\r\nimport { StyleSheet } from 'react-native';\r\nimport { View, Text } from '../components/Themed';\r\nimport CommonButton from '../components/CommonButton';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport { navigate } from '../navigation';\r\nimport { Channel } from '../types';\r\nimport useMessengerChannelList, { useMessengerChannelMutation } from '../hooks/lists/useMessengerChannelList';\r\nimport TextField from '../components/TextField';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport ModalSection from '../components/ModalSection';\r\nimport { useMessengerMemberMutation } from '../hooks/lists/useMessengerMemberList';\r\nimport { avatarFromChannel } from '../components/Avatar';\r\nimport useModalEffect from '../hooks/useModalEffect';\r\n\r\nexport default function ChannelEditModal({id, member_id, type}: {id?:number, member_id?:number, type:string}) {\r\n  const { lang } = useLangContext()\r\n  const {auth} = useAuthContext()\r\n  const { setModal } = useModalsContext()\r\n  const channelList = useMessengerChannelList(type, auth)\r\n  const channelMutation = useMessengerChannelMutation(type)\r\n  const messengerMemberMutation = useMessengerMemberMutation()\r\n  const channel = channelList?.find(v=>v.id==id)\r\n  const title = type=='messenger'?\r\n    (id?lang('Chat Setting'):lang('New chat')):\r\n    (id?lang('Channel Setting'):lang('New Channel'))\r\n  const [name, setName] = useState('')\r\n  const [description, setDescription] = useState('')\r\n  const back = ()=>{\r\n    setModal(ChannelEditModal, null)\r\n  }\r\n\r\n  useEffect(()=>{\r\n    if (channel){\r\n      const {name:_name} = avatarFromChannel(channel, auth.user)\r\n      setName(_name)\r\n      setDescription(channel?.description || '')\r\n    }\r\n  }, [channel?.id])\r\n  useModalEffect(back, [])\r\n\r\n  return <ModalSection>\r\n    <View style={{justifyContent:'space-between', flex:1, width:'100%'}}>\r\n      <View style={{width:'100%'}}>\r\n        <Text style={{fontSize:20}}>{title}</Text>\r\n        <View style={styles.separator} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n        <TextField name={lang('Channel Name')} value={name} setValue={setName} width={'60%'}/>\r\n        <TextField name={lang('Description')} value={description} setValue={setDescription} multiline width={'60%'}/>\r\n      </View>\r\n      <View style={{width:'100%', flexDirection:'row'}}>\r\n        {member_id &&<View style={{flexDirection:'row', justifyContent:'flex-start'}}>\r\n          <CommonButton title={lang('leave')} style={{marginHorizontal:5}} textStyle={{color:'red'}} onPress={()=>messengerMemberMutation.leave(member_id).then(back)}/>\r\n        </View>}\r\n        <View style={{flex:1, flexDirection:'row', justifyContent:'flex-end'}}>\r\n          <CommonButton title={lang('save')} onPress={()=>{\r\n            if(auth?.user?.id && auth.groupId){\r\n              const newChannel:Channel = {id, name, description, type, owner:auth?.user?.id, group:auth.groupId};\r\n              (id?channelMutation.update(newChannel):channelMutation.create(newChannel)).then(v=>navigate(\"Main\", {\r\n                screen:v.type == 'messenger'?'ChatScreen':'MyMessageScreen',\r\n                params:{id:v.id}\r\n              }))\r\n            }\r\n          }}/>\r\n          <CommonButton title={lang('cancel')} style={{marginHorizontal:5}} onPress={back}/>\r\n        </View>\r\n      </View>\r\n    </View>\r\n  </ModalSection>\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  field:{\r\n    width:'50%',\r\n    flexDirection:'row',\r\n    padding:10,\r\n  },\r\n  separator: {\r\n    marginBottom: 20,\r\n    height: 1,\r\n    width: '100%',\r\n  },\r\n})","import React, { useState, useEffect } from \"react\";\r\nimport { StyleSheet, TextInput } from \"react-native\";\r\nimport useLangContext from \"../hooks/useLangContext\";\r\nimport useUserMembershipList, { useUserMembershipMutation } from \"../hooks/lists/useUserMembershipList\";\r\nimport useAuthContext from \"../hooks/useAuthContext\";\r\nimport ModalSection from \"../components/ModalSection\";\r\nimport useModalsContext from \"../hooks/useModalsContext\";\r\nimport { View, Text } from \"../components/Themed\";\r\nimport RowField from \"../components/RowField\";\r\nimport CommonButton from \"../components/CommonButton\";\r\nimport CommonTextInput from \"../components/CommonTextInput\";\r\nimport useExternalMembershipList from \"../hooks/lists/useExternalMembershipList\";\r\n// import TextButton from \"../components/TextButton\";\r\n// import Colors from \"../constants/Colors\";\r\n// import useColorScheme from \"../hooks/useColorScheme\";\r\n\r\ntype ErrorMessages = {\r\n    username?:string,\r\n    name?:string,\r\n    password?:string,\r\n    checkPassword?:string\r\n}\r\n\r\nconst ErrorView = (props:{message?:string})=>{\r\n  const { lang } = useLangContext()\r\n  return props.message?<View style={styles.form_error}>\r\n  <Text style={styles.form_error_text}>{lang(props.message)}</Text>\r\n</View>:<></>\r\n}\r\n\r\nexport default function RegistrationModal({id}:{id?:number}) {\r\n  const { lang } = useLangContext()\r\n  const {auth} = useAuthContext()\r\n  // const theme = useColorScheme()\r\n  // const color = Colors[theme].text\r\n  const { setModal } = useModalsContext()\r\n  const [username, setUsername] = useState(\"\");\r\n  const [name, setName] = useState(\"\")\r\n  const [password, setPassword] = useState(\"\");\r\n  const [checkPassword, setCheckPassword] = useState(\"\")\r\n  const [isStaff, setIsStaff] = useState(false)\r\n  const [error, setError] = useState<ErrorMessages>({})\r\n  const userList = useUserMembershipList(auth)\r\n  const externalMemberList = useExternalMembershipList(username)\r\n  const userMembershipMutation = useUserMembershipMutation()\r\n  const user = userList?.find(v=>v.id==id)\r\n  const usernameDisable = user && user.is_guest===false\r\n  useEffect(()=>{\r\n    if (user){\r\n      setUsername(user.username)\r\n      setName(user.name)\r\n    }\r\n  }, [user?.id])\r\n  const _register = ()=>{\r\n    let newError:ErrorMessages = {};\r\n    if ((externalMemberList?.length || 0) >0 && !usernameDisable) newError.username = \"The username is already in use.\"\r\n    if (username.length < 10 || username.length > 64) newError.username = \"Set 10-64 characters.\"\r\n    if (name.length < 1 || name.length > 64) newError.name = \"Set 1-64 characters.\"\r\n    if (!/^(?=.*[A-Za-z])(?=.*\\d)(?=.*[@$!%*#?&])[A-Za-z\\d@$!%*#?&]{10,64}$/.test(password) && !(usernameDisable && password.length==0)) newError.password = \"Set 10-64 characters with a combination of letters/numbers/valid special characters.\"\r\n    if (password != checkPassword) newError.checkPassword = \"Incorrect between password and check password.\"\r\n    if (Object.keys(newError).length > 0){\r\n        setError(newError)\r\n        return\r\n    }\r\n    if (id){\r\n      userMembershipMutation.update({\r\n        id,\r\n        name,\r\n        username:usernameDisable?undefined:username,\r\n        is_guest:false,\r\n        password:password.length>0?password:undefined,\r\n      }).then(()=>{(id!=auth.user?.id || user?.is_guest) && back()})\r\n    }\r\n    else{\r\n      auth?.groupId && userMembershipMutation.create({\r\n          username,\r\n          name,\r\n          password,\r\n          is_guest:false,\r\n          is_staff:isStaff,\r\n          inviteGroupId:auth.groupId,\r\n\r\n      }).then(back)\r\n    }\r\n  }\r\n  const back = ()=>{\r\n    setModal(RegistrationModal, null)\r\n  }\r\n  return <ModalSection>\r\n    <View style={{justifyContent:'space-between', flex:1, width:'100%'}}>\r\n      <View style={{flex:1, width:'100%'}}>\r\n        <Text style={{fontSize:20}}>{usernameDisable?lang('Edit User'):lang('Create User')}</Text>\r\n        <View style={styles.separator} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n        <RowField name={lang('Username')} width={'60%'}>\r\n          {usernameDisable?<Text style={{fontSize:16}}>{username}</Text>:<CommonTextInput\r\n              value={username}\r\n              setValue={(text) => setUsername(text)}\r\n              keyboardType={'email-address'}\r\n          />}\r\n          <ErrorView message={error.username}/>\r\n        </RowField>\r\n        <RowField name={lang('Name')} width={'60%'}>\r\n          <CommonTextInput\r\n              value={name}\r\n              setValue={(text) => setName(text)}\r\n          />\r\n          <ErrorView message={error.name}/>\r\n        </RowField>\r\n        <RowField name={lang('Password')} width={'60%'}>\r\n          <CommonTextInput\r\n              value={password}\r\n              secureTextEntry\r\n              setValue={(text) => setPassword(text)}\r\n          />\r\n          <ErrorView message={error.password}/>\r\n        </RowField>\r\n        <RowField name={lang('Check Password')} width={'60%'}>\r\n          <CommonTextInput\r\n              value={checkPassword}\r\n              secureTextEntry\r\n              setValue={(text) => setCheckPassword(text)}\r\n          />\r\n          <ErrorView message={error.checkPassword}/>\r\n        </RowField>\r\n        {/* <RowField name={lang('Manager Permission')} width={'60%'}>\r\n          <View style={{flexDirection:'row'}}>\r\n            {[[lang('Yes'), true], [lang('No'), false]].map(([title, value])=><TextButton \r\n              key={title} title={title} textStyle={{fontSize:16, color, textDecorationLine:isStaff==value?'underline':'none'}} style={{borderRadius:20}} onPress={(\r\n              )=>setIsStaff(value)}/>)}\r\n          </View>\r\n        </RowField> */}\r\n      </View>\r\n      <View style={{width:'100%', flexDirection:'row'}}>\r\n        {id && <View style={{flexDirection:'row', justifyContent:'flex-start'}}>\r\n          <CommonButton title={lang('delete account')} style={{marginHorizontal:5}} textStyle={{color:'red'}} onPress={()=>userMembershipMutation.delete(id).then(back)}/>\r\n        </View>}\r\n        <View style={{flex:1, flexDirection:'row', justifyContent:'flex-end'}}>\r\n          <CommonButton title={lang('save')} onPress={_register}/>\r\n          <CommonButton title={lang('cancel')} style={{marginHorizontal:5}} onPress={back}/>\r\n        </View>\r\n      </View>\r\n    </View>\r\n  </ModalSection>\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  form_error: {\r\n    height: 22,\r\n    width:'100%',\r\n  },\r\n  form_error_text:{\r\n    textAlignVertical:'center',\r\n    color:'red',\r\n    fontSize:13,\r\n  },\r\n  separator: {\r\n    marginBottom: 20,\r\n    height: 1,\r\n    width: '100%',\r\n  },\r\n});","import React, { useMemo } from 'react';\r\n\r\nimport { TextProps, StyleProp } from 'react-native';\r\nimport {View, Text } from './Themed'\r\nimport useResizeContext from '../hooks/useResizeContext';\r\n\r\ntype Props = {\r\n  name: string,\r\n  width?:any,\r\n  children: React.ReactNode\r\n  textStyle?: StyleProp<TextProps>\r\n}\r\n\r\nexport default function RowField(props:Props) {\r\n  const windowType = useResizeContext()\r\n  const rowStyle = useMemo(()=>windowType=='landscape'?\r\n    {flexDirection:'row', alignItems: 'center', justifyContent:'space-between'}:\r\n    {flexDirection:'column', alignItems:'flex-start'} as any\r\n  , [windowType])\r\n  return (\r\n    <View style={[{paddingVertical:windowType=='landscape'?15:5, width:'100%'}, rowStyle]}>\r\n        <Text style={[windowType=='landscape'?{flex:1}:{width:'100%'},{paddingHorizontal: 15, fontSize:16}, props.textStyle]}>{props.name}</Text>\r\n        <View style={[windowType=='landscape'?{flex:6}:{width:'100%'},{paddingHorizontal: 15}]}>\r\n          <View style={{width:props.width}}>\r\n            {props.children}\r\n          </View>\r\n        </View>\r\n    </View>\r\n  )\r\n}","import React from 'react';\r\nimport { Platform } from 'react-native';\r\nimport { TabView, SceneMap,NavigationState, SceneRendererProps, TabBar } from 'react-native-tab-view';\r\nimport Colors from '../constants/Colors';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport { TabViewRecord } from '../types';\r\n\r\n\r\nexport default (props:{tabs:TabViewRecord, tabBarPosition:\"top\"|\"bottom\", index?:number, onTab?:(index:number)=>void})=>{\r\n  const { lang } = useLangContext()\r\n  const index = props.index || 0\r\n  const theme = useColorScheme()\r\n  const entries = Object.entries(props.tabs)\r\n  const onTab = props.onTab\r\n  const icons = Object.assign({}, ...entries.map(([k, v])=>({[k]:v.icon})))\r\n  return <TabView\r\n    renderTabBar={(props:SceneRendererProps & {navigationState: NavigationState<any>})=>{\r\n      return <TabBar\r\n        {...props}\r\n        indicatorStyle={{ backgroundColor: \"#2196F3\" }}\r\n        style={{ backgroundColor:Colors[theme].background}}\r\n        /* @ts-ignore */\r\n        labelStyle={{whiteSpace:\"nowrap\"}}\r\n        activeColor={Colors[theme].text}\r\n        inactiveColor={Colors[theme].text}\r\n        renderIcon={(scene)=>icons[scene.route.key]}\r\n        onTabPress={(scene)=>onTab?.(entries.findIndex(([k, v])=>k == scene.route.key))}\r\n      />\r\n    }}\r\n    navigationState={{ index, routes: entries.map(([k, v])=>({key:k, title:lang(v.title)}))}}\r\n    onIndexChange={(v)=>{onTab?.(v)}}\r\n    onSwipeStart={()=>{\r\n      if (Platform.OS === 'web') {\r\n        if (window.getSelection) {\r\n            var sel = window.getSelection();\r\n            sel?.removeAllRanges();\r\n        }\r\n    }\r\n    }}\r\n    renderScene={SceneMap(Object.assign({}, ...entries.map(([k, v])=>({[k]:v.component}))))}\r\n    tabBarPosition={props.tabBarPosition}\r\n  />\r\n}\r\n\r\n","import * as React from 'react';\r\nimport { View } from './Themed';\r\nimport { StyleSheet, StyleProp, ViewStyle, TextStyle, Pressable } from 'react-native';\r\nimport Colors from '../constants/Colors';\r\n\r\nexport type ItemParamList = {\r\n    outerContainerStyle?:StyleProp<TextStyle>\r\n    containerStyle?:StyleProp<ViewStyle>\r\n    bodyStyle?:StyleProp<ViewStyle>\r\n    children?: React.ReactNode\r\n    onPress?: ()=>void\r\n}\r\n\r\nexport default function CommonItem(props:ItemParamList){\r\n  // const [hover, setHover] = React.useState(false)\r\n  const [press, setPress] = React.useState(false)\r\n  return (\r\n    <Pressable\r\n      style={[styles.outerContainer ,props.outerContainerStyle, (press)?{backgroundColor:'rgb(242,242,242)'}:{}]}\r\n      onPressIn={()=>setPress(true)}\r\n      onPress={()=>props.onPress?.()}\r\n      onPressOut={()=>setPress(false)}\r\n      //  //@ts-ignore\r\n      //  onHoverIn={()=>setHover(true)}\r\n      //  onHoverOut={()=>setHover(false)}\r\n    >\r\n        <View style={[styles.container ,props.containerStyle]}>\r\n            <View style={[styles.bodyView, props.bodyStyle]}>\r\n                <>{props.children}</>\r\n            </View>\r\n      </View>\r\n    </Pressable>\r\n    )\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  outerContainer:{\r\n    width:'100%',\r\n    maxWidth:1080,\r\n    alignItems:'stretch',\r\n  },  \r\n  container: {\r\n      marginHorizontal:20,\r\n      backgroundColor:'transparent'\r\n    },\r\n    bodyView:{\r\n      width: '100%',\r\n      padding: 10,\r\n      minHeight: 40,\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      borderBottomWidth:1,\r\n      borderColor:Colors.borderColor,\r\n      backgroundColor:'transparent'\r\n    }\r\n  });\r\n  ","import React from 'react'\r\nimport TextButton from \"./TextButton\"\r\nimport useAuthContext from \"../hooks/useAuthContext\"\r\nimport useResizeContext from '../hooks/useResizeContext'\r\nimport { View } from 'react-native'\r\nimport useModalsContext from '../hooks/useModalsContext'\r\nimport AlertModal from '../modals/AlertModal'\r\nimport useLangContext from '../hooks/useLangContext'\r\nimport useColorScheme from '../hooks/useColorScheme'\r\nimport Colors from '../constants/Colors'\r\n\r\ntype ButtonProps = {title:string, onPress:()=>void, windowType?:'landscape'|'portrait'}\r\n\r\nexport default (props:{extra?:ButtonProps[]})=>{\r\n    const { lang } = useLangContext()\r\n    const theme = useColorScheme()\r\n    const {auth, dispatch} = useAuthContext()\r\n    const { setModal } = useModalsContext()\r\n    const windowType = useResizeContext()\r\n    const defaultButtonProps:ButtonProps[] = [{title:lang('sign out'), onPress:()=>{\r\n        if (auth?.user?.is_guest){\r\n            setModal(AlertModal, {type:\"GUEST_LOGOUT\"})\r\n        }\r\n        else{\r\n            dispatch({type:\"LOGOUT_REQUEST\"})\r\n        }\r\n    }}]\r\n    const buttonProps = (props.extra?[...props.extra, ...defaultButtonProps]:defaultButtonProps).filter(v=>v.windowType==windowType || v.windowType == undefined)\r\n    return<View style={{flexDirection:'row'}}>\r\n        {buttonProps.map((v,k)=><TextButton key={k} {...v} textStyle={{color:Colors[theme].text}} color='#gray'/>)}\r\n    </View>\r\n}\r\n  ","import React, { useEffect } from 'react';\r\nimport Profile from '../components/Profile';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport useUserMembershipList from '../hooks/lists/useUserMembershipList';\r\nimport { useMessengerChannelMutation } from '../hooks/lists/useMessengerChannelList';\r\nimport CommonButton from '../components/CommonButton';\r\nimport { Channel } from '../types';\r\nimport { navigate } from '../navigation';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport { Text, View } from '../components/Themed';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport { Ionicons } from '../lib/@expo/vector-icons';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport Colors from '../constants/Colors';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { BottomSheet } from '../components/ModalSection';\r\nimport useModalEffect from '../hooks/useModalEffect';\r\nimport RegistrationModal from './RegistrationModal';\r\n\r\nexport default function ProfileModal({id}:{id:number}) {\r\n  const { lang } = useLangContext()\r\n  const theme = useColorScheme()\r\n  const {auth} = useAuthContext()\r\n  const { setModal } = useModalsContext()\r\n  const userList = useUserMembershipList(auth)\r\n  const user = userList?.find(v=>v.id==id)\r\n  const isSelf = auth.user && user && (auth.user?.id==user?.id)\r\n  const channelMutation = useMessengerChannelMutation('messenger')\r\n  const back = ()=>{\r\n    setModal(ProfileModal, null)\r\n  }\r\n  useEffect(()=>{\r\n    if (!(id && user) && userList)\r\n      back()\r\n  }, [userList])\r\n  useModalEffect(back, [])\r\n  return user?<BottomSheet>\r\n    <View style={{flexDirection:'row', width:'100%'}}>\r\n      <View style={{flex:1, flexDirection:'row'}}>\r\n        <TouchableOpacity onPress={back}>\r\n          <Ionicons size={20} name=\"arrow-back\" color={Colors[theme].text}/>\r\n        </TouchableOpacity>\r\n      </View>\r\n      <View style={{flex:1}}>\r\n        <Text style={{fontSize:20, textAlign:'center'}}>{lang('profile')}</Text>\r\n      </View>\r\n      <View style={{flex:1}}/>\r\n    </View>\r\n    <View style={{marginBottom: 20, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n    \r\n    <Profile username={user.username} name={user.name} userId={user.id} />\r\n    {isSelf?\r\n    (!auth.user?.is_guest && <CommonButton title={lang('Account Settings')} onPress={()=>{setModal(RegistrationModal, {id:auth.user?.id})}}/>):\r\n    <CommonButton title={lang('1:1 Chat')} onPress={()=>{\r\n      if(auth?.user?.id && auth.groupId){\r\n        const newChannel:Channel = {name:\"\", type:'messenger', owner:auth?.user?.id, group:auth.groupId, subowner:user.id};\r\n        channelMutation.direct(newChannel).then(v=>navigate(\"Main\", {screen:\"ChatScreen\", params: {id:v.id}}))\r\n      }\r\n    }}/>}\r\n  </BottomSheet>:<></>\r\n}\r\n","import React from 'react'\r\nimport { View, StyleSheet, Linking, Platform, TouchableOpacity  } from 'react-native'\r\nimport { } from 'react-native-gesture-handler'\r\nimport { AntDesign } from '../lib/@expo/vector-icons'; \r\nimport Colors from '../constants/Colors';\r\n\r\nconst openURL = Platform.OS=='web'?(url:string)=>{location.href=url}:Linking.openURL\r\n\r\nexport default (props:{theme:'light'|'dark'})=>{\r\n    return<View style={Styles.footer_buttons}>\r\n        <TouchableOpacity style={Styles.footer_button} onPress={()=>openURL(\"https://github.com/blacktokki/tokki-tok\")}>\r\n            <AntDesign name=\"github\" size={24} color={Colors[props.theme].iconColor} />\r\n        </TouchableOpacity>\r\n        <TouchableOpacity style={Styles.footer_button} onPress={()=>Linking.openURL(\"mailto:ydh051541@naver.com\")}>\r\n            <AntDesign name=\"mail\" size={24} color={Colors[props.theme].iconColor} />\r\n        </TouchableOpacity>\r\n    </View>\r\n}\r\n\r\nconst Styles = StyleSheet.create({\r\n      footer_buttons: {\r\n        width: '100%',\r\n        flexDirection: 'row',\r\n        justifyContent: 'flex-end',\r\n        paddingBottom: 20,\r\n        paddingRight: 20,\r\n      },\r\n      footer_button: {\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        width: 38,\r\n        height: 38,\r\n        marginHorizontal: 12,\r\n        borderWidth: 1,\r\n        borderColor: '#E7E7E7',\r\n        borderRadius: 60,\r\n      },\r\n})","import React, {useEffect, useState} from 'react';\r\nimport {\r\n  Text,\r\n  TextInput,\r\n  TouchableOpacity,\r\n  View,\r\n  StyleSheet,\r\n} from 'react-native';\r\nimport { StackScreenProps } from '@react-navigation/stack';\r\nimport useAuthContext from '../../hooks/useAuthContext';\r\nimport useLangContext from '../../hooks/useLangContext';\r\nimport ContractFooter from '../../components/ContractFooter';\r\n\r\nexport default function LoginScreen({\r\n  navigation, route\r\n}: StackScreenProps<any, 'Login'>) {\r\n  const { lang } = useLangContext()\r\n  const [username, setUsername] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const {error, dispatch} = useAuthContext()\r\n  const _login = ()=>dispatch({type:'LOGIN_REQUEST', username, password})\r\n  useEffect(() => {\r\n    navigation.setOptions({\r\n      headerRight: undefined\r\n    });\r\n  }, [navigation]);\r\n\r\n  return (<View style={Styles.login_container}>\r\n    <View style={Styles.login_wrapper}>\r\n      <View style={Styles.form}>\r\n        {error && <View style={Styles.form_error}>\r\n          <Text style={Styles.form_error_text}>{lang(error)}</Text>\r\n        </View>}\r\n        <TextInput\r\n          style={Styles.form_input}\r\n          value={username}\r\n          placeholder={lang('Username')}\r\n          onChangeText={(text) => setUsername(text)}\r\n          autoCapitalize={'none'}\r\n          keyboardType={'email-address'}\r\n          onSubmitEditing={_login}\r\n        />\r\n        <TextInput\r\n          style={Styles.form_input}\r\n          value={password}\r\n          placeholder={lang('Password')}\r\n          secureTextEntry\r\n          onChangeText={(text) => setPassword(text)}\r\n          onSubmitEditing={_login}\r\n        />\r\n        <TouchableOpacity onPress={_login}>\r\n          <View style={Styles.button}>\r\n            <Text style={Styles.button_label}>{lang('Sign in')}</Text>\r\n          </View>\r\n        </TouchableOpacity>\r\n        <TouchableOpacity onPress={() => dispatch({type:\"LOGIN_GUEST\"})}>\r\n          <Text style={Styles.guest_footer_text}>\r\n            {lang(\"Sign in as guest\")}\r\n          </Text>\r\n        </TouchableOpacity>\r\n      </View>\r\n      <View style={Styles.login_social}>\r\n        <View style={Styles.login_social_separator}>\r\n          <View style={Styles.login_social_separator_line} />\r\n          <Text style={Styles.login_social_separator_text}>{'*'}</Text>\r\n          <View style={Styles.login_social_separator_line} />\r\n        </View>\r\n        <View style={Styles.login_social_buttons}>\r\n        </View>\r\n      </View>\r\n      {/* <>\r\n        <TouchableOpacity onPress={() => navigate(\"RegistrationScreen\")}>\r\n          <Text style={Styles.login_footer_text}>\r\n            {\"Don't have an account? \"}\r\n            <Text style={Styles.login_footer_link}>{'Sign up'}</Text>\r\n          </Text>\r\n        </TouchableOpacity>\r\n      </> */}\r\n    </View>\r\n    <ContractFooter theme='light'/>\r\n  </View>);\r\n};\r\n\r\nconst Styles = StyleSheet.create({\r\n    login_container: {\r\n      flex: 1,\r\n      backgroundColor: '#FFF',\r\n    },\r\n    login_header: {\r\n      alignItems: 'center',\r\n      paddingTop: 30,\r\n      paddingBottom: 50,\r\n      backgroundColor: '#208AEC',\r\n    },\r\n    login_header_logo: {\r\n      width: 220,\r\n      resizeMode: 'contain',\r\n    },\r\n    login_header_text: {\r\n      marginTop: 15,\r\n      color: '#f0f0f0',\r\n      fontSize: 16,\r\n    },\r\n    login_header_text_bold: {\r\n      color: '#fff',\r\n      fontWeight: 'bold',\r\n    },\r\n    login_wrapper: {\r\n      flex: 1,\r\n      justifyContent: 'space-between',\r\n      paddingTop: 40,\r\n      borderTopRightRadius: 12,\r\n      borderTopLeftRadius: 12,\r\n      backgroundColor: '#fff',\r\n      alignItems: 'center',\r\n    },\r\n    form: {\r\n      width: '100%',\r\n      maxWidth: 320,\r\n    },\r\n    form_error: {\r\n      height: 22,\r\n      width:'100%',\r\n    },\r\n    form_error_text:{\r\n      textAlignVertical:'center',\r\n      color:'red',\r\n      fontSize:13,\r\n    },\r\n    form_input: {\r\n      height: 44,\r\n      paddingHorizontal: 20,\r\n      marginBottom: 20,\r\n      backgroundColor: '#EDF0F7',\r\n      borderRadius: 50,\r\n    },\r\n    button: {\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      height: 44,\r\n      backgroundColor: '#0065A4',\r\n      borderRadius: 50,\r\n    },\r\n    button_label: {\r\n      color: '#fff',\r\n      fontSize: 16,\r\n    },\r\n    login_social: {\r\n      width: '100%',\r\n      maxWidth: 280,\r\n      marginTop: 20,\r\n    },\r\n    login_social_separator: {\r\n      flexDirection: 'row',\r\n      alignItems: 'center',\r\n    },\r\n    login_social_separator_line: {\r\n      flex: 1,\r\n      width: '100%',\r\n      height: 1,\r\n      backgroundColor: '#E0E0E0',\r\n    },\r\n    login_social_separator_text: {\r\n      marginHorizontal: 10,\r\n      color: '#808080',\r\n      fontSize: 16,\r\n    },\r\n    login_social_buttons: {\r\n      flexDirection: 'row',\r\n      justifyContent: 'center',\r\n      marginTop: 20,\r\n    },\r\n    login_social_button: {\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      width: 60,\r\n      height: 60,\r\n      marginHorizontal: 12,\r\n      borderWidth: 1,\r\n      borderColor: '#E7E7E7',\r\n      borderRadius: 60,\r\n    },\r\n    login_social_icon: {\r\n      width: 38,\r\n      height: 38,\r\n      resizeMode: 'contain',\r\n    },\r\n    login_social_facebook: {\r\n      backgroundColor: '#4267B2',\r\n      borderColor: '#4267B2',\r\n    },\r\n    login_footer_text: {\r\n      flexDirection: 'row',\r\n      alignItems: 'center',\r\n      color: '#808080',\r\n      fontSize: 14,\r\n    },\r\n    guest_footer_text: {\r\n      flexDirection: 'row',\r\n      alignSelf: 'center',\r\n      color: '#808080',\r\n      fontSize: 15,\r\n      margin: 15\r\n    },\r\n    login_footer_link: {\r\n      color: '#208AEC',\r\n      fontSize: 15,\r\n      fontWeight: 'bold',\r\n    },\r\n  });\r\n  ","import React, { createContext, useContext } from \"react\"\r\nimport { SendJsonMessage } from \"react-use-websocket/dist/lib/types\";\r\nimport { WebSocketInternalProvider } from \"../../hooks/useWebsocketContext\";\r\n\r\nconst WebSocketContext = createContext<{lastJsonMessage:any, sendJsonMessage:SendJsonMessage }>({lastJsonMessage:undefined, sendJsonMessage:()=>{}});\r\n\r\nexport const WebSocketProvider = ({disable, children}:{disable?:boolean, children:React.ReactNode})=>{\r\n  return disable?<></>:<WebSocketInternalProvider path={'messenger/ws/rtc/'} Context={WebSocketContext} useBackground>\r\n    {children}\r\n  </WebSocketInternalProvider>\r\n}\r\n\r\nexport default ()=>{\r\n  const webSocketContext = useContext(WebSocketContext)\r\n  return webSocketContext\r\n}\r\n\r\n","import React, { useCallback, useRef, useState, useMemo } from \"react\";\r\n//@ts-ignore\r\nimport { RTCView, mediaDevices, RTCPeerConnection, MediaStream, RTCSessionDescription, RTCIceCandidate } from \"react-native-webrtc-web-shim\";\r\nimport {TURN_SERVER} from \"../../../constants/Envs\"\r\n\r\n\r\nconsole.log(TURN_SERVER?\"use turn server\": \"use stun server\")\r\n\r\nexport const peerConstraints = {\r\n\ticeServers: [TURN_SERVER?JSON.parse(TURN_SERVER):{urls: 'stun:stun.l.google.com:19302'}]\r\n};\r\n\r\nexport const sessionConstraints = {\r\n\tmandatory: {\r\n\t\tOfferToReceiveAudio: true,\r\n\t\tOfferToReceiveVideo: true,\r\n\t\tVoiceActivityDetection: true\r\n\t}\r\n};\r\n\r\nconst mediaConstraints = {audio:true, video:{framerate:30}}\r\n\r\n//@ts-ignore\r\nexport {MediaStream, RTCPeerConnection, RTCSessionDescription} from \"react-native-webrtc-web-shim\";\r\n\r\nconst onICEcandidate = (pc:typeof RTCPeerConnection, message:any)=>{\r\n\tconst _message = message.data.rtcMessage\r\n\t\tconst candidate = new RTCIceCandidate(_message);\r\n\t\tif (pc) {\r\n\t\t\tconsole.log(\"ICE candidate Added\");\r\n\t\t\tpc.addIceCandidate(candidate);\r\n\t\t}\r\n}\r\n\r\nconst sendICEcandidate = (event:any, sendMessage:(data:any)=>void, receiver:string, target:string) => {\r\n\t// When you find a null candidate then there are no more candidates.\r\n\t// Gathering of candidates has finished.\r\n\tif ( !event.candidate ) { return; };\r\n\t// Send the event.candidate onto the person you're calling.\r\n\t// Keeping to Trickle ICE Standards, you should send the candidates immediately.\r\n\tsendMessage({type:'ICEcandidate', receiver, data:{target, rtcMessage:event.candidate}})\r\n  }\r\n\r\nconst BAND_WIDTH = 8000\r\n\r\nconst optimizeSdp = (offerDescription:RTCSessionDescription)=>{\r\n\tvar arr = offerDescription.sdp.split('\\r\\n');\r\n\tarr.forEach((str:string, i:number) => {\r\n\t\tif (/^a=fmtp:\\d*/.test(str)) {\r\n\t\t\tarr[i] = str + `;x-google-max-bitrate=${BAND_WIDTH};x-google-min-bitrate=${BAND_WIDTH};x-google-start-bitrate=${BAND_WIDTH}`;\r\n\t\t} else if (/^a=mid:(0|video)/.test(str)) { // if with audio then 0=>1\r\n\t\t\tarr[i] += `\\r\\nb=AS:${BAND_WIDTH}`;\r\n\t\t}\r\n\t});\r\n  \treturn new RTCSessionDescription({\r\n    \ttype: offerDescription.type,\r\n    \tsdp: arr.join('\\r\\n'),\r\n  \t})\r\n}\r\n\r\nconst createOffer = async(pcRefCurrent:{pc?:typeof RTCPeerConnection, receiver:string}, sendMessage:(data:any)=>void, stream:typeof MediaStream, target:string, user?:{name:string})=>{\r\n\tstream && pcRefCurrent.pc.addStream( stream );\r\n\tconst offerDescription = optimizeSdp((await pcRefCurrent.pc.createOffer( sessionConstraints )));\r\n\tawait pcRefCurrent.pc.setLocalDescription( offerDescription );\r\n\tsendMessage({type:'call', receiver:pcRefCurrent.receiver, data:{target, name:user?.name, rtcMessage:offerDescription}})\r\n}\r\n\r\nexport const useLocalCam = (sendMessage:(data:any)=>void)=>{\r\n\tconst pcRef = useRef<Record<number,{pc:typeof RTCPeerConnection, receiver:string}>>({})\r\n\tconst [sender, setSender] = useState<string>()\r\n\tconst [_stream, setStream] = useState<MediaStream>()\r\n\tconst isPlay = useMemo(()=>_stream?true:false, [_stream])\r\n\tconst CustomRTCView = useCallback(React.memo(({style}:{style:any})=>(_stream?<RTCView stream={_stream} style={style} videoProps={{height:'100%'}} />:<></>)) , [_stream])\r\n\tconst start = useCallback(async(user:{name:string}, stream?:typeof MediaStream, mode?:'camera'|'display')=>{\r\n\t\tconsole.log(\"start\");\r\n\t\tif (!_stream || mode!==undefined) {\r\n\t\t\ttry {\r\n\t\t\t\tlet newStream:typeof MediaStream;\r\n\t\t\t\tif(mode == 'camera'){\r\n\t\t\t\t\tnewStream = await mediaDevices.getUserMedia(mediaConstraints)\r\n\t\t\t\t}\r\n\t\t\t\telse if (mode == 'display'){\r\n\t\t\t\t\tnewStream = await mediaDevices.getDisplayMedia(mediaConstraints)\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tnewStream = stream || await mediaDevices.getUserMedia(mediaConstraints).catch((e:any)=>mediaDevices.getDisplayMedia(mediaConstraints));\r\n\t\t\t\t}\r\n\t\t\t\tsetStream(newStream)\r\n\t\t\t\tObject.entries(pcRef.current).map(([k, v])=>{\r\n\t\t\t\t\tcreateOffer(v, sendMessage, newStream, 'guest', user)\r\n\t\t\t\t})\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.error(e);\r\n\t\t\t}\r\n\t\t}\r\n\t}, [_stream])\r\n\tconst stop = useCallback(()=>{\r\n\t\tconsole.log(\"stop\");\r\n\t\tif(_stream){\r\n\t\t\t_stream.getTracks().map((track:any) => track.stop());\r\n\t\t\tsetStream(undefined)\r\n\t\t}\r\n\t}, [_stream])\r\n\treturn {\r\n\t\tstart,\r\n\t\tstop,\r\n\t\twebsocketOnMessage: async(response:any, user:{name:string})=>{\r\n\t\t\tlet type = response.type;\r\n\t\t\tif (type == 'connection'){\r\n\t\t\t\tsetSender(response.data.channel_name)\r\n\t\t\t}\r\n\t\t\tif (type == 'start' && response.data.target=='host'){\r\n\t\t\t  console.log('1 start')\r\n\t\t\t  const peerConnection = new RTCPeerConnection( peerConstraints );\r\n\t\t\t  peerConnection.addEventListener( 'icecandidate', (event:any) => sendICEcandidate(event, sendMessage, response.sender, 'guest'));\r\n\t\t\t  pcRef.current[response.sender] = {pc:peerConnection, receiver: response.sender}\r\n\t\t\t  createOffer(pcRef.current[response.sender], sendMessage, _stream, 'guest', user)\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (type == \"answer\" && response.data.target == 'host'){\r\n\t\t\t  console.log('3 answer')\r\n\t\t\t  const peerConnection = pcRef.current[response.sender].pc\r\n\t\t\t  const answerDescription = new RTCSessionDescription(response.data.rtcMessage);\r\n\t\t\t  await peerConnection.setRemoteDescription( answerDescription );\r\n\t\t\t  // const streams = pcRef.current.pc.getRemoteStreams()\r\n\t\t\t  // setMirrorStream(streams[streams.length - 1])\r\n\t\t\t}\r\n\t\t\tif (type == \"ICEcandidate\" && response.data.target=='host'){\r\n\t\t\t\tconst peerConnection = pcRef.current[response.sender].pc\r\n\t\t\t\tonICEcandidate(peerConnection, response)\r\n\t\t\t}\r\n\t\t},\r\n\t\tCustomRTCView,\r\n\t\tisPlay,\r\n\t\tsender,\r\n\t\t// renderMirrorView,\r\n\t}\r\n}\r\n\r\nexport const useRemoteCam = (sendMessage:(data:any)=>void)=>{\r\n\tconst pcRef = useRef<{pc?:RTCPeerConnection, receiver?:string, statsInterval?:any}>({})\r\n\tconst [user, setUser] = useState<{name:string}>()\r\n\tconst [_stream, setStream] = useState<MediaStream>()\r\n\tconst CustomRTCView = useCallback(React.memo((style:any)=>_stream?<RTCView stream={_stream} style={style} videoProps={{height:'100%'}} />:<></>), [_stream])\r\n\tconst isPlay = useMemo(()=>_stream?true:false, [_stream])\r\n\tconst start = useCallback((receiver:string)=>{\r\n\t\tconsole.log(\"start\");\r\n\t\tif (!pcRef.current.pc) {\r\n\t\t  pcRef.current.pc = new RTCPeerConnection( peerConstraints );\r\n\t\t  pcRef.current.receiver = receiver\r\n\t\t}\r\n\t\tif (!_stream){\r\n\t\t\tsendMessage({type:'start', receiver, data:{'target': 'host'}})\r\n\t\t}\r\n\t}, [_stream])\r\n\tconst stop = () => {\r\n\t\tconsole.log(\"stop\");\r\n\t\tif (pcRef.current.pc) {\r\n\t\t  // peerConnection._unregisterEvents();\r\n\t\t  setStream(undefined)\r\n\t\t  pcRef.current.pc.close();\r\n\t\t  pcRef.current.pc = undefined\r\n\t\t  pcRef.current.receiver = undefined\r\n\t\t  clearInterval(pcRef.current.statsInterval)\r\n\t\t}\r\n\t}\r\n\treturn {\r\n\t\tstart,\r\n\t\tstop,\r\n\t\twebsocketOnMessage: async(response:any)=>{\r\n\t\t\tlet type = response.type;\r\n\t\t\tif (type == 'start' && response.data.target=='guest' && response.sender == pcRef.current?.receiver){\r\n\t\t\t\tconsole.log('(remote)1 start')\r\n\t\t\t\tconst peerConnection = pcRef.current.pc\r\n\t\t\t\tsetUser({name: response.data.name})\r\n\t\t\t\tpeerConnection.addEventListener('icecandidate', (event:any) => sendICEcandidate(event, sendMessage, response.sender, 'host'));\r\n\t\t\t\tpeerConnection.addEventListener('iceconnectionstatechange', (e:any)=>{\r\n\t\t\t\t\tif (pcRef.current.pc.iceConnectionState == 'connected'){\r\n\t\t\t\t\t\tlet activeStream = false\r\n\t\t\t\t\t\tpcRef.current.statsInterval = setInterval(async()=>{\r\n\t\t\t\t\t\t\tconst stats = await pcRef.current.pc.getStats(null)\r\n\t\t\t\t\t\t\tlet statsOutput = \"\";\r\n\t\t\t\t\t\t\tlet framePerSecond = undefined\r\n\t\t\t\t\t\t\tstats.forEach((report:any) => {\r\n\t\t\t\t\t\t\t\tif (report.type === \"inbound-rtp\" && report.kind === \"video\") {\r\n\t\t\t\t\t\t\t\t\tObject.keys(report).forEach((statName) => {\r\n\t\t\t\t\t\t\t\t\t\tstatsOutput += `${statName}: ${report[statName]}\\n`;\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\tframePerSecond = report.framesPerSecond\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tconsole.log(activeStream, framePerSecond)\r\n\t\t\t\t\t\t\tif (framePerSecond != undefined){\r\n\t\t\t\t\t\t\t\tactiveStream = true\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (activeStream){\r\n\t\t\t\t\t\t\t\tstop()\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tconsole.log(new Date().toTimeString().split(' ')[0], statsOutput)\r\n\t\t\t\t\t\t}, 1000);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (pcRef.current.pc.iceConnectionState == 'failed'){\r\n\t\t\t\t\t\tstop()\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t// peerConnection.addTransceiver('audio', {\r\n\t\t\t\t// \tdirection: 'recvonly'\r\n\t\t\t\t// });\r\n\t\t\t\tpeerConnection.addTransceiver('video', {\r\n\t\t\t\t\tdirection: 'recvonly'\r\n\t\t\t\t});\r\n\t\t\t\tawait createOffer({pc:pcRef.current.pc, receiver:response.sender}, sendMessage, _stream, 'host', user)\r\n\t\t\t}  \r\n\t\t\tif (type == \"answer\" && response.data.target=='guest' && response.sender == pcRef.current?.receiver){\r\n\t\t\t\tconsole.log('(remote)3 answer')\r\n\t\t\t\tconst answerDescription = new RTCSessionDescription(response.data.rtcMessage);\r\n\t\t\t\tawait pcRef.current.pc.setRemoteDescription( answerDescription );\r\n\t\t\t\tconst streams = pcRef.current.pc.getRemoteStreams()\r\n\t\t\t\tsetStream(streams[streams.length - 1])\r\n\t\t\t\tsendMessage({type:'end', receiver:pcRef.current.receiver, data:{}})\r\n\t\t\t}\r\n\t\t\tif (type == \"call\" && response.sender == pcRef.current?.receiver){\r\n\t\t\t  console.log('2 call')\r\n\t\t\t  const peerConnection = pcRef.current.pc\r\n\t\t\t  setUser({name:response.data.name})\r\n\t\t\t  if (!peerConnection)\r\n\t\t\t\treturn\r\n\t\t\t  peerConnection.addEventListener( 'icecandidate', (event:any) => sendICEcandidate(event, sendMessage, response.sender, 'host'));\r\n\t\t\t  const offerDescription = new RTCSessionDescription(response.data.rtcMessage);\r\n\t\t\t  await peerConnection.setRemoteDescription( offerDescription );\r\n\t\t\t  const answerDescription = await peerConnection.createAnswer( sessionConstraints );\r\n\t\t\t  await peerConnection.setLocalDescription( answerDescription );\r\n\t\t\t  sendMessage({type:'answer', receiver:pcRef.current.receiver, data:{target:'host', rtcMessage:peerConnection.localDescription}})\r\n\t\t\t  // Here is a good place to process candidates.\r\n\t\t\t  const streams = pcRef.current.pc.getRemoteStreams()\r\n\t\t\t  setStream(streams[streams.length - 1])\r\n\t\t\t}\r\n\t\t\tif (type == \"ICEcandidate\" && response.data.target=='guest' && response.sender == pcRef.current?.receiver)\r\n\t\t\t  onICEcandidate(pcRef.current.pc, response)\r\n\t\t},\r\n\t\tCustomRTCView,\r\n\t\tuser,\r\n\t\tisPlay\r\n\t}\r\n}","import {StyleSheet} from \"react-native\";\r\nexport {useLocalCam, useRemoteCam} from \"./p2p\"\r\n\r\nexport const camStyle = StyleSheet.create({\r\n\tcontainer:{ flex: 1},\r\n\tcam:{ flex: 1, height:'100%'},\r\n\tbottonContainer: {position:\"absolute\", bottom:0, justifyContent:'flex-end'},\r\n\tbuttonBar: { flexDirection: \"row\", justifyContent: \"space-around\" },\r\n\tlabel: {backgroundColor:'#0008', color:'white', paddingHorizontal:5},\r\n})","import React, { useEffect } from \"react\";\r\nimport {Button, View, Text} from \"react-native\";\r\nimport useWebsocketContext from \"./useWebsocketContext\";\r\nimport { useLocalCam, camStyle} from \"./webrtc\";\r\n\r\n\r\nexport default (props:{user?:{name:string}|null, mode?:'camera'|'display'|null})=>{\r\n  const {lastJsonMessage, sendJsonMessage} = useWebsocketContext()\r\n  const {start, stop, websocketOnMessage, CustomRTCView, isPlay} = useLocalCam(sendJsonMessage)\r\n  useEffect(()=>{\r\n    props.user && lastJsonMessage && websocketOnMessage(lastJsonMessage, props.user)\r\n  }, [lastJsonMessage, props.user])\r\n  useEffect(()=>{\r\n    if(props.mode && !isPlay){\r\n      props.user && start(props.user, undefined, props.mode)\r\n    }\r\n    else if(props.mode===null && isPlay){\r\n      stop()\r\n    }\r\n    return ()=>{isPlay && stop()}\r\n  }, [isPlay, props.user, props.mode])\r\n  return (\r\n    <View style={camStyle.container}>\r\n      <CustomRTCView style={camStyle.cam}/>\r\n      <View style={camStyle.bottonContainer}>\r\n        <View style={camStyle.buttonBar}>  \r\n        </View>\r\n        <View style={{flexDirection:'row'}}><Text style={camStyle.label}>{props.user?.name}</Text></View>\r\n        <View style={camStyle.buttonBar}>\r\n          {props.mode === undefined && !isPlay && <Button title=\"Start\" onPress={()=>props.user && start(props.user)} />}\r\n          {props.mode === undefined && isPlay && <Button title=\"Stop\" onPress={stop} />}\r\n        </View>\r\n      </View>\r\n    </View>\r\n  );\r\n}\r\n","import React, { useState, useEffect, } from \"react\";\r\nimport {Button,Text, TextInput, View} from \"react-native\";\r\nimport useWebsocketContext from \"./useWebsocketContext\";\r\nimport { useRemoteCam, camStyle} from \"./webrtc\";\r\n\r\nexport default (props:{receiver?:string})=>{\r\n  const [receiver, setReceiver] = useState('')\r\n  const {lastJsonMessage, sendJsonMessage} = useWebsocketContext()\r\n  const {start, stop, websocketOnMessage, CustomRTCView, isPlay, user} = useRemoteCam(sendJsonMessage)\r\n  useEffect(()=>{\r\n    lastJsonMessage && websocketOnMessage(lastJsonMessage)\r\n  }, [lastJsonMessage])\r\n  useEffect(()=>{\r\n    if(props.receiver){\r\n      start(props.receiver)\r\n    }\r\n    return ()=>stop()\r\n  }, [props.receiver])\r\n  return (\r\n    <View style={camStyle.container}>\r\n      <CustomRTCView style={camStyle.cam}/>\r\n      <View style={camStyle.bottonContainer}>\r\n        <View style={camStyle.buttonBar}>\r\n        </View>\r\n        <View style={{flexDirection:'row'}}>{\r\n          (props.receiver || isPlay)?\r\n          <Text style={camStyle.label}>{user?.name || 'loading...'}</Text>:\r\n          <>\r\n            <Text style={{borderWidth:1}}>Receiver:&nbsp;</Text>\r\n            <TextInput style={{borderWidth:1, flex:1}} value={receiver} onChangeText={setReceiver}/>\r\n          </> \r\n        }</View>\r\n        <View style={camStyle.buttonBar}>\r\n          {props.receiver === undefined && !isPlay && <Button title=\"Start\" onPress={()=>start(receiver)} />}\r\n          {props.receiver === undefined && isPlay && <Button title=\"Stop\" onPress={stop} />}\r\n        </View>\r\n      </View>\r\n    </View>\r\n  );\r\n}\r\n\r\n","import React, {useEffect, useState} from 'react';\r\nimport { StyleSheet, View } from 'react-native';\r\nimport { View as ThemedView } from '../../../components/Themed' \r\nimport Colors from '../../../constants/Colors';\r\nimport {default as useRtcContext, WebSocketProvider as RtcProvider} from \"../../../lib/react-native-webrtc/useWebsocketContext\";\r\nimport LocalCam from '../../../lib/react-native-webrtc/LocalCam';\r\nimport RemoteCam from '../../../lib/react-native-webrtc/RemoteCam';\r\nimport useResizeContext from '../../../hooks/useResizeContext';\r\nimport useAuthContext from '../../../hooks/useAuthContext';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport CommonButton from '../../../components/CommonButton';\r\nimport { Ionicons } from '../../../lib/@expo/vector-icons';\r\nimport useIsMobile from '../../../hooks/useIsMobile';\r\n\r\ntype VideoType = 'camera'|'display'|null\r\ntype VideoCallProps = {channel_id:number, setDisable:(disable:boolean)=>void, disable?:boolean}\r\n\r\n\r\nconst VideoView = (props:{\r\n  scale:string,\r\n  focusGuest?:string,\r\n  setFocusGuest:(focusGuest?:string)=>void\r\n  receiver?:string\r\n  children:React.ReactNode\r\n})=>{\r\n  return <View style={[{maxWidth:props.scale, maxHeight:props.scale, borderWidth:1, borderColor:Colors.borderColor, backgroundColor:'gray', flexDirection:'row', flexGrow:1}, (props.focusGuest == undefined || props.focusGuest == props.receiver)?{height:'100%'}:{maxWidth:0, height:0}]}>\r\n    <TouchableOpacity style={{flex:1}} containerStyle={{flex:1, justifyContent:'center'}} onPress={()=>props.setFocusGuest(props.focusGuest?undefined:props.receiver)}>\r\n    {props.children}\r\n    </TouchableOpacity>\r\n  </View>\r\n    \r\n  \r\n}\r\n\r\nconst VideoCallContainer = ({channel_id, disable, setDisable}:VideoCallProps)=>{\r\n  const {auth} = useAuthContext()\r\n  const isMobile = useIsMobile()\r\n  const [videoMode, setVideoMode] = useState<VideoType>(null)\r\n  const [guests, setGuests] = useState<string[]>([])\r\n  const [focusGuest, setFocusGuest] = useState<string>()\r\n  const windowType = useResizeContext()\r\n  const { lastJsonMessage, sendJsonMessage } = useRtcContext()\r\n  useEffect(()=>{\r\n    if(lastJsonMessage !=null){\r\n      if(lastJsonMessage['type']=='connection'){\r\n        sendJsonMessage({'type':'broadcast', 'data':{'channel_id':channel_id}})\r\n      }\r\n      if(lastJsonMessage['type']=='broadcast_guest' || lastJsonMessage['type']=='broadcast_host'){\r\n        setGuests([...guests, lastJsonMessage['sender']])\r\n      }\r\n      if(lastJsonMessage['type']=='broadcast_disconnect'){\r\n        const channel_name = lastJsonMessage['sender']\r\n        const exist = guests.find(v=>v == channel_name)\r\n        exist && setGuests(guests.filter(v=>v != channel_name))\r\n      }\r\n    }\r\n  }, [lastJsonMessage])\r\n  const scale = focusGuest?'100%':`${100 / Math.max(2, Math.ceil(Math.sqrt(guests.length + 1)))}%`\r\n  const toggleVideoMode = (mode:VideoType)=>{\r\n    setVideoMode(videoMode!=mode?mode:null)\r\n  }\r\n  return lastJsonMessage !==undefined ?\r\n    <ThemedView style={[\r\n      {aspectRatio:!disable?16/9:0, borderColor:Colors.borderColor, borderRadius:10},\r\n      windowType=='landscape'?{flexShrink:1, flexGrow:0, height:'100%', borderLeftWidth:1, paddingBottom:65}:{maxHeight:'36%', width:'100%', borderBottomWidth:1}\r\n    ]}>\r\n      <View style={{aspectRatio:focusGuest?undefined:16/9, backgroundColor:'white', flexWrap:'wrap', flexDirection:'row', width:'100%', height:'100%'}}>\r\n        {guests.map((receiver, i)=><VideoView scale={scale} focusGuest={focusGuest} setFocusGuest={setFocusGuest} receiver={receiver}>\r\n          <RemoteCam receiver={receiver}/>\r\n        </VideoView>\r\n        )}\r\n        <VideoView scale={scale} focusGuest={focusGuest} setFocusGuest={setFocusGuest} receiver={auth.user?.name}>\r\n          <LocalCam user={auth.user} mode={videoMode}/>\r\n        </VideoView>\r\n      </View>\r\n      <ThemedView style={[\r\n          {position:'absolute', alignItems:'center', justifyContent:'flex-end', width:'100%',flexDirection:'row'},\r\n          windowType=='landscape'?{bottom:0, paddingTop:15, paddingBottom:10, paddingHorizontal:19}:{backgroundColor:'transparent'}\r\n        ]}>\r\n        <CommonButton title={''} style={{height:40, paddingTop:8}} onPress={()=>toggleVideoMode('camera')}/>\r\n        {!isMobile && <CommonButton title={''} style={{height:40, paddingTop:8}} onPress={()=>toggleVideoMode('display')}/>}\r\n        <CommonButton title={''} style={{height:40, paddingTop:8}} onPress={()=>setDisable(true)}>\r\n          <Ionicons size={20} name=\"arrow-back\" color={'deepskyblue'}/>\r\n        </CommonButton>\r\n      </ThemedView>\r\n    </ThemedView>:\r\n  <></>\r\n  }\r\n  \r\nexport default React.memo(({channel_id, disable, setDisable}:VideoCallProps)=>{\r\n  return <RtcProvider disable={disable}>\r\n    <VideoCallContainer channel_id={channel_id} disable={disable} setDisable={setDisable}/>\r\n  </RtcProvider>\r\n})\r\n","import React, {useState} from \"react\"\r\nimport {View, TouchableOpacity} from 'react-native'\r\nimport { Text } from \"../Themed\";\r\nimport useUploadContext from \"../../hooks/useUploadContext\";\r\n\r\nconst UploadTag = (props:{data:{filename:string, progress?:number}, index:number, isExpand:boolean, setExpand:(index?:number)=>void})=>{\r\n    return <View style={{backgroundColor:'lightgray', borderRadius:20, overflow:'hidden', margin:5}}>\r\n        <View style={{backgroundColor:'darkgray', position:'absolute', width:`${(props.data.progress || 0)*100}%`, height:'100%'}}/>\r\n        <View style={{paddingVertical:5, paddingHorizontal:5, flexDirection:'row'}}>\r\n            <Text></Text>\r\n            <View style={{paddingHorizontal:5}}><Text>{props.data.filename}</Text></View>\r\n        </View>\r\n    </View>\r\n}\r\n\r\n\r\nexport default (props:{channel_id:number})=>{\r\n    const { upload } = useUploadContext()\r\n    const [expand, setExpand] = useState<number>()\r\n    const uploadData = upload[props.channel_id]\r\n    return <View style={{flexDirection:'row', paddingTop:5, paddingHorizontal:(uploadData?.length || 0)>0?20:0}}>\r\n        {uploadData?.map((f,i)=><UploadTag key={i} data={f} index={i} isExpand={i==expand} setExpand={setExpand}/>)}\r\n    </View>\r\n}","import React from 'react';\r\nimport { Editor } from '@tinymce/tinymce-react';\r\nimport { EditorProps } from '../../types';\r\nconst INIT = require('../../../web/editor-config')\r\nconst PATH = process.env.PUBLIC_URL + '/tinymce/tinymce.min.js'\r\n\r\nexport default (props:EditorProps) => {\r\n\treturn <Editor\r\n        tinymceScriptSrc={PATH}\r\n        onInit={(e, editor) => {props.onReady?.()}}\r\n        onEditorChange={props.setValue}\r\n        init={{\r\n          setup:INIT.setup,\r\n          plugins: INIT.plugins,\r\n          toolbar: INIT.toolbar,\r\n          height: '100%',\r\n          skin: props.theme=='light'?'oxide':'oxide-dark',\r\n          content_css: props.theme=='light'?'default':'dark',\r\n          menubar: false,\r\n          branding: false,\r\n          statusbar: false,\r\n          block_formats: '1=h2;2=h3;3=h4;=p;',\r\n          fontsize_formats: '11pt 14pt 18pt 24pt',\r\n        }}\r\n        value={props.value}\r\n    />\r\n};\r\n","import React, { useState, useEffect } from 'react';\r\nimport { View } from 'react-native';\r\nimport Editor from '../lib/tinymce/Editor';\r\n// import Editor from '../lib/tinymce/EditorView';\r\nimport { EditorProps } from '../types';\r\n\r\nexport default (props:EditorProps & {active:boolean, children?:React.ReactNode}) => {\r\n\tconst [ready, setReady] = useState<boolean>(false)\r\n  useEffect(()=>{\r\n    if(!props.active)\r\n      setReady(false)\r\n  }, [props.active])\r\n  return props.active?(\r\n        <View style={{flex:1, height:'100%'}}>\r\n        {!ready && props.children}\r\n    \t  <Editor\r\n          theme={props.theme}\r\n          value={props.value}\r\n          setValue={props.setValue}\r\n          onReady={()=>{\r\n            if(!ready){\r\n              setReady(true); props.onReady?.()\r\n            }\r\n          }}/>\r\n      </View>\r\n    ):<>{props.children}</>;\r\n};\r\n","import React, { useEffect, useMemo, useRef, useState} from 'react';\r\nimport { Platform, StyleProp, View, ViewStyle } from 'react-native';\r\nimport { TextInput } from 'react-native-gesture-handler';\r\nimport CommonButton from '../../components/CommonButton';\r\nimport { useMessengerContentMutation } from '../../hooks/lists/useMessengerContentList';\r\nimport useAuthContext from '../../hooks/useAuthContext';\r\nimport Colors from '../../constants/Colors';\r\nimport useColorScheme from '../../hooks/useColorScheme';\r\nimport { View as ThemedView } from '../../components/Themed' \r\nimport useIsMobile from '../../hooks/useIsMobile';\r\nimport DateTimePickerModal from '../../modals/DateTimePickerModal'\r\nimport useLangContext from '../../hooks/useLangContext';\r\nimport { Entypo } from '../../lib/@expo/vector-icons';\r\nimport TimerTags, { timerFormat } from '../../components/Messages/TimerTags';\r\nimport UploadTags from '../../components/Messages/UploadTags';\r\nimport Messages from '../../components/Messages';\r\nimport Editor from '../../components/Editor';\r\nimport useResizeContext from '../../hooks/useResizeContext';\r\nimport useModalsContext from '../../hooks/useModalsContext';\r\n\r\nfunction uploadFile(){\r\n    return new Promise<Blob|undefined>((resolve, reject)=>{\r\n      if (Platform.OS == 'web'){\r\n        var input = document.createElement('input');\r\n        input.type = 'file';\r\n        input.onchange = e => { \r\n          resolve((e.target as any).files[0])\r\n        }\r\n        input.onabort = reject\r\n        input.onerror = reject\r\n        input.click();\r\n      }\r\n      else\r\n        resolve(undefined)\r\n    })\r\n  }\r\n\r\nexport default ({channel_id, isEditor, setIsEditor, style, extraButtons}:{channel_id:number, isEditor:boolean, setIsEditor:(v:boolean)=>void, style?:StyleProp<ViewStyle>, extraButtons?:{title:string, onPress:()=>void, disabled?:boolean}[]})=>{\r\n    const theme = useColorScheme()\r\n    const windowType = useResizeContext()\r\n    const { lang } = useLangContext()\r\n    const isMobile = useIsMobile()\r\n    const {auth} = useAuthContext()\r\n    const { setModal } = useModalsContext()\r\n    const inputRef = useRef<TextInput>(null)\r\n    const [value, setValue] = useState('')\r\n    const [editorValue, setEditorValue] = useState('')\r\n    const [timer, setTimer] = useState<string>()\r\n    const [messageEvent, sendToScreen] = useState<{value:string, editorValue:string}>()\r\n    const [bottomTab, setBottomTab] = useState<boolean>(false)\r\n    const [autoFocus, setAutoFocus] = useState<boolean|null>(null)\r\n    const valueLines = useMemo(()=>bottomTab?1:value.split(\"\\n\").length, [value, bottomTab])\r\n    const contentMutation = useMessengerContentMutation()\r\n    const postValue = ()=>{\r\n        if (value.length>0){\r\n          if(isEditor){\r\n            contentMutation.create({channel:channel_id, user:auth.user?.id, content:'', timer, editor: {title:value, content:editorValue}})\r\n          }\r\n          else{\r\n            contentMutation.create({channel:channel_id, user:auth.user?.id, content:value, timer})\r\n          }\r\n          setTimer(undefined)\r\n          setBottomTab(false)\r\n          setValue('')\r\n          setAutoFocus(true)\r\n          if(isEditor){\r\n            setEditorValue('')\r\n            setIsEditor(false)\r\n          }\r\n        }\r\n      }\r\n      const onKeyPress = (e:any) => {\r\n        if (!isMobile){\r\n          const event = e as KeyboardEvent;\r\n            if (!event.shiftKey && event.key === \"Enter\"){\r\n              postValue()\r\n              event.preventDefault()\r\n          }\r\n        }\r\n      }\r\n      \r\n      useEffect(()=>{\r\n        if(messageEvent){\r\n          setIsEditor(false)\r\n          setValue(value.concat(value.length>0?\"\\n\":\"\", messageEvent.value))\r\n          setEditorValue(editorValue.concat(\"\\r\\n\", messageEvent.editorValue))\r\n          sendToScreen(undefined)\r\n          setIsEditor(true)\r\n        }\r\n      }, [messageEvent, value, editorValue])\r\n      useEffect(()=>{\r\n        if(autoFocus){\r\n          (inputRef.current as any).focus?.()\r\n          setAutoFocus(false)\r\n        }\r\n      }, [autoFocus])\r\n      // useEffect(()=>{\r\n      //   if (autoFocus==null && !isMobile){\r\n      //     const timeout = setTimeout(()=>setAutoFocus(true), 500)\r\n      //     return ()=>clearTimeout(timeout)\r\n      //   }\r\n      // })\r\n\r\n\r\n    return <View style={style}>\r\n      <Messages channel_id={channel_id} auth={auth} reverse sendToScreen={sendToScreen}/>\r\n      <View style={{position:'absolute', flexDirection:'row'}}>\r\n        <UploadTags channel_id={channel_id}/>\r\n        <TimerTags channel_id={channel_id}/>\r\n      </View>\r\n      <ThemedView style={[{bottom:0, width:'100%', paddingTop:15, paddingBottom:10, paddingHorizontal:19}, isEditor?{height:windowType=='landscape'?'50%':'100%'}:{}]}>\r\n        <View style={{alignItems:'center', width:'100%',flexDirection:'row'}}>\r\n          <CommonButton title={''} style={{height:'100%', paddingTop:8, borderTopRightRadius:0, borderBottomRightRadius:0, justifyContent:'center'}} onPress={()=>{isEditor?setIsEditor(false):setBottomTab(!bottomTab)}}>\r\n            <View style={{top:-2}}>\r\n              <Entypo name={isEditor || bottomTab?\"cross\":\"plus\"} size={24} color={Colors[theme].text}/>\r\n            </View>\r\n          </CommonButton>\r\n          {timer && <CommonButton style={{height:'100%', paddingTop:8, borderRadius:0}} title={`${timerFormat(timer)}`} onPress={()=>{setModal(DateTimePickerModal, {datetime:timer, callback:(datetime:string)=>setTimer(datetime)});setBottomTab(false)}}/>}\r\n          <TextInput\r\n              ref={inputRef}\r\n              value={value} \r\n              onChangeText={setValue}\r\n              onKeyPress={onKeyPress}\r\n              style={{flex:1, borderWidth:1, minHeight:41, borderColor:Colors.borderColor, backgroundColor:Colors[theme].background, color:Colors[theme].text, paddingVertical:1, paddingHorizontal:3}}\r\n              onFocus={()=>setBottomTab(false)}\r\n              multiline \r\n              numberOfLines={valueLines}/>\r\n          <CommonButton style={{height:'100%', paddingTop:8, borderTopLeftRadius:0, borderBottomLeftRadius:0, justifyContent:'center'}} title={''} onPress={postValue}/>\r\n        </View>\r\n        <Editor theme={theme} active={isEditor} value={editorValue} setValue={setEditorValue} onReady={()=>setBottomTab(false)}/>\r\n        {bottomTab && <View style={{alignItems:'center', width:'100%', flexDirection:'row', paddingTop:15, paddingBottom:5}}>\r\n          <CommonButton style={{height:80, flex:1, justifyContent:'center', marginRight:15}} title={`\\n ${lang('File')}`} onPress={()=>uploadFile().then(f=>{contentMutation.create({channel:channel_id, user:auth.user?.id, content:'', file:f});setBottomTab(false)})}/>\r\n          <CommonButton style={{height:80, flex:1, justifyContent:'center', marginRight:15}} title={`\\n ${lang('Editor')}`} onPress={()=>{setIsEditor(!isEditor); isEditor && setBottomTab(false)}}/>\r\n          <CommonButton style={{height:80, flex:1, justifyContent:'center', marginRight:15}} title={`\\n ${lang('Timer')}`} onPress={()=>{setModal(DateTimePickerModal, {datetime:timer, callback:(datetime:string)=>setTimer(datetime)});setBottomTab(false)}}/>\r\n          {extraButtons?.map(v=><CommonButton style={{height:80, flex:1, justifyContent:'center', marginRight:15}} title={v.title} onPress={()=>{v.onPress();setBottomTab(false)}} disabled={v.disabled}/>)}\r\n        </View>}\r\n      </ThemedView>\r\n    </View>\r\n}","import React, { useState,  useEffect,  useMemo,useLayoutEffect } from \"react\"\r\nimport useMessengerMemberList from './lists/useMessengerMemberList';\r\nimport useMessengerChannelList from './lists/useMessengerChannelList';\r\nimport { avatarFromChannel } from '../components/Avatar';\r\nimport useResizeContext from './useResizeContext';\r\nimport useModalsContext from './useModalsContext';\r\nimport InviteModal from '../modals/InviteModal';\r\nimport useLangContext from './useLangContext';\r\nimport useAuthContext from \"./useAuthContext\";\r\nimport { StackNavigationProp } from \"@react-navigation/stack\";\r\nimport { RouteProp } from \"@react-navigation/native\";\r\nimport HeaderRight from \"../components/HeaderRight\";\r\nimport ChannelEditModal from \"../modals/ChannelEditModal\";\r\n\r\nexport default (navigation:StackNavigationProp<any, any>, route:RouteProp<any, any>,channel_id:any, type:string, isEditor:boolean)=>{\r\n    const { lang, locale } = useLangContext()\r\n    const {auth} = useAuthContext()\r\n    const { setModal } = useModalsContext()\r\n    const windowType = useResizeContext()\r\n    const channelList = useMessengerChannelList(type, auth)\r\n    const channel = channelList?.find(v=>v.id==parseInt(channel_id))\r\n    const channelAvatar = channel?avatarFromChannel(channel, auth.user):undefined\r\n    const memberList = useMessengerMemberList(channel_id)\r\n    const member_id = useMemo(()=>memberList?.find(v=>v.user == auth.user?.id)?.id, [auth, memberList])\r\n\r\n\r\n    useLayoutEffect(() => {\r\n        navigation.setOptions({\r\n          headerRight: ()=> <HeaderRight extra={channel?.type=='messenger'?[\r\n            {title:lang('invite'), onPress:()=>setModal(InviteModal, {id:channel_id})},\r\n            {title:lang('setting'), onPress:()=>setModal(ChannelEditModal, {id:channel_id, type:channel?.type, member_id})}\r\n          ] : [\r\n            {title:lang('setting'), onPress:()=>setModal(ChannelEditModal, {id:channel_id, type:channel?.type, member_id})}\r\n          ]}/>,\r\n          title: channelAvatar?.name,\r\n          headerShown:!(windowType=='portrait' && isEditor)\r\n        });\r\n      }, [navigation, route, member_id, locale, windowType, isEditor,channel]);\r\n    \r\n      const back = ()=>{\r\n        if(navigation.canGoBack())\r\n            navigation.goBack()\r\n          else{\r\n            navigation.navigate('HomeScreen', {tab:2})\r\n          }\r\n      }\r\n      \r\n      useEffect(()=>{\r\n        setModal(null, null)\r\n        if (!channel_id)\r\n          back()\r\n      }, [route])\r\n      useEffect(()=>{\r\n        if (memberList===null || (memberList!=undefined && memberList.find(v=>v.user==auth.user?.id)==undefined))\r\n          back()\r\n      }, [memberList])\r\n      useEffect(()=>{\r\n        if(channelList===null || (channelList!=undefined && channel==undefined))\r\n            back()\r\n      }, [channelList])\r\n}","import React from \"react\"\r\nimport CommonSection from \"../../../components/CommonSection\"\r\nimport Colors from \"../../../constants/Colors\"\r\nimport useColorScheme, { setColorScheme } from \"../../../hooks/useColorScheme\"\r\nimport { StyleSheet, Text, View} from 'react-native';\r\nimport useLangContext from \"../../../hooks/useLangContext\";\r\nimport { useColorScheme as useConfigColorScheme} from 'react-native-appearance';\r\nimport useFirebaseContext from \"../../../hooks/useFirebaseContext\";\r\nimport TextButton from \"../../../components/TextButton\";\r\nimport useModalsContext from \"../../../hooks/useModalsContext\";\r\nimport RegistrationModal from \"../../../modals/RegistrationModal\";\r\nimport useAuthContext from \"../../../hooks/useAuthContext\";\r\n\r\n\r\nconst ConfigSection = ({title, children}:{title:string, children?: React.ReactNode})=>{\r\n  const theme = useColorScheme()\r\n  const color = Colors[theme].text\r\n  return <CommonSection bodyStyle={{alignItems:'flex-start', backgroundColor:theme=='light'?'transparent':\"black\"}}>\r\n    <Text style={{fontSize:20, color, fontWeight:'600'}}>{title}</Text>\r\n    {children}\r\n  </CommonSection>\r\n}\r\n\r\nexport default ()=>{\r\n  const { lang, locale, setLocale } = useLangContext()\r\n  const { setModal } = useModalsContext()\r\n  const {auth} = useAuthContext()\r\n  const theme = useColorScheme()\r\n  const configTheme = useConfigColorScheme()\r\n  const {enable:noti, setEnable:setNoti} = useFirebaseContext()\r\n  const color = Colors[theme].text\r\n  return <>\r\n    <ConfigSection title={lang('* Notification Settings')}>\r\n      <View style={{flexDirection:'row'}}>\r\n        {[[lang('On'), true], [lang('Off'), false]].map(([title, n])=><TextButton\r\n          key={title} title={title || ''} textStyle={{fontSize:16, color, textDecorationLine:noti==n?'underline':'none'}} style={{borderRadius:20}} onPress={()=>{setNoti(n)}}/>)}\r\n      </View>\r\n    </ConfigSection>\r\n    <ConfigSection title={lang('* Language Settings')}>\r\n    <View style={{flexDirection:'row'}}>\r\n        {[[lang('Auto'), 'auto'], ['', 'ko'], ['English', 'en']].map(([title, l])=><TextButton \r\n          key={title} title={title || ''} textStyle={{fontSize:16, color, textDecorationLine:locale==l?'underline':'none'}} style={{borderRadius:20}} onPress={()=>setLocale(l)}/>)}\r\n      </View>\r\n    </ConfigSection>\r\n    <ConfigSection title={lang('* Skin Settings')}>\r\n      <View style={{flexDirection:'row'}}>\r\n        {[[lang('Auto'), 'no-preference'], [lang('Light'), 'light'], [lang('Dark'), 'dark']].map(([title, colorScheme])=><TextButton \r\n          key={title} title={title} textStyle={{fontSize:16, color, textDecorationLine:configTheme==colorScheme?'underline':'none'}} style={{borderRadius:20}} onPress={(\r\n            )=>setColorScheme(colorScheme)}/>)}\r\n      </View>\r\n    </ConfigSection>\r\n  </>\r\n}","import React, {useState, useEffect, useLayoutEffect, useRef} from 'react';\r\nimport { StackNavigationProp, StackScreenProps } from '@react-navigation/stack';\r\nimport { View, ScrollView, useWindowDimensions} from 'react-native';\r\nimport { Text as StyledText } from 'react-native-paper';\r\nimport { Text } from '../../../components/Themed'\r\nimport useResizeContext from '../../../hooks/useResizeContext';\r\nimport TabView from '../../../components/TabView';\r\nimport HeaderRight from '../../../components/HeaderRight';\r\nimport TextButton from '../../../components/TextButton';\r\nimport Colors from '../../../constants/Colors';\r\nimport useColorScheme  from '../../../hooks/useColorScheme';\r\nimport useModalsContext from '../../../hooks/useModalsContext';\r\nimport ChannelEditModal from '../../../modals/ChannelEditModal';\r\nimport useLangContext from '../../../hooks/useLangContext';\r\nimport ContractFooter from '../../../components/ContractFooter';\r\nimport { MessengerChannel, TabViewRecord, UserMembership } from '../../../types';\r\nimport useAuthContext from '../../../hooks/useAuthContext';\r\nimport useUserMembershipList from '../../../hooks/lists/useUserMembershipList';\r\nimport { FontAwesome, Ionicons, MaterialCommunityIcons, SimpleLineIcons } from '../../../lib/@expo/vector-icons';\r\nimport { useMessengerChannelSorted } from '../../../hooks/lists/useMessengerChannelList';\r\nimport CommonItem from '../../../components/CommonItem';\r\nimport MemberItem from '../../../components/MemberItem';\r\nimport ProfileModal from '../../../modals/ProfileModal';\r\nimport { navigate } from '../../../navigation';\r\nimport CommonSection from '../../../components/CommonSection';\r\nimport ConfigSections from './ConfigSections';\r\nimport Avatar, { avatarFromChannel } from '../../../components/Avatar';\r\nimport RegistrationModal from '../../../modals/RegistrationModal';\r\nimport { useNavigation } from '@react-navigation/native';\r\n\r\n\r\nconst useHeaderSetter = (options:any[]) =>{\r\n  const tempref = useRef<NodeJS.Timer>()\r\n  const indexRef = useRef<number>()\r\n  const {width } = useWindowDimensions()\r\n  const navigation = useNavigation()\r\n  useEffect(()=>{\r\n    return ()=>{\r\n      clearInterval(tempref.current)\r\n    }\r\n  }, [])\r\n  return (ref:any)=>{\r\n      clearInterval(tempref.current)\r\n      /*@ts-ignore */\r\n      tempref.current=setInterval(()=>{ref?.measure((fx, fy, _, height, px, py)=>{\r\n        const i = Math.round(-px/width)\r\n        if (indexRef.current != i){\r\n          indexRef.current = i\r\n          navigation.setOptions(options[i])\r\n        }\r\n      })\r\n    }, 300)\r\n  }\r\n}\r\n\r\nconst renderIndexDetector= (Component:React.ComponentType<any>, headerIndexRef:(ref:any)=>void)=>{\r\n  return (props:any)=><View style={{flex:1}} ref={headerIndexRef}>\r\n    <Component {...props}/>\r\n  </View>\r\n}\r\n\r\nconst MemberTabView = ()=>{\r\n  const {auth} = useAuthContext()\r\n  const theme = useColorScheme()\r\n  const { setModal } = useModalsContext()\r\n  const userList = useUserMembershipList(auth)\r\n  const memberItem = React.useMemo(\r\n      ()=>userList && userList.map((item, index)=><MemberItem key={index} member={item} onPress={()=>setModal(ProfileModal, {id:item.id})}/>), [userList])\r\n  return <ScrollView style={{flex:1, backgroundColor:Colors[theme].background}}>\r\n      {memberItem}\r\n  </ScrollView>\r\n}\r\n\r\nconst MessengerTabView = ()=>{\r\n  const {auth} = useAuthContext()\r\n  const channelList = useMessengerChannelSorted('messenger', auth)\r\n  const theme = useColorScheme()\r\n\r\n  const today = (new Date()).toISOString().slice(0, 10)\r\n  return <ScrollView style={{flex:1, backgroundColor:Colors[theme].background}}>\r\n      {channelList?.map((item, index)=>{\r\n          const {avatar, name} = avatarFromChannel(item, auth.user)\r\n          const date = item.last_message?.created.slice(0,10)\r\n          const content = item.last_message?.preview_content || item.last_message?.content || ''\r\n          return <CommonItem key={index} bodyStyle={{flexDirection:'row', justifyContent:'space-between'}} onPress={()=>navigate(\"ChatScreen\", {id:item.id})}>\r\n              <View style={{flexDirection:'row', flexShrink:1}}>\r\n                  {avatar?\r\n                    <View style={{ marginRight:20}}>\r\n                      <Avatar name={avatar.name} size={44} userId={avatar.id}/>\r\n                    </View>:\r\n                    <FontAwesome size={40} color={Colors[theme].iconColor} style={{ marginBottom: -3, marginRight:20 }} name='users'/>}\r\n                  <View>\r\n                      <View style={{flexDirection:'row'}}>\r\n                          <Text style={{fontSize:18}}>{name}</Text>\r\n                          {item.type=='messenger' && <Text style={{fontSize:18, opacity: 0.4, paddingLeft:5}}>{item.member_count}</Text>}\r\n                      </View>\r\n                      <Text style={{fontSize:16, opacity: 0.4}}>{content.replaceAll('\\n', ' ')}</Text>\r\n                  </View>\r\n              </View>\r\n              <View>\r\n                  <Text style={{fontSize:14, opacity: 0.4, textAlign:'right'}}>{date==today?item.last_message?.created.slice(11,16):date}</Text>\r\n                  <Text style={{fontSize:14, textAlign:'right'}}>{item.unread_count?item.unread_count:' '}</Text>\r\n              </View>\r\n          </CommonItem>\r\n      })}\r\n  </ScrollView>\r\n}\r\n\r\nconst MyMessageTabView = ()=>{\r\n  const {auth} = useAuthContext()\r\n  const channelList = useMessengerChannelSorted('mycontent', auth)\r\n  const theme = useColorScheme()\r\n\r\n  const today = (new Date()).toISOString().slice(0, 10)\r\n  return <ScrollView style={{flex:1, backgroundColor:Colors[theme].background}} contentContainerStyle={{flexWrap:'wrap', flexDirection:'row'}}>\r\n      {channelList?.map((item, index)=>{\r\n          const date = item.last_message?.created.slice(0,10)\r\n          const content = item.last_message?.preview_content || item.last_message?.content || ''\r\n          const onPress = ()=>navigate(\"MyMessageScreen\", {id:item.id})\r\n          return <CommonItem key={index} outerContainerStyle={{flexBasis:'50%'}} onPress={onPress}>\r\n              {/* @ts-ignore */}\r\n              <CommonItem containerStyle={{marginHorizontal:0}} bodyStyle={{borderRadius:6, borderWidth:1, wordBreak:'break-word'}} onPress={onPress}>\r\n                <Text style={{fontSize:16, opacity: 0.4}}>{content}</Text>\r\n              </CommonItem>\r\n              <View style={{flexDirection:'row', marginTop:10, justifyContent:'space-between', alignItems:'center', width:'100%'}}>\r\n                <Text style={{fontSize:18}}>{item.name}</Text>\r\n                <Text style={{fontSize:14, opacity: 0.4, textAlign:'right'}}>{date==today?item.last_message?.created.slice(11,16):date}</Text>\r\n                  \r\n              </View>\r\n          </CommonItem>\r\n      })}\r\n  </ScrollView>\r\n}\r\n\r\n\r\nconst ConfigTabView = ()=>{\r\n  const theme = useColorScheme()\r\n  return <ScrollView style={{flex:1, backgroundColor:Colors[theme].background}}>\r\n    <ConfigSections/>\r\n  </ScrollView>\r\n}\r\n\r\nconst getBottomTabs = (theme:'light'|'dark', headerSetter:(ref:any)=>void)=>{\r\n  const color = Colors[theme].iconColor\r\n  return {\r\n    OneTab:{\r\n        title:'member',\r\n        component:renderIndexDetector(MemberTabView, headerSetter),\r\n        icon:<MaterialCommunityIcons size={32} color={color} style={{ marginBottom: -3 }} name='account'/>,\r\n    },\r\n    TwoTab:{\r\n        title:'chat',\r\n        component:MessengerTabView,\r\n        icon:<Ionicons size={30} color={color} style={{ marginBottom: -3 }} name='chatbox'/>\r\n    },\r\n    ThreeTab:{\r\n      title:'my messages',\r\n      component:MyMessageTabView,\r\n      icon:<MaterialCommunityIcons size={32} color={color} style={{ marginBottom: -3 }} name='pencil-box'/>\r\n  },\r\n    FourTab:{\r\n        title:'config',\r\n        component:ConfigTabView,\r\n        icon:<SimpleLineIcons size={30} color={color} style={{ marginBottom: -3 }} name='options'/>\r\n    }\r\n  } as TabViewRecord\r\n}\r\n\r\n\r\nexport default function HomeScreen({navigation, route}: StackScreenProps<any, 'Home'>) {\r\n  const { lang, locale } = useLangContext()\r\n  const windowType = useResizeContext();\r\n  const theme = useColorScheme()\r\n  const { setModal } = useModalsContext()\r\n  const {auth} = useAuthContext()\r\n  const [ home, setHome ] = useState(windowType == 'landscape')\r\n  const color = Colors[theme].text\r\n  const options = [\r\n    {title:lang('member'), headerRight:()=><HeaderRight extra={[{title:lang('create'), onPress:()=>setModal(RegistrationModal, auth.user?.is_guest?{id:auth.user.id}:{})}]}/>},\r\n    {title:lang('chat'), headerRight:()=><HeaderRight extra={[{title:lang('create'), onPress:()=>setModal(ChannelEditModal, {type:'messenger'})}]}/>},\r\n    {title:lang('my messages'), headerRight:()=><HeaderRight extra={[{title:lang('create'), onPress:()=>setModal(ChannelEditModal, {type:'mycontent'})}]}/>},\r\n    {title:lang('config'), headerRight:()=><HeaderRight/>}\r\n  ]\r\n  const headerSetter = useHeaderSetter(options)\r\n  \r\n  useLayoutEffect(() => {\r\n    const index = route?.params?.tab | 0\r\n    navigation.setOptions(windowType == 'portrait'?options[index]:{\r\n      title: lang('home'),\r\n      headerRight: ()=><HeaderRight/>\r\n    });\r\n  }, [navigation, route, windowType, locale]);\r\n  useEffect(()=>{\r\n    setHome(windowType == 'landscape')\r\n  }, [windowType])\r\n  return home?\r\n    <ScrollView contentContainerStyle={{flex:1, alignItems:'center'}}>\r\n      <View style={{flexGrow:1, width:'80%', marginTop:72}}>\r\n        <StyledText style={{fontSize:32, color}}>Tokki Tok</StyledText>\r\n        <View style={{backgroundColor:Colors.borderColor, height:1, width:'100%'}}/>\r\n        {/* <Text style={{fontSize:20, color:'gray'}}>Welcome! This is a messenger for teams.</Text>*/}\r\n        <View style={{height:24}}/>\r\n        <CommonSection bodyStyle={{alignItems:'flex-start', backgroundColor:theme=='light'?'transparent':\"black\"}}>\r\n          <TextButton title={lang('+ New chat')} textStyle={{fontSize:20, color}} style={{paddingLeft:0, borderRadius:20}} onPress={()=>setModal(ChannelEditModal, {type:'messenger'})}/>\r\n        </CommonSection>\r\n        <ConfigSections/>\r\n      </View>\r\n      <ContractFooter theme={theme}/>\r\n    </ScrollView>:\r\n    <TabView tabs={getBottomTabs(theme, headerSetter)} tabBarPosition=\"bottom\" index={parseInt(route.params?.['tab'] || 0)} onTab={(index)=>{navigation.setParams({tab:index})}}/>\r\n}\r\n\r\n","import LoginScreen from \"./login/LoginScreen\";\r\nimport DemoScreen from \"./login/DemoScreen\";\r\nimport ChatScreen from \"./main/ChatScreen\";\r\nimport HomeScreen from \"./main/HomeScreen\";\r\nimport MyMessageScreen from \"./main/MyMessageScreen\";\r\n// import BoardEditScreen from \"../lib/blacktokki-board/BoardEditScreen\";\r\nimport { Screens } from \"../types\";\r\n\r\nexport const main = {\r\n    HomeScreen:{\r\n        title:'home',\r\n        component:HomeScreen,\r\n        path:'home',\r\n    },\r\n    ChatScreen:{\r\n        title:'chat',\r\n        component:ChatScreen,\r\n        path:'chat'\r\n    },\r\n    MyMessageScreen:{\r\n        title:'my messages',\r\n        component:MyMessageScreen,\r\n        path:'mymessage'\r\n    },\r\n} as Screens\r\n\r\nexport const login = {\r\n    LoginScreen:{\r\n        path: 'login',\r\n        title: 'Sign in',\r\n        component:LoginScreen\r\n    },\r\n    DemoScreen:{\r\n        title:'',\r\n        component:DemoScreen,\r\n        path:'demo'\r\n    }\r\n} as Screens\r\n\r\nexport const modal = {\r\n    // BoardEditScreen:{\r\n    //     title:'board',\r\n    //     component:BoardEditScreen,\r\n    //     path:'modal/board'\r\n    // },\r\n} as Screens","import React, { useState} from 'react';\r\nimport { StackScreenProps } from '@react-navigation/stack';\r\nimport { View } from 'react-native';\r\nimport VideoCallSection from './VideoCallSection';\r\nimport useResizeContext from '../../../hooks/useResizeContext';\r\nimport useLangContext from '../../../hooks/useLangContext';\r\nimport ChatSection from '../ChatSection';\r\nimport useChatSection from '../../../hooks/useChatSection';\r\n\r\n\r\nexport default function ChatScreen({navigation, route}: StackScreenProps<any, 'Chat'>) {\r\n  const channel_id = route?.params?.id\r\n  const windowType = useResizeContext()\r\n  const { lang } = useLangContext()\r\n  const [isEditor, setIsEditor] = useState<boolean>(false)\r\n  const [videoMode, setVideoMode] = useState<boolean>(false)\r\n  useChatSection(navigation, route, channel_id, 'messenger', isEditor)\r\n  \r\n  return <View style={[\r\n    {flex:1, alignItems:'center'},\r\n    windowType=='landscape'?{flexDirection:'row-reverse', minWidth:480}:{flexDirection:'column'}\r\n  ]}>\r\n    <VideoCallSection channel_id={channel_id} setDisable={(d)=>setVideoMode(!d)} disable={!videoMode}/>\r\n    <ChatSection \r\n      channel_id={channel_id} \r\n      isEditor={isEditor} \r\n      setIsEditor={setIsEditor} \r\n      style={[videoMode?{flexShrink:1}:{flex:1}, windowType=='landscape'?{minWidth:320, height:'100%'}:{width:'100%'}]}\r\n      extraButtons={[{title:`\\n ${lang('Video Call')}`, onPress:()=>setVideoMode(!videoMode), disabled:videoMode}]}\r\n    />\r\n  </View>\r\n}","import React, { useState } from 'react';\r\nimport { StackScreenProps } from '@react-navigation/stack';\r\nimport useResizeContext from '../../hooks/useResizeContext';\r\nimport ChatSection from './ChatSection';\r\nimport useChatSection from '../../hooks/useChatSection';\r\n\r\n\r\nexport default function MyMessageScreen({navigation, route}: StackScreenProps<any, 'Chat'>) {\r\n  const channel_id = route?.params?.id\r\n  const windowType = useResizeContext()\r\n  const [isEditor, setIsEditor] = useState<boolean>(false)\r\n  useChatSection(navigation, route, channel_id, 'mycontent', isEditor)\r\n  return <ChatSection\r\n      channel_id={channel_id} \r\n      isEditor={isEditor} \r\n      setIsEditor={setIsEditor} \r\n      style={[{flex:1}, windowType=='landscape'?{minWidth:320, height:'100%'}:{width:'100%'}]}\r\n  />\r\n}","import React, { useLayoutEffect } from 'react';\r\n\r\nimport { StackScreenProps } from '@react-navigation/stack';\r\nimport useAuthContext from '../../hooks/useAuthContext';\r\n\r\nexport default function DemoScreen({navigation}: StackScreenProps<any, 'Demo'>) {\r\n    const {dispatch} = useAuthContext()\r\n    useLayoutEffect(() => {\r\n        navigation.setOptions({headerRight: undefined});\r\n        dispatch({type:\"LOGIN_GUEST\"})\r\n    }, []);\r\n  return <></>\r\n};","import React, { Suspense, useState } from 'react';\r\nimport CommonButton from '../components/CommonButton';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport { Text, View } from '../components/Themed';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport { Ionicons } from '../lib/@expo/vector-icons';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport Colors from '../constants/Colors';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { BottomSheet } from '../components/ModalSection';\r\nimport dayjs from 'dayjs';\r\nimport useModalEffect from '../hooks/useModalEffect';\r\n\r\nconst dayTypes = ['AM', 'PM'].map(value=>({label:value, value}))\r\nconst hours = [...Array(12).keys()].map((value, index)=>(index + 1).toString().padStart(2, '0')).map(value=>({label:value, value}))\r\nconst minutes = [...Array(12).keys()].map((value, index)=>(index * 5).toString().padStart(2, '0')).map(value=>({label:value, value}))\r\n\r\n\r\nconst getDisableDays=(date:dayjs.Dayjs)=>{\r\n  let startDate = date.clone().startOf('month').add(-1, 'month')\r\n  const endDate = date.clone().endOf('month').add(1, 'month')\r\n  const today = dayjs().startOf('day')\r\n  const result = []\r\n  while(startDate<=endDate && startDate<today){\r\n    result.push(startDate.format('YYYY-MM-DD'))\r\n    startDate = startDate.add(1, 'day')\r\n  }\r\n  return result\r\n}\r\n\r\nconst defaultDayjs = ()=>{\r\n  const m = dayjs()\r\n  const restMinute = parseInt(m.format('mm')) % 5\r\n  return m.add(5-restMinute, 'minute')\r\n}\r\n\r\nconst Calendar = React.lazy(()=> import('../components/Calendar'))\r\nconst CommonPicker = React.lazy(()=>import('../components/CommonPicker'))\r\n\r\nexport default function DateTimePickerModal({datetime, callback}:{datetime?:string, callback:(datetime?:string)=>void}) {\r\n  const _dayjs = datetime?dayjs(datetime):defaultDayjs()\r\n  const { lang, locale } = useLangContext()\r\n  const theme = useColorScheme()\r\n  const [date, setDate] = useState(_dayjs.format('YYYY-MM-DD'));\r\n  const [dayType, setDayType] = useState(_dayjs.locale('en').format('A'))\r\n  const [hour, setHour] = useState(_dayjs.format('hh'))\r\n  const [minute, setMinute] = useState(_dayjs.format('mm'))\r\n  const [disableDays, setDisableDays] = useState<string[]>(getDisableDays(_dayjs))\r\n  const { setModal } = useModalsContext()\r\n  const back = ()=>{\r\n    setModal(DateTimePickerModal, null)\r\n  }\r\n  useModalEffect(back, [])\r\n  return <BottomSheet>\r\n    <View style={{flexDirection:'row', width:'100%'}}>\r\n      <View style={{flex:1, flexDirection:'row'}}>\r\n        <TouchableOpacity onPress={back}>\r\n          <Ionicons size={20} name=\"arrow-back\" color={Colors[theme].text}/>\r\n        </TouchableOpacity>\r\n      </View>\r\n      <View style={{flex:1}}>\r\n        <Text style={{fontSize:20, textAlign:'center'}}>{lang('Date & Time')}</Text>\r\n      </View>\r\n      <View style={{flex:1}}/>\r\n    </View>\r\n    <View style={{marginBottom: 20, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n    <Suspense fallback={<></>}>\r\n      <Calendar\r\n        locale={locale}\r\n        style={undefined} \r\n        setDate={setDate}\r\n        disableAllTouchEventsForDisabledDays={true}\r\n        onMonthChange={(v)=>setDisableDays(getDisableDays(dayjs(v.dateString)))}\r\n        markedDates={{\r\n          ...disableDays.reduce((p, c)=>{p[c]={disabled:true};return p}, {} as Record<string, any>),\r\n          ...(date?[date]:[]).reduce((p, c)=>{p[c]={selected:true};return p}, {} as Record<string, any>)\r\n        }}\r\n      />\r\n      <View style={{flexDirection:'row', paddingVertical:10, width:400, height:50}}>\r\n        <CommonPicker value={dayType} setValue={setDayType} values={dayTypes}/>\r\n        <Text style={{fontSize:20}}> </Text>\r\n        <CommonPicker value={hour} setValue={setHour} values={hours}/>\r\n        <Text style={{fontSize:20}}> : </Text>\r\n        <CommonPicker value={minute} setValue={setMinute} values={minutes}/>\r\n      </View>\r\n    </Suspense>\r\n    <View style={{flexDirection:'row'}}>\r\n      <CommonButton title={lang('save')} onPress={()=>{\r\n        callback?.(dayjs(`${date} ${hour}:${minute} ${dayType}`).toISOString())\r\n        back()\r\n      }}/>\r\n      <CommonButton title={lang('cancel')} onPress={()=>{\r\n        callback?.(undefined)\r\n        back()\r\n      }}/>\r\n      \r\n    </View>\r\n  </BottomSheet>\r\n}\r\n","import { useQuery } from \"react-query\";\r\nimport { getExternalMembershipList } from \"../../services\";\r\n\r\nexport default function useExternalMembershipList(keyword?:string){\r\n  const { data } = useQuery([\"UserMembershipList\", keyword] , async()=>keyword?(await getExternalMembershipList(keyword)):[])\r\n  return data\r\n}","import React from 'react';\r\nimport { StyleProp, TextStyle } from 'react-native';\r\nimport { CustomTextInputProps } from '../types';\r\nimport CommonTextInput from './CommonTextInput';\r\nimport RowField from './RowField';\r\n\r\nexport default function TextField(props:CustomTextInputProps & {name: string, width?:any, textStyle?:StyleProp<TextStyle>}) {\r\n  return (\r\n    <RowField name={props.name} width={props.width} textStyle={props.textStyle}>\r\n      <CommonTextInput {...props} />\r\n   </RowField>\r\n  )\r\n}","import React, { useState } from 'react';\r\nimport { TextInput } from 'react-native';\r\nimport Colors from '../constants/Colors';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { CustomTextInputProps } from '../types';\r\n\r\nexport default (props:CustomTextInputProps)=>{\r\n    const [contentHeight, setContentHeight] = useState<number>()\r\n    const minHeight = props.minHeight || 30\r\n    const theme = useColorScheme()\r\n    if (props.multiline){\r\n        console.log(contentHeight)\r\n    }\r\n    return <TextInput style={[{\r\n            borderColor:'#d0d7de', \r\n            fontSize:16, \r\n            borderWidth:1, \r\n            borderRadius:6, \r\n            paddingHorizontal:10, \r\n            paddingVertical:3, \r\n            backgroundColor:Colors[theme].background,\r\n            color:Colors[theme].text,\r\n            height:props.multiline?contentHeight:minHeight,\r\n        }, props.style]}\r\n        placeholder={props.placeholder}\r\n        editable={!props.disabled} \r\n        keyboardType={props.keyboardType}\r\n        secureTextEntry={props.secureTextEntry}\r\n        value={props.value}\r\n        onChangeText={props.setValue}\r\n        onContentSizeChange={props.multiline?(e) => setContentHeight(Math.max(e.nativeEvent.contentSize.height -0.5, minHeight) + 2):undefined}\r\n        onBlur={()=>props.onBlur?.(props.value)}\r\n        onEndEditing={()=>props.onEndEditing?.(props.value)}\r\n        multiline={props.multiline}\r\n    />\r\n}","import React from \"react\"\r\nimport CommonItem from \"./CommonItem\"\r\nimport { UserMembership } from \"../types\"\r\nimport Avatar from \"./Avatar\"\r\nimport { Text, View } from \"./Themed\"\r\n\r\nexport default ({member:item, onPress}:{member:UserMembership, onPress?:()=>void})=> {\r\n    return <CommonItem key={item.id} bodyStyle={{flexDirection:'row', justifyContent:'flex-start'}} onPress={onPress}>\r\n        <View style={{marginTop:4, marginRight:12}}><Avatar name={item.name} userId={item.id} size={44}/></View>\r\n        <Text style={{fontSize:20, fontWeight:'400'}}>{item.name}</Text>\r\n    </CommonItem>\r\n}","import React from 'react';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport CommonButton from '../components/CommonButton';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport { Text, View } from '../components/Themed';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport { BottomSheet } from '../components/ModalSection';\r\nimport useModalEffect from '../hooks/useModalEffect';\r\n\r\n\r\nexport default function AlertModal({type}:{type:string}) {\r\n  const { lang } = useLangContext()\r\n  const { setModal } = useModalsContext()\r\n  const {dispatch} = useAuthContext()\r\n  const back = ()=>{\r\n    setModal(AlertModal, null)\r\n  }\r\n  const messages = {\r\n    \"GUEST_LOGOUT\":{\r\n      message: 'Guest users cannot reconnect after logging out. Please create an account or log in.',\r\n      title: 'sign out',\r\n      onPress: ()=>dispatch({type:\"LOGOUT_REQUEST\"})\r\n    }\r\n  } as Record<string, {message:string, title:string, onPress:()=>void}>\r\n\r\n  useModalEffect(back, [])\r\n  return <BottomSheet>\r\n    <Text>{lang(messages[type].message)}</Text>\r\n    <View style={{width:'100%', flexDirection:'row', justifyContent:'flex-end'}}>\r\n      <CommonButton title={lang(messages[type].title)} onPress={messages[type].onPress}/>\r\n      <CommonButton title={lang('cancel')} onPress={()=>back()}/>\r\n    </View>\r\n  </BottomSheet>\r\n}\r\n","import React from 'react';\r\nimport {View} from 'react-native'\r\nimport {Text} from './Themed';\r\nimport { ProfileProps } from '../types';\r\nimport Avatar from './Avatar';\r\n\r\nexport default (props:ProfileProps)=>{\r\n    return <View style={{width:'100%', height:135, justifyContent:'space-evenly', alignItems:'center'}}>\r\n        <Avatar {...props} size={75}/>\r\n        <Text style={{fontWeight:'bold', fontSize:15}}>{props.name}</Text>\r\n        <Text style={{fontWeight:'normal', fontSize:14}}>{props.username}</Text>\r\n    </View>\r\n}","import React, { useState,  useEffect, createContext, useMemo, useRef, useContext } from \"react\"\r\nimport firebase from \"firebase/app\";\r\nimport \"firebase/messaging\";\r\nimport {FCM_PUBLIC_VAPID_KEY, FCM_API_KEY} from \"../constants/Envs\"\r\nimport { Notification as NotificationType, UserMembership } from \"../types\";\r\nimport { getNotification, postNotification, putNotification } from \"../services/notification\";\r\n\r\nconst firebaseConfig = require(\"../../web/firebase-config.js\")\r\n// Initialize Firebase\r\nconst key = firebaseConfig.messagingSenderId\r\nconst apiKeyEncrypted = (FCM_API_KEY as string).split('').map((v, i)=> (v.charCodeAt(0) ^ key.charCodeAt(i)).toString(16).padStart(2, '0')).join('')\r\nconst app = firebase.initializeApp({...firebaseConfig, apiKey:FCM_API_KEY});\r\n// const analytics = getAnalytics(app);\r\nconst messaging = firebase.messaging(app);\r\n\r\nmessaging.onMessage((payload) => {\r\n  if (!(\"Notification\" in window)) {\r\n    alert(\"This browser does not support desktop notification\");\r\n  }\r\n  else if (Notification.permission === \"granted\") {\r\n    const message_set = JSON.parse(payload.data['message_set'])[0]\r\n    new Notification(payload.data.channel_name, { body: `${payload.data.name}: ${message_set.content}` });\r\n  }\r\n});\r\n\r\nconst requestToken = async()=>{\r\n  const permission = await Notification.requestPermission();\r\n  if (permission === 'granted') {\r\n    const serviceWorkerRegistration = await navigator.serviceWorker.register(`${process.env.PUBLIC_URL}/firebase-messaging-sw.js?${apiKeyEncrypted}`)\r\n    console.log('[SW]: SCOPE: ', serviceWorkerRegistration.scope);\r\n    const currentToken = await messaging.getToken({serviceWorkerRegistration, vapidKey: FCM_PUBLIC_VAPID_KEY }).catch(\r\n      async()=>await messaging.getToken({serviceWorkerRegistration, vapidKey: FCM_PUBLIC_VAPID_KEY })\r\n    )\r\n    window.addEventListener('beforeunload', (event:any) => {\r\n      event.preventDefault();\r\n      serviceWorkerRegistration.unregister()\r\n    });\r\n    if (currentToken)\r\n      return currentToken\r\n  }\r\n  return null\r\n}\r\n\r\nconst FirebaseContext = createContext<{enable?:boolean, setEnable:(enable:boolean)=>void}>({setEnable:()=>{}});\r\n\r\nexport const FirebaseProvider = ({user, children}:{user?:UserMembership|null, children:React.ReactNode})=>{\r\n  const tokenRef = useRef<string|null>()\r\n  const [notification, setNotification] = useState<NotificationType|null>()\r\n  const enable = useMemo(()=>notification===undefined?undefined:(notification?.token?true:false), [notification])\r\n  const setEnable = (enable:boolean)=>{\r\n    if(user && notification){\r\n      putNotification({...notification, token:enable?(tokenRef.current==undefined?null:tokenRef.current):null}).then((noti)=>{\r\n        setNotification(noti)\r\n      })\r\n    }\r\n  }\r\n  useEffect(()=>{\r\n    let isMount = true;\r\n    if(user){\r\n      if (tokenRef.current ===undefined){\r\n        tokenRef.current = null\r\n        requestToken().then((t)=>{\r\n          tokenRef.current = t\r\n          if (notification){\r\n            putNotification({...notification, token:tokenRef.current}).then((noti)=>{\r\n              if(isMount)setNotification(noti)\r\n            })\r\n          }\r\n        });\r\n      }\r\n      if (notification===undefined){\r\n        getNotification(user.id).then((noti)=>{\r\n          if(isMount)setNotification(noti || null)\r\n        })\r\n      }\r\n      else if(notification===null){\r\n        postNotification({user:user.id, type:'WEB', token:null}).then((noti)=>{\r\n          if(isMount)setNotification(noti)\r\n        })\r\n      }\r\n      else if (notification.token && tokenRef.current && tokenRef.current != notification.token){\r\n        putNotification({...notification, token:tokenRef.current}).then((noti)=>{\r\n          if(isMount)setNotification(noti)\r\n        })\r\n      }\r\n    }\r\n    return ()=>{isMount=false}\r\n  }, [user, notification])\r\n  return <FirebaseContext.Provider value={{enable, setEnable}}>\r\n    {(enable!=undefined || user===null) && children}\r\n  </FirebaseContext.Provider>\r\n}\r\n\r\nexport default ()=>{\r\n  const {enable, setEnable} = useContext(FirebaseContext)\r\n  return {enable, setEnable}\r\n}\r\n","import { useMemo, useReducer } from \"react\"\r\n\r\ntype LocalSearchAction = {type:string, keyword?:string}\r\n\r\ntype LocalSearchState ={active:boolean, keyword:string}\r\n\r\n\r\n\r\nconst localSearchReducer =(initialState:LocalSearchState, action:LocalSearchAction)=>{\r\n    switch (action.type){\r\n        case 'SEARCH':\r\n          return {\r\n            ...initialState,\r\n            keyword: action.keyword\r\n          } as LocalSearchState\r\n        case 'ENABLE_SEARCH':\r\n          return {\r\n            ...initialState,\r\n            active:true,\r\n          }\r\n        case 'DISABLE_SEARCH':\r\n            return{\r\n                ...initialState,\r\n                active:false,\r\n                keyword: ''\r\n            }\r\n        default:\r\n            throw new Error( `Unhandled action type: ${action.type}`)\r\n    }\r\n  }\r\n\r\n\r\nexport default function useLocalSearch<T>(target:T[], compare:(value:T, keyword:string)=>boolean) {\r\n  const [searchState, dispatch] = useReducer(localSearchReducer, {active:false, keyword:''})\r\n  const data = useMemo(()=>searchState.active?target.filter(v=>compare(v, searchState.keyword)):target, [searchState, target])\r\n  return {searchState, dispatch, data}\r\n}","\r\nimport React, {useState} from 'react';\r\nimport { StyleProp, TextStyle, View } from 'react-native';\r\nimport Clipboard from '@react-native-clipboard/clipboard';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport { CustomTextInputProps } from '../types';\r\nimport CommonButton from './CommonButton';\r\nimport RowField from './RowField';\r\nimport { Text } from './Themed';\r\nimport useResizeContext from '../hooks/useResizeContext';\r\n\r\nexport default function CopyField(props:CustomTextInputProps & {name: string, width?:any, textStyle?:StyleProp<TextStyle>}) {\r\n  const { lang } = useLangContext()\r\n  const windowType = useResizeContext()\r\n  const [copied, setCopied] = useState(false)\r\n  return (\r\n    <RowField name={props.name} width={props.width} textStyle={props.textStyle}>\r\n      <View style={{flexDirection:windowType=='landscape'?'row':'column', justifyContent:'space-between'}}>\r\n        <View style={{justifyContent:'center'}}>\r\n          <Text style={{fontSize:16}}>{props.value}</Text>\r\n        </View>\r\n        <View>\r\n          <CommonButton title={lang('copy')} onPress={()=>{Clipboard.setString(props.value);setCopied(true)}}/>\r\n          {copied && <Text style={{fontSize:12, alignSelf:'center', color:'red'}}>{lang(\"copied\")}</Text>}\r\n        </View>\r\n      </View>\r\n   </RowField>\r\n  )\r\n}","import React, {useRef,MutableRefObject, useMemo, useState, useEffect } from 'react';\r\nimport { View, Text } from '../components/Themed';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport useUserMembershipList from '../hooks/lists/useUserMembershipList';\r\nimport { TabViewRecord, UserMembership } from '../types';\r\nimport CommonButton from '../components/CommonButton';\r\nimport useMessengerMemberList, { useMessengerMemberMutation } from '../hooks/lists/useMessengerMemberList';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport useExternalMembershipList from '../hooks/lists/useExternalMembershipList';\r\nimport TextField from '../components/TextField';\r\nimport useLocalSearch from '../hooks/useLocalSearch';\r\nimport TabView from '../components/TabView';\r\nimport { FlatList } from 'react-native-gesture-handler';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport MemberItem from '../components/MemberItem';\r\nimport ModalSection from '../components/ModalSection';\r\nimport useModalEffect from '../hooks/useModalEffect';\r\nimport CopyField from '../components/CopyField';\r\n\r\nconst InviteItem = (props:{item:UserMembership, selectedRef:MutableRefObject<Set<number>>})=>{\r\n  const [selected, setSelected] = useState(props.selectedRef.current.has(props.item.id))\r\n  return <View style={selected?{borderWidth:1, borderColor:'blue'}:{}}>\r\n    <MemberItem member={props.item} onPress={()=>{\r\n      if (selected){\r\n        setSelected(false)\r\n        props.selectedRef.current.delete(props.item.id)\r\n      }\r\n      else{\r\n        setSelected(true)\r\n        props.selectedRef.current.add(props.item.id)\r\n      }\r\n    }}/>\r\n  </View>\r\n\r\n}\r\ntype InviteTabViewProps = {\r\n  id:number,\r\n  selectedRef:MutableRefObject<Set<number>>\r\n}\r\n\r\nconst GroupTabView = ({id, selectedRef}:InviteTabViewProps)=>{\r\n  const { lang } = useLangContext()\r\n  const {auth} = useAuthContext()\r\n  const { setModal } = useModalsContext()\r\n  const userList = useUserMembershipList(auth)\r\n  const memberList = useMessengerMemberList(id)\r\n  const messengerMemberMutation = useMessengerMemberMutation()\r\n  const rawData = useMemo(()=>{\r\n    const memberSet = new Set(memberList?.map(v=>v.user))\r\n    return userList?.filter(v=>!memberSet.has(v.id)) || []\r\n  }, [userList, memberList])\r\n  const {data, dispatch:dispatchKeyword, searchState} = useLocalSearch(rawData, (v, keyword)=>(v.username.includes(keyword) || v.name.includes(keyword)))\r\n  const search = (k:string)=>{\r\n    if (k?.length>0){\r\n      dispatchKeyword({type:'ENABLE_SEARCH'})\r\n      dispatchKeyword({type:'SEARCH', keyword:k})\r\n    }\r\n    else{\r\n      dispatchKeyword({type:'DISABLE_SEARCH'})\r\n    }\r\n  }\r\n  const back = ()=>{\r\n    setModal(InviteModal, null)\r\n  }\r\n  useModalEffect(back, [])\r\n  return <View style={{alignItems:'center', flex:1}}>\r\n    <View style={{'width': '100%', flex:1}}>\r\n      <TextField name={`${lang('Username')} & ${lang('Name')}`} placeholder={auth.user?.name} value={searchState.keyword} setValue={search} width={'80%'}/>\r\n      {id && data && <FlatList contentContainerStyle={{flexGrow:1}} data={data} renderItem={({item})=><InviteItem item={item} selectedRef={selectedRef}/>}/>}\r\n    </View>\r\n    <View style={[{width:'100%', flexDirection:'row', padding:10,}, {justifyContent:'flex-end'}]}>\r\n      <CommonButton title={lang('invite')} onPress={()=>{\r\n        messengerMemberMutation.invite({\r\n          channel_id:id,\r\n          user_ids:[...selectedRef.current]\r\n        }).then(back)\r\n      }}/>\r\n      <CommonButton title={lang('cancel')} onPress={back}/>\r\n    </View>\r\n  </View>\r\n}\r\n\r\nconst DELAY = 500\r\n\r\nconst ExternalMembershipTabView = ({id, selectedRef}:InviteTabViewProps)=>{\r\n  const { lang } = useLangContext()\r\n  const [value, setValue] = useState('')\r\n  const [keyword, setKeyword] = useState('')\r\n  const timeoutRef = useRef<NodeJS.Timeout>()\r\n  const {auth} = useAuthContext()\r\n  const { setModal } = useModalsContext()\r\n  const memberList = useMessengerMemberList(id)\r\n  const externalMemberList = useExternalMembershipList(keyword)\r\n  const data = useMemo(()=>{\r\n    const memberSet = new Set(memberList?.map(v=>v.user))\r\n    return externalMemberList?.filter(v=>!memberSet.has(v.id)) || []\r\n  }, [externalMemberList, memberList])\r\n  const messengerMemberMutation = useMessengerMemberMutation()\r\n  useEffect(()=>{\r\n    timeoutRef.current = setTimeout(()=>{\r\n      setKeyword(value)\r\n    }, DELAY)\r\n    return ()=>{timeoutRef.current && clearTimeout(timeoutRef.current)}\r\n  }, [value])\r\n  const back = ()=>{\r\n    setModal(InviteModal, null)\r\n  }\r\n  const inviteLink = location.href.replace('chat', 'invitee')\r\n  return <View style={{alignItems:'center', flex:1}}>\r\n  <View style={{'width': '100%', flex:1, paddingVertical:10}}>\r\n    <CopyField name={lang('invite link')} width={'80%'} value={inviteLink}/>\r\n    <View style={{marginVertical: 10, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n    <TextField name={lang('Username')} placeholder={auth.user?.username} value={value} setValue={setValue} width={'80%'}/>\r\n    {id && data && <FlatList contentContainerStyle={{flexGrow:1}} data={data} renderItem={({item})=><InviteItem item={item} selectedRef={selectedRef}/>}/>}\r\n  </View>\r\n  <View style={[{width:'100%', flexDirection:'row', padding:10,}, {justifyContent:'flex-end'}]}>\r\n    <CommonButton title={lang('invite')} onPress={()=>{\r\n      messengerMemberMutation.invite({\r\n        channel_id:id,\r\n        user_ids:[...selectedRef.current]\r\n      }).then(back)\r\n    }}/>\r\n    <CommonButton title={lang('cancel')} onPress={back}/>\r\n  </View>\r\n</View>\r\n}\r\n\r\nexport default function InviteModal({id}:{id:number}) {\r\n  const { lang } = useLangContext()\r\n  const selectedRef = useRef<Set<number>>(new Set())\r\n  const drawerTabs:TabViewRecord = {\r\n    group:{\r\n      title: 'Group',\r\n      component: ()=><GroupTabView id={id} selectedRef={selectedRef}/>,\r\n      icon: <></>\r\n    },\r\n    external:{\r\n      title: 'External members',\r\n      component: ()=><ExternalMembershipTabView id={id} selectedRef={selectedRef}/>,\r\n      icon: <></>\r\n    }\r\n  }\r\n  return <ModalSection>\r\n    <View style={{flex:1, width:'100%'}}>\r\n      <View style={{width:'100%'}}>\r\n        <Text style={{fontSize:20}}>{lang('invite')}</Text>\r\n        <View style={{marginBottom: 20, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n      </View>\r\n      <TabView tabs={drawerTabs} tabBarPosition={\"top\"}/>\r\n    </View>\r\n  </ModalSection>\r\n}\r\n\r\n","import { useEffect } from \"react\"\r\nimport { navigate } from \"../navigation\"\r\nimport useMessengerChannelList from \"./lists/useMessengerChannelList\"\r\nimport { useMessengerMemberMutation } from \"./lists/useMessengerMemberList\"\r\nimport useAuthContext from \"./useAuthContext\"\r\n\r\nlet invitee_id:number|undefined\r\nlet invitee_state:0|1|2=0\r\n\r\nexport const replaceInviteeState = (l:Location)=>{\r\n    if(l !==undefined && l.pathname.endsWith('/invitee')){\r\n        var params = l.search.slice(1).split('&').filter(v=>v.startsWith('id='))\r\n        if (params.length>0)\r\n            invitee_id = parseInt(params[0].split('=')[1])\r\n        window.history.replaceState(null, '', l.href.split('invitee')[0]\r\n        );\r\n    }\r\n}\r\n\r\nexport default ()=>{\r\n    const {auth} = useAuthContext()\r\n    const channelList = useMessengerChannelList(auth)\r\n    const messengerMemberMutation = useMessengerMemberMutation()\r\n    useEffect(()=>{\r\n        if (auth.user){\r\n            if (invitee_id && channelList){\r\n                var id = invitee_id;\r\n                var redirect = ()=>navigate(\"Main\", {screen:\"ChatScreen\", params: {id}})\r\n                invitee_id = undefined;\r\n                invitee_state = 1;\r\n                if(channelList.find(v=>v.id==id) === undefined){\r\n                    console.log(`invite processing (channel:${id})`)\r\n                    messengerMemberMutation.invite({\r\n                        channel_id:id,\r\n                        user_ids:[auth.user.id]\r\n                    }).then(redirect)\r\n                }\r\n                else{\r\n                    console.log('already invite')\r\n                    redirect()\r\n                }\r\n            }\r\n        }\r\n        else{\r\n            if (invitee_state == 1){\r\n                invitee_state=2\r\n            }\r\n        }\r\n    }, [auth, channelList])\r\n    useEffect(()=>{\r\n        if(auth.user && invitee_state==2){\r\n            navigate(\"Main\", {screen:\"HomeScreen\"})\r\n        }\r\n    }, [auth.user])\r\n}","editorConfig = {\r\n    plugins: 'image link charmap advlist lists paste', //autoresize textcolor imagetools,\r\n    toolbar: 'fontsizeselect | bold italic underline strikethrough | undo redo | alignleft aligncenter alignright | bullist numlist | link', // charmap removeformat\r\n    setup: (editor)=>{\r\n    }\r\n}\r\nif (typeof module !== 'undefined') {\r\n    module.exports = editorConfig\r\n}\r\n","firebaseConfig = {\n    \"authDomain\": \"virtual-metrics-355712.firebaseapp.com\",\n    \"projectId\": \"virtual-metrics-355712\",\n    \"storageBucket\": \"virtual-metrics-355712.appspot.com\",\n    \"messagingSenderId\": \"76003576924\",\n    \"appId\": \"1:76003576924:web:c8c8a006d07918bbc02a99\",\n    \"measurementId\": \"G-SEL35L4N5R\"\n}\nif (typeof module !== 'undefined') {\n    module.exports = firebaseConfig\n}\n","/**\r\n * Learn more about deep linking with React Navigation\r\n * https://reactnavigation.org/docs/deep-linking\r\n * https://reactnavigation.org/docs/configuring-links\r\n */\r\n\r\nimport { LinkingOptions } from '@react-navigation/native';\r\nimport * as Linking from 'expo-linking';\r\nimport {main, login, modal} from '../screens';\r\n\r\nconst ROOTPATH = 'tokki-tok'  // github repository name\r\n\r\nObject.values(modal).forEach(v=>v.path = ROOTPATH + '/' + v.path)\r\n\r\nexport default  {\r\n  prefixes: [Linking.makeUrl('/')],\r\n  config: {\r\n    screens: {\r\n      Main: {\r\n        screens:{\r\n          ...main,\r\n          ...login,\r\n          NotFound: '*',\r\n        },\r\n        path: ROOTPATH\r\n      },\r\n      ...modal\r\n    },\r\n  },\r\n} as LinkingOptions;\r\n"],"sourceRoot":""}