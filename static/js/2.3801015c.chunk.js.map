{"version":3,"sources":["src/screens/NotFoundScreen.tsx","src/navigation/Drawer.tsx","src/modals/index.ts","src/navigation/MainNavigator.tsx","src/components/Themed.tsx","src/constants/Colors.ts","src/hooks/useModalsContext.tsx","src/hooks/useResizeContext.tsx","src/components/CommonButton.tsx","src/components/ModalSection.tsx","src/lib/react-native-paper/Avatar.tsx","src/components/Avatar.tsx","src/components/CommonSection.tsx","src/hooks/lists/useMessengerChannelList.ts","src/hooks/useModalEffect.ts","src/navigation/index.tsx","src/hooks/useWebsocketContext.tsx","src/hooks/lists/usePeopleUserList.ts","src/hooks/lists/useMessengerMemberList.ts","src/modals/ProfileModal.tsx","src/components/TextButton.tsx","src/modals/ChannelEditModal.tsx","src/modals/RegistrationModal.tsx","src/hooks/useUserMutation.ts","src/hooks/lists/useMessengerContentList.ts","src/hooks/useUploadContext.tsx","src/components/RowField.tsx","src/hooks/lists/useExternalUserList.ts","src/components/TabView.tsx","src/components/CommonItem.tsx","src/components/HeaderRight.tsx","src/modals/AddPeopleModal.tsx","src/components/ContractFooter.tsx","src/screens/login/LoginScreen.tsx","src/lib/react-native-webrtc/useWebsocketContext.tsx","src/lib/react-native-webrtc/webrtc/p2p.tsx","src/lib/react-native-webrtc/webrtc/index.ts","src/lib/react-native-webrtc/LocalCam.tsx","src/lib/react-native-webrtc/RemoteCam.tsx","src/screens/main/ChatScreen/VideoCallSection.tsx","src/components/Messages/UploadTags.tsx","src/lib/tinymce/Editor.tsx","src/components/Editor.tsx","src/screens/main/ChatSection.tsx","src/screens/main/HomeScreen/ConfigSections.tsx","src/screens/main/HomeScreen/index.tsx","src/screens/index.ts","src/screens/main/ChatScreen/index.tsx","src/hooks/useChatSection.tsx","src/screens/login/DemoScreen.tsx","src/hooks/useLocalSearch.ts","src/components/CopyField.tsx","src/modals/InviteModal.tsx","src/modals/DateTimePickerModal.tsx","src/components/Messages/MessageContentView.tsx","src/modals/MessageModal.tsx","src/components/Messages/EditorPreview.tsx","src/components/Profile.tsx","src/components/CommonTextInput.tsx","src/components/TextField.tsx","src/components/MemberItem.tsx","src/modals/AlertModal.tsx","src/hooks/useFirebaseContext.tsx","src/components/Messages/LinkPreview.tsx","src/components/Messages/FilePreview.tsx","src/components/Messages/index.tsx","src/hooks/lists/useMessengerViewerList.ts","src/components/Messages/TimerTags.tsx","src/hooks/lists/useTimerMessageContent.ts","src/hooks/useInvitee.ts","web/editor-config.js","web/firebase-config.js","src/navigation/LinkingConfiguration.ts"],"names":["NotFoundScreen","_ref","navigation","lang","useLangContext","auth","useAuthContext","_jsxs","View","style","styles","container","children","_jsx","Text","title","TouchableOpacity","onPress","replace","user","link","linkText","StyleSheet","create","flex","backgroundColor","alignItems","justifyContent","padding","fontSize","fontWeight","marginTop","paddingVertical","color","PeopleTabView","setModal","useModalsContext","userList","usePeopleUserList","map","item","index","CommonItem","containerStyle","marginHorizontal","bodyStyle","ProfileModal","id","marginLeft","name","MessengerTabView","channelList","useMessengerChannelSorted","avatarFromChannel","navigate","colors","useTheme","theme","useColorScheme","windowType","useResizeContext","_useState","useState","_useState2","_slicedToArray","setIndex","onAddList","AddPeopleModal","ChannelEditModal","type","drawerTabs","Colors","iconColor","MemberTab","component","icon","MaterialCommunityIcons","size","marginBottom","ChatTab","Ionicons","getDrawerTabs","useEffect","undefined","tabBar","background","borderTopColor","border","width","pointerEvents","_Fragment","Profile","userId","username","flexDirection","TextButton","textStyle","borderRadius","accessibilityRole","content","Object","keys","length","TabView","tabs","tabBarPosition","onTab","borderTopWidth","borderColor","values","drawerTab","Tab","elevation","borderRightWidth","tab","label","textAlign","InviteModal","AlertModal","DateTimePickerModal","MessageModal","RegistrationModal","Main","createStackNavigator","isMobile","useIsMobile","_useLangContext","locale","entries","useMemo","console","log","login","main","modalValues","modals","backgroundStyle","UploadContextProvider","ModalsProvider","Drawer","WebSocketProvider","disable","FirebaseProvider","Navigator","screenOptions","route","headerStyle","header","height","headerTitleStyle","text","headerLeft","canGOBackScreen","findIndex","v","goBack","canGoBack","disabled","CommonButton","buttonBackgroundColor","hoverColor","margin","paddingHorizontal","headerRight","HeaderRight","headerLeftContainerStyle","borderBottomWidth","headerBottomColor","cardStyle","flexShrink","animationEnabled","cardStyleInterpolator","CardStyleInterpolators","forHorizontalIOS","_ref2","_ref3","key","screen","Screen","options","useThemeColor","props","colorName","colorFromProps","lightColor","darkColor","otherProps","_objectWithoutProperties","_excluded","light","dark","DefaultText","_objectSpread","_excluded2","DefaultView","tint","tabIconDefault","tabIconSelected","buttonBorderColor","focus","ModalsContext","createContext","allModals","setModals","_useState3","_useState4","animationType","setAnimationType","filter","visible","Component","Provider","value","newModals","m","modal","Modal","transparent","useContext","getWindowType","window","ResizeContextContext","Dimensions","get","ResizeContextProvider","detectMobile","useMobileDetect","_useWindowDimensions","useWindowDimensions","setWindowType","DefaultButton","hover","setHover","Pressable","onHoverIn","onHoverOut","selectable","_props","borderWidth","CommonSection","autoScale","outerContainerStyle","alignSelf","maxWidth","BottomSheet","normalizeHash","hash","min","max","Math","floor","str","initHash","i","charCodeAt","abs","stringToHSL","Avatar","split","join","toUpperCase","avatar","member_count","subowner","owner","titleText","titleStyle","subtitle","outerContainer","outerContainerFill","withSeparator","separator","titleOnPress","titleView","bodyView","marginVertical","useMessengerChannelList","queryClient","useQueryClient","lastJsonMessage","useWebsocketContext","data","useQuery","_asyncToGenerator","_auth$user","getChannelList","setQueryData","_data","find","concat","_toConsumableArray","sort","a","b","_data2$message_set$","channel","last_message","message_set","created","_a$last_message","_b$last_message","useMessengerChannelMutation","useMutation","postChannel","onSuccess","invalidateQueries","update","putChannel","direct","postDirectChannel","mutateAsync","callback","deps","useNavigation","event","e","preventDefault","addListener","removeListener","enableScreens","electronVersion","navigationRef","React","params","_navigationRef$curren","_navigationRef$curren2","current","_process","_process$versions","process","versions","Navigation","defaultColorScheme","useDefaultColorScheme","userColorScheme","colorScheme","NavigationContainer","ref","documentTitle","formatter","linking","LinkingConfiguration","DarkTheme","DefaultTheme","RootNavigator","Root","useInvitee","mode","headerMode","forVerticalIOS","MainNavigator","headerShown","gestureDirection","replaceInviteeState","location","IGNORE_WERNINGS","warnLogger","warn","message","some","includes","defaultContext","sendJsonMessage","WebSocketContext","WebSocketInternalProvider","path","Context","useBackground","token","setToken","AppState","currentState","isActive","setIsActive","_useWebSocket","useWebSocket","websockerURL","shouldReconnect","closeEvent","protocols","onOpen","onClose","AsyncStorage","getItem","then","listener","addEventListener","nextState","remove","usePeopleList","peopleId","_auth$user2","peopleChannel","usePeopleChannelId","getPeopleList","peopleList","useUserList","usePeopleMutation","_usePeopleList2","_create","_ref4","user_ids","postBulkMessengerMember","channel_id","_x","apply","arguments","_delete","_ref5","_peopleList$find","deleteMessengerMember","_x2","delete","useMessengerMemberList","getMessengerMemberList","useMessengerMemberMutation","invite","leave","peopleMutation","useExternalUser","isSelf","isExternal","channelMutation","back","useModalEffect","is_guest","_auth$user3","_auth$user4","newChannel","member_id","messengerMemberMutation","setName","description","setDescription","_name","ModalSection","ScrollView","flexGrow","maxHeight","TextField","setValue","multiline","field","ErrorView","form_error","form_error_text","setUsername","_useState5","_useState6","password","setPassword","_useState7","_useState8","checkPassword","setCheckPassword","_useState9","_useState10","_useState11","_useState12","error","setError","externalMemberList","useExternalUserList","userMembershipMutation","_useAuthContext","dispatch","postUser","_update","patchUser","deleteUser","useUserMutation","usernameDisable","RowField","CommonTextInput","keyboardType","secureTextEntry","newError","test","textAlignVertical","updateContnetPage","pages","updateMessages","update_i","forEach","page","timer","is_archive","useMessengerContentList","_useInfiniteQuery","useInfiniteQuery","pageParam","getMessengerContentList","select","next","getNextPageParam","lastPage","refetchOnReconnect","refetchOnWindowFocus","query","updated_gte","Date","state","dataUpdatedAt","toISOString","newData","getNewMessengerContentList","contents","lastMessageId","nextMessages","timerMessageRefetch","fetchNextPage","pageParams","useMessengerContentMutation","channelId","uploadDispatch","useUploadContext","postMessage","_patch","patchMessengerContent","mutate","patch","UploadContext","upload","uploadReducer","initialState","action","files","f","filename","progress","push","_defineProperty","_useReducer","useReducer","_useReducer2","rowStyle","keyword","getExternalUserList","getExternalUser","icons","assign","k","renderTabBar","TabBar","indicatorStyle","labelStyle","whiteSpace","activeColor","inactiveColor","renderIcon","scene","onTabPress","navigationState","routes","_ref6","_ref7","onIndexChange","onSwipeStart","Platform","OS","getSelection","sel","removeAllRanges","renderScene","SceneMap","_ref8","_ref9","_React$useState","_React$useState2","press","setPress","onPressIn","onPressOut","minHeight","defaultButtonProps","buttonProps","extra","selectedRef","useRef","Set","userFilter","memberSet","has","ExternalMembershipTabView","isChannel","openURL","url","href","Linking","Styles","footer_buttons","footer_button","AntDesign","paddingBottom","paddingRight","login_container","login_header","paddingTop","login_header_logo","resizeMode","login_header_text","login_header_text_bold","login_wrapper","borderTopRightRadius","borderTopLeftRadius","form","form_input","button","button_label","login_social","login_social_separator","login_social_separator_line","login_social_separator_text","login_social_buttons","login_social_button","login_social_icon","login_social_facebook","login_footer_text","guest_footer_text","login_footer_link","TURN_SERVER","peerConstraints","iceServers","JSON","parse","urls","sessionConstraints","mandatory","OfferToReceiveAudio","OfferToReceiveVideo","VoiceActivityDetection","mediaConstraints","audio","video","framerate","onICEcandidate","pc","_message","rtcMessage","candidate","RTCIceCandidate","addIceCandidate","sendICEcandidate","sendMessage","receiver","target","createOffer","pcRefCurrent","stream","addStream","offerDescription","arr","sdp","RTCSessionDescription","optimizeSdp","setLocalDescription","_x3","_x4","_x5","camStyle","cam","bottonContainer","position","bottom","buttonBar","_props$user","_useWebsocketContext","_useLocalCam","pcRef","sender","setSender","_stream","setStream","isPlay","CustomRTCView","useCallback","memo","RTCView","videoProps","start","newStream","mediaDevices","getUserMedia","getDisplayMedia","catch","_x6","_x7","_x8","stop","getTracks","track","websocketOnMessage","_websocketOnMessage","response","channel_name","peerConnection","RTCPeerConnection","answerDescription","setRemoteDescription","_x9","_x10","useLocalCam","Button","setReceiver","_useRemoteCam","setUser","close","clearInterval","statsInterval","_websocketOnMessage2","_pcRef$current","_pcRef$current2","_pcRef$current3","_pcRef$current4","iceConnectionState","activeStream","setInterval","stats","getStats","statsOutput","framePerSecond","report","kind","statName","framesPerSecond","toTimeString","addTransceiver","direction","streams","getRemoteStreams","createAnswer","localDescription","_x11","useRemoteCam","TextInput","onChangeText","VideoView","scale","focusGuest","setFocusGuest","VideoCallContainer","setDisable","videoMode","setVideoMode","guests","setGuests","_useRtcContext","useRtcContext","ceil","sqrt","toggleVideoMode","ThemedView","aspectRatio","borderLeftWidth","flexWrap","RemoteCam","LocalCam","RtcProvider","UploadTag","overflow","expand","setExpand","uploadData","isExpand","INIT","require","Editor","tinymceScriptSrc","onInit","editor","onReady","onEditorChange","init","setup","plugins","toolbar","skin","content_css","menubar","branding","statusbar","block_formats","fontsize_formats","ready","setReady","active","isEditor","setIsEditor","extraButtons","inputRef","editorValue","setEditorValue","setTimer","messageEvent","sendToScreen","bottomTab","setBottomTab","autoFocus","setAutoFocus","valueLines","contentMutation","postValue","Messages","reverse","UploadTags","TimerTags","borderBottomRightRadius","top","Entypo","timerFormat","datetime","onKeyPress","shiftKey","onFocus","numberOfLines","borderBottomLeftRadius","marginRight","Promise","resolve","reject","input","document","createElement","onchange","onabort","onerror","click","file","ConfigSection","setLocale","configTheme","useConfigColorScheme","_useFirebaseContext","useFirebaseContext","noti","enable","setNoti","setEnable","n","textDecorationLine","l","setColorScheme","paddingLeft","memberItem","MemberItem","member","today","slice","_item$last_message","_item$last_message2","_item$last_message3","_item$last_message4","_avatarFromChannel","date","preview_content","FontAwesome","opacity","replaceAll","unread_count","ConfigTabView","ConfigSections","getBottomTabs","headerSetter","headerIndexRef","OneTab","TwoTab","FourTab","SimpleLineIcons","HomeScreen","_route$params2","home","setHome","tempref","indexRef","measure","fx","fy","_","px","py","round","setOptions","useHeaderSetter","useLayoutEffect","_route$params","contentContainerStyle","StyledText","ContractFooter","parseInt","setParams","ChatScreen","channelAvatar","memberList","_memberList$find","useChatSection","minWidth","VideoCallSection","d","ChatSection","LoginScreen","_login","placeholder","autoCapitalize","onSubmitEditing","DemoScreen","localSearchReducer","Error","CopyField","copied","setCopied","Clipboard","setString","InviteItem","selected","setSelected","add","_useLocalSearch","compare","searchState","useLocalSearch","dispatchKeyword","FlatList","renderItem","setKeyword","timeoutRef","setTimeout","clearTimeout","inviteLink","messengerMemberList","external","dayTypes","hours","Array","toString","padStart","minutes","getDisableDays","startDate","clone","startOf","endDate","endOf","dayjs","result","format","Calendar","lazy","CommonPicker","_dayjs","restMinute","defaultDayjs","setDate","dayType","setDayType","hour","setHour","minute","setMinute","disableDays","setDisableDays","Suspense","fallback","disableAllTouchEventsForDisabledDays","onMonthChange","dateString","markedDates","reduce","p","c","MessageContentView","Hyperlink","linkDefault","wordBreak","linkStyle","onPressLink","isOwner","editorContents","attatchment_set","fullContent","regexForStripHTML","RenderHTML","contentWidth","source","baseStyle","contentHeight","setContentHeight","editable","onContentSizeChange","newHeight","nativeEvent","contentSize","onBlur","onEndEditing","messages","buttons","firebaseConfig","messagingSenderId","apiKeyEncrypted","FCM_API_KEY","app","firebase","initializeApp","apiKey","messaging","onMessage","payload","Notification","permission","body","alert","requestToken","requestPermission","serviceWorkerRegistration","navigator","serviceWorker","register","scope","currentToken","getToken","vapidKey","FCM_PUBLIC_VAPID_KEY","unregister","FirebaseContext","tokenRef","notification","setNotification","isMount","t","putNotification","getNotification","postNotification","_useContext","touchableRef","onLongPress","image_url","Image","uri","humanFileSize","pow","toFixed","showBorder","thumbnail","filesize","MessengerContentPageItem","_nextPage2","lastTouchRef","now","nextPage","_nextPage","nextContent","onTouchMove","index2","isSystem","isFirst","ownerId","dayChanged","onProfile","getOnPress","timerToString","attatchment","aIndex","EditorPreview","FilePreview","LinkPreview","useViewerContentList","_props$auth","_props$auth$user","onScroll","contentOffset","y","onLayout","layout","_timerFormat","year","month","TimerTag","end","ratio","diff","timerMessages","getTimerMessageContentList","sorted","_sorted$","ms","Number","MAX_VALUE","timeout","useTimerMessageContentList","setNow","invitee_id","invitee_state","pathname","endsWith","search","startsWith","history","replaceState","redirect","editorConfig","module","exports","ROOTPATH","prefixes","config","screens","NotFound"],"mappings":"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","file":"static/js/2.3801015c.chunk.js","sourcesContent":["import { StackScreenProps } from '@react-navigation/stack';\r\nimport * as React from 'react';\r\nimport { StyleSheet, Text, TouchableOpacity, View } from 'react-native';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport useLangContext from '../hooks/useLangContext';\r\n\r\nexport default function NotFoundScreen({\r\n  navigation,\r\n}: StackScreenProps<any, 'NotFound'>) {\r\n  const { lang } = useLangContext()\r\n  const { auth } = useAuthContext()\r\n  return (\r\n    <View style={styles.container}>\r\n      <Text style={styles.title}>{lang(\"This screen doesn't exist.\")}</Text>\r\n      <TouchableOpacity onPress={() => navigation.replace(auth.user?'HomeScreen':'LoginScreen')} style={styles.link}>\r\n        <Text style={styles.linkText}>{lang(\"Go to home screen!\")}</Text>\r\n      </TouchableOpacity>\r\n    </View>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: '#fff',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    padding: 20,\r\n  },\r\n  title: {\r\n    fontSize: 20,\r\n    fontWeight: 'bold',\r\n  },\r\n  link: {\r\n    marginTop: 15,\r\n    paddingVertical: 15,\r\n  },\r\n  linkText: {\r\n    fontSize: 14,\r\n    color: '#2e78b7',\r\n  },\r\n});\r\n","import { useTheme } from '@react-navigation/native';\r\nimport React, { useEffect, useState } from 'react';\r\nimport { View, StyleSheet } from 'react-native';\r\nimport Profile from '../components/Profile';\r\nimport TextButton from '../components/TextButton';\r\nimport Colors from '../constants/Colors';\r\nimport useResizeContext from '../hooks/useResizeContext';\r\nimport TabView from '../components/TabView';\r\nimport { TabViewRecord, User } from '../types';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport ChannelEditModal from '../modals/ChannelEditModal';\r\nimport CommonItem from '../components/CommonItem';\r\nimport { Text } from '../components/Themed';\r\nimport useAuthContext, { Auth } from '../hooks/useAuthContext';\r\nimport { useMessengerChannelSorted } from '../hooks/lists/useMessengerChannelList';\r\nimport { navigate } from '.'\r\nimport { avatarFromChannel } from '../components/Avatar';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { Ionicons, MaterialCommunityIcons } from '../lib/@expo/vector-icons';\r\nimport usePeopleUserList from '../hooks/lists/usePeopleUserList';\r\nimport ProfileModal from '../modals/ProfileModal';\r\nimport AddPeopleModal from '../modals/AddPeopleModal';\r\n\r\n\r\nconst PeopleTabView = ()=>{\r\n  const {auth} = useAuthContext()\r\n  const { setModal } = useModalsContext()\r\n  const userList = usePeopleUserList(auth)\r\n  return <View style={{flex:1}}>\r\n    {userList?.map((item, index)=>{\r\n      return <CommonItem key={index} containerStyle={{marginHorizontal:0}} bodyStyle={{alignItems:'flex-start'}} onPress={()=>setModal(ProfileModal, {id:item.id})}>\r\n        <Text style={{marginLeft:20}}>{item.name}</Text>\r\n      </CommonItem>\r\n    })}\r\n  </View>\r\n}\r\n\r\nconst MessengerTabView = ()=>{\r\n  const {auth} = useAuthContext()\r\n  const channelList = useMessengerChannelSorted('messenger', auth);\r\n  return <View style={{flex:1}}>\r\n    {channelList?.map((item, index)=>{\r\n      const {name} = avatarFromChannel(item, auth.user)\r\n      return <CommonItem key={index} containerStyle={{marginHorizontal:0}} bodyStyle={{alignItems:'flex-start'}} onPress={()=>navigate(\"ChatScreen\", {id:item.id})}>\r\n        <Text style={{marginLeft:20}}>{name}</Text>\r\n      </CommonItem>\r\n    })}\r\n  </View>\r\n}\r\nconst getDrawerTabs = (theme:'light'|'dark')=>{\r\n  const color = Colors[theme].iconColor\r\n  return {\r\n    MemberTab:{\r\n      title:'people',\r\n      component:PeopleTabView,\r\n      icon:<MaterialCommunityIcons size={32} color={color} style={{ marginBottom: -3 }} name='account'/>,\r\n    },\r\n    ChatTab:{\r\n        title:'chat',\r\n        component:MessengerTabView,\r\n        icon:<Ionicons size={30} color={color} style={{ marginBottom: -3 }} name='chatbox'/>\r\n    },\r\n    // MyMessageTab:{\r\n    //   title:'my messages',\r\n    //   component:MyMessageTabView,\r\n    //   icon:<MaterialCommunityIcons size={32} color={color} style={{ marginBottom: -3 }} name='pencil-box'/>\r\n    // }\r\n  } as TabViewRecord\r\n}\r\n\r\nexport default ({auth}:{auth:Auth})=> {\r\n  const { colors } = useTheme();\r\n  const theme = useColorScheme();\r\n  const windowType = useResizeContext();\r\n  const [index, setIndex] = useState<number>();\r\n  const { setModal } = useModalsContext()\r\n  \r\n  const onAddList = [\r\n    ()=>setModal(AddPeopleModal, {}),\r\n    ()=>setModal(ChannelEditModal, {type:'messenger'}),\r\n    // ()=>setModal(ChannelEditModal, {type:'mycontent'}),\r\n  ]\r\n  const drawerTabs = getDrawerTabs(theme)\r\n\r\n  useEffect(()=>{\r\n    if(index===undefined){\r\n      setIndex(0)\r\n    }\r\n  }, [])\r\n  return <View style={windowType=='landscape'?[\r\n      styles.tabBar,\r\n      {\r\n        backgroundColor: Colors[theme].background,\r\n        borderTopColor: colors.border,\r\n      },\r\n      // tabBarStyle,\r\n    ]:{width:0}}\r\n    pointerEvents={false ? 'none' : 'auto'}\r\n  >\r\n    {windowType=='landscape' && auth.user && index!==undefined && <>\r\n      <Profile userId={auth.user.id} username={auth.user.username} name={auth.user.name}/>\r\n      <View style={{flexDirection:'row-reverse'}}>\r\n          <TextButton title='+' textStyle={{fontSize:20}} style={{borderRadius:20}} onPress={onAddList[index]}/>\r\n      </View>\r\n      <View accessibilityRole=\"tablist\" style={styles.content}>\r\n        {Object.keys(drawerTabs).length>1 ? \r\n          <TabView tabs={drawerTabs} tabBarPosition={\"top\"} onTab={setIndex} index={index}/>: \r\n          <View style={{borderTopWidth:1, flex:1, borderColor:colors.border}}>            \r\n            {Object.values(drawerTabs).map(drawerTab=>{const Tab = drawerTab.component; return <Tab key={drawerTab.title}/>})}\r\n          </View>\r\n        }\r\n      </View>\r\n    </>}\r\n  </View>\r\n}\r\n\r\n{/*<Text style={[styles.label, { color: d.isFocused ? colors.primary : '#222' }]}></Text> */}\r\n\r\nconst styles = StyleSheet.create({\r\n    tabBar: {\r\n      width:240,\r\n      elevation: 8,\r\n      borderRightWidth:1,\r\n      borderColor:Colors.borderColor\r\n    },\r\n    content: {\r\n      flex: 1,\r\n      flexDirection: 'row',\r\n    },\r\n    tab: {\r\n        flex: 1,\r\n        alignItems: 'center',\r\n    },\r\n    label: {\r\n        textAlign: 'center',\r\n        backgroundColor: 'transparent',\r\n      },\r\n  });","import InviteModal from \"./InviteModal\";\r\nimport ProfileModal from \"./ProfileModal\";\r\nimport ChannelEditModal from \"./ChannelEditModal\"\r\nimport AlertModal from \"./AlertModal\";\r\nimport DateTimePickerModal from \"./DateTimePickerModal\"\r\nimport MessageModal from \"./MessageModal\";\r\nimport RegistrationModal from \"./RegistrationModal\";\r\nimport AddPeopleModal from \"./AddPeopleModal\";\r\n\r\nexport default [\r\n    InviteModal,\r\n    AddPeopleModal,\r\n    ProfileModal,\r\n    ChannelEditModal,\r\n    AlertModal,\r\n    DateTimePickerModal,\r\n    MessageModal,\r\n    RegistrationModal\r\n]","import { CardStyleInterpolators, createStackNavigator } from '@react-navigation/stack';\r\nimport React, {useMemo} from 'react';\r\nimport { View } from 'react-native';\r\nimport { Ionicons } from '../lib/@expo/vector-icons';\r\nimport useResizeContext from '../hooks/useResizeContext';\r\nimport NotFoundScreen from '../screens/NotFoundScreen';\r\nimport {main, login} from '../screens';\r\nimport Drawer from './Drawer';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport { WebSocketProvider } from '../hooks/useWebsocketContext';\r\nimport HeaderRight from '../components/HeaderRight'\r\nimport Colors from '../constants/Colors';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport { FirebaseProvider } from '../hooks/useFirebaseContext';\r\nimport useIsMobile from '../hooks/useIsMobile';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { ModalsProvider } from '../hooks/useModalsContext';\r\nimport modals from '../modals';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport CommonButton from '../components/CommonButton';\r\nimport { UploadContextProvider } from '../hooks/useUploadContext';\r\n\r\nconst Main = createStackNavigator();\r\n\r\nfunction headerLeft(navigation:any, route:any, windowType:string, theme:'light'|'dark', isMobile:boolean){\r\n    const canGOBackScreen = ['HomeScreen', 'LoginScreen'].findIndex(v=>v == route.name) == -1\r\n    const goBack = ()=>{\r\n        if (navigation.canGoBack())\r\n            navigation.goBack()\r\n        else if (canGOBackScreen)\r\n            navigation.replace('HomeScreen')\r\n    }\r\n    if (windowType=='portrait' && canGOBackScreen)\r\n        return <TouchableOpacity onPress={goBack} disabled={!isMobile}>\r\n            <CommonButton title={''} color={isMobile?Colors[theme].buttonBackgroundColor:Colors[theme].hoverColor} onPress={goBack} disabled={isMobile} style={{width:32, height:32, margin:16, paddingVertical:1, paddingHorizontal:4}}>\r\n                <Ionicons size={24} color={Colors[theme].iconColor} name=\"arrow-back\"/>\r\n            </CommonButton>\r\n        </TouchableOpacity>\r\n    return null\r\n}\r\n\r\nexport default ()=>{\r\n    const windowType = useResizeContext();\r\n    const isMobile = useIsMobile()\r\n    const {auth} = useAuthContext()\r\n    const theme = useColorScheme()\r\n    const {lang, locale} = useLangContext()\r\n    const entries = useMemo(()=>{\r\n        if (auth.user === undefined)\r\n            return []\r\n        console.log('current user: ', auth.user)\r\n        return Object.entries(auth.user === null?login:main)\r\n    }, [auth, locale])\r\n    const modalValues = useMemo(()=>{\r\n        if (auth.user === undefined)\r\n            return []\r\n        return auth.user === null?[]:modals\r\n    }, [auth])\r\n    const backgroundStyle = theme=='light'?{}:{backgroundColor:'#010409'}\r\n    return (auth.user!==undefined?<View style={{flexDirection:'row', flex:1}}>\r\n        <UploadContextProvider>\r\n            <ModalsProvider modals={modalValues}>\r\n                {auth.user?<Drawer auth={auth}/>:undefined}\r\n                <View style={[{flex:1}, backgroundStyle]}>\r\n                    <WebSocketProvider disable={auth.user === null || auth.user === undefined}>\r\n                        <FirebaseProvider user={auth.user}>\r\n                            <Main.Navigator\r\n                                screenOptions={({navigation, route})=>({\r\n                                    headerStyle:{backgroundColor:Colors[theme].header, height:isMobile?50:undefined},\r\n                                    headerTitleStyle:{color:Colors[theme].text},\r\n                                    headerLeft:()=>headerLeft(navigation, route, windowType, theme, isMobile),\r\n                                    headerRight:()=><HeaderRight/>,\r\n                                    headerLeftContainerStyle:{backgroundColor:Colors[theme].header, borderBottomWidth:1, borderColor:Colors[theme].headerBottomColor},\r\n                                    cardStyle:[{flexShrink:1}, backgroundStyle],\r\n                                    animationEnabled:windowType=='portrait',\r\n                                    cardStyleInterpolator: CardStyleInterpolators.forHorizontalIOS\r\n                                })}\r\n                            >\r\n                                {entries.map(([key, screen])=><Main.Screen key={key} name={key} component={screen.component} options={{ title: lang(screen.title) }} />)}\r\n                                <Main.Screen name=\"NotFound\" component={NotFoundScreen} options={{ title: 'Oops!' }} />\r\n                            </Main.Navigator>\r\n                        </FirebaseProvider>\r\n                    </WebSocketProvider>\r\n                </View>\r\n            </ModalsProvider>\r\n        </UploadContextProvider>\r\n    </View>:<></>);\r\n}","/**\r\n * Learn more about Light and Dark modes:\r\n * https://docs.expo.io/guides/color-schemes/\r\n */\r\n\r\nimport * as React from 'react';\r\nimport { Text as DefaultText, View as DefaultView } from 'react-native';\r\n\r\nimport Colors from '../constants/Colors'\r\nimport useColorScheme from '../hooks/useColorScheme';\r\n\r\nexport function useThemeColor(\r\n  props: { light?: string; dark?: string },\r\n  colorName: keyof typeof Colors.light & keyof typeof Colors.dark\r\n) {\r\n  const theme = useColorScheme();\r\n  const colorFromProps = props[theme];\r\n\r\n  if (colorFromProps) {\r\n    return colorFromProps;\r\n  } else {\r\n    return Colors[theme][colorName];\r\n  }\r\n}\r\n\r\ntype ThemeProps = {\r\n  lightColor?: string;\r\n  darkColor?: string;\r\n};\r\n\r\nexport type TextProps = ThemeProps & DefaultText['props'];\r\nexport type ViewProps = ThemeProps & DefaultView['props'];\r\n\r\nexport function Text(props: TextProps) {\r\n  const { style, lightColor, darkColor, ...otherProps } = props;\r\n  const color = useThemeColor({ light: lightColor, dark: darkColor }, 'text');\r\n\r\n  return <DefaultText style={[{ color }, style]} {...otherProps} />;\r\n}\r\n\r\nexport function View(props: ViewProps) {\r\n  const { style, lightColor, darkColor, ...otherProps } = props;\r\n  const backgroundColor = useThemeColor({ light: lightColor, dark: darkColor }, 'background');\r\n\r\n  return <DefaultView style={[{ backgroundColor }, style]} {...otherProps} />;\r\n}\r\n","const tintColorLight = '#2f95dc';\r\nconst tintColorDark = '#fff';\r\n\r\nexport default {\r\n  light: {\r\n    text: '#000',\r\n    background: '#fff',\r\n    tint: tintColorLight,\r\n    tabIconDefault: '#ccc',\r\n    tabIconSelected: tintColorLight,\r\n    hoverColor:'rgb(242,242,242)',\r\n    buttonBackgroundColor: '#f6f8fa', //'rgba(9,30,66,0.08)',//rgb(242,242,242)\\\r\n    header:'#f6f8fa',\r\n    headerBottomColor:'rgb(216, 216, 216)',\r\n    buttonBorderColor:'rgba(27,31,36,0.15)',\r\n    iconColor: 'black'\r\n  },\r\n  dark: {\r\n    text: '#fff',\r\n    background: '#000',\r\n    tint: tintColorDark,\r\n    tabIconDefault: '#ccc',\r\n    tabIconSelected: tintColorDark,\r\n    hoverColor: '#010409',//'rgb(1,4,9)',\r\n    buttonBackgroundColor: '#010409',//'#282624',\r\n    header:'#010409',\r\n    headerBottomColor:'rgb(40, 40, 40)',\r\n    buttonBorderColor:'rgba(229,225,220,0.15)',\r\n    iconColor: 'white'\r\n  },\r\n  borderColor:'#d0d7de',\r\n  \r\n  focus:'#0065A4',\r\n};\r\n","import React, { useState, createContext, useContext, useEffect } from \"react\";\r\nimport { Modal } from \"react-native\";\r\nimport useResizeContext from \"./useResizeContext\";\r\n\r\ntype ModalProps = any\r\n\r\ntype ModalState = {\r\n  Component:React.ComponentType<ModalProps>,\r\n  props:any\r\n  visible:boolean\r\n}\r\ntype SetModal = (Component:ModalState[\"Component\"]|null, props:ModalProps|null)=>void\r\n\r\nconst ModalsContext = createContext<{setModal: SetModal}>({\r\n    setModal: () => {}\r\n});\r\n\r\nexport const ModalsProvider = ({children, modals:allModals}:{children:React.ReactNode, modals:React.ComponentType<ModalProps>[]}) => {\r\n    const [modals, setModals] = useState<ModalState[]>([]);\r\n    const windowType = useResizeContext();\r\n    const [animationType, setAnimationType] = useState('none')\r\n    const setModal:SetModal = (Component, props) => {\r\n        const newModals = modals.map(m=>{\r\n            if(Component==null || m.Component != Component){\r\n                return {\r\n                    ...m,\r\n                    visible:false\r\n                }\r\n            }\r\n            else if(m.Component == Component){\r\n                return {\r\n                    Component, \r\n                    props:props!==null?props:m.props,\r\n                    visible:props!==null\r\n                }\r\n            }\r\n            return m        \r\n        })\r\n        setModals(newModals);\r\n    }\r\n    useEffect(()=>{\r\n        if (modals.filter(v=>v.visible).length == 0)\r\n            setAnimationType(windowType == 'landscape'?'fade':'slide')\r\n    }, [windowType])\r\n    useEffect(()=>{\r\n        setModals(allModals.map((Component)=>({Component, props:null, visible:false})))\r\n    }, [allModals])\r\n    return <ModalsContext.Provider value={{setModal}}>\r\n        {children}\r\n        {modals.map((modal, index)=>{\r\n            const { Component, props, visible } = modal;\r\n            return <Modal key={index} animationType={animationType as any} visible={visible} transparent>\r\n                <Component {...props}/>\r\n            </Modal>\r\n        })}\r\n    </ModalsContext.Provider>\r\n}\r\n\r\nexport default ()=>{\r\n    const modalsContext = useContext(ModalsContext)\r\n    return modalsContext\r\n}\r\n\r\n","import React, { useState, useEffect, createContext, useContext, useMemo } from 'react';\r\nimport { Dimensions, ScaledSize, useWindowDimensions } from 'react-native';\r\n//@ts-ignore\r\nimport useMobileDetect from 'use-mobile-detect-hook';\r\n\r\ntype WindowType = 'portrait' | 'landscape'\r\n\r\nconst getWindowType = (window:{width:number, height:number})=> window.height >= window.width?'portrait':'landscape' as WindowType;\r\n\r\nconst ResizeContextContext = createContext<WindowType>(getWindowType(Dimensions.get('window')));\r\n\r\nexport const ResizeContextProvider = ({children}:{children:React.ReactNode})=>{\r\n  const detectMobile = useMobileDetect();\r\n  const {width, height} = useWindowDimensions()\r\n  const [windowType, setWindowType] = useState(getWindowType({width, height}))\r\n  useEffect(()=>{\r\n    setWindowType(getWindowType({width, height}))\r\n  }, [width, height])\r\n  return <ResizeContextContext.Provider value={detectMobile.isMobile()?'portrait':windowType}>\r\n    {children}\r\n  </ResizeContextContext.Provider>\r\n}\r\n\r\nexport default function useResizeContext() {\r\n  const windowType = useContext(ResizeContextContext)\r\n  return windowType\r\n}","import React, { useState } from 'react';\r\nimport { Text, StyleSheet, Pressable, StyleProp, ViewStyle} from 'react-native';\r\nimport Colors from '../constants/Colors';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { CustomButtonProps } from '../types';\r\n\r\nconst DefaultButton = (props:CustomButtonProps & {borderColor:string})=>{\r\n    const [hover, setHover] = useState(false)\r\n    return <Pressable\r\n        onPress={()=>props.onPress()}\r\n        //@ts-ignore\r\n        onHoverIn={()=>setHover(true)}\r\n        onHoverOut={()=>setHover(false)}\r\n        disabled={props.disabled}\r\n        style={[\r\n            {\r\n                paddingVertical:5, \r\n                paddingHorizontal:16\r\n            },\r\n            props.style,\r\n            (hover || props.disabled)?{backgroundColor:props.color, borderColor:props.borderColor}:{}\r\n        ]}>\r\n            {props.children?props.children:\r\n            <Text selectable={false} style={[{fontSize:14}, props.textStyle]}>{props.title}</Text>}\r\n        </Pressable>\r\n}\r\n\r\nexport default (props:CustomButtonProps)=>{\r\n    const theme = useColorScheme()\r\n    const _props = {\r\n        color:Colors[theme].hoverColor,\r\n        borderColor:theme=='light'?Colors[theme].buttonBorderColor:'#7d8590',\r\n        ...props,\r\n        style:[\r\n            styles.style,\r\n            {\r\n                backgroundColor:Colors[theme].buttonBackgroundColor,\r\n                borderColor:Colors[theme].buttonBorderColor\r\n            },\r\n            props.style,\r\n        ] as StyleProp<ViewStyle>,\r\n        textStyle:[\r\n            styles.text, \r\n            {color:Colors[theme].text},\r\n            props.textStyle\r\n        ]\r\n    }\r\n    return <DefaultButton {..._props}/>\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n    style:{\r\n        borderRadius:6, \r\n        borderWidth:1, \r\n    },\r\n    text:{\r\n        textAlign:'center', \r\n        fontWeight:'600'\r\n    }\r\n});\r\n","import React from 'react'\r\nimport CommonSection from \"./CommonSection\";\r\nimport useResizeContext from '../hooks/useResizeContext';\r\n\r\nexport default (props:{children?: React.ReactNode})=>{\r\n    const windowType = useResizeContext();\r\n    return <CommonSection\r\n        autoScale\r\n        outerContainerStyle={{flex:1, alignSelf:'center', backgroundColor:'#8888', flexShrink:1, width:'100%'}}\r\n        containerStyle={{flex:1, margin:0, justifyContent:'center', alignItems:'center'}}\r\n        bodyStyle={windowType=='landscape'?{width:'90%', height:'90%', padding:'5%'}:{width:'100%', height:'100%', maxWidth:1080}}\r\n    >\r\n        {props.children}\r\n    </CommonSection>\r\n}\r\n\r\nexport const BottomSheet = (props:{children?: React.ReactNode})=><CommonSection\r\n    autoScale\r\n    outerContainerStyle={{flex:1, alignSelf:'center', backgroundColor:'#8888', width:'100%'}}\r\n    containerStyle={{flex:1, margin:0, justifyContent:'flex-end'}}\r\n>\r\n    {props.children}\r\n</CommonSection>","import * as React from 'react';\r\nimport { Avatar } from 'react-native-paper';\r\nimport { AvatarProps } from '../../types';\r\n\r\nconst normalizeHash = (hash: number, min: number, max: number) => {\r\n    return Math.floor((hash % (max - min)) + min);\r\n};\r\n\r\nconst stringToHSL = (str: string, initHash?:number) => {\r\n    let hash = initHash || 0;\r\n    for (let i = 0; i < str.length; i++) {\r\n      hash = str.charCodeAt(i) + ((hash << 5) - hash);\r\n    }\r\n    hash = Math.abs(hash);\r\n    return `hsl(${normalizeHash(hash, 0, 360)}, ${normalizeHash(hash, 0, 100)}%, ${normalizeHash(hash, 25, 75)}%)`;\r\n};\r\n\r\nexport default (props:AvatarProps) => {\r\n    const backgroundColor = stringToHSL(props.name, props.userId)\r\n    return <Avatar.Text style={{backgroundColor}} size={props.size} label={props.name.split(' ').map(v=>v[0]).join().toUpperCase()} />\r\n};","import React from 'react';\r\nimport Avatar from '../lib/react-native-paper/Avatar';\r\nimport { AvatarProps, MessengerChannel, User } from '../types';\r\n\r\nexport function avatarFromChannel(item:MessengerChannel, user?:User|null){\r\n    let avatar;\r\n    let name = item.name\r\n    if (item.member_count<3){\r\n        avatar = (item.member_count==1 || user?.id == item.subowner.id)?item.owner:item.subowner\r\n        name = name.length>0?name:avatar.name \r\n    }\r\n    return {avatar, name}\r\n}\r\n\r\nexport default (props:AvatarProps)=>{\r\n    return <Avatar {...props}/>\r\n}\r\n\r\n","import * as React from 'react';\r\nimport { View, Text } from './Themed';\r\nimport { StyleSheet, StyleProp, ViewStyle, TextStyle } from 'react-native';\r\nimport Colors from '../constants/Colors';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\n\r\nexport type SectionParamList = {\r\n    title?: string,\r\n    titleStyle?:StyleProp<TextStyle>\r\n    titleOnPress?:()=>void,\r\n    outerContainerStyle?:StyleProp<TextStyle>\r\n    containerStyle?:StyleProp<ViewStyle>\r\n    bodyStyle?:StyleProp<ViewStyle>\r\n    subtitle?: string\r\n    withSeparator?: boolean\r\n    autoScale?:boolean\r\n    children?: React.ReactNode\r\n}\r\n\r\nexport default function CommonSection(props:SectionParamList){\r\n  const titleText = <>\r\n    <Text style={[styles.title, props.titleStyle]}>{props.title}</Text>\r\n    <Text style={styles.subtitle}>{props.subtitle}</Text>\r\n  </>\r\n  return (\r\n    <View style={[styles.outerContainer, props.autoScale?{}:styles.outerContainerFill, props.outerContainerStyle]}>\r\n        <View style={[styles.container, props.containerStyle]}>\r\n            {props.withSeparator?<View style={styles.separator} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />:undefined}\r\n            {props.title?\r\n              (props.titleOnPress?\r\n                <TouchableOpacity onPress={props.titleOnPress} style={styles.titleView}>{titleText}</TouchableOpacity >:\r\n                <View style={styles.titleView}>{titleText}</View>):\r\n              undefined}\r\n            <View style={[styles.bodyView, props.bodyStyle]}>\r\n            {props.children}\r\n            </View>\r\n          </View>\r\n        </View>\r\n    )\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  outerContainer:{\r\n    alignItems:'stretch',\r\n    backgroundColor:'transparent'\r\n  },\r\n  outerContainerFill:{\r\n    width:'100%',\r\n    maxWidth:1080,\r\n  },\r\n  container: {\r\n      marginHorizontal:20,\r\n      marginVertical: 10,\r\n      backgroundColor:'transparent',\r\n    },\r\n    titleView:{\r\n      width: '100%',\r\n      flexDirection:'row',\r\n      backgroundColor:'transparent',\r\n      marginBottom:5,\r\n    },\r\n    title: {\r\n      flex:1,\r\n      fontSize: 16,\r\n    },\r\n    subtitle: {\r\n      flex:1,\r\n      fontSize: 12,\r\n      textAlign: 'right',\r\n      marginTop:4\r\n    },\r\n    separator: {\r\n      marginBottom: 0,\r\n      height: 1,\r\n      width: '100%',\r\n    },\r\n    bodyView:{\r\n      width: '100%',\r\n      padding: 20,\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      borderWidth:1,\r\n      borderColor:Colors.borderColor,\r\n      borderRadius:6\r\n    }\r\n  });\r\n  ","import { useEffect } from \"react\";\r\nimport { useMutation, useQuery, useQueryClient } from \"react-query\";\r\nimport { getChannelList, postChannel, postDirectChannel, putChannel } from \"../../services\";\r\nimport { Channel, MessengerChannel, MessengerContent } from \"../../types\";\r\nimport { Auth } from \"../useAuthContext\";\r\nimport useWebsocketContext from \"../useWebsocketContext\";\r\n\r\nexport default function useMessengerChannelList(type:Channel['type'], auth?:Auth){\r\n  const queryClient = useQueryClient()\r\n  const {lastJsonMessage} = useWebsocketContext()\r\n  const { data } = useQuery([\"ChannelList\", type] , async()=>await getChannelList(type, auth?.user?.id))\r\n\r\n  useEffect(()=>{\r\n    if(lastJsonMessage !=null){\r\n      if(lastJsonMessage['type']=='enter'){\r\n        queryClient.setQueryData<MessengerChannel[]>([\"ChannelList\", type], (_data)=>{\r\n          return (_data?.find(v=>v.id==lastJsonMessage['data']['id'])?_data:[lastJsonMessage['data'] , ...(_data|| [])]).sort((a, b)=>a.id - b.id)\r\n        })\r\n      }\r\n      if (lastJsonMessage['type']=='next_message'){\r\n        const data:MessengerContent = lastJsonMessage['data']\r\n        queryClient.setQueryData<MessengerChannel[]>([\"ChannelList\", type], (_data)=>(_data || []).map(v=>{\r\n          if (v.id == data.channel){\r\n            return {...v, last_message:{content:data.message_set[0]?.content, created:data.created}}\r\n          }\r\n          return v\r\n        }))\r\n      }\r\n      // if(lastJsonMessage['type']=='leave'){\r\n      //   queryClient.setQueryData<Channel[]>([\"MessengerChannelList\", type], (_data)=>_data?.filter(v=>v.id!=lastJsonMessage['data']['channel_id']) || [])\r\n      // }\r\n    }\r\n  }, [lastJsonMessage])\r\n  return data\r\n}\r\n\r\nexport function useMessengerChannelSorted(type:Channel['type'], auth?:Auth){\r\n  const channelList = useMessengerChannelList(type, auth);\r\n  return channelList?.sort((a, b)=>(a.last_message?.created || '') < (b.last_message?.created || '')?1:-1)\r\n}\r\nexport function useMessengerChannelMutation(type:string){\r\n  const queryClient = useQueryClient()\r\n\r\n  const create = useMutation(postChannel, {\r\n    onSuccess: ()=>queryClient.invalidateQueries([\"ChannelList\", type])\r\n  });\r\n\r\n  const update = useMutation(putChannel, {\r\n    onSuccess: () => queryClient.invalidateQueries([\"ChannelList\", type])\r\n  })\r\n\r\n  const direct = useMutation(postDirectChannel, {\r\n    onSuccess: () => queryClient.invalidateQueries([\"ChannelList\", type])\r\n  })\r\n\r\n  return { create:create.mutateAsync, update:update.mutateAsync, direct:direct.mutateAsync}\r\n}","import { DependencyList, useEffect } from \"react\";\r\nimport { EventArg, useNavigation } from \"@react-navigation/core\";\r\n\r\n\r\nexport default (callback:()=>void, deps?:DependencyList)=>{\r\n    const navigation = useNavigation()\r\n    useEffect(()=>{\r\n        const event = (e:EventArg<any, true, any>)=> {\r\n            e.preventDefault();\r\n            callback()\r\n        }\r\n        navigation.addListener('beforeRemove', event)\r\n        return () => {\r\n            navigation.removeListener('beforeRemove', event)\r\n        }\r\n  }, deps)\r\n}","/**\r\n * If you are not familiar with React Navigation, refer to the \"Fundamentals\" guide:\r\n * https://reactnavigation.org/docs/getting-started\r\n *\r\n */\r\nimport * as React from 'react';\r\nimport { useColorScheme as useDefaultColorScheme } from 'react-native';\r\nimport { useColorScheme as useColorScheme } from 'react-native-appearance';\r\nimport { enableScreens } from 'react-native-screens';\r\nimport { NavigationContainer, DefaultTheme, DarkTheme, NavigationContainerRef } from '@react-navigation/native';\r\nimport { CardStyleInterpolators, createStackNavigator } from '@react-navigation/stack';\r\n\r\nimport useResizeContext, { ResizeContextProvider } from '../hooks/useResizeContext';\r\nimport useInvitee, { replaceInviteeState } from '../hooks/useInvitee';\r\nimport { modal } from '../screens';\r\nimport LinkingConfiguration from './LinkingConfiguration';\r\nimport MainNavigator from './MainNavigator';\r\n\r\n\r\nenableScreens();\r\n\r\nconst navigationRef = React.createRef<NavigationContainerRef>();\r\n\r\nexport function navigate(name:string, params?:any) {\r\n  if (params)\r\n    navigationRef.current?.navigate(name, params);\r\n  navigationRef.current?.navigate(name);\r\n}\r\n\r\nlet electronVersion:string|undefined;\r\ntry{\r\n  electronVersion = process?.versions?.['electron']\r\n}\r\ncatch(e){\r\n  electronVersion = undefined\r\n}\r\n\r\nexport default function Navigation() {\r\n  const defaultColorScheme = useDefaultColorScheme()\r\n  const userColorScheme = useColorScheme()\r\n  const colorScheme = userColorScheme =='no-preference'?defaultColorScheme:userColorScheme\r\n  return <NavigationContainer\r\n    ref={navigationRef}\r\n    documentTitle={{formatter: (options, route) => {return `TOKKI TOK`}}}\r\n    linking={electronVersion?undefined:LinkingConfiguration}\r\n    theme={colorScheme === 'dark' ? DarkTheme : DefaultTheme}>\r\n        <ResizeContextProvider>\r\n          <RootNavigator />\r\n        </ResizeContextProvider>\r\n  </NavigationContainer>\r\n}\r\n\r\n\r\n// A root stack navigator is often used for displaying modals on top of all other content\r\n// Read more here: https://reactnavigation.org/docs/modal\r\nconst Root = createStackNavigator();\r\n\r\nfunction RootNavigator() {\r\n    const windowType = useResizeContext();\r\n    useInvitee()\r\n    return <Root.Navigator\r\n        mode= 'modal'\r\n        headerMode= 'screen'\r\n        screenOptions={{\r\n            cardStyle:{backgroundColor:\"white\"},\r\n            animationEnabled: true,\r\n            cardStyleInterpolator: CardStyleInterpolators.forVerticalIOS,\r\n        }}\r\n    >\r\n        <Root.Screen name=\"Main\" component={MainNavigator} options={{headerShown:false}}/>\r\n        {Object.entries(modal).map(([key, screen])=><Root.Screen key={key} name={key} component={screen.component} options={{\r\n            title: screen.title,\r\n            gestureDirection: windowType == 'landscape'?'vertical-inverted':'vertical'\r\n        }} />)}\r\n    </Root.Navigator>\r\n}\r\n\r\nreplaceInviteeState(window.location)\r\n\r\nconst IGNORE_WERNINGS:string[] = ['setNativeProps', 'useNativeDriver'];\r\n\r\nconst warnLogger = console.warn\r\n\r\nconsole.warn = (message: string|Object) => {\r\n    var warn = true;\r\n    if (message instanceof Object){\r\n      warn = false;\r\n    }\r\n    else if (IGNORE_WERNINGS.some(log=>message.includes(log))){\r\n      warn = false\r\n    };\r\n    if (warn){\r\n      warnLogger(message);\r\n    }\r\n    else{\r\n        // console.log(message)\r\n    }\r\n};\r\n","import React, { Context, createContext,  useContext, useEffect, useState } from \"react\"\r\nimport useWebSocket from \"react-use-websocket\"\r\nimport { SendJsonMessage } from \"react-use-websocket/dist/lib/types\"\r\nimport {websockerURL } from \"../constants/Envs\"\r\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\r\nimport { AppState, AppStateStatus } from \"react-native\";\r\n\r\ntype WebsocketContextType = {lastJsonMessage:any, sendJsonMessage:SendJsonMessage }\r\nconst defaultContext = {lastJsonMessage:undefined, sendJsonMessage:()=>{}}\r\nconst WebSocketContext = createContext<WebsocketContextType>(defaultContext);\r\n\r\nexport const WebSocketInternalProvider = ({children, path, Context, useBackground}:{children:React.ReactNode, path:string, Context:Context<WebsocketContextType>, useBackground?:boolean})=>{\r\n  const [token, setToken] = useState<string|null>(null)\r\n  const [isActive, setIsActive] = useState<boolean>(useBackground || AppState.currentState == 'active')\r\n  const { lastJsonMessage, sendJsonMessage } = useWebSocket(`${websockerURL}/${path}`,{\r\n    shouldReconnect: (closeEvent) => true,\r\n    protocols: token?['Authorization',  token]:undefined,\r\n    onOpen: (e)=>{console.log(`success websocket connection(${path})`)},\r\n    onClose: (e)=> {console.log(`closed websocket connection(${path})`)},\r\n  }, isActive && token!=null)\r\n  useEffect(()=>{\r\n    AsyncStorage.getItem('Authorization').then(setToken)\r\n    const onChange = (nextState:AppStateStatus)=>setIsActive(useBackground || nextState == 'active')\r\n    const listener = AppState.addEventListener(\"change\", onChange)\r\n    return ()=> listener.remove()\r\n  }, [])\r\n  return <Context.Provider value={token!=null?{lastJsonMessage, sendJsonMessage}:defaultContext}>\r\n      {children}\r\n    </Context.Provider>\r\n}\r\n\r\nexport const WebSocketProvider = ({disable, children}:{disable?:boolean, children:React.ReactNode})=>{\r\n  return disable?<>{children}</>:<WebSocketInternalProvider path={'messenger/ws/'} Context={WebSocketContext}>\r\n    {children}\r\n  </WebSocketInternalProvider>\r\n}\r\n\r\nexport default ()=>{\r\n  const webSocketContext = useContext(WebSocketContext)\r\n  return webSocketContext\r\n}\r\n\r\n","import { useMutation, useQuery, useQueryClient } from \"react-query\";\r\nimport { getChannelList, getPeopleList, postBulkMessengerMember, deleteMessengerMember, postChannel } from \"../../services\";\r\nimport useAuthContext, { Auth } from \"../useAuthContext\";\r\n\r\nfunction usePeopleChannelId(auth?:Auth){\r\n  const { data } = useQuery([\"People\", auth?.user?.id], async()=>{\r\n    if(auth?.user?.id){\r\n      const peopleChannel = await getChannelList(\"people\", auth.user.id)\r\n      if (peopleChannel === null)\r\n        return undefined;\r\n      if (peopleChannel.length === 0){\r\n        const newChannel = await postChannel({type:'people', owner:auth.user.id, name: ''})\r\n        return newChannel.id\r\n      }\r\n      return peopleChannel[0].id\r\n    }\r\n  })\r\n  return data\r\n}\r\n\r\nfunction usePeopleList(auth?:Auth){\r\n  const peopleId = usePeopleChannelId(auth)\r\n  const { data } = useQuery([\"PeopleList\", peopleId] , async()=>peopleId?await getPeopleList(peopleId):[])\r\n  return {peopleId, peopleList:data}\r\n}\r\n\r\nexport default function useUserList(auth?:Auth){\r\n  const { peopleList } = usePeopleList(auth)\r\n  return peopleList?.map(v=>v.user)\r\n}\r\n\r\nexport function usePeopleMutation(){\r\n  const { auth } = useAuthContext()\r\n  const {peopleId, peopleList} = usePeopleList(auth)\r\n  const queryClient = useQueryClient()\r\n\r\n  const _create = useMutation(async ({user_ids}:{user_ids:number[]})=>{peopleId && await postBulkMessengerMember({channel_id:peopleId, user_ids})}, {\r\n    onSuccess: (data, id)=>{\r\n      queryClient.invalidateQueries(\"PeopleList\")\r\n    }\r\n  })\r\n  const _delete = useMutation(async(userId:number)=>{\r\n    const id = peopleList?.find(v=>v.user.id===userId)?.id\r\n    id && await deleteMessengerMember(id)\r\n  }, {\r\n      onSuccess: () => {\r\n        queryClient.invalidateQueries(\"PeopleList\")\r\n      }\r\n    })\r\n  return {create:_create.mutateAsync, delete:_delete.mutateAsync}\r\n}","import { useMutation, useQuery, useQueryClient } from \"react-query\";\r\nimport { postBulkMessengerMember, deleteMessengerMember, getMessengerMemberList } from \"../../services\";\r\n\r\nexport default function useMessengerMemberList(channel_id:number){\r\n  const { data } = useQuery([\"MessengerMemberList\", channel_id] , async()=>await getMessengerMemberList(channel_id))\r\n  return data\r\n}\r\n\r\n\r\nexport function useMessengerMemberMutation(){\r\n  const queryClient = useQueryClient()\r\n  const invite = useMutation(postBulkMessengerMember, {\r\n    onSuccess: ()=>{\r\n      queryClient.invalidateQueries(\"MessengerMemberList\")\r\n    }\r\n  })\r\n\r\n  const leave = useMutation(deleteMessengerMember, {\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries(\"ChannelList\")\r\n      queryClient.invalidateQueries(\"MessengerMemberList\")\r\n    }\r\n  })\r\n  return {invite:invite.mutateAsync, leave:leave.mutateAsync}\r\n}","import React from 'react';\r\nimport Profile from '../components/Profile';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport usePeopleUserList, { usePeopleMutation } from '../hooks/lists/usePeopleUserList';\r\nimport { useMessengerChannelMutation } from '../hooks/lists/useMessengerChannelList';\r\nimport CommonButton from '../components/CommonButton';\r\nimport { Channel } from '../types';\r\nimport { navigate } from '../navigation';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport { Text, View } from '../components/Themed';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport { Ionicons } from '../lib/@expo/vector-icons';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport Colors from '../constants/Colors';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { BottomSheet } from '../components/ModalSection';\r\nimport useModalEffect from '../hooks/useModalEffect';\r\nimport RegistrationModal from './RegistrationModal';\r\nimport { useExternalUser } from '../hooks/lists/useExternalUserList';\r\n\r\nexport default function ProfileModal({id}:{id:number}) {\r\n  const { lang } = useLangContext()\r\n  const theme = useColorScheme()\r\n  const {auth} = useAuthContext()\r\n  const { setModal } = useModalsContext()\r\n  const userList = usePeopleUserList(auth)\r\n  const peopleMutation = usePeopleMutation()\r\n  const user = useExternalUser(id)\r\n  const isSelf = auth.user && user && (auth.user?.id==user?.id)\r\n  const isExternal = userList?.find(v=>v.id===user?.id) === undefined\r\n  const channelMutation = useMessengerChannelMutation('messenger')\r\n  const back = ()=>{\r\n    setModal(ProfileModal, null)\r\n  }\r\n  useModalEffect(back, [])\r\n  return user?<BottomSheet>\r\n    <View style={{flexDirection:'row', width:'100%'}}>\r\n      <View style={{flex:1, flexDirection:'row'}}>\r\n        <TouchableOpacity onPress={back}>\r\n          <Ionicons size={20} name=\"arrow-back\" color={Colors[theme].text}/>\r\n        </TouchableOpacity>\r\n      </View>\r\n      <View style={{flex:1}}>\r\n        <Text style={{fontSize:20, textAlign:'center'}}>{lang('profile')}</Text>\r\n      </View>\r\n      <View style={{flex:1}}/>\r\n    </View>\r\n    <View style={{marginBottom: 20, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n    \r\n    <Profile username={user.username} name={user.name} userId={user.id} />\r\n    {isSelf && !auth.user?.is_guest && <CommonButton title={lang('Account Settings')} onPress={()=>{setModal(RegistrationModal, {})}}/>}\r\n    <CommonButton title={lang(isSelf?'Chat with me':'1:1 Chat')} onPress={()=>{\r\n      if(auth?.user?.id){\r\n        const newChannel:Channel = {name:\"\", type:'messenger', owner:auth?.user?.id, subowner:isSelf?undefined:user.id};\r\n        channelMutation.direct(newChannel).then(v=>navigate(\"Main\", {screen:\"ChatScreen\", params: {id:v.id}}))\r\n      }\r\n    }}/>\r\n    {!isSelf &&\r\n      (isExternal?\r\n        <CommonButton title={lang('Add people')} onPress={()=>peopleMutation.create({user_ids:[id]}).then(back)}/>:\r\n        <CommonButton title={lang('Delete people')} onPress={()=>peopleMutation.delete(id).then(back)}/>\r\n      )\r\n    }\r\n  </BottomSheet>:<></>\r\n}\r\n","import React, { useState } from 'react';\r\nimport { StyleSheet} from 'react-native';\r\nimport { CustomButtonProps } from '../types';\r\nimport CommonButton from './CommonButton';\r\n\r\nexport default (props:CustomButtonProps)=>{\r\n    return <CommonButton {...props} style={[styles.style, props.style]}/>\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n    style:{\r\n        borderRadius:6, \r\n        backgroundColor: 'transparent',\r\n        borderWidth:0\r\n    },\r\n});\r\n","import React, {useState, useEffect } from 'react';\r\nimport { StyleSheet, ScrollView } from 'react-native';\r\nimport { View, Text } from '../components/Themed';\r\nimport CommonButton from '../components/CommonButton';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport { navigate } from '../navigation';\r\nimport { Channel } from '../types';\r\nimport useMessengerChannelList, { useMessengerChannelMutation } from '../hooks/lists/useMessengerChannelList';\r\nimport TextField from '../components/TextField';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport ModalSection from '../components/ModalSection';\r\nimport { useMessengerMemberMutation } from '../hooks/lists/useMessengerMemberList';\r\nimport { avatarFromChannel } from '../components/Avatar';\r\nimport useModalEffect from '../hooks/useModalEffect';\r\n\r\nexport default function ChannelEditModal({id, member_id, type}: {id?:number, member_id?:number, type:Channel['type']}) {\r\n  const { lang } = useLangContext()\r\n  const {auth} = useAuthContext()\r\n  const { setModal } = useModalsContext()\r\n  const channelList = useMessengerChannelList(type, auth)\r\n  const channelMutation = useMessengerChannelMutation(type)\r\n  const messengerMemberMutation = useMessengerMemberMutation()\r\n  const channel = channelList?.find(v=>v.id==id)\r\n  const title = type=='messenger'?\r\n    (id?lang('Chat Setting'):lang('New chat')):\r\n    ''//(id?lang('Channel Setting'):lang('New Channel'))\r\n  const [name, setName] = useState('')\r\n  const [description, setDescription] = useState('')\r\n  const back = ()=>{\r\n    setModal(ChannelEditModal, null)\r\n  }\r\n\r\n  useEffect(()=>{\r\n    if (channel){\r\n      const {name:_name} = avatarFromChannel(channel, auth.user)\r\n      setName(_name)\r\n      setDescription(channel?.description || '')\r\n    }\r\n  }, [channel?.id])\r\n  useModalEffect(back, [])\r\n\r\n  return <ModalSection>\r\n    <View style={{justifyContent:'space-between', flex:1, width:'100%'}}>\r\n      <View style={{width:'100%'}}>\r\n        <Text style={{fontSize:20}}>{title}</Text>\r\n        <View style={styles.separator} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n      </View>\r\n      <ScrollView style={{width:'100%', flexGrow:1, maxHeight:'80%'}}>\r\n        <TextField name={lang('Channel Name')} value={name} setValue={setName} width={'60%'}/>\r\n        <TextField name={lang('Description')} value={description} setValue={setDescription} multiline width={'60%'}/>\r\n      </ScrollView>\r\n      <View style={{width:'100%', flexDirection:'row'}}>\r\n        {member_id &&<View style={{flexDirection:'row', justifyContent:'flex-start'}}>\r\n          <CommonButton title={lang('leave')} style={{marginHorizontal:5}} textStyle={{color:'red'}} onPress={()=>messengerMemberMutation.leave(member_id).then(back)}/>\r\n        </View>}\r\n        <View style={{flex:1, flexDirection:'row', justifyContent:'flex-end'}}>\r\n          <CommonButton title={lang('save')} onPress={()=>{\r\n            if(auth?.user?.id){\r\n              const newChannel:Channel = {id, name, description, type, owner:auth?.user?.id};\r\n              (id?channelMutation.update(newChannel):channelMutation.create(newChannel)).then(v=>navigate(\"Main\", {\r\n                screen: 'ChatScreen', //v.type == 'messenger'?'ChatScreen':'MyMessageScreen',\r\n                params:{id:v.id}\r\n              }))\r\n            }\r\n          }}/>\r\n          <CommonButton title={lang('cancel')} style={{marginHorizontal:5}} onPress={back}/>\r\n        </View>\r\n      </View>\r\n    </View>\r\n  </ModalSection>\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  field:{\r\n    width:'50%',\r\n    flexDirection:'row',\r\n    padding:10,\r\n  },\r\n  separator: {\r\n    marginBottom: 20,\r\n    height: 1,\r\n    width: '100%',\r\n  },\r\n})","import React, { useState, useEffect } from \"react\";\r\nimport { StyleSheet } from \"react-native\";\r\nimport useLangContext from \"../hooks/useLangContext\";\r\nimport useUserMutation from \"../hooks/useUserMutation\";\r\nimport useAuthContext from \"../hooks/useAuthContext\";\r\nimport ModalSection from \"../components/ModalSection\";\r\nimport useModalsContext from \"../hooks/useModalsContext\";\r\nimport { View, Text } from \"../components/Themed\";\r\nimport RowField from \"../components/RowField\";\r\nimport CommonButton from \"../components/CommonButton\";\r\nimport CommonTextInput from \"../components/CommonTextInput\";\r\nimport useExternalUserList from \"../hooks/lists/useExternalUserList\";\r\n// import TextButton from \"../components/TextButton\";\r\n// import Colors from \"../constants/Colors\";\r\n// import useColorScheme from \"../hooks/useColorScheme\";\r\n\r\ntype ErrorMessages = {\r\n    username?:string,\r\n    name?:string,\r\n    password?:string,\r\n    checkPassword?:string\r\n}\r\n\r\nconst ErrorView = (props:{message?:string})=>{\r\n  const { lang } = useLangContext()\r\n  return props.message?<View style={styles.form_error}>\r\n  <Text style={styles.form_error_text}>{lang(props.message)}</Text>\r\n</View>:<></>\r\n}\r\n\r\nexport default function RegistrationModal() {\r\n  const { lang } = useLangContext()\r\n  const {auth} = useAuthContext()\r\n  // const theme = useColorScheme()\r\n  // const color = Colors[theme].text\r\n  const { setModal } = useModalsContext()\r\n  const [username, setUsername] = useState(\"\");\r\n  const [name, setName] = useState(\"\")\r\n  const [password, setPassword] = useState(\"\");\r\n  const [checkPassword, setCheckPassword] = useState(\"\")\r\n  const [isStaff, setIsStaff] = useState(false)\r\n  const [error, setError] = useState<ErrorMessages>({})\r\n  const externalMemberList = useExternalUserList(username)\r\n  const userMembershipMutation = useUserMutation()\r\n  const user = auth.user\r\n  const usernameDisable = user && user.is_guest===false\r\n  useEffect(()=>{\r\n    if (user){\r\n      setUsername(user.username)\r\n      setName(user.name)\r\n    }\r\n  }, [user?.id])\r\n  const _register = ()=>{\r\n    let newError:ErrorMessages = {};\r\n    if ((externalMemberList?.length || 0) >0 && !usernameDisable) newError.username = \"The username is already in use.\"\r\n    if (username.length < 10 || username.length > 64) newError.username = \"Set 10-64 characters.\"\r\n    if (name.length < 1 || name.length > 64) newError.name = \"Set 1-64 characters.\"\r\n    if (!/^(?=.*[A-Za-z])(?=.*\\d)(?=.*[@$!%*#?&])[A-Za-z\\d@$!%*#?&]{10,64}$/.test(password) && !(usernameDisable && password.length==0)) newError.password = \"Set 10-64 characters with a combination of letters/numbers/valid special characters.\"\r\n    if (password != checkPassword) newError.checkPassword = \"Incorrect between password and check password.\"\r\n    if (Object.keys(newError).length > 0){\r\n        setError(newError)\r\n        return\r\n    }\r\n    if(user?.id){\r\n      userMembershipMutation.update({\r\n        id:user?.id,\r\n        name,\r\n        username:usernameDisable?undefined:username,\r\n        is_guest:false,\r\n        password:password.length>0?password:undefined,\r\n      }).then(back)\r\n    }\r\n  }\r\n  const back = ()=>{\r\n    setModal(RegistrationModal, null)\r\n  }\r\n  return <ModalSection>\r\n    <View style={{justifyContent:'space-between', flex:1, width:'100%'}}>\r\n      <View style={{flex:1, width:'100%'}}>\r\n        <Text style={{fontSize:20}}>{usernameDisable?lang('Edit User'):lang('Create User')}</Text>\r\n        <View style={styles.separator} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n        <RowField name={lang('Username')} width={'60%'}>\r\n          {usernameDisable?<Text style={{fontSize:16}}>{username}</Text>:<CommonTextInput\r\n              value={username}\r\n              setValue={(text) => setUsername(text)}\r\n              keyboardType={'email-address'}\r\n          />}\r\n          <ErrorView message={error.username}/>\r\n        </RowField>\r\n        <RowField name={lang('Name')} width={'60%'}>\r\n          <CommonTextInput\r\n              value={name}\r\n              setValue={(text) => setName(text)}\r\n          />\r\n          <ErrorView message={error.name}/>\r\n        </RowField>\r\n        <RowField name={lang('Password')} width={'60%'}>\r\n          <CommonTextInput\r\n              value={password}\r\n              secureTextEntry\r\n              setValue={(text) => setPassword(text)}\r\n          />\r\n          <ErrorView message={error.password}/>\r\n        </RowField>\r\n        <RowField name={lang('Check Password')} width={'60%'}>\r\n          <CommonTextInput\r\n              value={checkPassword}\r\n              secureTextEntry\r\n              setValue={(text) => setCheckPassword(text)}\r\n          />\r\n          <ErrorView message={error.checkPassword}/>\r\n        </RowField>\r\n      </View>\r\n      <View style={{width:'100%', flexDirection:'row'}}>\r\n        {user?.id && <View style={{flexDirection:'row', justifyContent:'flex-start'}}>\r\n          <CommonButton title={lang('delete account')} style={{marginHorizontal:5}} textStyle={{color:'red'}} onPress={()=>userMembershipMutation.delete(user.id).then(back)}/>\r\n        </View>}\r\n        <View style={{flex:1, flexDirection:'row', justifyContent:'flex-end'}}>\r\n          <CommonButton title={lang('save')} onPress={_register}/>\r\n          <CommonButton title={lang('cancel')} style={{marginHorizontal:5}} onPress={back}/>\r\n        </View>\r\n      </View>\r\n    </View>\r\n  </ModalSection>\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  form_error: {\r\n    height: 22,\r\n    width:'100%',\r\n  },\r\n  form_error_text:{\r\n    textAlignVertical:'center',\r\n    color:'red',\r\n    fontSize:13,\r\n  },\r\n  separator: {\r\n    marginBottom: 20,\r\n    height: 1,\r\n    width: '100%',\r\n  },\r\n});","import { useMutation } from \"react-query\";\r\nimport { deleteUser, patchUser, postUser } from \"../services\";\r\nimport useAuthContext from \"./useAuthContext\";\r\n\r\nexport default function useUserMutation(){\r\n  const { auth, dispatch } = useAuthContext()\r\n  const _create = useMutation(postUser, {\r\n    onSuccess: ()=>{\r\n    }\r\n  })\r\n  const _update = useMutation(patchUser, {\r\n    onSuccess: (data, user)=>{\r\n      if (user.id == auth.user?.id)\r\n        if(user.username && user.password){\r\n          dispatch({type:'LOGIN_REQUEST', username:user.username, password:user.password})\r\n        }\r\n        else{\r\n          dispatch({type:\"REFRESH\"})\r\n        }\r\n      else{\r\n      }\r\n    }\r\n  })\r\n  const _delete = useMutation(deleteUser, {\r\n    onSuccess: (data, id)=>{\r\n      if (id == auth.user?.id)\r\n        dispatch({type:\"LOGOUT_REQUEST\"})\r\n    }\r\n  })\r\n  return {create:_create.mutateAsync, update:_update.mutateAsync, delete:_delete.mutateAsync}\r\n}","import { useEffect } from \"react\"\r\nimport { InfiniteData, Query, QueryKey, useInfiniteQuery, useMutation, useQueryClient } from \"react-query\"\r\nimport { getMessengerContentList, postMessage, patchMessengerContent, getNewMessengerContentList } from \"../../services\"\r\nimport { EditMessage, MessengerContent } from \"../../types\"\r\nimport useWebsocketContext from \"../useWebsocketContext\"\r\nimport useUploadContext from \"../useUploadContext\"\r\n\r\nexport type MessengerContentPage = {\r\n  next?:MessengerContentPage\r\n  current:MessengerContent[]\r\n}\r\n\r\nconst updateContnetPage = (pages:MessengerContentPage[], updateMessages:MessengerContent[])=>{\r\n  let update_i = 0\r\n  pages.forEach(page=>{\r\n    if (update_i == updateMessages.length)\r\n      return\r\n    page.current.forEach(v=>{\r\n      if (update_i == updateMessages.length)\r\n        return\r\n      if (v.id==updateMessages[update_i].id){\r\n        v.timer = updateMessages[update_i].timer\r\n        v.is_archive = updateMessages[update_i].is_archive\r\n        update_i += 1\r\n      }\r\n    })\r\n    page.current = page.current.filter(v=>!v.is_archive)\r\n  })\r\n}\r\n\r\nexport default function useMessengerContentList(channel_id:number){  \r\n  const queryClient = useQueryClient()\r\n  const refetch = (query:Query<MessengerContentPage, unknown, InfiniteData<MessengerContentPage>, QueryKey>)=>{\r\n    const updated_gte = new Date(query.state.dataUpdatedAt).toISOString()\r\n    const newData = {...query.state.data}\r\n    getNewMessengerContentList(channel_id, updated_gte).then(contents=>{\r\n      if(newData.pages){\r\n        const lastMessageId = newData.pages[0].current[0].id || 0\r\n        const nextMessages = contents.filter(v=>v.id>lastMessageId && v.is_archive==false)\r\n        const updateMessages = contents.filter(v=>v.id<=lastMessageId)\r\n        const timerMessageRefetch = nextMessages.findIndex(v=>v.timer) >= 0 || updateMessages.length > 0\r\n        newData.pages[0].current = [...nextMessages, ...newData.pages[0].current]\r\n        updateContnetPage(newData.pages, updateMessages)\r\n        timerMessageRefetch && queryClient.invalidateQueries([\"TimerMessageContentList\", channel_id])\r\n      }\r\n    })\r\n    return false\r\n  }\r\n  const { data, fetchNextPage } = useInfiniteQuery<MessengerContentPage>(\r\n    [\"MessengerContentList\", channel_id], \r\n    async({pageParam})=>getMessengerContentList(channel_id, pageParam).then(current=>({current})), \r\n    {\r\n      select:data=>{\r\n        if(data.pages.length > 1)\r\n          data.pages[data.pages.length - 2].next = data.pages[data.pages.length - 1]\r\n        return data;\r\n      },\r\n      getNextPageParam:(lastPage)=>lastPage?.current.length?lastPage.current[lastPage.current.length - 1].id:undefined,\r\n      refetchOnReconnect:false,\r\n      refetchOnWindowFocus:refetch\r\n    }\r\n  )\r\n  const { lastJsonMessage } = useWebsocketContext()\r\n  useEffect(()=>{\r\n    if(lastJsonMessage !=null && lastJsonMessage['data']['channel'] == channel_id){\r\n      if(lastJsonMessage['type']=='next_message'){\r\n        queryClient.setQueryData<InfiniteData<MessengerContentPage>>([\"MessengerContentList\", channel_id], (_data)=>{\r\n          if(_data?.pages[0].current && _data?.pages[0].current[0].id != lastJsonMessage['data'].id)\r\n            _data.pages[0].current = [lastJsonMessage['data'], ..._data?.pages[0].current]\r\n          return {...(_data || {pages:[], pageParams:[]})}\r\n        })\r\n      }\r\n      if(lastJsonMessage['type']=='update_message'){\r\n        queryClient.setQueryData<InfiniteData<MessengerContentPage>>([\"MessengerContentList\", channel_id], (_data)=>{\r\n          _data?.pages && updateContnetPage(_data.pages, [lastJsonMessage['data']])\r\n          return {...(_data || {pages:[], pageParams:[]})}\r\n        })\r\n      }\r\n    }\r\n  }, [lastJsonMessage])\r\n  return { data, fetchNextPage }\r\n}\r\n\r\nexport function useMessengerContentMutation(channelId?:number){\r\n  // const queryClient = useQueryClient()\r\n  const {dispatch:uploadDispatch} = useUploadContext()\r\n  const create = useMutation((message:EditMessage)=>postMessage(message, uploadDispatch), {\r\n    onSuccess: () => {\r\n      // queryClient.setQueryData(['MessengerContentList'], (data:any) => ({\r\n      //   pages: data.pages.slice(0, 1),\r\n      //   pageParams: data.pageParams.slice(0, 1),\r\n      // }))\r\n      // queryClient.invalidateQueries(\"MessengerContentList\")\r\n    }\r\n  });\r\n  const _patch = useMutation(patchMessengerContent);\r\n  return { create:create.mutate, patch:_patch.mutate }\r\n}","import React, { createContext, useContext, Dispatch, useReducer } from 'react';\r\n\r\ntype UploadState = Record<number, {\r\n  filename: string,\r\n  progress?: number,\r\n}[]>\r\n\r\ntype UploadAction = {\r\n  channel:number,\r\n  filename:string,\r\n  progress?:number\r\n}\r\n\r\ntype UploadContextType = {\r\n  upload:UploadState,\r\n  dispatch:Dispatch<UploadAction>\r\n}\r\n\r\nconst UploadContext = createContext<UploadContextType>({upload:{} as UploadState, dispatch:()=>{}});\r\n\r\nconst uploadReducer =(initialState:UploadState, action:UploadAction)=>{\r\n  const files = [...(initialState[action.channel] || [])]\r\n  const index = files.findIndex(f=>f.filename==action.filename)\r\n  if (index >= 0){\r\n    files[index] = {filename:action.filename, progress:action.progress} \r\n  }\r\n  else{\r\n    files.push({filename:action.filename, progress:action.progress})\r\n  }\r\n  return {\r\n    ...initialState,\r\n    [action.channel] : files.filter(f=>(f.progress || 0)<1)\r\n  }\r\n}\r\n\r\nexport const UploadContextProvider = ({children}:{children:React.ReactNode})=>{\r\n  const [upload, dispatch] = useReducer(uploadReducer, {})\r\n  return <UploadContext.Provider value={{upload, dispatch}}>\r\n    {children}\r\n  </UploadContext.Provider>\r\n}\r\n\r\nexport default function useUploadContext() {\r\n  const upload = useContext(UploadContext)\r\n  return upload\r\n}","import React, { useMemo } from 'react';\r\n\r\nimport { TextProps, StyleProp } from 'react-native';\r\nimport {View, Text } from './Themed'\r\nimport useResizeContext from '../hooks/useResizeContext';\r\n\r\ntype Props = {\r\n  name: string,\r\n  width?:any,\r\n  children: React.ReactNode\r\n  textStyle?: StyleProp<TextProps>\r\n}\r\n\r\nexport default function RowField(props:Props) {\r\n  const windowType = useResizeContext()\r\n  const rowStyle = useMemo(()=>windowType=='landscape'?\r\n    {flexDirection:'row', alignItems: 'center', justifyContent:'space-between'}:\r\n    {flexDirection:'column', alignItems:'flex-start'} as any\r\n  , [windowType])\r\n  return (\r\n    <View style={[{paddingVertical:windowType=='landscape'?15:5, width:'100%'}, rowStyle]}>\r\n        <Text style={[windowType=='landscape'?{flex:1}:{width:'100%'},{paddingHorizontal: 15, fontSize:16}, props.textStyle]}>{props.name}</Text>\r\n        <View style={[windowType=='landscape'?{flex:6}:{width:'100%'},{paddingHorizontal: 15}]}>\r\n          <View style={{width:props.width}}>\r\n            {props.children}\r\n          </View>\r\n        </View>\r\n    </View>\r\n  )\r\n}","import { useQuery } from \"react-query\";\r\nimport { getExternalUserList, getExternalUser } from \"../../services\";\r\n\r\nexport default function useExternalUserList(keyword?:string){\r\n  const { data } = useQuery([\"UserList\", keyword] , async()=>keyword?(await getExternalUserList(keyword)):[])\r\n  return data\r\n}\r\n\r\nexport function useExternalUser(id:number){\r\n  const { data } = useQuery([\"UserList\", id] , async()=>await getExternalUser(id))\r\n  return data\r\n}","import React from 'react';\r\nimport { Platform } from 'react-native';\r\nimport { TabView, SceneMap,NavigationState, SceneRendererProps, TabBar } from 'react-native-tab-view';\r\nimport Colors from '../constants/Colors';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport { TabViewRecord } from '../types';\r\n\r\n\r\nexport default (props:{tabs:TabViewRecord, tabBarPosition:\"top\"|\"bottom\", index?:number, onTab?:(index:number)=>void})=>{\r\n  const { lang } = useLangContext()\r\n  const index = props.index || 0\r\n  const theme = useColorScheme()\r\n  const entries = Object.entries(props.tabs)\r\n  const onTab = props.onTab\r\n  const icons = Object.assign({}, ...entries.map(([k, v])=>({[k]:v.icon})))\r\n  return <TabView\r\n    renderTabBar={(props:SceneRendererProps & {navigationState: NavigationState<any>})=>{\r\n      return <TabBar\r\n        {...props}\r\n        indicatorStyle={{ backgroundColor: \"#2196F3\" }}\r\n        style={{ backgroundColor:Colors[theme].background}}\r\n        /* @ts-ignore */\r\n        labelStyle={{whiteSpace:\"nowrap\"}}\r\n        activeColor={Colors[theme].text}\r\n        inactiveColor={Colors[theme].text}\r\n        renderIcon={(scene)=>icons[scene.route.key]}\r\n        onTabPress={(scene)=>onTab?.(entries.findIndex(([k, v])=>k == scene.route.key))}\r\n      />\r\n    }}\r\n    navigationState={{ index, routes: entries.map(([k, v])=>({key:k, title:lang(v.title)}))}}\r\n    onIndexChange={(v)=>{onTab?.(v)}}\r\n    onSwipeStart={()=>{\r\n      if (Platform.OS === 'web') {\r\n        if (window.getSelection) {\r\n            var sel = window.getSelection();\r\n            sel?.removeAllRanges();\r\n        }\r\n    }\r\n    }}\r\n    renderScene={SceneMap(Object.assign({}, ...entries.map(([k, v])=>({[k]:v.component}))))}\r\n    tabBarPosition={props.tabBarPosition}\r\n  />\r\n}\r\n\r\n","import * as React from 'react';\r\nimport { View } from './Themed';\r\nimport { StyleSheet, StyleProp, ViewStyle, TextStyle, Pressable } from 'react-native';\r\nimport Colors from '../constants/Colors';\r\n\r\nexport type ItemParamList = {\r\n    outerContainerStyle?:StyleProp<TextStyle>\r\n    containerStyle?:StyleProp<ViewStyle>\r\n    bodyStyle?:StyleProp<ViewStyle>\r\n    children?: React.ReactNode\r\n    onPress?: ()=>void\r\n}\r\n\r\nexport default function CommonItem(props:ItemParamList){\r\n  // const [hover, setHover] = React.useState(false)\r\n  const [press, setPress] = React.useState(false)\r\n  return (\r\n    <Pressable\r\n      style={[styles.outerContainer ,props.outerContainerStyle, (press)?{backgroundColor:'rgb(242,242,242)'}:{}]}\r\n      onPressIn={()=>setPress(true)}\r\n      onPress={()=>props.onPress?.()}\r\n      onPressOut={()=>setPress(false)}\r\n      //  //@ts-ignore\r\n      //  onHoverIn={()=>setHover(true)}\r\n      //  onHoverOut={()=>setHover(false)}\r\n    >\r\n        <View style={[styles.container ,props.containerStyle]}>\r\n            <View style={[styles.bodyView, props.bodyStyle]}>\r\n                <>{props.children}</>\r\n            </View>\r\n      </View>\r\n    </Pressable>\r\n    )\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  outerContainer:{\r\n    width:'100%',\r\n    maxWidth:1080,\r\n    alignItems:'stretch',\r\n  },  \r\n  container: {\r\n      marginHorizontal:20,\r\n      backgroundColor:'transparent'\r\n    },\r\n    bodyView:{\r\n      width: '100%',\r\n      padding: 10,\r\n      minHeight: 40,\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      borderBottomWidth:1,\r\n      borderColor:Colors.borderColor,\r\n      backgroundColor:'transparent'\r\n    }\r\n  });\r\n  ","import React from 'react'\r\nimport TextButton from \"./TextButton\"\r\nimport useAuthContext from \"../hooks/useAuthContext\"\r\nimport useResizeContext from '../hooks/useResizeContext'\r\nimport { View } from 'react-native'\r\nimport useModalsContext from '../hooks/useModalsContext'\r\nimport AlertModal from '../modals/AlertModal'\r\nimport useLangContext from '../hooks/useLangContext'\r\nimport useColorScheme from '../hooks/useColorScheme'\r\nimport Colors from '../constants/Colors'\r\n\r\ntype ButtonProps = {title:string, onPress:()=>void, windowType?:'landscape'|'portrait'}\r\n\r\nexport default (props:{extra?:ButtonProps[]})=>{\r\n    const { lang } = useLangContext()\r\n    const theme = useColorScheme()\r\n    const {auth, dispatch} = useAuthContext()\r\n    const { setModal } = useModalsContext()\r\n    const windowType = useResizeContext()\r\n    const defaultButtonProps:ButtonProps[] = [{title:lang('sign out'), onPress:()=>{\r\n        if (auth?.user?.is_guest){\r\n            setModal(AlertModal, {type:\"GUEST_LOGOUT\"})\r\n        }\r\n        else{\r\n            dispatch({type:\"LOGOUT_REQUEST\"})\r\n        }\r\n    }}]\r\n    const buttonProps = (props.extra?[...props.extra, ...defaultButtonProps]:defaultButtonProps).filter(v=>v.windowType==windowType || v.windowType == undefined)\r\n    return<View style={{flexDirection:'row'}}>\r\n        {buttonProps.map((v,k)=><TextButton key={k} {...v} textStyle={{color:Colors[theme].text}} color='#gray'/>)}\r\n    </View>\r\n}\r\n  ","import React, {useRef, useMemo } from 'react';\r\nimport { View, Text } from '../components/Themed';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport usePeopleUserList, { usePeopleMutation } from '../hooks/lists/usePeopleUserList';\r\nimport { User } from '../types';\r\nimport CommonButton from '../components/CommonButton';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport ModalSection from '../components/ModalSection';\r\nimport { ExternalMembershipTabView } from './InviteModal';\r\n\r\nexport default function AddPeopleModal(){\r\n  const { lang } = useLangContext()\r\n  const selectedRef = useRef<Set<number>>(new Set())\r\n  const { auth } = useAuthContext()\r\n  const userList = usePeopleUserList(auth);\r\n  const peopleMutation = usePeopleMutation()\r\n  const userFilter =  useMemo(()=>{\r\n    const memberSet = new Set(userList?.map(v=>v.id))\r\n    return (user:User) => !memberSet.has(user.id);\r\n  }, [userList])\r\n  const { setModal } = useModalsContext()\r\n  const back = ()=>{\r\n    setModal(AddPeopleModal, null)\r\n  }\r\n  return <ModalSection>\r\n  <View style={{flex:1, width:'100%'}}>\r\n    <View style={{width:'100%'}}>\r\n      <Text style={{fontSize:20}}>{lang('Add people')}</Text>\r\n      <View style={{marginBottom: 20, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n    </View>\r\n    <ExternalMembershipTabView selectedRef={selectedRef} userFilter={userFilter} isChannel={false}/>\r\n    <View style={[{width:'100%', flexDirection:'row', padding:10,}, {justifyContent:'flex-end'}]}>\r\n        <CommonButton title={lang('add')} onPress={()=>{\r\n          peopleMutation.create({\r\n            user_ids:[...selectedRef.current]\r\n          }).then(back)\r\n        }}/>\r\n        <CommonButton title={lang('cancel')} onPress={back}/>\r\n      </View>\r\n    </View>\r\n  </ModalSection>\r\n}\r\n\r\n","import React from 'react'\r\nimport { View, StyleSheet, Linking, Platform, TouchableOpacity  } from 'react-native'\r\nimport { } from 'react-native-gesture-handler'\r\nimport { AntDesign } from '../lib/@expo/vector-icons'; \r\nimport Colors from '../constants/Colors';\r\n\r\nconst openURL = Platform.OS=='web'?(url:string)=>{location.href=url}:Linking.openURL\r\n\r\nexport default (props:{theme:'light'|'dark'})=>{\r\n    return<View style={Styles.footer_buttons}>\r\n        <TouchableOpacity style={Styles.footer_button} onPress={()=>openURL(\"https://github.com/blacktokki/tokki-tok\")}>\r\n            <AntDesign name=\"github\" size={24} color={Colors[props.theme].iconColor} />\r\n        </TouchableOpacity>\r\n        <TouchableOpacity style={Styles.footer_button} onPress={()=>Linking.openURL(\"mailto:ydh051541@naver.com\")}>\r\n            <AntDesign name=\"mail\" size={24} color={Colors[props.theme].iconColor} />\r\n        </TouchableOpacity>\r\n    </View>\r\n}\r\n\r\nconst Styles = StyleSheet.create({\r\n      footer_buttons: {\r\n        width: '100%',\r\n        flexDirection: 'row',\r\n        justifyContent: 'flex-end',\r\n        paddingBottom: 20,\r\n        paddingRight: 20,\r\n      },\r\n      footer_button: {\r\n        alignItems: 'center',\r\n        justifyContent: 'center',\r\n        width: 38,\r\n        height: 38,\r\n        marginHorizontal: 12,\r\n        borderWidth: 1,\r\n        borderColor: '#E7E7E7',\r\n        borderRadius: 60,\r\n      },\r\n})","import React, {useEffect, useState} from 'react';\r\nimport {\r\n  Text,\r\n  TextInput,\r\n  TouchableOpacity,\r\n  View,\r\n  StyleSheet,\r\n} from 'react-native';\r\nimport { StackScreenProps } from '@react-navigation/stack';\r\nimport useAuthContext from '../../hooks/useAuthContext';\r\nimport useLangContext from '../../hooks/useLangContext';\r\nimport ContractFooter from '../../components/ContractFooter';\r\n\r\nexport default function LoginScreen({\r\n  navigation, route\r\n}: StackScreenProps<any, 'Login'>) {\r\n  const { lang } = useLangContext()\r\n  const [username, setUsername] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const {error, dispatch} = useAuthContext()\r\n  const _login = ()=>dispatch({type:'LOGIN_REQUEST', username, password})\r\n  useEffect(() => {\r\n    navigation.setOptions({\r\n      headerRight: undefined\r\n    });\r\n  }, [navigation]);\r\n\r\n  return (<View style={Styles.login_container}>\r\n    <View style={Styles.login_wrapper}>\r\n      <View style={Styles.form}>\r\n        {error && <View style={Styles.form_error}>\r\n          <Text style={Styles.form_error_text}>{lang(error)}</Text>\r\n        </View>}\r\n        <TextInput\r\n          style={Styles.form_input}\r\n          value={username}\r\n          placeholder={lang('Username')}\r\n          onChangeText={(text) => setUsername(text)}\r\n          autoCapitalize={'none'}\r\n          keyboardType={'email-address'}\r\n          onSubmitEditing={_login}\r\n        />\r\n        <TextInput\r\n          style={Styles.form_input}\r\n          value={password}\r\n          placeholder={lang('Password')}\r\n          secureTextEntry\r\n          onChangeText={(text) => setPassword(text)}\r\n          onSubmitEditing={_login}\r\n        />\r\n        <TouchableOpacity onPress={_login}>\r\n          <View style={Styles.button}>\r\n            <Text style={Styles.button_label}>{lang('Sign in')}</Text>\r\n          </View>\r\n        </TouchableOpacity>\r\n        <TouchableOpacity onPress={() => dispatch({type:\"LOGIN_GUEST\"})}>\r\n          <Text style={Styles.guest_footer_text}>\r\n            {lang(\"Sign in as guest\")}\r\n          </Text>\r\n        </TouchableOpacity>\r\n      </View>\r\n      <View style={Styles.login_social}>\r\n        <View style={Styles.login_social_separator}>\r\n          <View style={Styles.login_social_separator_line} />\r\n          <Text style={Styles.login_social_separator_text}>{'*'}</Text>\r\n          <View style={Styles.login_social_separator_line} />\r\n        </View>\r\n        <View style={Styles.login_social_buttons}>\r\n        </View>\r\n      </View>\r\n      {/* <>\r\n        <TouchableOpacity onPress={() => navigate(\"RegistrationScreen\")}>\r\n          <Text style={Styles.login_footer_text}>\r\n            {\"Don't have an account? \"}\r\n            <Text style={Styles.login_footer_link}>{'Sign up'}</Text>\r\n          </Text>\r\n        </TouchableOpacity>\r\n      </> */}\r\n    </View>\r\n    <ContractFooter theme='light'/>\r\n  </View>);\r\n};\r\n\r\nconst Styles = StyleSheet.create({\r\n    login_container: {\r\n      flex: 1,\r\n      backgroundColor: '#FFF',\r\n    },\r\n    login_header: {\r\n      alignItems: 'center',\r\n      paddingTop: 30,\r\n      paddingBottom: 50,\r\n      backgroundColor: '#208AEC',\r\n    },\r\n    login_header_logo: {\r\n      width: 220,\r\n      resizeMode: 'contain',\r\n    },\r\n    login_header_text: {\r\n      marginTop: 15,\r\n      color: '#f0f0f0',\r\n      fontSize: 16,\r\n    },\r\n    login_header_text_bold: {\r\n      color: '#fff',\r\n      fontWeight: 'bold',\r\n    },\r\n    login_wrapper: {\r\n      flex: 1,\r\n      justifyContent: 'space-between',\r\n      paddingTop: 40,\r\n      borderTopRightRadius: 12,\r\n      borderTopLeftRadius: 12,\r\n      backgroundColor: '#fff',\r\n      alignItems: 'center',\r\n    },\r\n    form: {\r\n      width: '100%',\r\n      maxWidth: 320,\r\n    },\r\n    form_error: {\r\n      height: 22,\r\n      width:'100%',\r\n    },\r\n    form_error_text:{\r\n      textAlignVertical:'center',\r\n      color:'red',\r\n      fontSize:13,\r\n    },\r\n    form_input: {\r\n      height: 44,\r\n      paddingHorizontal: 20,\r\n      marginBottom: 20,\r\n      backgroundColor: '#EDF0F7',\r\n      borderRadius: 50,\r\n    },\r\n    button: {\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      height: 44,\r\n      backgroundColor: '#0065A4',\r\n      borderRadius: 50,\r\n    },\r\n    button_label: {\r\n      color: '#fff',\r\n      fontSize: 16,\r\n    },\r\n    login_social: {\r\n      width: '100%',\r\n      maxWidth: 280,\r\n      marginTop: 20,\r\n    },\r\n    login_social_separator: {\r\n      flexDirection: 'row',\r\n      alignItems: 'center',\r\n    },\r\n    login_social_separator_line: {\r\n      flex: 1,\r\n      width: '100%',\r\n      height: 1,\r\n      backgroundColor: '#E0E0E0',\r\n    },\r\n    login_social_separator_text: {\r\n      marginHorizontal: 10,\r\n      color: '#808080',\r\n      fontSize: 16,\r\n    },\r\n    login_social_buttons: {\r\n      flexDirection: 'row',\r\n      justifyContent: 'center',\r\n      marginTop: 20,\r\n    },\r\n    login_social_button: {\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      width: 60,\r\n      height: 60,\r\n      marginHorizontal: 12,\r\n      borderWidth: 1,\r\n      borderColor: '#E7E7E7',\r\n      borderRadius: 60,\r\n    },\r\n    login_social_icon: {\r\n      width: 38,\r\n      height: 38,\r\n      resizeMode: 'contain',\r\n    },\r\n    login_social_facebook: {\r\n      backgroundColor: '#4267B2',\r\n      borderColor: '#4267B2',\r\n    },\r\n    login_footer_text: {\r\n      flexDirection: 'row',\r\n      alignItems: 'center',\r\n      color: '#808080',\r\n      fontSize: 14,\r\n    },\r\n    guest_footer_text: {\r\n      flexDirection: 'row',\r\n      alignSelf: 'center',\r\n      color: '#808080',\r\n      fontSize: 15,\r\n      margin: 15\r\n    },\r\n    login_footer_link: {\r\n      color: '#208AEC',\r\n      fontSize: 15,\r\n      fontWeight: 'bold',\r\n    },\r\n  });\r\n  ","import React, { createContext, useContext } from \"react\"\r\nimport { SendJsonMessage } from \"react-use-websocket/dist/lib/types\";\r\nimport { WebSocketInternalProvider } from \"../../hooks/useWebsocketContext\";\r\n\r\nconst WebSocketContext = createContext<{lastJsonMessage:any, sendJsonMessage:SendJsonMessage }>({lastJsonMessage:undefined, sendJsonMessage:()=>{}});\r\n\r\nexport const WebSocketProvider = ({disable, children}:{disable?:boolean, children:React.ReactNode})=>{\r\n  return disable?<></>:<WebSocketInternalProvider path={'messenger/ws/rtc/'} Context={WebSocketContext} useBackground>\r\n    {children}\r\n  </WebSocketInternalProvider>\r\n}\r\n\r\nexport default ()=>{\r\n  const webSocketContext = useContext(WebSocketContext)\r\n  return webSocketContext\r\n}\r\n\r\n","import React, { useCallback, useRef, useState, useMemo } from \"react\";\r\n//@ts-ignore\r\nimport { RTCView, mediaDevices, RTCPeerConnection, MediaStream, RTCSessionDescription, RTCIceCandidate } from \"react-native-webrtc-web-shim\";\r\nimport {TURN_SERVER} from \"../../../constants/Envs\"\r\n\r\n\r\nconsole.log(TURN_SERVER?\"use turn server\": \"use stun server\")\r\n\r\nexport const peerConstraints = {\r\n\ticeServers: [TURN_SERVER?JSON.parse(TURN_SERVER):{urls: 'stun:stun.l.google.com:19302'}]\r\n};\r\n\r\nexport const sessionConstraints = {\r\n\tmandatory: {\r\n\t\tOfferToReceiveAudio: true,\r\n\t\tOfferToReceiveVideo: true,\r\n\t\tVoiceActivityDetection: true\r\n\t}\r\n};\r\n\r\nconst mediaConstraints = {audio:true, video:{framerate:30}}\r\n\r\n//@ts-ignore\r\nexport {MediaStream, RTCPeerConnection, RTCSessionDescription} from \"react-native-webrtc-web-shim\";\r\n\r\nconst onICEcandidate = (pc:typeof RTCPeerConnection, message:any)=>{\r\n\tconst _message = message.data.rtcMessage\r\n\t\tconst candidate = new RTCIceCandidate(_message);\r\n\t\tif (pc) {\r\n\t\t\tconsole.log(\"ICE candidate Added\");\r\n\t\t\tpc.addIceCandidate(candidate);\r\n\t\t}\r\n}\r\n\r\nconst sendICEcandidate = (event:any, sendMessage:(data:any)=>void, receiver:string, target:string) => {\r\n\t// When you find a null candidate then there are no more candidates.\r\n\t// Gathering of candidates has finished.\r\n\tif ( !event.candidate ) { return; };\r\n\t// Send the event.candidate onto the person you're calling.\r\n\t// Keeping to Trickle ICE Standards, you should send the candidates immediately.\r\n\tsendMessage({type:'ICEcandidate', receiver, data:{target, rtcMessage:event.candidate}})\r\n  }\r\n\r\nconst BAND_WIDTH = 8000\r\n\r\nconst optimizeSdp = (offerDescription:RTCSessionDescription)=>{\r\n\tvar arr = offerDescription.sdp.split('\\r\\n');\r\n\tarr.forEach((str:string, i:number) => {\r\n\t\tif (/^a=fmtp:\\d*/.test(str)) {\r\n\t\t\tarr[i] = str + `;x-google-max-bitrate=${BAND_WIDTH};x-google-min-bitrate=${BAND_WIDTH};x-google-start-bitrate=${BAND_WIDTH}`;\r\n\t\t} else if (/^a=mid:(0|video)/.test(str)) { // if with audio then 0=>1\r\n\t\t\tarr[i] += `\\r\\nb=AS:${BAND_WIDTH}`;\r\n\t\t}\r\n\t});\r\n  \treturn new RTCSessionDescription({\r\n    \ttype: offerDescription.type,\r\n    \tsdp: arr.join('\\r\\n'),\r\n  \t})\r\n}\r\n\r\nconst createOffer = async(pcRefCurrent:{pc?:typeof RTCPeerConnection, receiver:string}, sendMessage:(data:any)=>void, stream:typeof MediaStream, target:string, user?:{name:string})=>{\r\n\tstream && pcRefCurrent.pc.addStream( stream );\r\n\tconst offerDescription = optimizeSdp((await pcRefCurrent.pc.createOffer( sessionConstraints )));\r\n\tawait pcRefCurrent.pc.setLocalDescription( offerDescription );\r\n\tsendMessage({type:'call', receiver:pcRefCurrent.receiver, data:{target, name:user?.name, rtcMessage:offerDescription}})\r\n}\r\n\r\nexport const useLocalCam = (sendMessage:(data:any)=>void)=>{\r\n\tconst pcRef = useRef<Record<number,{pc:typeof RTCPeerConnection, receiver:string}>>({})\r\n\tconst [sender, setSender] = useState<string>()\r\n\tconst [_stream, setStream] = useState<MediaStream>()\r\n\tconst isPlay = useMemo(()=>_stream?true:false, [_stream])\r\n\tconst CustomRTCView = useCallback(React.memo(({style}:{style:any})=>(_stream?<RTCView stream={_stream} style={style} videoProps={{height:'100%'}} />:<></>)) , [_stream])\r\n\tconst start = useCallback(async(user:{name:string}, stream?:typeof MediaStream, mode?:'camera'|'display')=>{\r\n\t\tconsole.log(\"start\");\r\n\t\tif (!_stream || mode!==undefined) {\r\n\t\t\ttry {\r\n\t\t\t\tlet newStream:typeof MediaStream;\r\n\t\t\t\tif(mode == 'camera'){\r\n\t\t\t\t\tnewStream = await mediaDevices.getUserMedia(mediaConstraints)\r\n\t\t\t\t}\r\n\t\t\t\telse if (mode == 'display'){\r\n\t\t\t\t\tnewStream = await mediaDevices.getDisplayMedia(mediaConstraints)\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tnewStream = stream || await mediaDevices.getUserMedia(mediaConstraints).catch((e:any)=>mediaDevices.getDisplayMedia(mediaConstraints));\r\n\t\t\t\t}\r\n\t\t\t\tsetStream(newStream)\r\n\t\t\t\tObject.entries(pcRef.current).map(([k, v])=>{\r\n\t\t\t\t\tcreateOffer(v, sendMessage, newStream, 'guest', user)\r\n\t\t\t\t})\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.error(e);\r\n\t\t\t}\r\n\t\t}\r\n\t}, [_stream])\r\n\tconst stop = useCallback(()=>{\r\n\t\tconsole.log(\"stop\");\r\n\t\tif(_stream){\r\n\t\t\t_stream.getTracks().map((track:any) => track.stop());\r\n\t\t\tsetStream(undefined)\r\n\t\t}\r\n\t}, [_stream])\r\n\treturn {\r\n\t\tstart,\r\n\t\tstop,\r\n\t\twebsocketOnMessage: async(response:any, user:{name:string})=>{\r\n\t\t\tlet type = response.type;\r\n\t\t\tif (type == 'connection'){\r\n\t\t\t\tsetSender(response.data.channel_name)\r\n\t\t\t}\r\n\t\t\tif (type == 'start' && response.data.target=='host'){\r\n\t\t\t  console.log('1 start')\r\n\t\t\t  const peerConnection = new RTCPeerConnection( peerConstraints );\r\n\t\t\t  peerConnection.addEventListener( 'icecandidate', (event:any) => sendICEcandidate(event, sendMessage, response.sender, 'guest'));\r\n\t\t\t  pcRef.current[response.sender] = {pc:peerConnection, receiver: response.sender}\r\n\t\t\t  createOffer(pcRef.current[response.sender], sendMessage, _stream, 'guest', user)\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (type == \"answer\" && response.data.target == 'host'){\r\n\t\t\t  console.log('3 answer')\r\n\t\t\t  const peerConnection = pcRef.current[response.sender].pc\r\n\t\t\t  const answerDescription = new RTCSessionDescription(response.data.rtcMessage);\r\n\t\t\t  await peerConnection.setRemoteDescription( answerDescription );\r\n\t\t\t  // const streams = pcRef.current.pc.getRemoteStreams()\r\n\t\t\t  // setMirrorStream(streams[streams.length - 1])\r\n\t\t\t}\r\n\t\t\tif (type == \"ICEcandidate\" && response.data.target=='host'){\r\n\t\t\t\tconst peerConnection = pcRef.current[response.sender].pc\r\n\t\t\t\tonICEcandidate(peerConnection, response)\r\n\t\t\t}\r\n\t\t},\r\n\t\tCustomRTCView,\r\n\t\tisPlay,\r\n\t\tsender,\r\n\t\t// renderMirrorView,\r\n\t}\r\n}\r\n\r\nexport const useRemoteCam = (sendMessage:(data:any)=>void)=>{\r\n\tconst pcRef = useRef<{pc?:RTCPeerConnection, receiver?:string, statsInterval?:any}>({})\r\n\tconst [user, setUser] = useState<{name:string}>()\r\n\tconst [_stream, setStream] = useState<MediaStream>()\r\n\tconst CustomRTCView = useCallback(React.memo((style:any)=>_stream?<RTCView stream={_stream} style={style} videoProps={{height:'100%'}} />:<></>), [_stream])\r\n\tconst isPlay = useMemo(()=>_stream?true:false, [_stream])\r\n\tconst start = useCallback((receiver:string)=>{\r\n\t\tconsole.log(\"start\");\r\n\t\tif (!pcRef.current.pc) {\r\n\t\t  pcRef.current.pc = new RTCPeerConnection( peerConstraints );\r\n\t\t  pcRef.current.receiver = receiver\r\n\t\t}\r\n\t\tif (!_stream){\r\n\t\t\tsendMessage({type:'start', receiver, data:{'target': 'host'}})\r\n\t\t}\r\n\t}, [_stream])\r\n\tconst stop = () => {\r\n\t\tconsole.log(\"stop\");\r\n\t\tif (pcRef.current.pc) {\r\n\t\t  // peerConnection._unregisterEvents();\r\n\t\t  setStream(undefined)\r\n\t\t  pcRef.current.pc.close();\r\n\t\t  pcRef.current.pc = undefined\r\n\t\t  pcRef.current.receiver = undefined\r\n\t\t  clearInterval(pcRef.current.statsInterval)\r\n\t\t}\r\n\t}\r\n\treturn {\r\n\t\tstart,\r\n\t\tstop,\r\n\t\twebsocketOnMessage: async(response:any)=>{\r\n\t\t\tlet type = response.type;\r\n\t\t\tif (type == 'start' && response.data.target=='guest' && response.sender == pcRef.current?.receiver){\r\n\t\t\t\tconsole.log('(remote)1 start')\r\n\t\t\t\tconst peerConnection = pcRef.current.pc\r\n\t\t\t\tsetUser({name: response.data.name})\r\n\t\t\t\tpeerConnection.addEventListener('icecandidate', (event:any) => sendICEcandidate(event, sendMessage, response.sender, 'host'));\r\n\t\t\t\tpeerConnection.addEventListener('iceconnectionstatechange', (e:any)=>{\r\n\t\t\t\t\tif (pcRef.current.pc.iceConnectionState == 'connected'){\r\n\t\t\t\t\t\tlet activeStream = false\r\n\t\t\t\t\t\tpcRef.current.statsInterval = setInterval(async()=>{\r\n\t\t\t\t\t\t\tconst stats = await pcRef.current.pc.getStats(null)\r\n\t\t\t\t\t\t\tlet statsOutput = \"\";\r\n\t\t\t\t\t\t\tlet framePerSecond = undefined\r\n\t\t\t\t\t\t\tstats.forEach((report:any) => {\r\n\t\t\t\t\t\t\t\tif (report.type === \"inbound-rtp\" && report.kind === \"video\") {\r\n\t\t\t\t\t\t\t\t\tObject.keys(report).forEach((statName) => {\r\n\t\t\t\t\t\t\t\t\t\tstatsOutput += `${statName}: ${report[statName]}\\n`;\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\tframePerSecond = report.framesPerSecond\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tconsole.log(activeStream, framePerSecond)\r\n\t\t\t\t\t\t\tif (framePerSecond != undefined){\r\n\t\t\t\t\t\t\t\tactiveStream = true\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (activeStream){\r\n\t\t\t\t\t\t\t\tstop()\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tconsole.log(new Date().toTimeString().split(' ')[0], statsOutput)\r\n\t\t\t\t\t\t}, 1000);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (pcRef.current.pc.iceConnectionState == 'failed'){\r\n\t\t\t\t\t\tstop()\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t// peerConnection.addTransceiver('audio', {\r\n\t\t\t\t// \tdirection: 'recvonly'\r\n\t\t\t\t// });\r\n\t\t\t\tpeerConnection.addTransceiver('video', {\r\n\t\t\t\t\tdirection: 'recvonly'\r\n\t\t\t\t});\r\n\t\t\t\tawait createOffer({pc:pcRef.current.pc, receiver:response.sender}, sendMessage, _stream, 'host', user)\r\n\t\t\t}  \r\n\t\t\tif (type == \"answer\" && response.data.target=='guest' && response.sender == pcRef.current?.receiver){\r\n\t\t\t\tconsole.log('(remote)3 answer')\r\n\t\t\t\tconst answerDescription = new RTCSessionDescription(response.data.rtcMessage);\r\n\t\t\t\tawait pcRef.current.pc.setRemoteDescription( answerDescription );\r\n\t\t\t\tconst streams = pcRef.current.pc.getRemoteStreams()\r\n\t\t\t\tsetStream(streams[streams.length - 1])\r\n\t\t\t\tsendMessage({type:'end', receiver:pcRef.current.receiver, data:{}})\r\n\t\t\t}\r\n\t\t\tif (type == \"call\" && response.sender == pcRef.current?.receiver){\r\n\t\t\t  console.log('2 call')\r\n\t\t\t  const peerConnection = pcRef.current.pc\r\n\t\t\t  setUser({name:response.data.name})\r\n\t\t\t  if (!peerConnection)\r\n\t\t\t\treturn\r\n\t\t\t  peerConnection.addEventListener( 'icecandidate', (event:any) => sendICEcandidate(event, sendMessage, response.sender, 'host'));\r\n\t\t\t  const offerDescription = new RTCSessionDescription(response.data.rtcMessage);\r\n\t\t\t  await peerConnection.setRemoteDescription( offerDescription );\r\n\t\t\t  const answerDescription = await peerConnection.createAnswer( sessionConstraints );\r\n\t\t\t  await peerConnection.setLocalDescription( answerDescription );\r\n\t\t\t  sendMessage({type:'answer', receiver:pcRef.current.receiver, data:{target:'host', rtcMessage:peerConnection.localDescription}})\r\n\t\t\t  // Here is a good place to process candidates.\r\n\t\t\t  const streams = pcRef.current.pc.getRemoteStreams()\r\n\t\t\t  setStream(streams[streams.length - 1])\r\n\t\t\t}\r\n\t\t\tif (type == \"ICEcandidate\" && response.data.target=='guest' && response.sender == pcRef.current?.receiver)\r\n\t\t\t  onICEcandidate(pcRef.current.pc, response)\r\n\t\t},\r\n\t\tCustomRTCView,\r\n\t\tuser,\r\n\t\tisPlay\r\n\t}\r\n}","import {StyleSheet} from \"react-native\";\r\nexport {useLocalCam, useRemoteCam} from \"./p2p\"\r\n\r\nexport const camStyle = StyleSheet.create({\r\n\tcontainer:{ flex: 1},\r\n\tcam:{ flex: 1, height:'100%'},\r\n\tbottonContainer: {position:\"absolute\", bottom:0, justifyContent:'flex-end'},\r\n\tbuttonBar: { flexDirection: \"row\", justifyContent: \"space-around\" },\r\n\tlabel: {backgroundColor:'#0008', color:'white', paddingHorizontal:5},\r\n})","import React, { useEffect } from \"react\";\r\nimport {Button, View, Text} from \"react-native\";\r\nimport useWebsocketContext from \"./useWebsocketContext\";\r\nimport { useLocalCam, camStyle} from \"./webrtc\";\r\n\r\n\r\nexport default (props:{user?:{name:string}|null, mode?:'camera'|'display'|null})=>{\r\n  const {lastJsonMessage, sendJsonMessage} = useWebsocketContext()\r\n  const {start, stop, websocketOnMessage, CustomRTCView, isPlay} = useLocalCam(sendJsonMessage)\r\n  useEffect(()=>{\r\n    props.user && lastJsonMessage && websocketOnMessage(lastJsonMessage, props.user)\r\n  }, [lastJsonMessage, props.user])\r\n  useEffect(()=>{\r\n    if(props.mode && !isPlay){\r\n      props.user && start(props.user, undefined, props.mode)\r\n    }\r\n    else if(props.mode===null && isPlay){\r\n      stop()\r\n    }\r\n    return ()=>{isPlay && stop()}\r\n  }, [isPlay, props.user, props.mode])\r\n  return (\r\n    <View style={camStyle.container}>\r\n      <CustomRTCView style={camStyle.cam}/>\r\n      <View style={camStyle.bottonContainer}>\r\n        <View style={camStyle.buttonBar}>  \r\n        </View>\r\n        <View style={{flexDirection:'row'}}><Text style={camStyle.label}>{props.user?.name}</Text></View>\r\n        <View style={camStyle.buttonBar}>\r\n          {props.mode === undefined && !isPlay && <Button title=\"Start\" onPress={()=>props.user && start(props.user)} />}\r\n          {props.mode === undefined && isPlay && <Button title=\"Stop\" onPress={stop} />}\r\n        </View>\r\n      </View>\r\n    </View>\r\n  );\r\n}\r\n","import React, { useState, useEffect, } from \"react\";\r\nimport {Button,Text, TextInput, View} from \"react-native\";\r\nimport useWebsocketContext from \"./useWebsocketContext\";\r\nimport { useRemoteCam, camStyle} from \"./webrtc\";\r\n\r\nexport default (props:{receiver?:string})=>{\r\n  const [receiver, setReceiver] = useState('')\r\n  const {lastJsonMessage, sendJsonMessage} = useWebsocketContext()\r\n  const {start, stop, websocketOnMessage, CustomRTCView, isPlay, user} = useRemoteCam(sendJsonMessage)\r\n  useEffect(()=>{\r\n    lastJsonMessage && websocketOnMessage(lastJsonMessage)\r\n  }, [lastJsonMessage])\r\n  useEffect(()=>{\r\n    if(props.receiver){\r\n      start(props.receiver)\r\n    }\r\n    return ()=>stop()\r\n  }, [props.receiver])\r\n  return (\r\n    <View style={camStyle.container}>\r\n      <CustomRTCView style={camStyle.cam}/>\r\n      <View style={camStyle.bottonContainer}>\r\n        <View style={camStyle.buttonBar}>\r\n        </View>\r\n        <View style={{flexDirection:'row'}}>{\r\n          (props.receiver || isPlay)?\r\n          <Text style={camStyle.label}>{user?.name || 'loading...'}</Text>:\r\n          <>\r\n            <Text style={{borderWidth:1}}>Receiver:&nbsp;</Text>\r\n            <TextInput style={{borderWidth:1, flex:1}} value={receiver} onChangeText={setReceiver}/>\r\n          </> \r\n        }</View>\r\n        <View style={camStyle.buttonBar}>\r\n          {props.receiver === undefined && !isPlay && <Button title=\"Start\" onPress={()=>start(receiver)} />}\r\n          {props.receiver === undefined && isPlay && <Button title=\"Stop\" onPress={stop} />}\r\n        </View>\r\n      </View>\r\n    </View>\r\n  );\r\n}\r\n\r\n","import React, {useEffect, useState} from 'react';\r\nimport { StyleSheet, View } from 'react-native';\r\nimport { View as ThemedView } from '../../../components/Themed' \r\nimport Colors from '../../../constants/Colors';\r\nimport {default as useRtcContext, WebSocketProvider as RtcProvider} from \"../../../lib/react-native-webrtc/useWebsocketContext\";\r\nimport LocalCam from '../../../lib/react-native-webrtc/LocalCam';\r\nimport RemoteCam from '../../../lib/react-native-webrtc/RemoteCam';\r\nimport useResizeContext from '../../../hooks/useResizeContext';\r\nimport useAuthContext from '../../../hooks/useAuthContext';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport CommonButton from '../../../components/CommonButton';\r\nimport { Ionicons } from '../../../lib/@expo/vector-icons';\r\nimport useIsMobile from '../../../hooks/useIsMobile';\r\n\r\ntype VideoType = 'camera'|'display'|null\r\ntype VideoCallProps = {channel_id:number, setDisable:(disable:boolean)=>void, disable?:boolean}\r\n\r\n\r\nconst VideoView = (props:{\r\n  scale:string,\r\n  focusGuest?:string,\r\n  setFocusGuest:(focusGuest?:string)=>void\r\n  receiver?:string\r\n  children:React.ReactNode\r\n})=>{\r\n  return <View style={[{maxWidth:props.scale, maxHeight:props.scale, borderWidth:1, borderColor:Colors.borderColor, backgroundColor:'gray', flexDirection:'row', flexGrow:1}, (props.focusGuest == undefined || props.focusGuest == props.receiver)?{height:'100%'}:{maxWidth:0, height:0}]}>\r\n    <TouchableOpacity style={{flex:1}} containerStyle={{flex:1, justifyContent:'center'}} onPress={()=>props.setFocusGuest(props.focusGuest?undefined:props.receiver)}>\r\n    {props.children}\r\n    </TouchableOpacity>\r\n  </View>\r\n    \r\n  \r\n}\r\n\r\nconst VideoCallContainer = ({channel_id, disable, setDisable}:VideoCallProps)=>{\r\n  const {auth} = useAuthContext()\r\n  const isMobile = useIsMobile()\r\n  const [videoMode, setVideoMode] = useState<VideoType>(null)\r\n  const [guests, setGuests] = useState<string[]>([])\r\n  const [focusGuest, setFocusGuest] = useState<string>()\r\n  const windowType = useResizeContext()\r\n  const { lastJsonMessage, sendJsonMessage } = useRtcContext()\r\n  useEffect(()=>{\r\n    if(lastJsonMessage !=null){\r\n      if(lastJsonMessage['type']=='connection'){\r\n        sendJsonMessage({'type':'broadcast', 'data':{'channel_id':channel_id}})\r\n      }\r\n      if(lastJsonMessage['type']=='broadcast_guest' || lastJsonMessage['type']=='broadcast_host'){\r\n        setGuests([...guests, lastJsonMessage['sender']])\r\n      }\r\n      if(lastJsonMessage['type']=='broadcast_disconnect'){\r\n        const channel_name = lastJsonMessage['sender']\r\n        const exist = guests.find(v=>v == channel_name)\r\n        exist && setGuests(guests.filter(v=>v != channel_name))\r\n      }\r\n    }\r\n  }, [lastJsonMessage])\r\n  const scale = focusGuest?'100%':`${100 / Math.max(2, Math.ceil(Math.sqrt(guests.length + 1)))}%`\r\n  const toggleVideoMode = (mode:VideoType)=>{\r\n    setVideoMode(videoMode!=mode?mode:null)\r\n  }\r\n  return lastJsonMessage !==undefined ?\r\n    <ThemedView style={[\r\n      {aspectRatio:!disable?16/9:0, borderColor:Colors.borderColor, borderRadius:10},\r\n      windowType=='landscape'?{flexShrink:1, flexGrow:0, height:'100%', borderLeftWidth:1, paddingBottom:65}:{maxHeight:'36%', width:'100%', borderBottomWidth:1}\r\n    ]}>\r\n      <View style={{aspectRatio:focusGuest?undefined:16/9, backgroundColor:'white', flexWrap:'wrap', flexDirection:'row', width:'100%', height:'100%'}}>\r\n        {guests.map((receiver, i)=><VideoView scale={scale} focusGuest={focusGuest} setFocusGuest={setFocusGuest} receiver={receiver}>\r\n          <RemoteCam receiver={receiver}/>\r\n        </VideoView>\r\n        )}\r\n        <VideoView scale={scale} focusGuest={focusGuest} setFocusGuest={setFocusGuest} receiver={auth.user?.name}>\r\n          <LocalCam user={auth.user} mode={videoMode}/>\r\n        </VideoView>\r\n      </View>\r\n      <ThemedView style={[\r\n          {position:'absolute', alignItems:'center', justifyContent:'flex-end', width:'100%',flexDirection:'row'},\r\n          windowType=='landscape'?{bottom:0, paddingTop:15, paddingBottom:10, paddingHorizontal:19}:{backgroundColor:'transparent'}\r\n        ]}>\r\n        <CommonButton title={'⏺️'} style={{height:40, paddingTop:8}} onPress={()=>toggleVideoMode('camera')}/>\r\n        {!isMobile && <CommonButton title={'🖥️'} style={{height:40, paddingTop:8}} onPress={()=>toggleVideoMode('display')}/>}\r\n        <CommonButton title={''} style={{height:40, paddingTop:8}} onPress={()=>setDisable(true)}>\r\n          <Ionicons size={20} name=\"arrow-back\" color={'deepskyblue'}/>\r\n        </CommonButton>\r\n      </ThemedView>\r\n    </ThemedView>:\r\n  <></>\r\n  }\r\n  \r\nexport default React.memo(({channel_id, disable, setDisable}:VideoCallProps)=>{\r\n  return <RtcProvider disable={disable}>\r\n    <VideoCallContainer channel_id={channel_id} disable={disable} setDisable={setDisable}/>\r\n  </RtcProvider>\r\n})\r\n","import React, {useState} from \"react\"\r\nimport {View, TouchableOpacity} from 'react-native'\r\nimport { Text } from \"../Themed\";\r\nimport useUploadContext from \"../../hooks/useUploadContext\";\r\n\r\nconst UploadTag = (props:{data:{filename:string, progress?:number}, index:number, isExpand:boolean, setExpand:(index?:number)=>void})=>{\r\n    return <View style={{backgroundColor:'lightgray', borderRadius:20, overflow:'hidden', margin:5}}>\r\n        <View style={{backgroundColor:'darkgray', position:'absolute', width:`${(props.data.progress || 0)*100}%`, height:'100%'}}/>\r\n        <View style={{paddingVertical:5, paddingHorizontal:5, flexDirection:'row'}}>\r\n            <Text>📤</Text>\r\n            <View style={{paddingHorizontal:5}}><Text>{props.data.filename}</Text></View>\r\n        </View>\r\n    </View>\r\n}\r\n\r\n\r\nexport default (props:{channel_id:number})=>{\r\n    const { upload } = useUploadContext()\r\n    const [expand, setExpand] = useState<number>()\r\n    const uploadData = upload[props.channel_id]\r\n    return <View style={{flexDirection:'row', paddingTop:5, paddingHorizontal:(uploadData?.length || 0)>0?20:0}}>\r\n        {uploadData?.map((f,i)=><UploadTag key={i} data={f} index={i} isExpand={i==expand} setExpand={setExpand}/>)}\r\n    </View>\r\n}","import React from 'react';\r\nimport { Editor } from '@tinymce/tinymce-react';\r\nimport { EditorProps } from '../../types';\r\nconst INIT = require('../../../web/editor-config')\r\nconst PATH = process.env.PUBLIC_URL + '/tinymce/tinymce.min.js'\r\n\r\nexport default (props:EditorProps) => {\r\n\treturn <Editor\r\n        tinymceScriptSrc={PATH}\r\n        onInit={(e, editor) => {props.onReady?.()}}\r\n        onEditorChange={props.setValue}\r\n        init={{\r\n          setup:INIT.setup,\r\n          plugins: INIT.plugins,\r\n          toolbar: INIT.toolbar,\r\n          height: '100%',\r\n          skin: props.theme=='light'?'oxide':'oxide-dark',\r\n          content_css: props.theme=='light'?'default':'dark',\r\n          menubar: false,\r\n          branding: false,\r\n          statusbar: false,\r\n          block_formats: '제목1=h2;제목2=h3;제목3=h4;본문=p;',\r\n          fontsize_formats: '11pt 14pt 18pt 24pt',\r\n        }}\r\n        value={props.value}\r\n    />\r\n};\r\n","import React, { useState, useEffect } from 'react';\r\nimport { View } from 'react-native';\r\nimport Editor from '../lib/tinymce/Editor';\r\n// import Editor from '../lib/tinymce/EditorView';\r\nimport { EditorProps } from '../types';\r\n\r\nexport default (props:EditorProps & {active:boolean, children?:React.ReactNode}) => {\r\n\tconst [ready, setReady] = useState<boolean>(false)\r\n  useEffect(()=>{\r\n    if(!props.active)\r\n      setReady(false)\r\n  }, [props.active])\r\n  return props.active?(\r\n        <View style={{flex:1, height:'100%'}}>\r\n        {!ready && props.children}\r\n    \t  <Editor\r\n          theme={props.theme}\r\n          value={props.value}\r\n          setValue={props.setValue}\r\n          onReady={()=>{\r\n            if(!ready){\r\n              setReady(true); props.onReady?.()\r\n            }\r\n          }}/>\r\n      </View>\r\n    ):<>{props.children}</>;\r\n};\r\n","import React, { useEffect, useMemo, useRef, useState} from 'react';\r\nimport { Platform, StyleProp, View, ViewStyle } from 'react-native';\r\nimport { TextInput } from 'react-native-gesture-handler';\r\nimport CommonButton from '../../components/CommonButton';\r\nimport { useMessengerContentMutation } from '../../hooks/lists/useMessengerContentList';\r\nimport useAuthContext from '../../hooks/useAuthContext';\r\nimport Colors from '../../constants/Colors';\r\nimport useColorScheme from '../../hooks/useColorScheme';\r\nimport { View as ThemedView } from '../../components/Themed' \r\nimport useIsMobile from '../../hooks/useIsMobile';\r\nimport DateTimePickerModal from '../../modals/DateTimePickerModal'\r\nimport useLangContext from '../../hooks/useLangContext';\r\nimport { Entypo } from '../../lib/@expo/vector-icons';\r\nimport TimerTags, { timerFormat } from '../../components/Messages/TimerTags';\r\nimport UploadTags from '../../components/Messages/UploadTags';\r\nimport Messages from '../../components/Messages';\r\nimport Editor from '../../components/Editor';\r\nimport useResizeContext from '../../hooks/useResizeContext';\r\nimport useModalsContext from '../../hooks/useModalsContext';\r\n\r\nfunction uploadFile(){\r\n    return new Promise<Blob|undefined>((resolve, reject)=>{\r\n      if (Platform.OS == 'web'){\r\n        var input = document.createElement('input');\r\n        input.type = 'file';\r\n        input.onchange = e => { \r\n          resolve((e.target as any).files[0])\r\n        }\r\n        input.onabort = reject\r\n        input.onerror = reject\r\n        input.click();\r\n      }\r\n      else\r\n        resolve(undefined)\r\n    })\r\n  }\r\n\r\nexport default ({channel_id, isEditor, setIsEditor, style, extraButtons}:{channel_id:number, isEditor:boolean, setIsEditor:(v:boolean)=>void, style?:StyleProp<ViewStyle>, extraButtons?:{title:string, onPress:()=>void, disabled?:boolean}[]})=>{\r\n    const theme = useColorScheme()\r\n    const windowType = useResizeContext()\r\n    const { lang } = useLangContext()\r\n    const isMobile = useIsMobile()\r\n    const {auth} = useAuthContext()\r\n    const { setModal } = useModalsContext()\r\n    const inputRef = useRef<TextInput>(null)\r\n    const [value, setValue] = useState('')\r\n    const [editorValue, setEditorValue] = useState('')\r\n    const [timer, setTimer] = useState<string>()\r\n    const [messageEvent, sendToScreen] = useState<{value:string, editorValue:string}>()\r\n    const [bottomTab, setBottomTab] = useState<boolean>(false)\r\n    const [autoFocus, setAutoFocus] = useState<boolean|null>(null)\r\n    const valueLines = useMemo(()=>bottomTab?1:value.split(\"\\n\").length, [value, bottomTab])\r\n    const contentMutation = useMessengerContentMutation()\r\n    const postValue = ()=>{\r\n        if (value.length>0){\r\n          if(isEditor){\r\n            contentMutation.create({channel:channel_id, user:auth.user?.id, content:'', timer, editor: {title:value, content:editorValue}})\r\n          }\r\n          else{\r\n            contentMutation.create({channel:channel_id, user:auth.user?.id, content:value, timer})\r\n          }\r\n          setTimer(undefined)\r\n          setBottomTab(false)\r\n          setValue('')\r\n          setAutoFocus(true)\r\n          if(isEditor){\r\n            setEditorValue('')\r\n            setIsEditor(false)\r\n          }\r\n        }\r\n      }\r\n      const onKeyPress = (e:any) => {\r\n        if (!isMobile){\r\n          const event = e as KeyboardEvent;\r\n            if (!event.shiftKey && event.key === \"Enter\"){\r\n              postValue()\r\n              event.preventDefault()\r\n          }\r\n        }\r\n      }\r\n      \r\n      useEffect(()=>{\r\n        if(messageEvent){\r\n          setIsEditor(false)\r\n          setValue(value.concat(value.length>0?\"\\n\":\"\", messageEvent.value))\r\n          setEditorValue(editorValue.concat(\"\\r\\n\", messageEvent.editorValue))\r\n          sendToScreen(undefined)\r\n          setIsEditor(true)\r\n        }\r\n      }, [messageEvent, value, editorValue])\r\n      useEffect(()=>{\r\n        if(autoFocus){\r\n          (inputRef.current as any).focus?.()\r\n          setAutoFocus(false)\r\n        }\r\n      }, [autoFocus])\r\n      // useEffect(()=>{\r\n      //   if (autoFocus==null && !isMobile){\r\n      //     const timeout = setTimeout(()=>setAutoFocus(true), 500)\r\n      //     return ()=>clearTimeout(timeout)\r\n      //   }\r\n      // })\r\n\r\n\r\n    return <View style={style}>\r\n      <Messages channel_id={channel_id} auth={auth} reverse sendToScreen={sendToScreen}/>\r\n      <View style={{position:'absolute', flexDirection:'row'}}>\r\n        <UploadTags channel_id={channel_id}/>\r\n        <TimerTags channel_id={channel_id}/>\r\n      </View>\r\n      <ThemedView style={[{bottom:0, width:'100%', paddingTop:15, paddingBottom:10, paddingHorizontal:19}, isEditor?{height:windowType=='landscape'?'50%':'100%'}:{}]}>\r\n        <View style={{alignItems:'center', width:'100%',flexDirection:'row'}}>\r\n          <CommonButton title={''} style={{height:'100%', paddingTop:8, borderTopRightRadius:0, borderBottomRightRadius:0, justifyContent:'center'}} onPress={()=>{isEditor?setIsEditor(false):setBottomTab(!bottomTab)}}>\r\n            <View style={{top:-2}}>\r\n              <Entypo name={isEditor || bottomTab?\"cross\":\"plus\"} size={24} color={Colors[theme].text}/>\r\n            </View>\r\n          </CommonButton>\r\n          {timer && <CommonButton style={{height:'100%', paddingTop:8, borderRadius:0}} title={`⌚${timerFormat(timer)}`} onPress={()=>{setModal(DateTimePickerModal, {datetime:timer, callback:(datetime:string)=>setTimer(datetime)});setBottomTab(false)}}/>}\r\n          <TextInput\r\n              ref={inputRef}\r\n              value={value} \r\n              onChangeText={setValue}\r\n              onKeyPress={onKeyPress}\r\n              style={{flex:1, borderWidth:1, minHeight:41, borderColor:Colors.borderColor, backgroundColor:Colors[theme].background, color:Colors[theme].text, paddingVertical:1, paddingHorizontal:3}}\r\n              onFocus={()=>setBottomTab(false)}\r\n              multiline \r\n              numberOfLines={valueLines}/>\r\n          <CommonButton style={{height:'100%', paddingTop:8, borderTopLeftRadius:0, borderBottomLeftRadius:0, justifyContent:'center'}} title={'💬'} onPress={postValue}/>\r\n        </View>\r\n        <Editor theme={theme} active={isEditor} value={editorValue} setValue={setEditorValue} onReady={()=>setBottomTab(false)}/>\r\n        {bottomTab && <View style={{alignItems:'center', width:'100%', flexDirection:'row', paddingTop:15, paddingBottom:5}}>\r\n          <CommonButton style={{height:80, flex:1, justifyContent:'center', marginRight:15}} title={`📤\\n ${lang('File')}`} onPress={()=>uploadFile().then(f=>{contentMutation.create({channel:channel_id, user:auth.user?.id, content:'', file:f});setBottomTab(false)})}/>\r\n          <CommonButton style={{height:80, flex:1, justifyContent:'center', marginRight:15}} title={`✏️\\n ${lang('Editor')}`} onPress={()=>{setIsEditor(!isEditor); isEditor && setBottomTab(false)}}/>\r\n          <CommonButton style={{height:80, flex:1, justifyContent:'center', marginRight:15}} title={`⌚\\n ${lang('Timer')}`} onPress={()=>{setModal(DateTimePickerModal, {datetime:timer, callback:(datetime:string)=>setTimer(datetime)});setBottomTab(false)}}/>\r\n          {extraButtons?.map((v, k)=><CommonButton key={k} style={{height:80, flex:1, justifyContent:'center', marginRight:15}} title={v.title} onPress={()=>{v.onPress();setBottomTab(false)}} disabled={v.disabled}/>)}\r\n        </View>}\r\n      </ThemedView>\r\n    </View>\r\n}","import React from \"react\"\r\nimport CommonSection from \"../../../components/CommonSection\"\r\nimport Colors from \"../../../constants/Colors\"\r\nimport useColorScheme, { setColorScheme } from \"../../../hooks/useColorScheme\"\r\nimport { StyleSheet, Text, View} from 'react-native';\r\nimport useLangContext from \"../../../hooks/useLangContext\";\r\nimport { useColorScheme as useConfigColorScheme} from 'react-native-appearance';\r\nimport useFirebaseContext from \"../../../hooks/useFirebaseContext\";\r\nimport TextButton from \"../../../components/TextButton\";\r\nimport useModalsContext from \"../../../hooks/useModalsContext\";\r\nimport RegistrationModal from \"../../../modals/RegistrationModal\";\r\nimport useAuthContext from \"../../../hooks/useAuthContext\";\r\n\r\n\r\nconst ConfigSection = ({title, children}:{title:string, children?: React.ReactNode})=>{\r\n  const theme = useColorScheme()\r\n  const color = Colors[theme].text\r\n  return <CommonSection bodyStyle={{alignItems:'flex-start', backgroundColor:theme=='light'?'transparent':\"black\"}}>\r\n    <Text style={{fontSize:20, color, fontWeight:'600'}}>{title}</Text>\r\n    {children}\r\n  </CommonSection>\r\n}\r\n\r\nexport default ()=>{\r\n  const { lang, locale, setLocale } = useLangContext()\r\n  const { setModal } = useModalsContext()\r\n  const {auth} = useAuthContext()\r\n  const theme = useColorScheme()\r\n  const configTheme = useConfigColorScheme()\r\n  const {enable:noti, setEnable:setNoti} = useFirebaseContext()\r\n  const color = Colors[theme].text\r\n  return <>\r\n    <ConfigSection title={lang('* Notification Settings')}>\r\n      <View style={{flexDirection:'row'}}>\r\n        {[[lang('On'), true], [lang('Off'), false]].map(([title, n])=><TextButton\r\n          key={title} title={title || ''} textStyle={{fontSize:16, color, textDecorationLine:noti==n?'underline':'none'}} style={{borderRadius:20}} onPress={()=>{setNoti(n)}}/>)}\r\n      </View>\r\n    </ConfigSection>\r\n    <ConfigSection title={lang('* Language Settings')}>\r\n    <View style={{flexDirection:'row'}}>\r\n        {[[lang('Auto'), 'auto'], ['한국어', 'ko'], ['English', 'en']].map(([title, l])=><TextButton \r\n          key={title} title={title || ''} textStyle={{fontSize:16, color, textDecorationLine:locale==l?'underline':'none'}} style={{borderRadius:20}} onPress={()=>setLocale(l)}/>)}\r\n      </View>\r\n    </ConfigSection>\r\n    <ConfigSection title={lang('* Skin Settings')}>\r\n      <View style={{flexDirection:'row'}}>\r\n        {[[lang('Auto'), 'no-preference'], [lang('Light'), 'light'], [lang('Dark'), 'dark']].map(([title, colorScheme])=><TextButton \r\n          key={title} title={title} textStyle={{fontSize:16, color, textDecorationLine:configTheme==colorScheme?'underline':'none'}} style={{borderRadius:20}} onPress={(\r\n            )=>setColorScheme(colorScheme)}/>)}\r\n      </View>\r\n    </ConfigSection>\r\n    {!auth.user?.is_guest && <CommonSection bodyStyle={{alignItems:'flex-start', backgroundColor:theme=='light'?'transparent':\"black\"}}>\r\n      <TextButton title={lang('Account Settings')} textStyle={{fontSize:20, color}} style={{paddingLeft:0, borderRadius:20}} onPress={()=>setModal(RegistrationModal, {})}/>\r\n    </CommonSection>}\r\n  </>\r\n}","import React, {useState, useEffect, useLayoutEffect, useRef} from 'react';\r\nimport { StackNavigationProp, StackScreenProps } from '@react-navigation/stack';\r\nimport { View, ScrollView, useWindowDimensions} from 'react-native';\r\nimport { Text as StyledText } from 'react-native-paper';\r\nimport { Text } from '../../../components/Themed'\r\nimport useResizeContext from '../../../hooks/useResizeContext';\r\nimport TabView from '../../../components/TabView';\r\nimport HeaderRight from '../../../components/HeaderRight';\r\nimport TextButton from '../../../components/TextButton';\r\nimport Colors from '../../../constants/Colors';\r\nimport useColorScheme  from '../../../hooks/useColorScheme';\r\nimport useModalsContext from '../../../hooks/useModalsContext';\r\nimport ChannelEditModal from '../../../modals/ChannelEditModal';\r\nimport useLangContext from '../../../hooks/useLangContext';\r\nimport ContractFooter from '../../../components/ContractFooter';\r\nimport { TabViewRecord } from '../../../types';\r\nimport useAuthContext from '../../../hooks/useAuthContext';\r\nimport usePeopleUserList from '../../../hooks/lists/usePeopleUserList';\r\nimport { FontAwesome, Ionicons, MaterialCommunityIcons, SimpleLineIcons } from '../../../lib/@expo/vector-icons';\r\nimport { useMessengerChannelSorted } from '../../../hooks/lists/useMessengerChannelList';\r\nimport CommonItem from '../../../components/CommonItem';\r\nimport MemberItem from '../../../components/MemberItem';\r\nimport ProfileModal from '../../../modals/ProfileModal';\r\nimport { navigate } from '../../../navigation';\r\nimport CommonSection from '../../../components/CommonSection';\r\nimport ConfigSections from './ConfigSections';\r\nimport Avatar, { avatarFromChannel } from '../../../components/Avatar';\r\nimport { useNavigation } from '@react-navigation/native';\r\nimport AddPeopleModal from '../../../modals/AddPeopleModal';\r\n\r\n\r\nconst useHeaderSetter = (options:any[]) =>{\r\n  const tempref = useRef<NodeJS.Timer>()\r\n  const indexRef = useRef<number>()\r\n  const {width } = useWindowDimensions()\r\n  const navigation = useNavigation()\r\n  useEffect(()=>{\r\n    return ()=>{\r\n      clearInterval(tempref.current)\r\n    }\r\n  }, [])\r\n  return (ref:any)=>{\r\n      clearInterval(tempref.current)\r\n      /*@ts-ignore */\r\n      tempref.current=setInterval(()=>{ref?.measure((fx, fy, _, height, px, py)=>{\r\n        const i = Math.round(-px/width)\r\n        if (indexRef.current != i){\r\n          indexRef.current = i\r\n          navigation.setOptions(options[i])\r\n        }\r\n      })\r\n    }, 300)\r\n  }\r\n}\r\n\r\nconst renderIndexDetector= (Component:React.ComponentType<any>, headerIndexRef:(ref:any)=>void)=>{\r\n  return (props:any)=><View style={{flex:1}} ref={headerIndexRef}>\r\n    <Component {...props}/>\r\n  </View>\r\n}\r\n\r\nconst PeopleTabView = ()=>{\r\n  const {auth} = useAuthContext()\r\n  const theme = useColorScheme()\r\n  const { setModal } = useModalsContext()\r\n  const userList = usePeopleUserList(auth)\r\n  const memberItem = React.useMemo(\r\n      ()=>userList && userList.map((item, index)=><MemberItem key={index} member={item} onPress={()=>setModal(ProfileModal, {id:item.id})}/>), [userList])\r\n  return <ScrollView style={{flex:1, backgroundColor:Colors[theme].background}}>\r\n      {memberItem}\r\n  </ScrollView>\r\n}\r\n\r\nconst MessengerTabView = ()=>{\r\n  const {auth} = useAuthContext()\r\n  const channelList = useMessengerChannelSorted('messenger', auth)\r\n  const theme = useColorScheme()\r\n\r\n  const today = (new Date()).toISOString().slice(0, 10)\r\n  return <ScrollView style={{flex:1, backgroundColor:Colors[theme].background}}>\r\n      {channelList?.map((item, index)=>{\r\n          const {avatar, name} = avatarFromChannel(item, auth.user)\r\n          const date = item.last_message?.created.slice(0,10)\r\n          const content = item.last_message?.preview_content || item.last_message?.content || ''\r\n          return <CommonItem key={index} bodyStyle={{flexDirection:'row', justifyContent:'space-between'}} onPress={()=>navigate(\"ChatScreen\", {id:item.id})}>\r\n              <View style={{flexDirection:'row', flexShrink:1}}>\r\n                  {avatar?\r\n                    <View style={{ marginRight:20}}>\r\n                      <Avatar name={avatar.name} size={44} userId={avatar.id}/>\r\n                    </View>:\r\n                    <FontAwesome size={40} color={Colors[theme].iconColor} style={{ marginBottom: -3, marginRight:20 }} name='users'/>}\r\n                  <View>\r\n                      <View style={{flexDirection:'row'}}>\r\n                          <Text style={{fontSize:18}}>{name}</Text>\r\n                          {item.type=='messenger' && <Text style={{fontSize:18, opacity: 0.4, paddingLeft:5}}>{item.member_count}</Text>}\r\n                      </View>\r\n                      <Text style={{fontSize:16, opacity: 0.4}}>{content.replaceAll('\\n', ' ')}</Text>\r\n                  </View>\r\n              </View>\r\n              <View>\r\n                  <Text style={{fontSize:14, opacity: 0.4, textAlign:'right'}}>{date==today?item.last_message?.created.slice(11,16):date}</Text>\r\n                  <Text style={{fontSize:14, textAlign:'right'}}>{item.unread_count?item.unread_count:' '}</Text>\r\n              </View>\r\n          </CommonItem>\r\n      })}\r\n  </ScrollView>\r\n}\r\n\r\n\r\nconst ConfigTabView = ()=>{\r\n  const theme = useColorScheme()\r\n  return <ScrollView style={{flex:1, backgroundColor:Colors[theme].background}}>\r\n    <ConfigSections/>\r\n  </ScrollView>\r\n}\r\n\r\nconst getBottomTabs = (theme:'light'|'dark', headerSetter:(ref:any)=>void)=>{\r\n  const color = Colors[theme].iconColor\r\n  return {\r\n    OneTab:{\r\n        title:'people',\r\n        component:renderIndexDetector(PeopleTabView, headerSetter),\r\n        icon:<MaterialCommunityIcons size={32} color={color} style={{ marginBottom: -3 }} name='account'/>,\r\n    },\r\n    TwoTab:{\r\n        title:'chat',\r\n        component:MessengerTabView,\r\n        icon:<Ionicons size={30} color={color} style={{ marginBottom: -3 }} name='chatbox'/>\r\n    },\r\n    // ThreeTab:{\r\n    //   title:'my messages',\r\n    //   component:MyMessageTabView,\r\n    //   icon:<MaterialCommunityIcons size={32} color={color} style={{ marginBottom: -3 }} name='pencil-box'/>\r\n    // },\r\n    FourTab:{\r\n        title:'config',\r\n        component:ConfigTabView,\r\n        icon:<SimpleLineIcons size={30} color={color} style={{ marginBottom: -3 }} name='options'/>\r\n    }\r\n  } as TabViewRecord\r\n}\r\n\r\n\r\nexport default function HomeScreen({navigation, route}: StackScreenProps<any, 'Home'>) {\r\n  const { lang, locale } = useLangContext()\r\n  const windowType = useResizeContext();\r\n  const theme = useColorScheme()\r\n  const { setModal } = useModalsContext()\r\n  const {auth} = useAuthContext()\r\n  const [ home, setHome ] = useState(windowType == 'landscape')\r\n  const color = Colors[theme].text\r\n  const options = [\r\n    {title:lang('people'), headerRight:()=><HeaderRight extra={[{title:lang('create'), onPress:()=>setModal(AddPeopleModal, {})}]}/>},\r\n    {title:lang('chat'), headerRight:()=><HeaderRight extra={[{title:lang('create'), onPress:()=>setModal(ChannelEditModal, {type:'messenger'})}]}/>},\r\n    // {title:lang('my messages'), headerRight:()=><HeaderRight extra={[{title:lang('create'), onPress:()=>setModal(ChannelEditModal, {type:'mycontent'})}]}/>},\r\n    {title:lang('config'), headerRight:()=><HeaderRight/>}\r\n  ]\r\n  const headerSetter = useHeaderSetter(options)\r\n  \r\n  useLayoutEffect(() => {\r\n    const index = route?.params?.tab | 0\r\n    navigation.setOptions(windowType == 'portrait'?options[index]:{\r\n      title: lang('home'),\r\n      headerRight: ()=><HeaderRight/>\r\n    });\r\n  }, [navigation, route, windowType, locale]);\r\n  useEffect(()=>{\r\n    setHome(windowType == 'landscape')\r\n  }, [windowType])\r\n  return home?\r\n    <ScrollView contentContainerStyle={{flex:1, alignItems:'center'}}>\r\n      <View style={{flexGrow:1, width:'80%', marginTop:72}}>\r\n        <StyledText style={{fontSize:32, color}}>Tokki Tok</StyledText>\r\n        <View style={{backgroundColor:Colors.borderColor, height:1, width:'100%'}}/>\r\n        {/* <Text style={{fontSize:20, color:'gray'}}>Welcome! This is a messenger for teams.</Text>*/}\r\n        <View style={{height:24}}/>\r\n        <CommonSection bodyStyle={{alignItems:'flex-start', backgroundColor:theme=='light'?'transparent':\"black\"}}>\r\n          <TextButton title={lang('+ New chat')} textStyle={{fontSize:20, color}} style={{paddingLeft:0, borderRadius:20}} onPress={()=>setModal(ChannelEditModal, {type:'messenger'})}/>\r\n        </CommonSection>\r\n        <ConfigSections/>\r\n      </View>\r\n      <ContractFooter theme={theme}/>\r\n    </ScrollView>:\r\n    <TabView tabs={getBottomTabs(theme, headerSetter)} tabBarPosition=\"bottom\" index={parseInt(route.params?.['tab'] || 0)} onTab={(index)=>{navigation.setParams({tab:index})}}/>\r\n}\r\n\r\n","import LoginScreen from \"./login/LoginScreen\";\r\nimport DemoScreen from \"./login/DemoScreen\";\r\nimport ChatScreen from \"./main/ChatScreen\";\r\nimport HomeScreen from \"./main/HomeScreen\";\r\n// import BoardEditScreen from \"../lib/blacktokki-board/BoardEditScreen\";\r\nimport { Screens } from \"../types\";\r\n\r\nexport const main = {\r\n    HomeScreen:{\r\n        title:'home',\r\n        component:HomeScreen,\r\n        path:'home',\r\n    },\r\n    ChatScreen:{\r\n        title:'chat',\r\n        component:ChatScreen,\r\n        path:'chat'\r\n    },\r\n    // BoardScreen:{\r\n    //     title:'board',\r\n    //     component:BoardScreen,\r\n    //     path:'board'\r\n    // },\r\n} as Screens\r\n\r\nexport const login = {\r\n    LoginScreen:{\r\n        path: 'login',\r\n        title: 'Sign in',\r\n        component:LoginScreen\r\n    },\r\n    DemoScreen:{\r\n        title:'',\r\n        component:DemoScreen,\r\n        path:'demo'\r\n    }\r\n} as Screens\r\n\r\nexport const modal = {\r\n    // BoardEditScreen:{\r\n    //     title:'board',\r\n    //     component:BoardEditScreen,\r\n    //     path:'modal/board'\r\n    // },\r\n} as Screens","import React, { useState} from 'react';\r\nimport { StackScreenProps } from '@react-navigation/stack';\r\nimport { View } from 'react-native';\r\nimport VideoCallSection from './VideoCallSection';\r\nimport useResizeContext from '../../../hooks/useResizeContext';\r\nimport useLangContext from '../../../hooks/useLangContext';\r\nimport ChatSection from '../ChatSection';\r\nimport useChatSection from '../../../hooks/useChatSection';\r\n\r\n\r\nexport default function ChatScreen({navigation, route}: StackScreenProps<any, 'Chat'>) {\r\n  const channel_id = route?.params?.id\r\n  const windowType = useResizeContext()\r\n  const { lang } = useLangContext()\r\n  const [isEditor, setIsEditor] = useState<boolean>(false)\r\n  const [videoMode, setVideoMode] = useState<boolean>(false)\r\n  useChatSection(navigation, route, channel_id, 'messenger', isEditor)\r\n  \r\n  return <View style={[\r\n    {flex:1, alignItems:'center'},\r\n    windowType=='landscape'?{flexDirection:'row-reverse', minWidth:480}:{flexDirection:'column'}\r\n  ]}>\r\n    <VideoCallSection channel_id={channel_id} setDisable={(d)=>setVideoMode(!d)} disable={!videoMode}/>\r\n    <ChatSection \r\n      channel_id={channel_id} \r\n      isEditor={isEditor} \r\n      setIsEditor={setIsEditor} \r\n      style={[videoMode?{flexShrink:1}:{flex:1}, windowType=='landscape'?{minWidth:320, height:'100%'}:{width:'100%'}]}\r\n      extraButtons={[{title:`📹\\n ${lang('Video Call')}`, onPress:()=>setVideoMode(!videoMode), disabled:videoMode}]}\r\n    />\r\n  </View>\r\n}","import React, { useState,  useEffect,  useMemo,useLayoutEffect } from \"react\"\r\nimport useMessengerMemberList from './lists/useMessengerMemberList';\r\nimport useMessengerChannelList from './lists/useMessengerChannelList';\r\nimport { avatarFromChannel } from '../components/Avatar';\r\nimport useResizeContext from './useResizeContext';\r\nimport useModalsContext from './useModalsContext';\r\nimport InviteModal from '../modals/InviteModal';\r\nimport useLangContext from './useLangContext';\r\nimport useAuthContext from \"./useAuthContext\";\r\nimport { StackNavigationProp } from \"@react-navigation/stack\";\r\nimport { RouteProp } from \"@react-navigation/native\";\r\nimport HeaderRight from \"../components/HeaderRight\";\r\nimport ChannelEditModal from \"../modals/ChannelEditModal\";\r\nimport { Channel } from \"../types\";\r\n\r\nexport default (navigation:StackNavigationProp<any, any>, route:RouteProp<any, any>,channel_id:any, type:Channel['type'], isEditor:boolean)=>{\r\n    const { lang, locale } = useLangContext()\r\n    const {auth} = useAuthContext()\r\n    const { setModal } = useModalsContext()\r\n    const windowType = useResizeContext()\r\n    const channelList = useMessengerChannelList(type, auth)\r\n    const channel = channelList?.find(v=>v.id==parseInt(channel_id))\r\n    const channelAvatar = channel?avatarFromChannel(channel, auth.user):undefined\r\n    const memberList = useMessengerMemberList(channel_id)\r\n    const member_id = useMemo(()=>memberList?.find(v=>v.user == auth.user?.id)?.id, [auth, memberList])\r\n\r\n\r\n    useLayoutEffect(() => {\r\n        navigation.setOptions({\r\n          headerRight: ()=> <HeaderRight extra={channel?.type=='messenger'?[\r\n            {title:lang('invite'), onPress:()=>setModal(InviteModal, {id:channel_id})},\r\n            {title:lang('setting'), onPress:()=>setModal(ChannelEditModal, {id:channel_id, type:channel?.type, member_id})}\r\n          ] : [\r\n            {title:lang('setting'), onPress:()=>setModal(ChannelEditModal, {id:channel_id, type:channel?.type, member_id})}\r\n          ]}/>,\r\n          title: channelAvatar?.name,\r\n          headerShown:!(windowType=='portrait' && isEditor)\r\n        });\r\n      }, [navigation, route, member_id, locale, windowType, isEditor,channel]);\r\n    \r\n      const back = ()=>{\r\n        if(navigation.canGoBack())\r\n            navigation.goBack()\r\n          else{\r\n            navigation.navigate('HomeScreen', {tab:2})\r\n          }\r\n      }\r\n      \r\n      useEffect(()=>{\r\n        setModal(null, null)\r\n        if (!channel_id)\r\n          back()\r\n      }, [route])\r\n      useEffect(()=>{\r\n        if (memberList===null || (memberList!=undefined && memberList.find(v=>v.user==auth.user?.id)==undefined))\r\n          back()\r\n      }, [memberList])\r\n      useEffect(()=>{\r\n        if(channelList===null || (channelList!=undefined && channel==undefined))\r\n            back()\r\n      }, [channelList])\r\n}","import React, { useLayoutEffect } from 'react';\r\n\r\nimport { StackScreenProps } from '@react-navigation/stack';\r\nimport useAuthContext from '../../hooks/useAuthContext';\r\n\r\nexport default function DemoScreen({navigation}: StackScreenProps<any, 'Demo'>) {\r\n    const {dispatch} = useAuthContext()\r\n    useLayoutEffect(() => {\r\n        navigation.setOptions({headerRight: undefined});\r\n        dispatch({type:\"LOGIN_GUEST\"})\r\n    }, []);\r\n  return <></>\r\n};","import { useMemo, useReducer } from \"react\"\r\n\r\ntype LocalSearchAction = {type:string, keyword?:string}\r\n\r\ntype LocalSearchState ={active:boolean, keyword:string}\r\n\r\n\r\n\r\nconst localSearchReducer =(initialState:LocalSearchState, action:LocalSearchAction)=>{\r\n    switch (action.type){\r\n        case 'SEARCH':\r\n          return {\r\n            ...initialState,\r\n            keyword: action.keyword\r\n          } as LocalSearchState\r\n        case 'ENABLE_SEARCH':\r\n          return {\r\n            ...initialState,\r\n            active:true,\r\n          }\r\n        case 'DISABLE_SEARCH':\r\n            return{\r\n                ...initialState,\r\n                active:false,\r\n                keyword: ''\r\n            }\r\n        default:\r\n            throw new Error( `Unhandled action type: ${action.type}`)\r\n    }\r\n  }\r\n\r\n\r\nexport default function useLocalSearch<T>(target:T[], compare:(value:T, keyword:string)=>boolean) {\r\n  const [searchState, dispatch] = useReducer(localSearchReducer, {active:false, keyword:''})\r\n  const data = useMemo(()=>searchState.active?target.filter(v=>compare(v, searchState.keyword)):target, [searchState, target])\r\n  return {searchState, dispatch, data}\r\n}","\r\nimport React, {useState} from 'react';\r\nimport { StyleProp, TextStyle, View } from 'react-native';\r\nimport Clipboard from '@react-native-clipboard/clipboard';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport { CustomTextInputProps } from '../types';\r\nimport CommonButton from './CommonButton';\r\nimport RowField from './RowField';\r\nimport { Text } from './Themed';\r\nimport useResizeContext from '../hooks/useResizeContext';\r\n\r\nexport default function CopyField(props:CustomTextInputProps & {name: string, width?:any, textStyle?:StyleProp<TextStyle>}) {\r\n  const { lang } = useLangContext()\r\n  const windowType = useResizeContext()\r\n  const [copied, setCopied] = useState(false)\r\n  return (\r\n    <RowField name={props.name} width={props.width} textStyle={props.textStyle}>\r\n      <View style={{flexDirection:windowType=='landscape'?'row':'column', justifyContent:'space-between'}}>\r\n        <View style={{justifyContent:'center'}}>\r\n          <Text style={{fontSize:16}}>{props.value}</Text>\r\n        </View>\r\n        <View>\r\n          <CommonButton title={lang('copy')} onPress={()=>{Clipboard.setString(props.value);setCopied(true)}}/>\r\n          {copied && <Text style={{fontSize:12, alignSelf:'center', color:'red'}}>{lang(\"copied\")}</Text>}\r\n        </View>\r\n      </View>\r\n   </RowField>\r\n  )\r\n}","import React, {useRef,MutableRefObject, useMemo, useState, useEffect } from 'react';\r\nimport { View, Text } from '../components/Themed';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport usePeopleUserList from '../hooks/lists/usePeopleUserList';\r\nimport { TabViewRecord, User } from '../types';\r\nimport CommonButton from '../components/CommonButton';\r\nimport useMessengerMemberList, { useMessengerMemberMutation } from '../hooks/lists/useMessengerMemberList';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport useExternalUserList from '../hooks/lists/useExternalUserList';\r\nimport TextField from '../components/TextField';\r\nimport useLocalSearch from '../hooks/useLocalSearch';\r\nimport TabView from '../components/TabView';\r\nimport { FlatList } from 'react-native-gesture-handler';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport MemberItem from '../components/MemberItem';\r\nimport ModalSection from '../components/ModalSection';\r\nimport useModalEffect from '../hooks/useModalEffect';\r\nimport CopyField from '../components/CopyField';\r\n\r\nconst InviteItem = (props:{item:User, selectedRef:MutableRefObject<Set<number>>})=>{\r\n  const [selected, setSelected] = useState(props.selectedRef.current.has(props.item.id))\r\n  return <View style={selected?{borderWidth:1, borderColor:'blue'}:{}}>\r\n    <MemberItem member={props.item} onPress={()=>{\r\n      if (selected){\r\n        setSelected(false)\r\n        props.selectedRef.current.delete(props.item.id)\r\n      }\r\n      else{\r\n        setSelected(true)\r\n        props.selectedRef.current.add(props.item.id)\r\n      }\r\n    }}/>\r\n  </View>\r\n\r\n}\r\ntype InviteTabViewProps = {\r\n  selectedRef:MutableRefObject<Set<number>>\r\n  userFilter:(user:User)=>boolean\r\n}\r\n\r\nconst PeopleTabView = ({selectedRef, userFilter}:InviteTabViewProps)=>{\r\n  const { lang } = useLangContext()\r\n  const {auth} = useAuthContext()\r\n  const userList = usePeopleUserList(auth)\r\n  const rawData = useMemo(()=>{\r\n    return userList?.filter(userFilter) || []\r\n  }, [userList, userFilter])\r\n  const {data, dispatch:dispatchKeyword, searchState} = useLocalSearch(rawData, (v, keyword)=>(v.username.includes(keyword) || v.name.includes(keyword)))\r\n  const search = (k:string)=>{\r\n    if (k?.length>0){\r\n      dispatchKeyword({type:'ENABLE_SEARCH'})\r\n      dispatchKeyword({type:'SEARCH', keyword:k})\r\n    }\r\n    else{\r\n      dispatchKeyword({type:'DISABLE_SEARCH'})\r\n    }\r\n  }\r\n  return <View style={{alignItems:'center', flex:1}}>\r\n    <View style={{'width': '100%', flex:1}}>\r\n      <TextField name={`${lang('Username')} & ${lang('Name')}`} placeholder={auth.user?.name} value={searchState.keyword} setValue={search} width={'80%'}/>\r\n      {data && <FlatList contentContainerStyle={{flexGrow:1}} data={data} renderItem={({item})=><InviteItem item={item} selectedRef={selectedRef}/>}/>}\r\n    </View>\r\n  </View>\r\n}\r\n\r\nconst DELAY = 500\r\n\r\nexport const ExternalMembershipTabView = ({selectedRef, userFilter, isChannel}:InviteTabViewProps & {isChannel:boolean})=>{\r\n  const { lang } = useLangContext()\r\n  const [value, setValue] = useState('')\r\n  const [keyword, setKeyword] = useState('')\r\n  const timeoutRef = useRef<NodeJS.Timeout>()\r\n  const {auth} = useAuthContext()\r\n  const externalMemberList = useExternalUserList(keyword)\r\n  const data = useMemo(()=>{\r\n    return externalMemberList?.filter(userFilter) || []\r\n  }, [externalMemberList, userFilter])\r\n  useEffect(()=>{\r\n    timeoutRef.current = setTimeout(()=>{\r\n      setKeyword(value)\r\n    }, DELAY)\r\n    return ()=>{timeoutRef.current && clearTimeout(timeoutRef.current)}\r\n  }, [value])\r\n  const inviteLink = isChannel?location.href.replace('chat', 'invitee'):undefined\r\n  return <View style={{alignItems:'center', flex:1}}>\r\n  <View style={{'width': '100%', flex:1, paddingVertical:10}}>\r\n    {inviteLink && <>\r\n      <CopyField name={lang('invite link')} width={'80%'} value={inviteLink}/>\r\n      <View style={{marginVertical: 10, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n    </>}\r\n    <TextField name={lang('Username')} placeholder={auth.user?.username} value={value} setValue={setValue} width={'80%'}/>\r\n    {data && <FlatList contentContainerStyle={{flexGrow:1}} data={data} renderItem={({item})=><InviteItem item={item} selectedRef={selectedRef}/>}/>}\r\n  </View>\r\n</View>\r\n}\r\n\r\nexport default function InviteModal({id}:{id:number}) {\r\n  const { lang } = useLangContext()\r\n  const selectedRef = useRef<Set<number>>(new Set())\r\n  const messengerMemberList = useMessengerMemberList(id)\r\n  const userFilter =  useMemo(()=>{\r\n    const memberSet = new Set(messengerMemberList?.map(v=>v.user))\r\n    return (user:User) => !memberSet.has(user.id);\r\n  }, [messengerMemberList])\r\n  const drawerTabs:TabViewRecord = {\r\n    member:{\r\n      title: 'People',\r\n      component: ()=><PeopleTabView selectedRef={selectedRef} userFilter={userFilter}/>,\r\n      icon: <></>\r\n    },\r\n    external:{\r\n      title: 'External members',\r\n      component: ()=><ExternalMembershipTabView selectedRef={selectedRef} userFilter={userFilter} isChannel/>,\r\n      icon: <></>\r\n    }\r\n  }\r\n  const messengerMemberMutation = useMessengerMemberMutation()\r\n  const { setModal } = useModalsContext()\r\n  const back = ()=>{\r\n    setModal(InviteModal, null)\r\n  }\r\n  useModalEffect(back, [])\r\n  return <ModalSection>\r\n    <View style={{flex:1, width:'100%'}}>\r\n      <View style={{width:'100%'}}>\r\n        <Text style={{fontSize:20}}>{lang('invite')}</Text>\r\n        <View style={{marginBottom: 20, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n      </View>\r\n      <TabView tabs={drawerTabs} tabBarPosition={\"top\"}/>\r\n      <View style={[{width:'100%', flexDirection:'row', padding:10,}, {justifyContent:'flex-end'}]}>\r\n        <CommonButton title={lang('invite')} onPress={()=>{\r\n          messengerMemberMutation.invite({\r\n            channel_id:id,\r\n            user_ids:[...selectedRef.current]\r\n          }).then(back)\r\n        }}/>\r\n        <CommonButton title={lang('cancel')} onPress={back}/>\r\n      </View>\r\n    </View>\r\n  </ModalSection>\r\n}\r\n\r\n","import React, { Suspense, useState } from 'react';\r\nimport CommonButton from '../components/CommonButton';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport { Text, View } from '../components/Themed';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport { Ionicons } from '../lib/@expo/vector-icons';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport Colors from '../constants/Colors';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { BottomSheet } from '../components/ModalSection';\r\nimport dayjs from 'dayjs';\r\nimport useModalEffect from '../hooks/useModalEffect';\r\n\r\nconst dayTypes = ['AM', 'PM'].map(value=>({label:value, value}))\r\nconst hours = [...Array(12).keys()].map((value, index)=>(index + 1).toString().padStart(2, '0')).map(value=>({label:value, value}))\r\nconst minutes = [...Array(12).keys()].map((value, index)=>(index * 5).toString().padStart(2, '0')).map(value=>({label:value, value}))\r\n\r\n\r\nconst getDisableDays=(date:dayjs.Dayjs)=>{\r\n  let startDate = date.clone().startOf('month').add(-1, 'month')\r\n  const endDate = date.clone().endOf('month').add(1, 'month')\r\n  const today = dayjs().startOf('day')\r\n  const result = []\r\n  while(startDate<=endDate && startDate<today){\r\n    result.push(startDate.format('YYYY-MM-DD'))\r\n    startDate = startDate.add(1, 'day')\r\n  }\r\n  return result\r\n}\r\n\r\nconst defaultDayjs = ()=>{\r\n  const m = dayjs()\r\n  const restMinute = parseInt(m.format('mm')) % 5\r\n  return m.add(5-restMinute, 'minute')\r\n}\r\n\r\nconst Calendar = React.lazy(()=> import('../components/Calendar'))\r\nconst CommonPicker = React.lazy(()=>import('../components/CommonPicker'))\r\n\r\nexport default function DateTimePickerModal({datetime, callback}:{datetime?:string, callback:(datetime?:string)=>void}) {\r\n  const _dayjs = datetime?dayjs(datetime):defaultDayjs()\r\n  const { lang, locale } = useLangContext()\r\n  const theme = useColorScheme()\r\n  const [date, setDate] = useState(_dayjs.format('YYYY-MM-DD'));\r\n  const [dayType, setDayType] = useState(_dayjs.locale('en').format('A'))\r\n  const [hour, setHour] = useState(_dayjs.format('hh'))\r\n  const [minute, setMinute] = useState(_dayjs.format('mm'))\r\n  const [disableDays, setDisableDays] = useState<string[]>(getDisableDays(_dayjs))\r\n  const { setModal } = useModalsContext()\r\n  const back = ()=>{\r\n    setModal(DateTimePickerModal, null)\r\n  }\r\n  useModalEffect(back, [])\r\n  return <BottomSheet>\r\n    <View style={{flexDirection:'row', width:'100%'}}>\r\n      <View style={{flex:1, flexDirection:'row'}}>\r\n        <TouchableOpacity onPress={back}>\r\n          <Ionicons size={20} name=\"arrow-back\" color={Colors[theme].text}/>\r\n        </TouchableOpacity>\r\n      </View>\r\n      <View style={{flex:1}}>\r\n        <Text style={{fontSize:20, textAlign:'center'}}>{lang('Date & Time')}</Text>\r\n      </View>\r\n      <View style={{flex:1}}/>\r\n    </View>\r\n    <View style={{marginBottom: 20, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n    <Suspense fallback={<></>}>\r\n      <Calendar\r\n        locale={locale}\r\n        style={undefined} \r\n        setDate={setDate}\r\n        disableAllTouchEventsForDisabledDays={true}\r\n        onMonthChange={(v)=>setDisableDays(getDisableDays(dayjs(v.dateString)))}\r\n        markedDates={{\r\n          ...disableDays.reduce((p, c)=>{p[c]={disabled:true};return p}, {} as Record<string, any>),\r\n          ...(date?[date]:[]).reduce((p, c)=>{p[c]={selected:true};return p}, {} as Record<string, any>)\r\n        }}\r\n      />\r\n      <View style={{flexDirection:'row', paddingVertical:10, width:400, height:50}}>\r\n        <CommonPicker value={dayType} setValue={setDayType} values={dayTypes}/>\r\n        <Text style={{fontSize:20}}> </Text>\r\n        <CommonPicker value={hour} setValue={setHour} values={hours}/>\r\n        <Text style={{fontSize:20}}> : </Text>\r\n        <CommonPicker value={minute} setValue={setMinute} values={minutes}/>\r\n      </View>\r\n    </Suspense>\r\n    <View style={{flexDirection:'row'}}>\r\n      <CommonButton title={lang('save')} onPress={()=>{\r\n        callback?.(dayjs(`${date} ${hour}:${minute} ${dayType}`).toISOString())\r\n        back()\r\n      }}/>\r\n      <CommonButton title={lang('cancel')} onPress={()=>{\r\n        callback?.(undefined)\r\n        back()\r\n      }}/>\r\n      \r\n    </View>\r\n  </BottomSheet>\r\n}\r\n","import React from \"react\"\r\nimport { StyleProp, TextStyle } from \"react-native\";\r\nimport Hyperlink from \"react-native-hyperlink\";\r\nimport { Text } from \"../Themed\";\r\n\r\ntype MessageContentProps = {textStyle?:StyleProp<TextStyle>, selectable?:boolean, onPressLink?:any}\r\n\r\nconst MessageContentView = (props:MessageContentProps  & {content?:string})=>{\r\n    /* @ts-ignore */\r\n    return <Hyperlink linkDefault={ true } style={{wordBreak:\"break-word\"}} linkStyle={{color: '#12b886'}} onPress={props.onPressLink}>\r\n        <Text selectable={props.selectable} style={props.textStyle}>{props.content}</Text>\r\n    </Hyperlink>\r\n}\r\n\r\nexport default MessageContentView","import React from 'react';\r\nimport Clipboard from '@react-native-clipboard/clipboard/dist';\r\nimport CommonButton from '../components/CommonButton';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport { Text, View } from '../components/Themed';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport { BottomSheet } from '../components/ModalSection';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport Colors from '../constants/Colors';\r\nimport { Ionicons } from '../lib/@expo/vector-icons';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { useMessengerContentMutation } from '../hooks/lists/useMessengerContentList';\r\nimport useModalEffect from '../hooks/useModalEffect';\r\nimport { EditorContent, MessengerContent } from '../types';\r\nimport { regexForStripHTML } from '../components/Messages/EditorPreview';\r\n\r\n\r\n\r\nexport default function MessageModal({content, isOwner, sendToScreen}:{content:MessengerContent, isOwner:boolean, sendToScreen?:(e:{value:string, editorValue:string})=>void}) {\r\n  const message = content.message_set[0]\r\n  const editorContents = (content.attatchment_set.filter(v=>v.type=='editor') as EditorContent[])\r\n  const editor  = editorContents.length>0?editorContents[0]:undefined\r\n  const fullContent = editor?editor.title.concat('\\r\\n', editor.description.replaceAll(regexForStripHTML, '')):message.content\r\n  const { lang } = useLangContext()\r\n  const { setModal } = useModalsContext()\r\n  const theme = useColorScheme()\r\n  const contentMutation = useMessengerContentMutation()\r\n  const back = ()=>{\r\n    setModal(MessageModal, null)\r\n  }\r\n  useModalEffect(back, [])\r\n  return <BottomSheet>\r\n    <View style={{flexDirection:'row', width:'100%'}}>\r\n      <View style={{flex:1, flexDirection:'row'}}>\r\n        <TouchableOpacity onPress={back}>\r\n          <Ionicons size={20} name=\"arrow-back\" color={Colors[theme].text}/>\r\n        </TouchableOpacity>\r\n      </View>\r\n      <View style={{flex:1}}>\r\n        <Text style={{fontSize:20, textAlign:'center'}}>{lang('Message')}</Text>\r\n      </View>\r\n      <View style={{flex:1}}/>\r\n    </View>\r\n    <View style={{marginBottom: 20, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n      <CommonButton style={{height:40, width:'100%', maxWidth:320, justifyContent:'center'}} title={lang('copy')} onPress={()=>{Clipboard.setString(fullContent);back()}}/>\r\n      {editor && sendToScreen && <CommonButton style={{height:40, width:'100%', maxWidth:320, justifyContent:'center'}} title={lang('move to editor')} onPress={()=>{sendToScreen({value:editor.title, editorValue:editor.description});back()}}/>}\r\n      {isOwner && content.timer && <CommonButton style={{height:40, width:'100%', maxWidth:320, justifyContent:'center'}} textStyle={{color:'red'}} title={lang('delete timer')} onPress={()=>{contentMutation.patch({id:content.id, timer:null});back()}}/>}\r\n      {isOwner && <CommonButton style={{height:40, width:'100%', maxWidth:320, justifyContent:'center'}} textStyle={{color:'red'}} title={lang('delete')} onPress={()=>{contentMutation.patch({id:content.id, is_archive:true});back()}}/>}\r\n  </BottomSheet>\r\n}\r\n","import React, { Suspense } from 'react'\r\nimport CommonSection from \"../CommonSection\"\r\nimport { View, Text } from \"../Themed\"\r\nimport { EditorContent } from \"../../types\"\r\nimport useColorScheme from \"../../hooks/useColorScheme\";\r\nimport Colors from \"../../constants/Colors\";\r\n\r\nconst RenderHTML = React.lazy(()=> import('react-native-render-html'))\r\n\r\nexport const regexForStripHTML = /<\\/?[^>]*>/gi;\r\n\r\nexport default React.memo(({content}:{content:EditorContent})=>{\r\n    const theme = useColorScheme()\r\n    return <View>\r\n        <Text style={{fontSize:18, fontWeight:'600', minWidth:140}}>{content.title}</Text>\r\n        <CommonSection containerStyle={{width:'100%', margin:0}} bodyStyle={{borderWidth:0, borderRadius:0, borderTopWidth:1, padding:0, alignItems:\"flex-start\"}}>\r\n            <Suspense fallback={<Text>{content.description.replaceAll(regexForStripHTML, '')}</Text>}>\r\n                <RenderHTML contentWidth={320} source={{'html':content.description}} baseStyle={{color:Colors[theme].text}}/>\r\n            </Suspense>\r\n        </CommonSection>\r\n    </View>\r\n})","import React from 'react';\r\nimport {View} from 'react-native'\r\nimport {Text} from './Themed';\r\nimport { ProfileProps } from '../types';\r\nimport Avatar from './Avatar';\r\n\r\nexport default (props:ProfileProps)=>{\r\n    return <View style={{width:'100%', height:135, justifyContent:'space-evenly', alignItems:'center'}}>\r\n        <Avatar {...props} size={75}/>\r\n        <Text style={{fontWeight:'bold', fontSize:15}}>{props.name}</Text>\r\n        <Text style={{fontWeight:'normal', fontSize:14}}>{props.username}</Text>\r\n    </View>\r\n}","import React, { useState } from 'react';\r\nimport { TextInput } from 'react-native';\r\nimport Colors from '../constants/Colors';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { CustomTextInputProps } from '../types';\r\n\r\nexport default (props:CustomTextInputProps)=>{\r\n    const [contentHeight, setContentHeight] = useState<number>()\r\n    const minHeight = props.minHeight || 30\r\n    const theme = useColorScheme()\r\n    return <TextInput style={[{\r\n            borderColor:'#d0d7de', \r\n            fontSize:16, \r\n            borderWidth:1, \r\n            borderRadius:6, \r\n            paddingHorizontal:10, \r\n            paddingVertical:3, \r\n            backgroundColor:Colors[theme].background,\r\n            color:Colors[theme].text,\r\n            height:props.multiline?contentHeight:minHeight,\r\n        }, props.style]}\r\n        placeholder={props.placeholder}\r\n        editable={!props.disabled} \r\n        keyboardType={props.keyboardType}\r\n        secureTextEntry={props.secureTextEntry}\r\n        value={props.value}\r\n        onChangeText={props.setValue}\r\n        onContentSizeChange={props.multiline?(e) => {\r\n            const newHeight = Math.max(e.nativeEvent.contentSize.height, minHeight) + 2\r\n            if(contentHeight==null || contentHeight +1 < newHeight){\r\n                setContentHeight(newHeight)\r\n            }\r\n        }:undefined}\r\n        \r\n        onBlur={()=>props.onBlur?.(props.value)}\r\n        onEndEditing={()=>props.onEndEditing?.(props.value)}\r\n        multiline={props.multiline}\r\n    />\r\n}","import React from 'react';\r\nimport { StyleProp, TextStyle } from 'react-native';\r\nimport { CustomTextInputProps } from '../types';\r\nimport CommonTextInput from './CommonTextInput';\r\nimport RowField from './RowField';\r\n\r\nexport default function TextField(props:CustomTextInputProps & {name: string, width?:any, textStyle?:StyleProp<TextStyle>}) {\r\n  return (\r\n    <RowField name={props.name} width={props.width} textStyle={props.textStyle}>\r\n      <CommonTextInput {...props} />\r\n   </RowField>\r\n  )\r\n}","import React from \"react\"\r\nimport CommonItem from \"./CommonItem\"\r\nimport { User } from \"../types\"\r\nimport Avatar from \"./Avatar\"\r\nimport { Text, View } from \"./Themed\"\r\n\r\nexport default ({member:item, onPress}:{member:User, onPress?:()=>void})=> {\r\n    return <CommonItem key={item.id} bodyStyle={{flexDirection:'row', justifyContent:'flex-start'}} onPress={onPress}>\r\n        <View style={{marginTop:4, marginRight:12}}><Avatar name={item.name} userId={item.id} size={44}/></View>\r\n        <Text style={{fontSize:20, fontWeight:'400'}}>{item.name}</Text>\r\n    </CommonItem>\r\n}","import React from 'react';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport CommonButton from '../components/CommonButton';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport { Text, View } from '../components/Themed';\r\nimport useLangContext from '../hooks/useLangContext';\r\nimport { BottomSheet } from '../components/ModalSection';\r\nimport useModalEffect from '../hooks/useModalEffect';\r\nimport RegistrationModal from './RegistrationModal';\r\n\r\n\r\nexport default function AlertModal({type}:{type:string}) {\r\n  const { lang } = useLangContext()\r\n  const { setModal } = useModalsContext()\r\n  const {auth, dispatch} = useAuthContext()\r\n  const back = ()=>{\r\n    setModal(AlertModal, null)\r\n  }\r\n  const messages = {\r\n    \"GUEST_LOGOUT\":{\r\n      message: 'Guest users cannot reconnect after logging out. Please create an account or log in.',\r\n      buttons:[\r\n        {\r\n          title: 'Create User',\r\n          onPress: ()=>{\r\n            setModal(RegistrationModal, {})\r\n          }\r\n        },\r\n        {\r\n          title: 'sign out',\r\n          onPress: ()=>dispatch({type:\"LOGOUT_REQUEST\"})\r\n        }\r\n      ]\r\n    }\r\n  } as Record<string, {message:string, buttons:{title:string, onPress:()=>void}[]}>\r\n\r\n  useModalEffect(back, [])\r\n  return <BottomSheet>\r\n    <Text>{lang(messages[type].message)}</Text>\r\n    <View style={{width:'100%', flexDirection:'row', justifyContent:'flex-end'}}>\r\n    {messages[type].buttons.map((button, i)=><CommonButton key={i} style={{marginRight:10}} title={lang(button.title)} onPress={button.onPress}/>)}\r\n    <CommonButton title={lang('cancel')} onPress={()=>back()}/>\r\n    </View>\r\n  </BottomSheet>\r\n}\r\n","import React, { useState,  useEffect, createContext, useMemo, useRef, useContext } from \"react\"\r\nimport firebase from \"firebase/app\";\r\nimport \"firebase/messaging\";\r\nimport {FCM_PUBLIC_VAPID_KEY, FCM_API_KEY} from \"../constants/Envs\"\r\nimport { Notification as NotificationType, User } from \"../types\";\r\nimport { getNotification, postNotification, putNotification } from \"../services/notification\";\r\n\r\nconst firebaseConfig = require(\"../../web/firebase-config.js\")\r\n// Initialize Firebase\r\nconst key = firebaseConfig.messagingSenderId\r\nconst apiKeyEncrypted = (FCM_API_KEY as string).split('').map((v, i)=> (v.charCodeAt(0) ^ key.charCodeAt(i)).toString(16).padStart(2, '0')).join('')\r\nconst app = firebase.initializeApp({...firebaseConfig, apiKey:FCM_API_KEY});\r\n// const analytics = getAnalytics(app);\r\nconst messaging = firebase.messaging(app);\r\n\r\nmessaging.onMessage((payload) => {\r\n  if (!(\"Notification\" in window)) {\r\n    alert(\"This browser does not support desktop notification\");\r\n  }\r\n  else if (Notification.permission === \"granted\") {\r\n    const message_set = JSON.parse(payload.data['message_set'])[0]\r\n    new Notification(payload.data.channel_name, { body: `${payload.data.name}: ${message_set.content}` });\r\n  }\r\n});\r\n\r\nconst requestToken = async()=>{\r\n  const permission = await Notification.requestPermission();\r\n  if (permission === 'granted') {\r\n    const serviceWorkerRegistration = await navigator.serviceWorker.register(`${process.env.PUBLIC_URL}/firebase-messaging-sw.js?${apiKeyEncrypted}`)\r\n    console.log('[SW]: SCOPE: ', serviceWorkerRegistration.scope);\r\n    const currentToken = await messaging.getToken({serviceWorkerRegistration, vapidKey: FCM_PUBLIC_VAPID_KEY }).catch(\r\n      async()=>await messaging.getToken({serviceWorkerRegistration, vapidKey: FCM_PUBLIC_VAPID_KEY })\r\n    )\r\n    window.addEventListener('beforeunload', (event:any) => {\r\n      event.preventDefault();\r\n      serviceWorkerRegistration.unregister()\r\n    });\r\n    if (currentToken)\r\n      return currentToken\r\n  }\r\n  return null\r\n}\r\n\r\nconst FirebaseContext = createContext<{enable?:boolean, setEnable:(enable:boolean)=>void}>({setEnable:()=>{}});\r\n\r\nexport const FirebaseProvider = ({user, children}:{user?:User|null, children:React.ReactNode})=>{\r\n  const tokenRef = useRef<string|null>()\r\n  const [notification, setNotification] = useState<NotificationType|null>()\r\n  const enable = useMemo(()=>notification===undefined?undefined:(notification?.token?true:false), [notification])\r\n  const setEnable = (enable:boolean)=>{\r\n    if(user && notification){\r\n      putNotification({...notification, token:enable?(tokenRef.current==undefined?null:tokenRef.current):null}).then((noti)=>{\r\n        setNotification(noti)\r\n      })\r\n    }\r\n  }\r\n  useEffect(()=>{\r\n    let isMount = true;\r\n    if(user){\r\n      if (tokenRef.current ===undefined){\r\n        tokenRef.current = null\r\n        requestToken().then((t)=>{\r\n          tokenRef.current = t\r\n          if (notification){\r\n            putNotification({...notification, token:tokenRef.current}).then((noti)=>{\r\n              if(isMount)setNotification(noti)\r\n            })\r\n          }\r\n        });\r\n      }\r\n      if (notification===undefined){\r\n        getNotification(user.id).then((noti)=>{\r\n          if(isMount)setNotification(noti || null)\r\n        })\r\n      }\r\n      else if(notification===null){\r\n        postNotification({user:user.id, type:'WEB', token:null}).then((noti)=>{\r\n          if(isMount)setNotification(noti)\r\n        })\r\n      }\r\n      else if (notification.token && tokenRef.current && tokenRef.current != notification.token){\r\n        putNotification({...notification, token:tokenRef.current}).then((noti)=>{\r\n          if(isMount)setNotification(noti)\r\n        })\r\n      }\r\n    }\r\n    return ()=>{isMount=false}\r\n  }, [user, notification])\r\n  return <FirebaseContext.Provider value={{enable, setEnable}}>\r\n    {(enable!=undefined || user===null) && children}\r\n  </FirebaseContext.Provider>\r\n}\r\n\r\nexport default ()=>{\r\n  const {enable, setEnable} = useContext(FirebaseContext)\r\n  return {enable, setEnable}\r\n}\r\n","import React, { MutableRefObject } from 'react'\r\nimport { Image, Linking } from \"react-native\"\r\nimport { TouchableOpacity } from \"react-native-gesture-handler\"\r\nimport CommonSection from \"../CommonSection\"\r\nimport { View, Text } from \"../Themed\"\r\nimport { Link } from \"../../types\"\r\n\r\n\r\n\r\nexport default ({link, isMobile, touchableRef}:{link:Link, isMobile:boolean, touchableRef:MutableRefObject<()=>boolean>})=>{\r\n    return <CommonSection containerStyle={{marginHorizontal:0}} bodyStyle={{padding:0}}>\r\n    <TouchableOpacity \r\n        onPress={()=>touchableRef.current() && Linking.openURL(link.url)}\r\n        onLongPress={()=>{}}\r\n        style={{width:'100%', flexDirection:'row'}}\r\n    >\r\n        {link.image_url?<Image source={{uri:link.image_url}} resizeMode=\"cover\" style={{ width:'100%', maxWidth:isMobile?120:150, maxHeight:isMobile?120:150, borderWidth:1}}/>:undefined}\r\n        <View style={{flex:1, marginHorizontal:20}}>\r\n            <Text style={{fontSize:18}}>{link.title}</Text>\r\n            <Text style={{fontSize:14}}>{link.description}</Text>\r\n            <Text style={{fontSize:12}}>{link.url}</Text>\r\n        </View>\r\n    </TouchableOpacity>\r\n    </CommonSection>\r\n}","import React, { MutableRefObject } from 'react'\r\nimport { Image, Linking } from \"react-native\"\r\nimport {TouchableOpacity} from \"react-native-gesture-handler\"\r\nimport CommonSection from \"../CommonSection\"\r\nimport { FontAwesome } from '../../lib/@expo/vector-icons'; \r\nimport { View, Text } from \"../Themed\"\r\nimport { File } from \"../../types\"\r\nimport useColorScheme from '../../hooks/useColorScheme';\r\nimport Colors from '../../constants/Colors';\r\n\r\nfunction humanFileSize(size:number) {\r\n    var i = size == 0 ? 0 : Math.floor(Math.log(size) / Math.log(1024));\r\n    return (size / Math.pow(1024, i)).toFixed(2) + ' ' + ['B', 'kB', 'MB', 'GB', 'TB'][i];\r\n  }\r\n  \r\n\r\nexport default ({file, isMobile, showBorder, touchableRef}:{file:File, isMobile:boolean, showBorder:ConstrainBoolean, touchableRef:MutableRefObject<()=>boolean>})=>{\r\n    const theme = useColorScheme()\r\n    return <CommonSection containerStyle={{marginHorizontal:0}} bodyStyle={showBorder?{padding:10}:{borderWidth:0, padding:0}}>\r\n    <TouchableOpacity \r\n        onPress={()=>touchableRef.current() && Linking.openURL(file.file)} \r\n        onLongPress={()=>{}}\r\n        style={{flexDirection:'row', alignItems:'flex-start', width:'100%'}} \r\n    >\r\n        {   file.thumbnail?\r\n            <Image source={{uri:file.thumbnail}} resizeMode=\"cover\" style={{width:isMobile?120:150, height:isMobile?120:150, borderWidth:1}}/>:\r\n            <FontAwesome name=\"file-o\" size={20} color={Colors[theme].iconColor} />}\r\n        <View style={{flex:1, marginHorizontal:10}}>\r\n            <Text style={{fontSize:18}}>{file.filename}</Text>\r\n            <Text style={{fontSize:14}}>{humanFileSize(file.filesize)}</Text>\r\n        </View>\r\n    </TouchableOpacity>\r\n    </CommonSection>\r\n}","import React, {useCallback, useMemo, useRef} from \"react\"\r\nimport { View, TouchableOpacity } from 'react-native';\r\nimport { FlatList } from \"react-native-gesture-handler\";\r\nimport { Auth } from \"../../hooks/useAuthContext\";\r\nimport useMessengerContentList, { MessengerContentPage } from \"../../hooks/lists/useMessengerContentList\"\r\nimport useIsMobile from \"../../hooks/useIsMobile\"\r\nimport useModalsContext from \"../../hooks/useModalsContext\"\r\nimport { Text } from '../Themed' \r\nimport Avatar from '../Avatar';\r\nimport LinkPreview from './LinkPreview';\r\nimport FilePreview from './FilePreview';\r\nimport MessageModal from '../../modals/MessageModal';\r\nimport CommonSection from \"../CommonSection\";\r\nimport { timerToString } from \"./TimerTags\";\r\nimport useViewerContentList from \"../../hooks/lists/useMessengerViewerList\";\r\nimport EditorPreview from \"./EditorPreview\";\r\nimport { MessengerContent } from \"../../types\";\r\nimport MessageContentView from \"./MessageContentView\";\r\nimport ProfileModal from \"../../modals/ProfileModal\";\r\n\r\nconst MessengerContentPageItem = React.memo((props:MessengerContentPage & {ownerId?:number, reverse?:boolean, getOnPress?:(content:MessengerContent)=>()=>void})=>{\r\n    const { setModal } = useModalsContext()\r\n    const lastTouchRef = useRef(Date.now()) \r\n    const touchableRef = useRef(()=>{\r\n      return Date.now() - lastTouchRef.current > 350\r\n    })\r\n    const isMobile = useIsMobile()\r\n    let nextPage = props.next;\r\n      while(nextPage?.next && nextPage.current.length==0){\r\n        nextPage = nextPage.next\r\n      }\r\n      const nextContent = nextPage?.current[0]\r\n      return <View \r\n        style={{flexDirection: props.reverse?'column-reverse':'column'}}\r\n        onTouchMove={()=>{lastTouchRef.current=Date.now()}}\r\n      >  \r\n        {props.current.map((content, index2)=>{\r\n          const next = index2 + 1 < props.current.length?props.current[index2+1]:nextContent\r\n          const created:string = content.created.slice(0, 16)\r\n          const date = created.slice(0, 10)\r\n          const isSystem = content.user == null\r\n          const isFirst = next==undefined || (content.user != next.user || created != next.created.slice(0, 16))\r\n          const isSelf = props.ownerId == content.user\r\n          const dayChanged = next==undefined || date != next.created.slice(0, 10)\r\n          const message = content.message_set[0]\r\n          const onProfile = ()=>setModal(ProfileModal, {id:content.user})\r\n          if (isSystem)\r\n            return <View key={content.id} style={{flexDirection:'row', justifyContent:'center', width:'100%', marginVertical:5}}>\r\n              <Text>{message.content}</Text>\r\n            </View>\r\n          return <View key={content.id}>\r\n            {dayChanged?<View style={{flexDirection:'row', justifyContent:'center', width:'100%'}}><Text>{date}</Text></View>:undefined}\r\n            <View key={content.id} style={{flexDirection:'row', justifyContent:isSelf?'space-between':'flex-start', width:'100%'}}>\r\n              {isFirst && !isSelf? <TouchableOpacity style={{marginTop:3, marginLeft:12}} onPress={onProfile} >\r\n                  <Avatar name={content.name} userId={content.user} size={36}/>\r\n                </TouchableOpacity>:\r\n                <View style={{width:48}}/>}\r\n              <CommonSection autoScale outerContainerStyle={{maxWidth:'90%'}} title={isFirst?content.name:undefined} titleStyle={{flex:undefined}} titleOnPress={isFirst?onProfile:undefined} bodyStyle={{padding:10}} subtitle={`${created.slice(11)}`}>\r\n                <TouchableOpacity onLongPress={props.getOnPress?.(content)}>\r\n                  {content.timer && <View style={{flexDirection:'row', alignItems:'stretch'}}>\r\n                    <Text style={{fontSize:12}}>⌚</Text>\r\n                    <Text style={{fontSize:12}} selectable={!isMobile}>{timerToString(content.timer)}</Text>\r\n                  </View>}\r\n                  <MessageContentView selectable={!isMobile} textStyle={{textAlign:isSelf?'right':'left'}} onPressLink={touchableRef.current()?undefined:()=>{}} content={message.content}/>\r\n                  {\r\n                    content.attatchment_set.map((attatchment, aIndex)=>{\r\n                      if (attatchment.type=='editor')\r\n                        return <EditorPreview key={aIndex} content={attatchment}/>\r\n                      if (attatchment.type=='file')\r\n                        return <FilePreview key={aIndex} file={attatchment} isMobile={isMobile} showBorder={false} touchableRef={touchableRef}/>\r\n                      if (attatchment.type=='link')\r\n                        return <LinkPreview key={aIndex} link={attatchment} isMobile={isMobile} touchableRef={touchableRef}/>\r\n                    })\r\n                  }\r\n                </TouchableOpacity>\r\n              </CommonSection>\r\n            </View>\r\n          </View>\r\n        })}\r\n      </View>\r\n  \r\n  })\r\n\r\nexport default (props:{channel_id:number, auth?:Auth, reverse?:boolean, sendToScreen?:(e:any)=>void})=>{\r\n    const height = useRef(0)\r\n    const {data, fetchNextPage } = props.auth?useMessengerContentList(props.channel_id):useViewerContentList(props.channel_id)\r\n    const ownerId = useMemo(()=>props.auth?.user?.id, [props.auth])\r\n    const { setModal } = useModalsContext()\r\n    const getOnPress = (content: MessengerContent)=>()=>setModal(MessageModal, {content, isOwner:ownerId == content.user, sendToScreen:props.sendToScreen})\r\n    const renderItem = useCallback(({item, index}:{item:MessengerContentPage, index:number})=><MessengerContentPageItem \r\n      {...item} \r\n      ownerId={ownerId} \r\n      reverse={props.reverse}\r\n      getOnPress={getOnPress}  \r\n    />, [ownerId])\r\n    return <FlatList\r\n        style={{flexDirection: props.reverse?'column-reverse':'column'}}\r\n        contentContainerStyle={{padding:10, flexGrow:1, flexDirection: props.reverse?'column-reverse':'column'}}\r\n        data={data?.pages}\r\n        renderItem={renderItem}\r\n        onScroll={(e)=>{\r\n          if (e.nativeEvent.contentSize.height - height.current + (props.reverse?1:-1)*e.nativeEvent.contentOffset.y < 1)\r\n            fetchNextPage()\r\n        }}\r\n        onLayout={(p)=>{height.current = p.nativeEvent.layout.height}}\r\n      />\r\n}","import { useInfiniteQuery } from \"react-query\"\r\nimport { getMessengerContentList } from \"../../services\"\r\nimport { MessengerContentPage } from \"./useMessengerContentList\"\r\n\r\n\r\nexport default function useViewerContentList(channel_id:number){  \r\n  const { data, fetchNextPage } = useInfiniteQuery<MessengerContentPage>(\r\n    [\"ViewerContentList\", channel_id], \r\n    async({pageParam})=>getMessengerContentList(channel_id, pageParam, true).then(current=>({current})), \r\n    {\r\n      select:data=>{\r\n        if(data.pages.length > 1)\r\n          data.pages[data.pages.length - 2].next = data.pages[data.pages.length - 1]\r\n        return data;\r\n      },\r\n      getNextPageParam:(lastPage)=>lastPage?.current.length?lastPage.current[lastPage.current.length - 1].id:undefined,\r\n      refetchOnReconnect:false,\r\n      refetchOnWindowFocus:false,\r\n    }\r\n  )\r\n  return { data, fetchNextPage }\r\n}\r\n","import React, {useState, useEffect} from \"react\"\r\nimport dayjs from \"dayjs\";\r\nimport {View, TouchableOpacity} from 'react-native'\r\nimport { Text } from \"../Themed\";\r\nimport useTimerMessageContentList from \"../../hooks/lists/useTimerMessageContent\";\r\nimport { MessengerContent } from \"../../types\";\r\nimport Avatar from \"../Avatar\";\r\nimport MessageContentView from \"./MessageContentView\";\r\n\r\nexport function timerFormat(datetime:string){\r\n    return _timerFormat(dayjs(datetime), dayjs())\r\n}\r\n\r\nfunction _timerFormat(m:dayjs.Dayjs, now:dayjs.Dayjs){\r\n    if (m.year() != now.year()){\r\n        return m.format('YYYY.MM')\r\n    }\r\n    if(m.month()!= now.month() || m.date() != now.date()){\r\n        return m.format('MM.DD')\r\n    }\r\n    return m.format('HH:mm')\r\n  }\r\n\r\nexport function timerToString(timer:string){\r\n    return dayjs(timer).format('YYYY.MM.DD HH:mm')\r\n}\r\n\r\nconst TimerTag = (props:{data:MessengerContent, now:dayjs.Dayjs, isExpand:boolean, setExpand:(id?:number)=>void})=>{\r\n    const start = dayjs(props.data.created)\r\n    const end = dayjs(props.data.timer)\r\n    const ratio = (start.diff(props.now)/start.diff(end))\r\n    const message = props.data.message_set[0]\r\n    return <TouchableOpacity onPress={()=>props.setExpand(props.isExpand?undefined:props.data.id)}>\r\n        <View style={{backgroundColor:'lightgray', borderRadius:20, overflow:'hidden', margin:5}}>\r\n            <View style={{backgroundColor:'darkgray', position:'absolute', width:`${ratio*100}%`, height:'100%'}}/>\r\n            {props.isExpand?\r\n            <View style={{paddingVertical:5, paddingHorizontal:5, maxWidth:270}}>\r\n                <View style={{flexDirection:'row'}}>\r\n                    <Avatar name={props.data.name} userId={props.data.user} size={20}/>\r\n                    <View style={{paddingHorizontal:5}}><Text>{props.data.name}</Text></View>\r\n                </View>\r\n                {props.data.timer &&\r\n                <View style={{flexDirection:'row', alignItems:'stretch'}}>\r\n                    <Text>⌚</Text>\r\n                    <Text selectable>{timerToString(props.data.timer)}</Text>\r\n                </View>}\r\n                {/* @ts-ignore */}\r\n                <MessageContentView selectable content={message.preview_content || message.content}/>\r\n            </View>:    \r\n            <View style={{paddingVertical:5, paddingHorizontal:5, flexDirection:'row'}}>\r\n                <Avatar name={props.data.name} userId={props.data.user} size={20}/>\r\n                <View style={{paddingHorizontal:5}}><Text>{_timerFormat(end, props.now)}</Text></View>\r\n            </View>}\r\n        </View>\r\n    </TouchableOpacity>\r\n}\r\n\r\n\r\nexport default (props:{channel_id:number})=>{\r\n    const timerMessages = useTimerMessageContentList(props.channel_id)\r\n    const [now, setNow] = useState(dayjs())\r\n    const [expand, setExpand] = useState<number>()\r\n    useEffect(()=>{\r\n        const timeout = setTimeout(()=>{\r\n            setNow(dayjs())\r\n        }, 2000)\r\n        return ()=>clearTimeout(timeout)\r\n    }, [now])\r\n    return <View style={{flexDirection:'row', paddingTop:5, paddingHorizontal:20}}>\r\n        {timerMessages?.map((v,i)=><TimerTag key={i} data={v} now={now} isExpand={v.id==expand} setExpand={setExpand}/>)}\r\n    </View>\r\n}","import { useEffect, useMemo } from \"react\"\r\nimport { useQuery, useQueryClient } from \"react-query\"\r\nimport { getTimerMessageContentList } from \"../../services\"\r\nimport { MessengerContent } from \"../../types\"\r\nimport useWebsocketContext from \"../useWebsocketContext\"\r\nimport dayjs from \"dayjs\"\r\n\r\nexport default function useTimerMessageContentList(channel_id:number){  \r\n  const queryClient = useQueryClient()\r\n  const { data } = useQuery<MessengerContent[]>(\r\n    [\"TimerMessageContentList\", channel_id], \r\n    async()=>await getTimerMessageContentList(channel_id, dayjs().toISOString()), \r\n    {\r\n      refetchOnReconnect:false,\r\n      refetchOnWindowFocus:false\r\n    }\r\n  )\r\n  const { lastJsonMessage } = useWebsocketContext()\r\n  useEffect(()=>{\r\n    if(lastJsonMessage !=null && lastJsonMessage['data']['channel'] == channel_id){\r\n      if(lastJsonMessage['type']=='next_message'){\r\n        if(lastJsonMessage['data']['timer'] && dayjs() < dayjs(lastJsonMessage['data']['timer']))\r\n          queryClient.setQueryData<MessengerContent[]>([\"TimerMessageContentList\", channel_id], (_data)=>{\r\n            return [...(_data || []), lastJsonMessage['data']]\r\n          })\r\n      }\r\n      if(lastJsonMessage['type']=='update_message'){\r\n        queryClient.setQueryData<MessengerContent[]>([\"TimerMessageContentList\", channel_id], (_data)=>{\r\n          return [...(_data?.filter(v=>v.id!=lastJsonMessage['data'].id || (lastJsonMessage['data']['timer']!=null && !lastJsonMessage['data']['is_archive'])) || [])]\r\n        })\r\n      }\r\n    }\r\n  }, [lastJsonMessage])\r\n  const sorted = useMemo(()=>data?.sort((a, b)=>(a.timer || '') > (b.timer || '')?1:-1), [data])\r\n  useEffect(()=>{\r\n    if (sorted?.[0]?.timer){\r\n      const id = sorted[0].id\r\n      const ms = Math.min(dayjs(sorted[0].timer).diff(dayjs()), Number.MAX_VALUE)\r\n      let timeout = setTimeout(()=>{\r\n        queryClient.setQueryData<MessengerContent[]>([\"TimerMessageContentList\", channel_id], (_data)=>{\r\n          return (_data || []).filter(v=>v.id!=id || dayjs(v.timer).diff(dayjs()) > 0)\r\n        })\r\n      }, ms)\r\n      return ()=>clearTimeout(timeout)\r\n    }\r\n  },[sorted])\r\n  return sorted\r\n}\r\n","import { useEffect } from \"react\"\r\nimport { navigate } from \"../navigation\"\r\nimport useMessengerChannelList from \"./lists/useMessengerChannelList\"\r\nimport { useMessengerMemberMutation } from \"./lists/useMessengerMemberList\"\r\nimport useAuthContext from \"./useAuthContext\"\r\n\r\nlet invitee_id:number|undefined\r\nlet invitee_state:0|1|2=0\r\n\r\nexport const replaceInviteeState = (l:Location)=>{\r\n    if(l !==undefined && l.pathname.endsWith('/invitee')){\r\n        var params = l.search.slice(1).split('&').filter(v=>v.startsWith('id='))\r\n        if (params.length>0)\r\n            invitee_id = parseInt(params[0].split('=')[1])\r\n        window.history.replaceState(null, '', l.href.split('invitee')[0]\r\n        );\r\n    }\r\n}\r\n\r\nexport default ()=>{\r\n    const {auth} = useAuthContext()\r\n    const channelList = useMessengerChannelList(\"messenger\", auth)\r\n    const messengerMemberMutation = useMessengerMemberMutation()\r\n    useEffect(()=>{\r\n        if (auth.user){\r\n            if (invitee_id && channelList){\r\n                var id = invitee_id;\r\n                var redirect = ()=>navigate(\"Main\", {screen:\"ChatScreen\", params: {id}})\r\n                invitee_id = undefined;\r\n                invitee_state = 1;\r\n                if(channelList.find(v=>v.id==id) === undefined){\r\n                    console.log(`invite processing (channel:${id})`)\r\n                    messengerMemberMutation.invite({\r\n                        channel_id:id,\r\n                        user_ids:[auth.user.id]\r\n                    }).then(redirect)\r\n                }\r\n                else{\r\n                    console.log('already invite')\r\n                    redirect()\r\n                }\r\n            }\r\n        }\r\n        else{\r\n            if (invitee_state == 1){\r\n                invitee_state=2\r\n            }\r\n        }\r\n    }, [auth, channelList])\r\n    useEffect(()=>{\r\n        if(auth.user && invitee_state==2){\r\n            navigate(\"Main\", {screen:\"HomeScreen\"})\r\n        }\r\n    }, [auth.user])\r\n}","editorConfig = {\r\n    plugins: 'image link charmap advlist lists paste', //autoresize textcolor imagetools,\r\n    toolbar: 'fontsizeselect | bold italic underline strikethrough | undo redo | alignleft aligncenter alignright | bullist numlist | link', // charmap removeformat\r\n    setup: (editor)=>{\r\n    }\r\n}\r\nif (typeof module !== 'undefined') {\r\n    module.exports = editorConfig\r\n}\r\n","firebaseConfig = {\n    \"authDomain\": \"virtual-metrics-355712.firebaseapp.com\",\n    \"projectId\": \"virtual-metrics-355712\",\n    \"storageBucket\": \"virtual-metrics-355712.appspot.com\",\n    \"messagingSenderId\": \"76003576924\",\n    \"appId\": \"1:76003576924:web:c8c8a006d07918bbc02a99\",\n    \"measurementId\": \"G-SEL35L4N5R\"\n}\nif (typeof module !== 'undefined') {\n    module.exports = firebaseConfig\n}\n","/**\r\n * Learn more about deep linking with React Navigation\r\n * https://reactnavigation.org/docs/deep-linking\r\n * https://reactnavigation.org/docs/configuring-links\r\n */\r\n\r\nimport { LinkingOptions } from '@react-navigation/native';\r\nimport * as Linking from 'expo-linking';\r\nimport {main, login, modal} from '../screens';\r\n\r\nconst ROOTPATH = 'tokki-tok'  // github repository name\r\n\r\nObject.values(modal).forEach(v=>v.path = ROOTPATH + '/' + v.path)\r\n\r\nexport default  {\r\n  prefixes: [Linking.makeUrl('/')],\r\n  config: {\r\n    screens: {\r\n      Main: {\r\n        screens:{\r\n          ...main,\r\n          ...login,\r\n          NotFound: '*',\r\n        },\r\n        path: ROOTPATH\r\n      },\r\n      ...modal\r\n    },\r\n  },\r\n} as LinkingOptions;\r\n"],"sourceRoot":""}