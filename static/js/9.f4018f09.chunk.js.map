{"version":3,"sources":["web/editor-config.js","web/firebase-config.js","src/navigation/LinkingConfiguration.ts","src/screens/NotFoundScreen.tsx","src/navigation/Drawer.tsx","src/modals/index.ts","src/navigation/MainNavigator.tsx","src/hooks/lists/useMessengerChannelList.ts","src/navigation/index.tsx","src/hooks/lists/useUserMembershipList.ts","src/hooks/lists/useMessengerMemberList.ts","src/components/TextButton.tsx","src/modals/ChannelEditModal.tsx","src/modals/RegistrationModal.tsx","src/components/HeaderRight.tsx","src/components/RowField.tsx","src/components/TabView.tsx","src/components/CommonItem.tsx","src/modals/ProfileModal.tsx","src/components/ContractFooter.tsx","src/screens/main/LoginScreen.tsx","src/lib/react-native-webrtc/useWebsocketContext.tsx","src/lib/react-native-webrtc/webrtc/p2p.tsx","src/lib/react-native-webrtc/webrtc/index.ts","src/lib/react-native-webrtc/LocalCam.tsx","src/lib/react-native-webrtc/RemoteCam.tsx","src/screens/main/ChatScreen/VideoCallSection.tsx","src/screens/main/ChatScreen/UploadTags.tsx","src/lib/tinymce/Editor.tsx","src/components/Editor.tsx","src/screens/main/HomeScreen/ConfigSections.tsx","src/screens/main/HomeScreen/index.tsx","src/screens/index.ts","src/screens/main/ChatScreen/index.tsx","src/screens/main/DemoScreen.tsx","src/modals/AlertModal.tsx","src/hooks/lists/useExternalMembershipList.ts","src/components/TextField.tsx","src/components/CommonTextInput.tsx","src/components/MemberItem.tsx","src/modals/DateTimePickerModal.tsx","src/components/Profile.tsx","src/hooks/useFirebaseContext.tsx","src/hooks/useLocalSearch.ts","src/components/CopyField.tsx","src/modals/InviteModal.tsx","src/hooks/useInvitee.ts"],"names":["editorConfig","plugins","toolbar","setup","editor","module","exports","firebaseConfig","Object","values","modal","forEach","v","path","ROOTPATH","prefixes","Linking","config","screens","_objectSpread","Main","main","login","NotFound","NotFoundScreen","_ref","navigation","lang","useLangContext","auth","useAuthContext","_jsxs","View","style","styles","container","children","_jsx","Text","title","TouchableOpacity","onPress","replace","user","link","linkText","StyleSheet","create","flex","backgroundColor","alignItems","justifyContent","padding","fontSize","fontWeight","marginTop","paddingVertical","color","MemberTabView","setModal","useModalsContext","userList","useUserMembershipList","map","item","index","CommonItem","containerStyle","marginHorizontal","bodyStyle","ProfileModal","id","marginLeft","name","MessengerTabView","channelList","useMessengerChannelSorted","avatarFromChannel","navigate","colors","useTheme","theme","useColorScheme","windowType","useResizeContext","_useState","useState","_useState2","_slicedToArray","setIndex","onAddList","_auth$user","RegistrationModal","is_guest","ChannelEditModal","type","drawerTabs","Colors","iconColor","MemberTab","component","icon","MaterialCommunityIcons","size","marginBottom","ChatTab","Ionicons","getDrawerTabs","useEffect","undefined","length","tabBar","background","borderTopColor","border","width","pointerEvents","_Fragment","Profile","userId","username","flexDirection","TextButton","textStyle","borderRadius","accessibilityRole","content","keys","TabView","tabs","tabBarPosition","onTab","borderTopWidth","borderColor","drawerTab","Tab","elevation","borderRightWidth","tab","label","textAlign","InviteModal","AlertModal","DateTimePickerModal","MessageModal","createStackNavigator","isMobile","useIsMobile","_useLangContext","locale","entries","useMemo","console","log","modalValues","modals","backgroundStyle","UploadContextProvider","ModalsProvider","Drawer","WebSocketProvider","disable","FirebaseProvider","Navigator","screenOptions","route","headerStyle","header","height","headerTitleStyle","text","headerLeft","canGOBackScreen","findIndex","goBack","canGoBack","disabled","CommonButton","buttonBackgroundColor","hoverColor","margin","paddingHorizontal","headerRight","HeaderRight","headerLeftContainerStyle","borderBottomWidth","headerBottomColor","cardStyle","flexShrink","animationEnabled","cardStyleInterpolator","CardStyleInterpolators","forHorizontalIOS","_ref2","_ref3","key","screen","Screen","options","useMessengerChannelList","queryClient","useQueryClient","lastJsonMessage","useWebsocketContext","data","useQuery","_asyncToGenerator","getMessengerChannelList","setQueryData","_data","find","concat","_toConsumableArray","sort","a","b","_data2$message_set$","channel","last_message","message_set","created","_a$last_message","_b$last_message","useMessengerChannelMutation","useMutation","postChannel","onSuccess","invalidateQueries","update","putChannel","direct","postDirectChannel","mutateAsync","enableScreens","electronVersion","navigationRef","React","params","_navigationRef$curren","_navigationRef$curren2","current","_process","_process$versions","process","versions","e","Navigation","defaultColorScheme","useDefaultColorScheme","userColorScheme","colorScheme","NavigationContainer","ref","documentTitle","formatter","linking","LinkingConfiguration","DarkTheme","DefaultTheme","ResizeContextProvider","RootNavigator","Root","useInvitee","mode","headerMode","forVerticalIOS","MainNavigator","headerShown","gestureDirection","replaceInviteeState","window","location","IGNORE_WERNINGS","warnLogger","warn","message","some","includes","groupId","getUserMembershipList","useUserMembershipMutation","_useAuthContext","dispatch","_create","postUser","_update","patchUser","password","_delete","deleteUser","_auth$user2","delete","useMessengerMemberList","channel_id","getMessengerMemberList","useMessengerMemberMutation","invite","postBulkMessengerMember","leave","deleteMessengerMember","props","borderWidth","member_id","channelMutation","messengerMemberMutation","setName","_useState3","_useState4","description","setDescription","back","_name","useModalEffect","ModalSection","separator","lightColor","darkColor","TextField","value","setValue","multiline","then","newChannel","owner","group","field","ErrorView","form_error","form_error_text","setUsername","_useState5","_useState6","setPassword","_useState7","_useState8","checkPassword","setCheckPassword","_useState9","_useState10","isStaff","_useState11","_useState12","error","setError","externalMemberList","useExternalMembershipList","userMembershipMutation","usernameDisable","RowField","CommonTextInput","keyboardType","secureTextEntry","newError","test","is_staff","inviteGroupId","textAlignVertical","defaultButtonProps","buttonProps","extra","filter","k","rowStyle","_React$useState","_React$useState2","icons","assign","apply","_defineProperty","renderTabBar","TabBar","indicatorStyle","activeColor","inactiveColor","renderIcon","scene","onTabPress","_ref4","_ref5","navigationState","routes","_ref6","_ref7","onIndexChange","renderScene","SceneMap","_ref8","_ref9","press","setPress","Pressable","outerContainer","outerContainerStyle","onPressIn","onPressOut","bodyView","maxWidth","minHeight","isSelf","BottomSheet","_auth$user3","subowner","openURL","Platform","OS","url","href","Styles","footer_buttons","footer_button","AntDesign","paddingBottom","paddingRight","login_container","login_header","paddingTop","login_header_logo","resizeMode","login_header_text","login_header_text_bold","login_wrapper","borderTopRightRadius","borderTopLeftRadius","form","form_input","button","button_label","login_social","login_social_separator","login_social_separator_line","login_social_separator_text","login_social_buttons","login_social_button","login_social_icon","login_social_facebook","login_footer_text","guest_footer_text","alignSelf","login_footer_link","WebSocketContext","createContext","sendJsonMessage","WebSocketInternalProvider","Context","useBackground","useContext","TURN_SERVER","peerConstraints","iceServers","JSON","parse","urls","sessionConstraints","mandatory","OfferToReceiveAudio","OfferToReceiveVideo","VoiceActivityDetection","mediaConstraints","audio","video","framerate","onICEcandidate","pc","_message","rtcMessage","candidate","RTCIceCandidate","addIceCandidate","sendICEcandidate","event","sendMessage","receiver","target","createOffer","pcRefCurrent","stream","addStream","offerDescription","arr","sdp","split","str","i","RTCSessionDescription","join","optimizeSdp","setLocalDescription","_x","_x2","_x3","_x4","_x5","arguments","camStyle","cam","bottonContainer","position","bottom","buttonBar","_props$user","_useWebsocketContext","_useLocalCam","pcRef","useRef","sender","setSender","_stream","setStream","isPlay","CustomRTCView","useCallback","memo","RTCView","videoProps","start","newStream","mediaDevices","getUserMedia","getDisplayMedia","catch","_x6","_x7","_x8","stop","getTracks","track","websocketOnMessage","_websocketOnMessage","response","channel_name","peerConnection","RTCPeerConnection","addEventListener","answerDescription","setRemoteDescription","_x9","_x10","useLocalCam","Button","setReceiver","_useRemoteCam","setUser","close","clearInterval","statsInterval","_websocketOnMessage2","_pcRef$current","_pcRef$current2","_pcRef$current3","_pcRef$current4","iceConnectionState","activeStream","setInterval","stats","getStats","statsOutput","framePerSecond","report","kind","statName","framesPerSecond","Date","toTimeString","addTransceiver","direction","streams","getRemoteStreams","createAnswer","localDescription","_x11","useRemoteCam","TextInput","onChangeText","VideoView","scale","maxHeight","flexGrow","focusGuest","setFocusGuest","VideoCallContainer","setDisable","videoMode","setVideoMode","guests","setGuests","_useRtcContext","useRtcContext","Math","max","ceil","sqrt","toggleVideoMode","ThemedView","aspectRatio","borderLeftWidth","flexWrap","RemoteCam","LocalCam","RtcProvider","UploadTag","overflow","progress","filename","upload","useUploadContext","expand","setExpand","uploadData","f","isExpand","INIT","require","Editor","tinymceScriptSrc","onInit","onReady","onEditorChange","init","skin","content_css","menubar","branding","statusbar","block_formats","fontsize_formats","ready","setReady","active","ConfigSection","CommonSection","setLocale","configTheme","useConfigColorScheme","_useFirebaseContext","useFirebaseContext","noti","enable","setNoti","setEnable","n","textDecorationLine","l","setColorScheme","paddingLeft","memberItem","MemberItem","member","ScrollView","today","toISOString","slice","_item$last_message","_item$last_message2","_item$last_message3","_item$last_message4","_avatarFromChannel","avatar","date","preview_content","marginRight","Avatar","FontAwesome","opacity","member_count","replaceAll","unread_count","ConfigTabView","ConfigSections","getBottomTabs","OneTab","TwoTab","FourTab","SimpleLineIcons","HomeScreen","_route$params2","home","setHome","useLayoutEffect","_route$params","setOptions","contentContainerStyle","StyledText","ContractFooter","parseInt","setParams","ChatScreen","_useMessengerChannelL","inputRef","channelAvatar","memberList","_memberList$find","editorValue","setEditorValue","timer","setTimer","autoFocus","setAutoFocus","bottomTab","setBottomTab","_useState13","_useState14","isEditor","setIsEditor","_useState15","_useState16","messageEvent","sendToScreen","valueLines","postValue","contentMutation","useMessengerContentMutation","_auth$user4","focus","timeout","setTimeout","clearTimeout","minWidth","VideoCallSection","d","Messages","reverse","UploadTags","TimerTags","borderBottomRightRadius","top","Entypo","timerFormat","datetime","callback","onKeyPress","shiftKey","preventDefault","onFocus","numberOfLines","borderBottomLeftRadius","Promise","resolve","reject","input","document","createElement","onchange","files","onabort","onerror","click","_auth$user5","file","LoginScreen","_login","placeholder","autoCapitalize","onSubmitEditing","DemoScreen","messages","keyword","getExternalMembershipList","contentHeight","setContentHeight","editable","onContentSizeChange","nativeEvent","contentSize","onBlur","onEndEditing","dayTypes","hours","Array","toString","padStart","minutes","getDisableDays","startDate","clone","startOf","add","endDate","endOf","dayjs","result","push","format","Calendar","lazy","CommonPicker","_dayjs","m","restMinute","defaultDayjs","setDate","dayType","setDayType","hour","setHour","minute","setMinute","disableDays","setDisableDays","Suspense","fallback","disableAllTouchEventsForDisabledDays","onMonthChange","dateString","markedDates","reduce","p","c","selected","messagingSenderId","apiKeyEncrypted","FCM_API_KEY","charCodeAt","app","firebase","initializeApp","apiKey","messaging","onMessage","payload","Notification","permission","body","alert","requestToken","requestPermission","serviceWorkerRegistration","navigator","serviceWorker","register","scope","currentToken","getToken","vapidKey","FCM_PUBLIC_VAPID_KEY","unregister","FirebaseContext","tokenRef","notification","setNotification","token","isMount","t","putNotification","getNotification","postNotification","Provider","_useContext","localSearchReducer","initialState","action","Error","CopyField","copied","setCopied","Clipboard","setString","InviteItem","selectedRef","has","setSelected","GroupTabView","_useLocalSearch","compare","_useReducer","useReducer","_useReducer2","searchState","useLocalSearch","memberSet","Set","dispatchKeyword","FlatList","renderItem","user_ids","ExternalMembershipTabView","setKeyword","timeoutRef","inviteLink","marginVertical","external","invitee_id","invitee_state","pathname","endsWith","search","startsWith","history","replaceState","redirect"],"mappings":"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","file":"static/js/9.f4018f09.chunk.js","sourcesContent":["editorConfig = {\n    plugins: 'image link charmap advlist lists paste', //autoresize textcolor imagetools,\n    toolbar: 'fontsizeselect | bold italic underline strikethrough | undo redo | alignleft aligncenter alignright | bullist numlist | link', // charmap removeformat\n    setup: (editor)=>{\n    }\n}\nif (typeof module !== 'undefined') {\n    module.exports = editorConfig\n}\n","firebaseConfig = {\n    \"authDomain\": \"virtual-metrics-355712.firebaseapp.com\",\n    \"projectId\": \"virtual-metrics-355712\",\n    \"storageBucket\": \"virtual-metrics-355712.appspot.com\",\n    \"messagingSenderId\": \"76003576924\",\n    \"appId\": \"1:76003576924:web:c8c8a006d07918bbc02a99\",\n    \"measurementId\": \"G-SEL35L4N5R\"\n}\nif (typeof module !== 'undefined') {\n    module.exports = firebaseConfig\n}\n","/**\n * Learn more about deep linking with React Navigation\n * https://reactnavigation.org/docs/deep-linking\n * https://reactnavigation.org/docs/configuring-links\n */\n\nimport { LinkingOptions } from '@react-navigation/native';\nimport * as Linking from 'expo-linking';\nimport {main, login, modal} from '../screens';\n\nconst ROOTPATH = 'tokki-tok'  // github repository name\n\nObject.values(modal).forEach(v=>v.path = ROOTPATH + '/' + v.path)\n\nexport default  {\n  prefixes: [Linking.makeUrl('/')],\n  config: {\n    screens: {\n      Main: {\n        screens:{\n          ...main,\n          ...login,\n          NotFound: '*',\n        },\n        path: ROOTPATH\n      },\n      ...modal\n    },\n  },\n} as LinkingOptions;\n","import { StackScreenProps } from '@react-navigation/stack';\nimport * as React from 'react';\nimport { StyleSheet, Text, TouchableOpacity, View } from 'react-native';\nimport useAuthContext from '../hooks/useAuthContext';\nimport useLangContext from '../hooks/useLangContext';\n\nexport default function NotFoundScreen({\n  navigation,\n}: StackScreenProps<any, 'NotFound'>) {\n  const { lang } = useLangContext()\n  const { auth } = useAuthContext()\n  return (\n    <View style={styles.container}>\n      <Text style={styles.title}>{lang(\"This screen doesn't exist.\")}</Text>\n      <TouchableOpacity onPress={() => navigation.replace(auth.user?'HomeScreen':'LoginScreen')} style={styles.link}>\n        <Text style={styles.linkText}>{lang(\"Go to home screen!\")}</Text>\n      </TouchableOpacity>\n    </View>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    backgroundColor: '#fff',\n    alignItems: 'center',\n    justifyContent: 'center',\n    padding: 20,\n  },\n  title: {\n    fontSize: 20,\n    fontWeight: 'bold',\n  },\n  link: {\n    marginTop: 15,\n    paddingVertical: 15,\n  },\n  linkText: {\n    fontSize: 14,\n    color: '#2e78b7',\n  },\n});\n","import { useTheme } from '@react-navigation/native';\nimport React, { useEffect, useState } from 'react';\nimport { View, StyleSheet } from 'react-native';\nimport Profile from '../components/Profile';\nimport TextButton from '../components/TextButton';\nimport Colors from '../constants/Colors';\nimport useResizeContext from '../hooks/useResizeContext';\nimport TabView from '../components/TabView';\nimport { TabViewRecord, UserMembership } from '../types';\nimport useModalsContext from '../hooks/useModalsContext';\nimport ChannelEditModal from '../modals/ChannelEditModal';\nimport CommonItem from '../components/CommonItem';\nimport { Text } from '../components/Themed';\nimport useAuthContext, { Auth } from '../hooks/useAuthContext';\nimport { useMessengerChannelSorted } from '../hooks/lists/useMessengerChannelList';\nimport { navigate } from '.'\nimport { avatarFromChannel } from '../components/Avatar';\nimport useColorScheme from '../hooks/useColorScheme';\nimport { Ionicons, MaterialCommunityIcons } from '../lib/@expo/vector-icons';\nimport RegistrationModal from '../modals/RegistrationModal';\nimport useUserMembershipList from '../hooks/lists/useUserMembershipList';\nimport ProfileModal from '../modals/ProfileModal';\n\n\nconst MemberTabView = ()=>{\n  const {auth} = useAuthContext()\n  const { setModal } = useModalsContext()\n  const userList = useUserMembershipList(auth)\n  return <View style={{flex:1}}>\n    {userList?.map((item, index)=>{\n      return <CommonItem key={index} containerStyle={{marginHorizontal:0}} bodyStyle={{alignItems:'flex-start'}} onPress={()=>setModal(ProfileModal, {id:item.id})}>\n        <Text style={{marginLeft:20}}>{item.name}</Text>\n      </CommonItem>\n    })}\n  </View>\n}\n\nconst MessengerTabView = ()=>{\n  const {auth} = useAuthContext()\n  const channelList = useMessengerChannelSorted(auth);\n  return <View style={{flex:1}}>\n    {channelList?.map((item, index)=>{\n      const {name} = avatarFromChannel(item, auth.user)\n      return <CommonItem key={index} containerStyle={{marginHorizontal:0}} bodyStyle={{alignItems:'flex-start'}} onPress={()=>navigate(\"ChatScreen\", {id:item.id})}>\n        <Text style={{marginLeft:20}}>{name}</Text>\n      </CommonItem>\n    })}\n  </View>\n}\nconst getDrawerTabs = (theme:'light'|'dark')=>{\n  const color = Colors[theme].iconColor\n  return {\n    MemberTab:{\n      title:'member',\n      component:MemberTabView,\n      icon:<MaterialCommunityIcons size={32} color={color} style={{ marginBottom: -3 }} name='account'/>,\n    },\n    ChatTab:{\n        title:'chat',\n        component:MessengerTabView,\n        icon:<Ionicons size={30} color={color} style={{ marginBottom: -3 }} name='chatbox'/>\n    },\n  } as TabViewRecord\n}\n\nexport default ({auth}:{auth:Auth})=> {\n  const { colors } = useTheme();\n  const theme = useColorScheme();\n  const windowType = useResizeContext();\n  const channelList = useMessengerChannelSorted(auth);\n  const [index, setIndex] = useState<number>();\n  const { setModal } = useModalsContext()\n  \n  const onAddList = [\n    ()=>setModal(RegistrationModal, auth.user?.is_guest?{id:auth.user.id}:{}),\n    ()=>setModal(ChannelEditModal, {type:'messenger'}),\n  ]\n  const drawerTabs = getDrawerTabs(theme)\n\n  useEffect(()=>{\n    if(index===undefined && channelList){\n      setIndex(channelList.length>0?1:0)\n    }\n  }, [channelList])\n  return <View style={windowType=='landscape'?[\n      styles.tabBar,\n      {\n        backgroundColor: Colors[theme].background,\n        borderTopColor: colors.border,\n      },\n      // tabBarStyle,\n    ]:{width:0}}\n    pointerEvents={false ? 'none' : 'auto'}\n  >\n    {windowType=='landscape' && auth.user && index!==undefined && <>\n      <Profile userId={auth.user.id} username={auth.user.username} name={auth.user.name}/>\n      <View style={{flexDirection:'row-reverse'}}>\n          <TextButton title='+' textStyle={{fontSize:20}} style={{borderRadius:20}} onPress={onAddList[index]}/>\n      </View>\n      <View accessibilityRole=\"tablist\" style={styles.content}>\n        {Object.keys(drawerTabs).length>1 ? \n          <TabView tabs={drawerTabs} tabBarPosition={\"top\"} onTab={setIndex} index={index}/>: \n          <View style={{borderTopWidth:1, flex:1, borderColor:colors.border}}>            \n            {Object.values(drawerTabs).map(drawerTab=>{const Tab = drawerTab.component; return <Tab key={drawerTab.title}/>})}\n          </View>\n        }\n      </View>\n    </>}\n  </View>\n}\n\n{/*<Text style={[styles.label, { color: d.isFocused ? colors.primary : '#222' }]}></Text> */}\n\nconst styles = StyleSheet.create({\n    tabBar: {\n      width:240,\n      elevation: 8,\n      borderRightWidth:1,\n      borderColor:Colors.borderColor\n    },\n    content: {\n      flex: 1,\n      flexDirection: 'row',\n    },\n    tab: {\n        flex: 1,\n        alignItems: 'center',\n    },\n    label: {\n        textAlign: 'center',\n        backgroundColor: 'transparent',\n      },\n  });","import InviteModal from \"./InviteModal\";\nimport ProfileModal from \"./ProfileModal\";\nimport ChannelEditModal from \"./ChannelEditModal\"\nimport AlertModal from \"./AlertModal\";\nimport DateTimePickerModal from \"./DateTimePickerModal\"\nimport MessageModal from \"./MessageModal\";\nimport RegistrationModal from \"./RegistrationModal\";\n\nexport default [\n    InviteModal,\n    ProfileModal,\n    ChannelEditModal,\n    AlertModal,\n    DateTimePickerModal,\n    MessageModal,\n    RegistrationModal\n]","import { CardStyleInterpolators, createStackNavigator } from '@react-navigation/stack';\nimport React, {useMemo} from 'react';\nimport { View } from 'react-native';\nimport { Ionicons } from '../lib/@expo/vector-icons';\nimport useResizeContext from '../hooks/useResizeContext';\nimport NotFoundScreen from '../screens/NotFoundScreen';\nimport {main, login} from '../screens';\nimport Drawer from './Drawer';\nimport useAuthContext from '../hooks/useAuthContext';\nimport { WebSocketProvider } from '../hooks/useWebsocketContext';\nimport HeaderRight from '../components/HeaderRight'\nimport Colors from '../constants/Colors';\nimport { TouchableOpacity } from 'react-native-gesture-handler';\nimport { FirebaseProvider } from '../hooks/useFirebaseContext';\nimport useIsMobile from '../hooks/useIsMobile';\nimport useColorScheme from '../hooks/useColorScheme';\nimport { ModalsProvider } from '../hooks/useModalsContext';\nimport modals from '../modals';\nimport useLangContext from '../hooks/useLangContext';\nimport CommonButton from '../components/CommonButton';\nimport { UploadContextProvider } from '../hooks/useUploadContext';\n\nconst Main = createStackNavigator();\n\nfunction headerLeft(navigation:any, route:any, windowType:string, theme:'light'|'dark', isMobile:boolean){\n    const canGOBackScreen = ['HomeScreen', 'LoginScreen'].findIndex(v=>v == route.name) == -1\n    const goBack = ()=>{\n        if (navigation.canGoBack())\n            navigation.goBack()\n        else if (canGOBackScreen)\n            navigation.replace('HomeScreen')\n    }\n    if (windowType=='portrait' && canGOBackScreen)\n        return <TouchableOpacity onPress={goBack} disabled={!isMobile}>\n            <CommonButton title={''} color={isMobile?Colors[theme].buttonBackgroundColor:Colors[theme].hoverColor} onPress={goBack} disabled={isMobile} style={{width:32, height:32, margin:16, paddingVertical:1, paddingHorizontal:4}}>\n                <Ionicons size={24} color={Colors[theme].iconColor} name=\"arrow-back\"/>\n            </CommonButton>\n        </TouchableOpacity>\n    return null\n}\n\nexport default ()=>{\n    const windowType = useResizeContext();\n    const isMobile = useIsMobile()\n    const {auth} = useAuthContext()\n    const theme = useColorScheme()\n    const {lang, locale} = useLangContext()\n    const entries = useMemo(()=>{\n        if (auth.user === undefined)\n            return []\n        console.log('current user: ', auth.user)\n        return Object.entries(auth.user === null?login:main)\n    }, [auth, locale])\n    const modalValues = useMemo(()=>{\n        if (auth.user === undefined)\n            return []\n        return auth.user === null?[]:modals\n    }, [auth])\n    const backgroundStyle = theme=='light'?{}:{backgroundColor:'#010409'}\n    return (auth.user!==undefined?<View style={{flexDirection:'row', flex:1}}>\n        <UploadContextProvider>\n            <ModalsProvider modals={modalValues}>\n                {auth.user?<Drawer auth={auth}/>:undefined}\n                <View style={[{flex:1}, backgroundStyle]}>\n                    <WebSocketProvider disable={auth.user === null || auth.user === undefined}>\n                        <FirebaseProvider user={auth.user}>\n                            <Main.Navigator\n                                screenOptions={({navigation, route})=>({\n                                    headerStyle:{backgroundColor:Colors[theme].header, height:isMobile?50:undefined},\n                                    headerTitleStyle:{color:Colors[theme].text},\n                                    headerLeft:()=>headerLeft(navigation, route, windowType, theme, isMobile),\n                                    headerRight:()=><HeaderRight/>,\n                                    headerLeftContainerStyle:{backgroundColor:Colors[theme].header, borderBottomWidth:1, borderColor:Colors[theme].headerBottomColor},\n                                    cardStyle:[{flexShrink:1}, backgroundStyle],\n                                    animationEnabled:windowType=='portrait',\n                                    cardStyleInterpolator: CardStyleInterpolators.forHorizontalIOS\n                                })}\n                            >\n                                {entries.map(([key, screen])=><Main.Screen key={key} name={key} component={screen.component} options={{ title: lang(screen.title) }} />)}\n                                <Main.Screen name=\"NotFound\" component={NotFoundScreen} options={{ title: 'Oops!' }} />\n                            </Main.Navigator>\n                        </FirebaseProvider>\n                    </WebSocketProvider>\n                </View>\n            </ModalsProvider>\n        </UploadContextProvider>\n    </View>:<></>);\n}","import { useEffect } from \"react\";\nimport { useMutation, useQuery, useQueryClient } from \"react-query\";\nimport { getMessengerChannelList, postChannel, postDirectChannel, putChannel } from \"../../services\";\nimport { MessengerChannel, MessengerContent } from \"../../types\";\nimport { Auth } from \"../useAuthContext\";\nimport useWebsocketContext from \"../useWebsocketContext\";\n\nexport default function useMessengerChannelList(auth?:Auth){\n  const queryClient = useQueryClient()\n  const {lastJsonMessage} = useWebsocketContext()\n  const { data } = useQuery(\"MessengerChannelList\" , async()=>await getMessengerChannelList(auth?.user?.id))\n\n  useEffect(()=>{\n    if(lastJsonMessage !=null){\n      if(lastJsonMessage['type']=='enter'){\n        queryClient.setQueryData<MessengerChannel[]>(\"MessengerChannelList\", (_data)=>{\n          return (_data?.find(v=>v.id==lastJsonMessage['data']['id'])?_data:[lastJsonMessage['data'] , ...(_data|| [])]).sort((a, b)=>a.id - b.id)\n        })\n      }\n      if (lastJsonMessage['type']=='next_message'){\n        const data:MessengerContent = lastJsonMessage['data']\n        queryClient.setQueryData<MessengerChannel[]>(\"MessengerChannelList\", (_data)=>(_data || []).map(v=>{\n          if (v.id == data.channel){\n            return {...v, last_message:{content:data.message_set[0]?.content, created:data.created}}\n          }\n          return v\n        }))\n      }\n      // if(lastJsonMessage['type']=='leave'){\n      //   queryClient.setQueryData<Channel[]>(\"MessengerChannelList\", (_data)=>_data?.filter(v=>v.id!=lastJsonMessage['data']['channel_id']) || [])\n      // }\n    }\n  }, [lastJsonMessage])\n  return data\n}\n\nexport function useMessengerChannelSorted(auth?:Auth){\n  const channelList = useMessengerChannelList(auth);\n  return channelList?.sort((a, b)=>(a.last_message?.created || '') < (b.last_message?.created || '')?1:-1)\n}\nexport function useMessengerChannelMutation(){\n  const queryClient = useQueryClient()\n\n  const create = useMutation(postChannel, {\n    onSuccess: ()=>queryClient.invalidateQueries(\"MessengerChannelList\")\n  });\n\n  const update = useMutation(putChannel, {\n    onSuccess: () => queryClient.invalidateQueries(\"MessengerChannelList\")\n  })\n\n  const direct = useMutation(postDirectChannel, {\n    onSuccess: () => queryClient.invalidateQueries(\"MessengerChannelList\")\n  })\n\n  return { create:create.mutateAsync, update:update.mutateAsync, direct:direct.mutateAsync}\n}","/**\n * If you are not familiar with React Navigation, refer to the \"Fundamentals\" guide:\n * https://reactnavigation.org/docs/getting-started\n *\n */\nimport * as React from 'react';\nimport { useColorScheme as useDefaultColorScheme } from 'react-native';\nimport { useColorScheme as useColorScheme } from 'react-native-appearance';\nimport { enableScreens } from 'react-native-screens';\nimport { NavigationContainer, DefaultTheme, DarkTheme, NavigationContainerRef } from '@react-navigation/native';\nimport { CardStyleInterpolators, createStackNavigator } from '@react-navigation/stack';\n\nimport useResizeContext, { ResizeContextProvider } from '../hooks/useResizeContext';\nimport useInvitee, { replaceInviteeState } from '../hooks/useInvitee';\nimport { modal } from '../screens';\nimport LinkingConfiguration from './LinkingConfiguration';\nimport MainNavigator from './MainNavigator';\n\n\nenableScreens();\n\nconst navigationRef = React.createRef<NavigationContainerRef>();\n\nexport function navigate(name:string, params?:any) {\n  if (params)\n    navigationRef.current?.navigate(name, params);\n  navigationRef.current?.navigate(name);\n}\n\nlet electronVersion:string|undefined;\ntry{\n  electronVersion = process?.versions?.['electron']\n}\ncatch(e){\n  electronVersion = undefined\n}\n\nexport default function Navigation() {\n  const defaultColorScheme = useDefaultColorScheme()\n  const userColorScheme = useColorScheme()\n  const colorScheme = userColorScheme =='no-preference'?defaultColorScheme:userColorScheme\n  return <NavigationContainer\n    ref={navigationRef}\n    documentTitle={{formatter: (options, route) => {return `TOKKI TOK`}}}\n    linking={electronVersion?undefined:LinkingConfiguration}\n    theme={colorScheme === 'dark' ? DarkTheme : DefaultTheme}>\n        <ResizeContextProvider>\n          <RootNavigator />\n        </ResizeContextProvider>\n  </NavigationContainer>\n}\n\n\n// A root stack navigator is often used for displaying modals on top of all other content\n// Read more here: https://reactnavigation.org/docs/modal\nconst Root = createStackNavigator();\n\nfunction RootNavigator() {\n    const windowType = useResizeContext();\n    useInvitee()\n    return <Root.Navigator\n        mode= 'modal'\n        headerMode= 'screen'\n        screenOptions={{\n            cardStyle:{backgroundColor:\"white\"},\n            animationEnabled: true,\n            cardStyleInterpolator: CardStyleInterpolators.forVerticalIOS,\n        }}\n    >\n        <Root.Screen name=\"Main\" component={MainNavigator} options={{headerShown:false}}/>\n        {Object.entries(modal).map(([key, screen])=><Root.Screen key={key} name={key} component={screen.component} options={{\n            title: screen.title,\n            gestureDirection: windowType == 'landscape'?'vertical-inverted':'vertical'\n        }} />)}\n    </Root.Navigator>\n}\n\nreplaceInviteeState(window.location)\n\nconst IGNORE_WERNINGS:string[] = ['setNativeProps', 'useNativeDriver'];\n\nconst warnLogger = console.warn\n\nconsole.warn = (message: string|Object) => {\n    var warn = true;\n    if (message instanceof Object){\n      warn = false;\n    }\n    else if (IGNORE_WERNINGS.some(log=>message.includes(log))){\n      warn = false\n    };\n    if (warn){\n      warnLogger(message);\n    }\n    else{\n        // console.log(message)\n    }\n};\n","import { useMutation, useQuery, useQueryClient } from \"react-query\";\nimport { deleteUser, getUserMembershipList, patchUser, postUser } from \"../../services\";\nimport useAuthContext, { Auth } from \"../useAuthContext\";\n\nexport default function useUserMembershipList(auth?:Auth){\n  const { data } = useQuery([\"UserMembershipList\", auth?.groupId] , async()=>auth?.groupId?(await getUserMembershipList(auth?.groupId)):[])\n  return data\n}\n\nexport function useUserMembershipMutation(){\n  const queryClient = useQueryClient()\n  const { auth, dispatch } = useAuthContext()\n  const _create = useMutation(postUser, {\n    onSuccess: ()=>{\n      queryClient.invalidateQueries(\"UserMembershipList\")\n    }\n  })\n  const _update = useMutation(patchUser, {\n    onSuccess: (data, user)=>{\n      if (user.id == auth.user?.id)\n        if(user.username && user.password){\n          dispatch({type:'LOGIN_REQUEST', username:user.username, password:user.password})\n        }\n        else{\n          dispatch({type:\"REFRESH\"})\n        }\n      else{\n        queryClient.invalidateQueries(\"UserMembershipList\")\n      }\n    }\n  })\n  const _delete = useMutation(deleteUser, {\n    onSuccess: (data, id)=>{\n      queryClient.invalidateQueries(\"UserMembershipList\")\n      if (id == auth.user?.id)\n        dispatch({type:\"LOGOUT_REQUEST\"})\n    }\n  })\n  return {create:_create.mutateAsync, update:_update.mutateAsync, delete:_delete.mutateAsync}\n}","import { useMutation, useQuery, useQueryClient } from \"react-query\";\nimport { postBulkMessengerMember, deleteMessengerMember, getMessengerMemberList } from \"../../services\";\n\nexport default function useMessengerMemberList(channel_id:number){\n  const { data } = useQuery([\"MessengerMemberList\", channel_id] , async()=>await getMessengerMemberList(channel_id))\n  return data\n}\n\n\nexport function useMessengerMemberMutation(){\n  const queryClient = useQueryClient()\n  const invite = useMutation(postBulkMessengerMember, {\n    onSuccess: ()=>{\n      queryClient.invalidateQueries(\"MessengerMemberList\")\n    }\n  })\n\n  const leave = useMutation(deleteMessengerMember, {\n    onSuccess: () => {\n      queryClient.invalidateQueries(\"MessengerChannelList\")\n      queryClient.invalidateQueries(\"MessengerMemberList\")\n    }\n  })\n  return {invite:invite.mutateAsync, leave:leave.mutateAsync}\n}","import React, { useState } from 'react';\nimport { StyleSheet} from 'react-native';\nimport { CustomButtonProps } from '../types';\nimport CommonButton from './CommonButton';\n\nexport default (props:CustomButtonProps)=>{\n    return <CommonButton {...props} style={[styles.style, props.style]}/>\n}\n\nconst styles = StyleSheet.create({\n    style:{\n        borderRadius:6, \n        backgroundColor: 'transparent',\n        borderWidth:0\n    },\n});\n","import React, {useState, useEffect } from 'react';\nimport { StyleSheet } from 'react-native';\nimport { View, Text } from '../components/Themed';\nimport CommonButton from '../components/CommonButton';\n// import useBoardChannelList, { useBoardChannelMutation } from '../hooks/lists/useBoardChannelList';\nimport useAuthContext from '../hooks/useAuthContext';\nimport { navigate } from '../navigation';\nimport { Channel } from '../types';\nimport useMessengerChannelList, { useMessengerChannelMutation } from '../hooks/lists/useMessengerChannelList';\nimport TextField from '../components/TextField';\nimport useModalsContext from '../hooks/useModalsContext';\nimport useLangContext from '../hooks/useLangContext';\nimport ModalSection from '../components/ModalSection';\nimport { useMessengerMemberMutation } from '../hooks/lists/useMessengerMemberList';\nimport { avatarFromChannel } from '../components/Avatar';\nimport useModalEffect from '../hooks/useModalEffect';\n\nexport default function ChannelEditModal({id, member_id, type}: {id?:number, member_id?:number, type:string}) {\n  const { lang } = useLangContext()\n  const {auth} = useAuthContext()\n  const { setModal } = useModalsContext()\n  const channelList = useMessengerChannelList(auth)\n  const channelMutation = useMessengerChannelMutation()\n  const messengerMemberMutation = useMessengerMemberMutation()\n  const channel = channelList?.find(v=>v.id==id)\n  const [name, setName] = useState('')\n  const [description, setDescription] = useState('')\n  const back = ()=>{\n    setModal(ChannelEditModal, null)\n  }\n\n  useEffect(()=>{\n    if (channel){\n      const {name:_name} = avatarFromChannel(channel, auth.user)\n      setName(_name)\n      setDescription(channel?.description || '')\n    }\n  }, [channel?.id])\n  useModalEffect(back, [])\n  return <ModalSection>\n    <View style={{justifyContent:'space-between', flex:1, width:'100%'}}>\n      <View style={{width:'100%'}}>\n        <Text style={{fontSize:20}}>{id?lang('Chat Setting'):lang('New chat')}</Text>\n        <View style={styles.separator} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\n        <TextField name={lang('Channel Name')} value={name} setValue={setName} width={'60%'}/>\n        <TextField name={lang('Description')} value={description} setValue={setDescription} multiline width={'60%'}/>\n      </View>\n      <View style={{width:'100%', flexDirection:'row'}}>\n        {member_id &&<View style={{flexDirection:'row', justifyContent:'flex-start'}}>\n          <CommonButton title={lang('leave')} style={{marginHorizontal:5}} textStyle={{color:'red'}} onPress={()=>messengerMemberMutation.leave(member_id).then(back)}/>\n        </View>}\n        <View style={{flex:1, flexDirection:'row', justifyContent:'flex-end'}}>\n          <CommonButton title={lang('save')} onPress={()=>{\n            if(auth?.user?.id && auth.groupId){\n              const newChannel:Channel = {id, name, description, type, owner:auth?.user?.id, group:auth.groupId};\n              (id?channelMutation.update(newChannel):channelMutation.create(newChannel)).then(v=>navigate(\"Main\", {\n                screen:v.type == 'messenger'?'ChatScreen':'BoardScreen',\n                params:{id:v.id}\n              }))\n            }\n          }}/>\n          <CommonButton title={lang('cancel')} style={{marginHorizontal:5}} onPress={back}/>\n        </View>\n      </View>\n    </View>\n  </ModalSection>\n}\n\nconst styles = StyleSheet.create({\n  field:{\n    width:'50%',\n    flexDirection:'row',\n    padding:10,\n  },\n  separator: {\n    marginBottom: 20,\n    height: 1,\n    width: '100%',\n  },\n})","import React, { useState, useEffect } from \"react\";\nimport { StyleSheet, TextInput } from \"react-native\";\nimport useLangContext from \"../hooks/useLangContext\";\nimport useUserMembershipList, { useUserMembershipMutation } from \"../hooks/lists/useUserMembershipList\";\nimport useAuthContext from \"../hooks/useAuthContext\";\nimport ModalSection from \"../components/ModalSection\";\nimport useModalsContext from \"../hooks/useModalsContext\";\nimport { View, Text } from \"../components/Themed\";\nimport RowField from \"../components/RowField\";\nimport CommonButton from \"../components/CommonButton\";\nimport CommonTextInput from \"../components/CommonTextInput\";\nimport useExternalMembershipList from \"../hooks/lists/useExternalMembershipList\";\n// import TextButton from \"../components/TextButton\";\n// import Colors from \"../constants/Colors\";\n// import useColorScheme from \"../hooks/useColorScheme\";\n\ntype ErrorMessages = {\n    username?:string,\n    name?:string,\n    password?:string,\n    checkPassword?:string\n}\n\nconst ErrorView = (props:{message?:string})=>{\n  const { lang } = useLangContext()\n  return props.message?<View style={styles.form_error}>\n  <Text style={styles.form_error_text}>{lang(props.message)}</Text>\n</View>:<></>\n}\n\nexport default function RegistrationModal({id}:{id?:number}) {\n  const { lang } = useLangContext()\n  const {auth} = useAuthContext()\n  // const theme = useColorScheme()\n  // const color = Colors[theme].text\n  const { setModal } = useModalsContext()\n  const [username, setUsername] = useState(\"\");\n  const [name, setName] = useState(\"\")\n  const [password, setPassword] = useState(\"\");\n  const [checkPassword, setCheckPassword] = useState(\"\")\n  const [isStaff, setIsStaff] = useState(false)\n  const [error, setError] = useState<ErrorMessages>({})\n  const userList = useUserMembershipList(auth)\n  const externalMemberList = useExternalMembershipList(username)\n  const userMembershipMutation = useUserMembershipMutation()\n  const user = userList?.find(v=>v.id==id)\n  const usernameDisable = user && user.is_guest===false\n  useEffect(()=>{\n    if (user){\n      setUsername(user.username)\n      setName(user.name)\n    }\n  }, [user?.id])\n  const _register = ()=>{\n    let newError:ErrorMessages = {};\n    if ((externalMemberList?.length || 0) >0 && !usernameDisable) newError.username = \"The username is already in use.\"\n    if (username.length < 10 || username.length > 64) newError.username = \"Set 10-64 characters.\"\n    if (name.length < 1 || name.length > 64) newError.name = \"Set 1-64 characters.\"\n    if (!/^(?=.*[A-Za-z])(?=.*\\d)(?=.*[@$!%*#?&])[A-Za-z\\d@$!%*#?&]{10,64}$/.test(password) && !(usernameDisable && password.length==0)) newError.password = \"Set 10-64 characters with a combination of letters/numbers/valid special characters.\"\n    if (password != checkPassword) newError.checkPassword = \"Incorrect between password and check password.\"\n    if (Object.keys(newError).length > 0){\n        setError(newError)\n        return\n    }\n    if (id){\n      userMembershipMutation.update({\n        id,\n        name,\n        username:usernameDisable?undefined:username,\n        is_guest:false,\n        password:password.length>0?password:undefined,\n      }).then(()=>{(id!=auth.user?.id || user?.is_guest) && back()})\n    }\n    else{\n      auth?.groupId && userMembershipMutation.create({\n          username,\n          name,\n          password,\n          is_guest:false,\n          is_staff:isStaff,\n          inviteGroupId:auth.groupId,\n\n      }).then(back)\n    }\n  }\n  const back = ()=>{\n    setModal(RegistrationModal, null)\n  }\n  return <ModalSection>\n    <View style={{justifyContent:'space-between', flex:1, width:'100%'}}>\n      <View style={{flex:1, width:'100%'}}>\n        <Text style={{fontSize:20}}>{usernameDisable?lang('Edit User'):lang('Create User')}</Text>\n        <View style={styles.separator} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\n        <RowField name={lang('Username')} width={'60%'}>\n          {usernameDisable?<Text style={{fontSize:16}}>{username}</Text>:<CommonTextInput\n              value={username}\n              setValue={(text) => setUsername(text)}\n              keyboardType={'email-address'}\n          />}\n          <ErrorView message={error.username}/>\n        </RowField>\n        <RowField name={lang('Name')} width={'60%'}>\n          <CommonTextInput\n              value={name}\n              setValue={(text) => setName(text)}\n          />\n          <ErrorView message={error.name}/>\n        </RowField>\n        <RowField name={lang('Password')} width={'60%'}>\n          <CommonTextInput\n              value={password}\n              secureTextEntry\n              setValue={(text) => setPassword(text)}\n          />\n          <ErrorView message={error.password}/>\n        </RowField>\n        <RowField name={lang('Check Password')} width={'60%'}>\n          <CommonTextInput\n              value={checkPassword}\n              secureTextEntry\n              setValue={(text) => setCheckPassword(text)}\n          />\n          <ErrorView message={error.checkPassword}/>\n        </RowField>\n        {/* <RowField name={lang('Manager Permission')} width={'60%'}>\n          <View style={{flexDirection:'row'}}>\n            {[[lang('Yes'), true], [lang('No'), false]].map(([title, value])=><TextButton \n              key={title} title={title} textStyle={{fontSize:16, color, textDecorationLine:isStaff==value?'underline':'none'}} style={{borderRadius:20}} onPress={(\n              )=>setIsStaff(value)}/>)}\n          </View>\n        </RowField> */}\n      </View>\n      <View style={{width:'100%', flexDirection:'row'}}>\n        {id && <View style={{flexDirection:'row', justifyContent:'flex-start'}}>\n          <CommonButton title={lang('delete account')} style={{marginHorizontal:5}} textStyle={{color:'red'}} onPress={()=>userMembershipMutation.delete(id).then(back)}/>\n        </View>}\n        <View style={{flex:1, flexDirection:'row', justifyContent:'flex-end'}}>\n          <CommonButton title={lang('save')} onPress={_register}/>\n          <CommonButton title={lang('cancel')} style={{marginHorizontal:5}} onPress={back}/>\n        </View>\n      </View>\n    </View>\n  </ModalSection>\n};\n\nconst styles = StyleSheet.create({\n  form_error: {\n    height: 22,\n    width:'100%',\n  },\n  form_error_text:{\n    textAlignVertical:'center',\n    color:'red',\n    fontSize:13,\n  },\n  separator: {\n    marginBottom: 20,\n    height: 1,\n    width: '100%',\n  },\n});","import React from 'react'\nimport TextButton from \"./TextButton\"\nimport useAuthContext from \"../hooks/useAuthContext\"\nimport useResizeContext from '../hooks/useResizeContext'\nimport { View } from 'react-native'\nimport useModalsContext from '../hooks/useModalsContext'\nimport AlertModal from '../modals/AlertModal'\nimport useLangContext from '../hooks/useLangContext'\nimport useColorScheme from '../hooks/useColorScheme'\nimport Colors from '../constants/Colors'\n\ntype ButtonProps = {title:string, onPress:()=>void, windowType?:'landscape'|'portrait'}\n\nexport default (props:{extra?:ButtonProps[]})=>{\n    const { lang } = useLangContext()\n    const theme = useColorScheme()\n    const {auth, dispatch} = useAuthContext()\n    const { setModal } = useModalsContext()\n    const windowType = useResizeContext()\n    const defaultButtonProps:ButtonProps[] = [{title:lang('sign out'), onPress:()=>{\n        if (auth?.user?.is_guest){\n            setModal(AlertModal, {type:\"GUEST_LOGOUT\"})\n        }\n        else{\n            dispatch({type:\"LOGOUT_REQUEST\"})\n        }\n    }}]\n    const buttonProps = (props.extra?[...props.extra, ...defaultButtonProps]:defaultButtonProps).filter(v=>v.windowType==windowType || v.windowType == undefined)\n    return<View style={{flexDirection:'row'}}>\n        {buttonProps.map((v,k)=><TextButton key={k} {...v} textStyle={{color:Colors[theme].text}} color='#gray'/>)}\n    </View>\n}\n  ","import React, { useMemo } from 'react';\n\nimport { TextProps, StyleProp } from 'react-native';\nimport {View, Text } from './Themed'\nimport useResizeContext from '../hooks/useResizeContext';\n\ntype Props = {\n  name: string,\n  width?:any,\n  children: React.ReactNode\n  textStyle?: StyleProp<TextProps>\n}\n\nexport default function RowField(props:Props) {\n  const windowType = useResizeContext()\n  const rowStyle = useMemo(()=>windowType=='landscape'?\n    {flexDirection:'row', alignItems: 'center', justifyContent:'space-between'}:\n    {flexDirection:'column', alignItems:'flex-start'} as any\n  , [windowType])\n  return (\n    <View style={[{paddingVertical:windowType=='landscape'?15:5, width:'100%'}, rowStyle]}>\n        <Text style={[windowType=='landscape'?{flex:1}:{width:'100%'},{paddingHorizontal: 15, fontSize:16}, props.textStyle]}>{props.name}</Text>\n        <View style={[windowType=='landscape'?{flex:6}:{width:'100%'},{paddingHorizontal: 15}]}>\n          <View style={{width:props.width}}>\n            {props.children}\n          </View>\n        </View>\n    </View>\n  )\n}","import React from 'react';\nimport { TabView, SceneMap,NavigationState, SceneRendererProps, TabBar } from 'react-native-tab-view';\nimport Colors from '../constants/Colors';\nimport useColorScheme from '../hooks/useColorScheme';\nimport useLangContext from '../hooks/useLangContext';\nimport { TabViewRecord } from '../types';\n\n\nexport default (props:{tabs:TabViewRecord, tabBarPosition:\"top\"|\"bottom\", index?:number, onTab?:(index:number)=>void})=>{\n  const { lang } = useLangContext()\n  const [index, setIndex] = React.useState(props.index || 0);\n  const theme = useColorScheme()\n  const entries = Object.entries(props.tabs)\n  const onTab = props.onTab\n  const icons = Object.assign({}, ...entries.map(([k, v])=>({[k]:v.icon})))\n  return <TabView\n    renderTabBar={(props:SceneRendererProps & {navigationState: NavigationState<any>})=>{\n      return <TabBar\n        {...props}\n        indicatorStyle={{ backgroundColor: \"#2196F3\" }}\n        style={{ backgroundColor:Colors[theme].background }}\n        activeColor={Colors[theme].text}\n        inactiveColor={Colors[theme].text}\n        renderIcon={(scene)=>icons[scene.route.key]}\n        onTabPress={(scene)=>onTab?.(entries.findIndex(([k, v])=>k == scene.route.key))}\n      />\n    }}\n    navigationState={{ index, routes: entries.map(([k, v])=>({key:k, title:lang(v.title)}))}}\n    onIndexChange={setIndex}\n    renderScene={SceneMap(Object.assign({}, ...entries.map(([k, v])=>({[k]:v.component}))))}\n    tabBarPosition={props.tabBarPosition}\n  />\n}\n\n","import * as React from 'react';\nimport { View } from './Themed';\nimport { StyleSheet, StyleProp, ViewStyle, TextStyle, Pressable } from 'react-native';\nimport Colors from '../constants/Colors';\n\nexport type ItemParamList = {\n    outerContainerStyle?:StyleProp<TextStyle>\n    containerStyle?:StyleProp<ViewStyle>\n    bodyStyle?:StyleProp<ViewStyle>\n    children?: React.ReactNode\n    onPress?: ()=>void\n}\n\nexport default function CommonItem(props:ItemParamList){\n  // const [hover, setHover] = React.useState(false)\n  const [press, setPress] = React.useState(false)\n  return (\n    <Pressable\n      style={[styles.outerContainer ,props.outerContainerStyle, (press)?{backgroundColor:'rgb(242,242,242)'}:{}]}\n      onPressIn={()=>setPress(true)}\n      onPress={()=>props.onPress?.()}\n      onPressOut={()=>setPress(false)}\n      //  //@ts-ignore\n      //  onHoverIn={()=>setHover(true)}\n      //  onHoverOut={()=>setHover(false)}\n    >\n        <View style={[styles.container ,props.containerStyle]}>\n            <View style={[styles.bodyView, props.bodyStyle]}>\n                <>{props.children}</>\n            </View>\n      </View>\n    </Pressable>\n    )\n}\n\nconst styles = StyleSheet.create({\n  outerContainer:{\n    width:'100%',\n    maxWidth:1080,\n    alignItems:'stretch',\n  },  \n  container: {\n      marginHorizontal:20,\n      backgroundColor:'transparent'\n    },\n    bodyView:{\n      width: '100%',\n      padding: 10,\n      minHeight: 40,\n      alignItems: 'center',\n      justifyContent: 'center',\n      borderBottomWidth:1,\n      borderColor:Colors.borderColor,\n      backgroundColor:'transparent'\n    }\n  });\n  ","import React, { useEffect } from 'react';\nimport Profile from '../components/Profile';\nimport useAuthContext from '../hooks/useAuthContext';\nimport useUserMembershipList from '../hooks/lists/useUserMembershipList';\nimport { useMessengerChannelMutation } from '../hooks/lists/useMessengerChannelList';\nimport CommonButton from '../components/CommonButton';\nimport { Channel } from '../types';\nimport { navigate } from '../navigation';\nimport useModalsContext from '../hooks/useModalsContext';\nimport { Text, View } from '../components/Themed';\nimport useLangContext from '../hooks/useLangContext';\nimport { Ionicons } from '../lib/@expo/vector-icons';\nimport { TouchableOpacity } from 'react-native-gesture-handler';\nimport Colors from '../constants/Colors';\nimport useColorScheme from '../hooks/useColorScheme';\nimport { BottomSheet } from '../components/ModalSection';\nimport useModalEffect from '../hooks/useModalEffect';\n\nexport default function ProfileModal({id}:{id:number}) {\n  const { lang } = useLangContext()\n  const theme = useColorScheme()\n  const {auth} = useAuthContext()\n  const { setModal } = useModalsContext()\n  const userList = useUserMembershipList(auth)\n  const user = userList?.find(v=>v.id==id)\n  const isSelf = auth.user && user && (auth.user?.id==user?.id)\n  const channelMutation = useMessengerChannelMutation()\n  const back = ()=>{\n    setModal(ProfileModal, null)\n  }\n  useEffect(()=>{\n    if (!(id && user) && userList)\n      back()\n  }, [userList])\n  useModalEffect(back, [])\n  return user?<BottomSheet>\n    <View style={{flexDirection:'row', width:'100%'}}>\n      <View style={{flex:1, flexDirection:'row'}}>\n        <TouchableOpacity onPress={back}>\n          <Ionicons size={20} name=\"arrow-back\" color={Colors[theme].text}/>\n        </TouchableOpacity>\n      </View>\n      <View style={{flex:1}}>\n        <Text style={{fontSize:20, textAlign:'center'}}>{lang('profile')}</Text>\n      </View>\n      <View style={{flex:1}}/>\n    </View>\n    <View style={{marginBottom: 20, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\n    \n    <Profile username={user.username} name={user.name} userId={user.id} />\n    <CommonButton title={lang(isSelf?'Chat with me':'1:1 Chat')} onPress={()=>{\n      if(auth?.user?.id && auth.groupId){\n        const newChannel:Channel = {name:\"\", type:'messenger', owner:auth?.user?.id, group:auth.groupId, subowner:isSelf?undefined:user.id};\n        channelMutation.direct(newChannel).then(v=>navigate(\"Main\", {screen:\"ChatScreen\", params: {id:v.id}}))\n      }\n    }}/>\n  </BottomSheet>:<></>\n}\n","import React from 'react'\nimport { View, StyleSheet, Linking, Platform, TouchableOpacity  } from 'react-native'\nimport { } from 'react-native-gesture-handler'\nimport { AntDesign } from '../lib/@expo/vector-icons'; \nimport Colors from '../constants/Colors';\n\nconst openURL = Platform.OS=='web'?(url:string)=>{location.href=url}:Linking.openURL\n\nexport default (props:{theme:'light'|'dark'})=>{\n    return<View style={Styles.footer_buttons}>\n        <TouchableOpacity style={Styles.footer_button} onPress={()=>openURL(\"https://github.com/blacktokki/tokki-tok\")}>\n            <AntDesign name=\"github\" size={24} color={Colors[props.theme].iconColor} />\n        </TouchableOpacity>\n        <TouchableOpacity style={Styles.footer_button} onPress={()=>Linking.openURL(\"mailto:ydh051541@naver.com\")}>\n            <AntDesign name=\"mail\" size={24} color={Colors[props.theme].iconColor} />\n        </TouchableOpacity>\n    </View>\n}\n\nconst Styles = StyleSheet.create({\n      footer_buttons: {\n        width: '100%',\n        flexDirection: 'row',\n        justifyContent: 'flex-end',\n        paddingBottom: 20,\n        paddingRight: 20,\n      },\n      footer_button: {\n        alignItems: 'center',\n        justifyContent: 'center',\n        width: 38,\n        height: 38,\n        marginHorizontal: 12,\n        borderWidth: 1,\n        borderColor: '#E7E7E7',\n        borderRadius: 60,\n      },\n})","import React, {useEffect, useState} from 'react';\nimport {\n  Text,\n  TextInput,\n  TouchableOpacity,\n  View,\n  StyleSheet,\n} from 'react-native';\nimport { StackScreenProps } from '@react-navigation/stack';\nimport useAuthContext from '../../hooks/useAuthContext';\nimport useLangContext from '../../hooks/useLangContext';\nimport ContractFooter from '../../components/ContractFooter';\n\nexport default function LoginScreen({\n  navigation, route\n}: StackScreenProps<any, 'Login'>) {\n  const { lang } = useLangContext()\n  const [username, setUsername] = useState('');\n  const [password, setPassword] = useState('');\n  const {error, dispatch} = useAuthContext()\n  const _login = ()=>dispatch({type:'LOGIN_REQUEST', username, password})\n  useEffect(() => {\n    navigation.setOptions({\n      headerRight: undefined\n    });\n  }, [navigation]);\n\n  return (<View style={Styles.login_container}>\n    <View style={Styles.login_wrapper}>\n      <View style={Styles.form}>\n        {error && <View style={Styles.form_error}>\n          <Text style={Styles.form_error_text}>{lang(error)}</Text>\n        </View>}\n        <TextInput\n          style={Styles.form_input}\n          value={username}\n          placeholder={lang('Username')}\n          onChangeText={(text) => setUsername(text)}\n          autoCapitalize={'none'}\n          keyboardType={'email-address'}\n          onSubmitEditing={_login}\n        />\n        <TextInput\n          style={Styles.form_input}\n          value={password}\n          placeholder={lang('Password')}\n          secureTextEntry\n          onChangeText={(text) => setPassword(text)}\n          onSubmitEditing={_login}\n        />\n        <TouchableOpacity onPress={_login}>\n          <View style={Styles.button}>\n            <Text style={Styles.button_label}>{lang('Sign in')}</Text>\n          </View>\n        </TouchableOpacity>\n        <TouchableOpacity onPress={() => dispatch({type:\"LOGIN_GUEST\"})}>\n          <Text style={Styles.guest_footer_text}>\n            {lang(\"Sign in as guest\")}\n          </Text>\n        </TouchableOpacity>\n      </View>\n      <View style={Styles.login_social}>\n        <View style={Styles.login_social_separator}>\n          <View style={Styles.login_social_separator_line} />\n          <Text style={Styles.login_social_separator_text}>{'*'}</Text>\n          <View style={Styles.login_social_separator_line} />\n        </View>\n        <View style={Styles.login_social_buttons}>\n        </View>\n      </View>\n      {/* <>\n        <TouchableOpacity onPress={() => navigate(\"RegistrationScreen\")}>\n          <Text style={Styles.login_footer_text}>\n            {\"Don't have an account? \"}\n            <Text style={Styles.login_footer_link}>{'Sign up'}</Text>\n          </Text>\n        </TouchableOpacity>\n      </> */}\n    </View>\n    <ContractFooter theme='light'/>\n  </View>);\n};\n\nconst Styles = StyleSheet.create({\n    login_container: {\n      flex: 1,\n      backgroundColor: '#FFF',\n    },\n    login_header: {\n      alignItems: 'center',\n      paddingTop: 30,\n      paddingBottom: 50,\n      backgroundColor: '#208AEC',\n    },\n    login_header_logo: {\n      width: 220,\n      resizeMode: 'contain',\n    },\n    login_header_text: {\n      marginTop: 15,\n      color: '#f0f0f0',\n      fontSize: 16,\n    },\n    login_header_text_bold: {\n      color: '#fff',\n      fontWeight: 'bold',\n    },\n    login_wrapper: {\n      flex: 1,\n      justifyContent: 'space-between',\n      paddingTop: 40,\n      borderTopRightRadius: 12,\n      borderTopLeftRadius: 12,\n      backgroundColor: '#fff',\n      alignItems: 'center',\n    },\n    form: {\n      width: '100%',\n      maxWidth: 320,\n    },\n    form_error: {\n      height: 22,\n      width:'100%',\n    },\n    form_error_text:{\n      textAlignVertical:'center',\n      color:'red',\n      fontSize:13,\n    },\n    form_input: {\n      height: 44,\n      paddingHorizontal: 20,\n      marginBottom: 20,\n      backgroundColor: '#EDF0F7',\n      borderRadius: 50,\n    },\n    button: {\n      alignItems: 'center',\n      justifyContent: 'center',\n      height: 44,\n      backgroundColor: '#0065A4',\n      borderRadius: 50,\n    },\n    button_label: {\n      color: '#fff',\n      fontSize: 16,\n    },\n    login_social: {\n      width: '100%',\n      maxWidth: 280,\n      marginTop: 20,\n    },\n    login_social_separator: {\n      flexDirection: 'row',\n      alignItems: 'center',\n    },\n    login_social_separator_line: {\n      flex: 1,\n      width: '100%',\n      height: 1,\n      backgroundColor: '#E0E0E0',\n    },\n    login_social_separator_text: {\n      marginHorizontal: 10,\n      color: '#808080',\n      fontSize: 16,\n    },\n    login_social_buttons: {\n      flexDirection: 'row',\n      justifyContent: 'center',\n      marginTop: 20,\n    },\n    login_social_button: {\n      alignItems: 'center',\n      justifyContent: 'center',\n      width: 60,\n      height: 60,\n      marginHorizontal: 12,\n      borderWidth: 1,\n      borderColor: '#E7E7E7',\n      borderRadius: 60,\n    },\n    login_social_icon: {\n      width: 38,\n      height: 38,\n      resizeMode: 'contain',\n    },\n    login_social_facebook: {\n      backgroundColor: '#4267B2',\n      borderColor: '#4267B2',\n    },\n    login_footer_text: {\n      flexDirection: 'row',\n      alignItems: 'center',\n      color: '#808080',\n      fontSize: 14,\n    },\n    guest_footer_text: {\n      flexDirection: 'row',\n      alignSelf: 'center',\n      color: '#808080',\n      fontSize: 15,\n      margin: 15\n    },\n    login_footer_link: {\n      color: '#208AEC',\n      fontSize: 15,\n      fontWeight: 'bold',\n    },\n  });\n  ","import React, { createContext, useContext } from \"react\"\nimport { SendJsonMessage } from \"react-use-websocket/dist/lib/types\";\nimport { WebSocketInternalProvider } from \"../../hooks/useWebsocketContext\";\n\nconst WebSocketContext = createContext<{lastJsonMessage:any, sendJsonMessage:SendJsonMessage }>({lastJsonMessage:undefined, sendJsonMessage:()=>{}});\n\nexport const WebSocketProvider = ({disable, children}:{disable?:boolean, children:React.ReactNode})=>{\n  return disable?<></>:<WebSocketInternalProvider path={'messenger/ws/rtc/'} Context={WebSocketContext} useBackground>\n    {children}\n  </WebSocketInternalProvider>\n}\n\nexport default ()=>{\n  const webSocketContext = useContext(WebSocketContext)\n  return webSocketContext\n}\n\n","import React, { useCallback, useRef, useState, useMemo } from \"react\";\n//@ts-ignore\nimport { RTCView, mediaDevices, RTCPeerConnection, MediaStream, RTCSessionDescription, RTCIceCandidate } from \"react-native-webrtc-web-shim\";\nimport {TURN_SERVER} from \"../../../constants/Envs\"\n\n\nconsole.log(TURN_SERVER?\"use turn server\": \"use stun server\")\n\nexport const peerConstraints = {\n\ticeServers: [TURN_SERVER?JSON.parse(TURN_SERVER):{urls: 'stun:stun.l.google.com:19302'}]\n};\n\nexport const sessionConstraints = {\n\tmandatory: {\n\t\tOfferToReceiveAudio: true,\n\t\tOfferToReceiveVideo: true,\n\t\tVoiceActivityDetection: true\n\t}\n};\n\nconst mediaConstraints = {audio:true, video:{framerate:30}}\n\n//@ts-ignore\nexport {MediaStream, RTCPeerConnection, RTCSessionDescription} from \"react-native-webrtc-web-shim\";\n\nconst onICEcandidate = (pc:typeof RTCPeerConnection, message:any)=>{\n\tconst _message = message.data.rtcMessage\n\t\tconst candidate = new RTCIceCandidate(_message);\n\t\tif (pc) {\n\t\t\tconsole.log(\"ICE candidate Added\");\n\t\t\tpc.addIceCandidate(candidate);\n\t\t}\n}\n\nconst sendICEcandidate = (event:any, sendMessage:(data:any)=>void, receiver:string, target:string) => {\n\t// When you find a null candidate then there are no more candidates.\n\t// Gathering of candidates has finished.\n\tif ( !event.candidate ) { return; };\n\t// Send the event.candidate onto the person you're calling.\n\t// Keeping to Trickle ICE Standards, you should send the candidates immediately.\n\tsendMessage({type:'ICEcandidate', receiver, data:{target, rtcMessage:event.candidate}})\n  }\n\nconst BAND_WIDTH = 8000\n\nconst optimizeSdp = (offerDescription:RTCSessionDescription)=>{\n\tvar arr = offerDescription.sdp.split('\\r\\n');\n\tarr.forEach((str:string, i:number) => {\n\t\tif (/^a=fmtp:\\d*/.test(str)) {\n\t\t\tarr[i] = str + `;x-google-max-bitrate=${BAND_WIDTH};x-google-min-bitrate=${BAND_WIDTH};x-google-start-bitrate=${BAND_WIDTH}`;\n\t\t} else if (/^a=mid:(0|video)/.test(str)) { // if with audio then 0=>1\n\t\t\tarr[i] += `\\r\\nb=AS:${BAND_WIDTH}`;\n\t\t}\n\t});\n  \treturn new RTCSessionDescription({\n    \ttype: offerDescription.type,\n    \tsdp: arr.join('\\r\\n'),\n  \t})\n}\n\nconst createOffer = async(pcRefCurrent:{pc?:typeof RTCPeerConnection, receiver:string}, sendMessage:(data:any)=>void, stream:typeof MediaStream, target:string, user?:{name:string})=>{\n\tstream && pcRefCurrent.pc.addStream( stream );\n\tconst offerDescription = optimizeSdp((await pcRefCurrent.pc.createOffer( sessionConstraints )));\n\tawait pcRefCurrent.pc.setLocalDescription( offerDescription );\n\tsendMessage({type:'call', receiver:pcRefCurrent.receiver, data:{target, name:user?.name, rtcMessage:offerDescription}})\n}\n\nexport const useLocalCam = (sendMessage:(data:any)=>void)=>{\n\tconst pcRef = useRef<Record<number,{pc:typeof RTCPeerConnection, receiver:string}>>({})\n\tconst [sender, setSender] = useState<string>()\n\tconst [_stream, setStream] = useState<MediaStream>()\n\tconst isPlay = useMemo(()=>_stream?true:false, [_stream])\n\tconst CustomRTCView = useCallback(React.memo(({style}:{style:any})=>(_stream?<RTCView stream={_stream} style={style} videoProps={{height:'100%'}} />:<></>)) , [_stream])\n\tconst start = useCallback(async(user:{name:string}, stream?:typeof MediaStream, mode?:'camera'|'display')=>{\n\t\tconsole.log(\"start\");\n\t\tif (!_stream || mode!==undefined) {\n\t\t\ttry {\n\t\t\t\tlet newStream:typeof MediaStream;\n\t\t\t\tif(mode == 'camera'){\n\t\t\t\t\tnewStream = await mediaDevices.getUserMedia(mediaConstraints)\n\t\t\t\t}\n\t\t\t\telse if (mode == 'display'){\n\t\t\t\t\tnewStream = await mediaDevices.getDisplayMedia(mediaConstraints)\n\t\t\t\t}\n\t\t\t\telse{\n\t\t\t\t\tnewStream = stream || await mediaDevices.getUserMedia(mediaConstraints).catch((e:any)=>mediaDevices.getDisplayMedia(mediaConstraints));\n\t\t\t\t}\n\t\t\t\tsetStream(newStream)\n\t\t\t\tObject.entries(pcRef.current).map(([k, v])=>{\n\t\t\t\t\tcreateOffer(v, sendMessage, newStream, 'guest', user)\n\t\t\t\t})\n\t\t\t} catch (e) {\n\t\t\t\tconsole.error(e);\n\t\t\t}\n\t\t}\n\t}, [_stream])\n\tconst stop = useCallback(()=>{\n\t\tconsole.log(\"stop\");\n\t\tif(_stream){\n\t\t\t_stream.getTracks().map((track:any) => track.stop());\n\t\t\tsetStream(undefined)\n\t\t}\n\t}, [_stream])\n\treturn {\n\t\tstart,\n\t\tstop,\n\t\twebsocketOnMessage: async(response:any, user:{name:string})=>{\n\t\t\tlet type = response.type;\n\t\t\tif (type == 'connection'){\n\t\t\t\tsetSender(response.data.channel_name)\n\t\t\t}\n\t\t\tif (type == 'start' && response.data.target=='host'){\n\t\t\t  console.log('1 start')\n\t\t\t  const peerConnection = new RTCPeerConnection( peerConstraints );\n\t\t\t  peerConnection.addEventListener( 'icecandidate', (event:any) => sendICEcandidate(event, sendMessage, response.sender, 'guest'));\n\t\t\t  pcRef.current[response.sender] = {pc:peerConnection, receiver: response.sender}\n\t\t\t  createOffer(pcRef.current[response.sender], sendMessage, _stream, 'guest', user)\n\t\t\t}\n\t\t\t\n\t\t\tif (type == \"answer\" && response.data.target == 'host'){\n\t\t\t  console.log('3 answer')\n\t\t\t  const peerConnection = pcRef.current[response.sender].pc\n\t\t\t  const answerDescription = new RTCSessionDescription(response.data.rtcMessage);\n\t\t\t  await peerConnection.setRemoteDescription( answerDescription );\n\t\t\t  // const streams = pcRef.current.pc.getRemoteStreams()\n\t\t\t  // setMirrorStream(streams[streams.length - 1])\n\t\t\t}\n\t\t\tif (type == \"ICEcandidate\" && response.data.target=='host'){\n\t\t\t\tconst peerConnection = pcRef.current[response.sender].pc\n\t\t\t\tonICEcandidate(peerConnection, response)\n\t\t\t}\n\t\t},\n\t\tCustomRTCView,\n\t\tisPlay,\n\t\tsender,\n\t\t// renderMirrorView,\n\t}\n}\n\nexport const useRemoteCam = (sendMessage:(data:any)=>void)=>{\n\tconst pcRef = useRef<{pc?:RTCPeerConnection, receiver?:string, statsInterval?:any}>({})\n\tconst [user, setUser] = useState<{name:string}>()\n\tconst [_stream, setStream] = useState<MediaStream>()\n\tconst CustomRTCView = useCallback(React.memo((style:any)=>_stream?<RTCView stream={_stream} style={style} videoProps={{height:'100%'}} />:<></>), [_stream])\n\tconst isPlay = useMemo(()=>_stream?true:false, [_stream])\n\tconst start = useCallback((receiver:string)=>{\n\t\tconsole.log(\"start\");\n\t\tif (!pcRef.current.pc) {\n\t\t  pcRef.current.pc = new RTCPeerConnection( peerConstraints );\n\t\t  pcRef.current.receiver = receiver\n\t\t}\n\t\tif (!_stream){\n\t\t\tsendMessage({type:'start', receiver, data:{'target': 'host'}})\n\t\t}\n\t}, [_stream])\n\tconst stop = () => {\n\t\tconsole.log(\"stop\");\n\t\tif (pcRef.current.pc) {\n\t\t  // peerConnection._unregisterEvents();\n\t\t  setStream(undefined)\n\t\t  pcRef.current.pc.close();\n\t\t  pcRef.current.pc = undefined\n\t\t  pcRef.current.receiver = undefined\n\t\t  clearInterval(pcRef.current.statsInterval)\n\t\t}\n\t}\n\treturn {\n\t\tstart,\n\t\tstop,\n\t\twebsocketOnMessage: async(response:any)=>{\n\t\t\tlet type = response.type;\n\t\t\tif (type == 'start' && response.data.target=='guest' && response.sender == pcRef.current?.receiver){\n\t\t\t\tconsole.log('(remote)1 start')\n\t\t\t\tconst peerConnection = pcRef.current.pc\n\t\t\t\tsetUser({name: response.data.name})\n\t\t\t\tpeerConnection.addEventListener('icecandidate', (event:any) => sendICEcandidate(event, sendMessage, response.sender, 'host'));\n\t\t\t\tpeerConnection.addEventListener('iceconnectionstatechange', (e:any)=>{\n\t\t\t\t\tif (pcRef.current.pc.iceConnectionState == 'connected'){\n\t\t\t\t\t\tlet activeStream = false\n\t\t\t\t\t\tpcRef.current.statsInterval = setInterval(async()=>{\n\t\t\t\t\t\t\tconst stats = await pcRef.current.pc.getStats(null)\n\t\t\t\t\t\t\tlet statsOutput = \"\";\n\t\t\t\t\t\t\tlet framePerSecond = undefined\n\t\t\t\t\t\t\tstats.forEach((report:any) => {\n\t\t\t\t\t\t\t\tif (report.type === \"inbound-rtp\" && report.kind === \"video\") {\n\t\t\t\t\t\t\t\t\tObject.keys(report).forEach((statName) => {\n\t\t\t\t\t\t\t\t\t\tstatsOutput += `${statName}: ${report[statName]}\\n`;\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t\tframePerSecond = report.framesPerSecond\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\tconsole.log(activeStream, framePerSecond)\n\t\t\t\t\t\t\tif (framePerSecond != undefined){\n\t\t\t\t\t\t\t\tactiveStream = true\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse if (activeStream){\n\t\t\t\t\t\t\t\tstop()\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tconsole.log(new Date().toTimeString().split(' ')[0], statsOutput)\n\t\t\t\t\t\t}, 1000);\n\t\t\t\t\t}\n\t\t\t\t\telse if (pcRef.current.pc.iceConnectionState == 'failed'){\n\t\t\t\t\t\tstop()\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t// peerConnection.addTransceiver('audio', {\n\t\t\t\t// \tdirection: 'recvonly'\n\t\t\t\t// });\n\t\t\t\tpeerConnection.addTransceiver('video', {\n\t\t\t\t\tdirection: 'recvonly'\n\t\t\t\t});\n\t\t\t\tawait createOffer({pc:pcRef.current.pc, receiver:response.sender}, sendMessage, _stream, 'host', user)\n\t\t\t}  \n\t\t\tif (type == \"answer\" && response.data.target=='guest' && response.sender == pcRef.current?.receiver){\n\t\t\t\tconsole.log('(remote)3 answer')\n\t\t\t\tconst answerDescription = new RTCSessionDescription(response.data.rtcMessage);\n\t\t\t\tawait pcRef.current.pc.setRemoteDescription( answerDescription );\n\t\t\t\tconst streams = pcRef.current.pc.getRemoteStreams()\n\t\t\t\tsetStream(streams[streams.length - 1])\n\t\t\t\tsendMessage({type:'end', receiver:pcRef.current.receiver, data:{}})\n\t\t\t}\n\t\t\tif (type == \"call\" && response.sender == pcRef.current?.receiver){\n\t\t\t  console.log('2 call')\n\t\t\t  const peerConnection = pcRef.current.pc\n\t\t\t  setUser({name:response.data.name})\n\t\t\t  if (!peerConnection)\n\t\t\t\treturn\n\t\t\t  peerConnection.addEventListener( 'icecandidate', (event:any) => sendICEcandidate(event, sendMessage, response.sender, 'host'));\n\t\t\t  const offerDescription = new RTCSessionDescription(response.data.rtcMessage);\n\t\t\t  await peerConnection.setRemoteDescription( offerDescription );\n\t\t\t  const answerDescription = await peerConnection.createAnswer( sessionConstraints );\n\t\t\t  await peerConnection.setLocalDescription( answerDescription );\n\t\t\t  sendMessage({type:'answer', receiver:pcRef.current.receiver, data:{target:'host', rtcMessage:peerConnection.localDescription}})\n\t\t\t  // Here is a good place to process candidates.\n\t\t\t  const streams = pcRef.current.pc.getRemoteStreams()\n\t\t\t  setStream(streams[streams.length - 1])\n\t\t\t}\n\t\t\tif (type == \"ICEcandidate\" && response.data.target=='guest' && response.sender == pcRef.current?.receiver)\n\t\t\t  onICEcandidate(pcRef.current.pc, response)\n\t\t},\n\t\tCustomRTCView,\n\t\tuser,\n\t\tisPlay\n\t}\n}","import {StyleSheet} from \"react-native\";\nexport {useLocalCam, useRemoteCam} from \"./p2p\"\n\nexport const camStyle = StyleSheet.create({\n\tcontainer:{ flex: 1},\n\tcam:{ flex: 1, height:'100%'},\n\tbottonContainer: {position:\"absolute\", bottom:0, justifyContent:'flex-end'},\n\tbuttonBar: { flexDirection: \"row\", justifyContent: \"space-around\" },\n\tlabel: {backgroundColor:'#0008', color:'white', paddingHorizontal:5},\n})","import React, { useEffect } from \"react\";\nimport {Button, View, Text} from \"react-native\";\nimport useWebsocketContext from \"./useWebsocketContext\";\nimport { useLocalCam, camStyle} from \"./webrtc\";\n\n\nexport default (props:{user?:{name:string}|null, mode?:'camera'|'display'|null})=>{\n  const {lastJsonMessage, sendJsonMessage} = useWebsocketContext()\n  const {start, stop, websocketOnMessage, CustomRTCView, isPlay} = useLocalCam(sendJsonMessage)\n  useEffect(()=>{\n    props.user && lastJsonMessage && websocketOnMessage(lastJsonMessage, props.user)\n  }, [lastJsonMessage, props.user])\n  useEffect(()=>{\n    if(props.mode && !isPlay){\n      props.user && start(props.user, undefined, props.mode)\n    }\n    else if(props.mode===null && isPlay){\n      stop()\n    }\n    return ()=>{isPlay && stop()}\n  }, [isPlay, props.user, props.mode])\n  return (\n    <View style={camStyle.container}>\n      <CustomRTCView style={camStyle.cam}/>\n      <View style={camStyle.bottonContainer}>\n        <View style={camStyle.buttonBar}>  \n        </View>\n        <View style={{flexDirection:'row'}}><Text style={camStyle.label}>{props.user?.name}</Text></View>\n        <View style={camStyle.buttonBar}>\n          {props.mode === undefined && !isPlay && <Button title=\"Start\" onPress={()=>props.user && start(props.user)} />}\n          {props.mode === undefined && isPlay && <Button title=\"Stop\" onPress={stop} />}\n        </View>\n      </View>\n    </View>\n  );\n}\n","import React, { useState, useEffect, } from \"react\";\nimport {Button,Text, TextInput, View} from \"react-native\";\nimport useWebsocketContext from \"./useWebsocketContext\";\nimport { useRemoteCam, camStyle} from \"./webrtc\";\n\nexport default (props:{receiver?:string})=>{\n  const [receiver, setReceiver] = useState('')\n  const {lastJsonMessage, sendJsonMessage} = useWebsocketContext()\n  const {start, stop, websocketOnMessage, CustomRTCView, isPlay, user} = useRemoteCam(sendJsonMessage)\n  useEffect(()=>{\n    lastJsonMessage && websocketOnMessage(lastJsonMessage)\n  }, [lastJsonMessage])\n  useEffect(()=>{\n    if(props.receiver){\n      start(props.receiver)\n    }\n    return ()=>stop()\n  }, [props.receiver])\n  return (\n    <View style={camStyle.container}>\n      <CustomRTCView style={camStyle.cam}/>\n      <View style={camStyle.bottonContainer}>\n        <View style={camStyle.buttonBar}>\n        </View>\n        <View style={{flexDirection:'row'}}>{\n          (props.receiver || isPlay)?\n          <Text style={camStyle.label}>{user?.name || 'loading...'}</Text>:\n          <>\n            <Text style={{borderWidth:1}}>Receiver:&nbsp;</Text>\n            <TextInput style={{borderWidth:1, flex:1}} value={receiver} onChangeText={setReceiver}/>\n          </> \n        }</View>\n        <View style={camStyle.buttonBar}>\n          {props.receiver === undefined && !isPlay && <Button title=\"Start\" onPress={()=>start(receiver)} />}\n          {props.receiver === undefined && isPlay && <Button title=\"Stop\" onPress={stop} />}\n        </View>\n      </View>\n    </View>\n  );\n}\n\n","import React, {useEffect, useState} from 'react';\nimport { StyleSheet, View } from 'react-native';\nimport { View as ThemedView } from '../../../components/Themed' \nimport Colors from '../../../constants/Colors';\nimport {default as useRtcContext, WebSocketProvider as RtcProvider} from \"../../../lib/react-native-webrtc/useWebsocketContext\";\nimport LocalCam from '../../../lib/react-native-webrtc/LocalCam';\nimport RemoteCam from '../../../lib/react-native-webrtc/RemoteCam';\nimport useResizeContext from '../../../hooks/useResizeContext';\nimport useAuthContext from '../../../hooks/useAuthContext';\nimport { TouchableOpacity } from 'react-native-gesture-handler';\nimport CommonButton from '../../../components/CommonButton';\nimport { Ionicons } from '../../../lib/@expo/vector-icons';\nimport useIsMobile from '../../../hooks/useIsMobile';\n\ntype VideoType = 'camera'|'display'|null\ntype VideoCallProps = {channel_id:number, setDisable:(disable:boolean)=>void, disable?:boolean}\n\n\nconst VideoView = (props:{\n  scale:string,\n  focusGuest?:string,\n  setFocusGuest:(focusGuest?:string)=>void\n  receiver?:string\n  children:React.ReactNode\n})=>{\n  return <View style={[{maxWidth:props.scale, maxHeight:props.scale, borderWidth:1, borderColor:Colors.borderColor, backgroundColor:'gray', flexDirection:'row', flexGrow:1}, (props.focusGuest == undefined || props.focusGuest == props.receiver)?{height:'100%'}:{maxWidth:0, height:0}]}>\n    <TouchableOpacity style={{flex:1}} containerStyle={{flex:1, justifyContent:'center'}} onPress={()=>props.setFocusGuest(props.focusGuest?undefined:props.receiver)}>\n    {props.children}\n    </TouchableOpacity>\n  </View>\n    \n  \n}\n\nconst VideoCallContainer = ({channel_id, disable, setDisable}:VideoCallProps)=>{\n  const {auth} = useAuthContext()\n  const isMobile = useIsMobile()\n  const [videoMode, setVideoMode] = useState<VideoType>(null)\n  const [guests, setGuests] = useState<string[]>([])\n  const [focusGuest, setFocusGuest] = useState<string>()\n  const windowType = useResizeContext()\n  const { lastJsonMessage, sendJsonMessage } = useRtcContext()\n  useEffect(()=>{\n    if(lastJsonMessage !=null){\n      if(lastJsonMessage['type']=='connection'){\n        sendJsonMessage({'type':'broadcast', 'data':{'channel_id':channel_id}})\n      }\n      if(lastJsonMessage['type']=='broadcast_guest' || lastJsonMessage['type']=='broadcast_host'){\n        setGuests([...guests, lastJsonMessage['sender']])\n      }\n      if(lastJsonMessage['type']=='broadcast_disconnect'){\n        const channel_name = lastJsonMessage['sender']\n        const exist = guests.find(v=>v == channel_name)\n        exist && setGuests(guests.filter(v=>v != channel_name))\n      }\n    }\n  }, [lastJsonMessage])\n  const scale = focusGuest?'100%':`${100 / Math.max(2, Math.ceil(Math.sqrt(guests.length + 1)))}%`\n  const toggleVideoMode = (mode:VideoType)=>{\n    setVideoMode(videoMode!=mode?mode:null)\n  }\n  return lastJsonMessage !==undefined ?\n    <ThemedView style={[\n      {aspectRatio:!disable?16/9:0, borderColor:Colors.borderColor, borderRadius:10},\n      windowType=='landscape'?{flexShrink:1, flexGrow:0, height:'100%', borderLeftWidth:1, paddingBottom:65}:{maxHeight:'36%', width:'100%', borderBottomWidth:1}\n    ]}>\n      <View style={{aspectRatio:focusGuest?undefined:16/9, backgroundColor:'white', flexWrap:'wrap', flexDirection:'row', width:'100%', height:'100%'}}>\n        {guests.map((receiver, i)=><VideoView scale={scale} focusGuest={focusGuest} setFocusGuest={setFocusGuest} receiver={receiver}>\n          <RemoteCam receiver={receiver}/>\n        </VideoView>\n        )}\n        <VideoView scale={scale} focusGuest={focusGuest} setFocusGuest={setFocusGuest} receiver={auth.user?.name}>\n          <LocalCam user={auth.user} mode={videoMode}/>\n        </VideoView>\n      </View>\n      <ThemedView style={[\n          {position:'absolute', alignItems:'center', justifyContent:'flex-end', width:'100%',flexDirection:'row'},\n          windowType=='landscape'?{bottom:0, paddingTop:15, paddingBottom:10, paddingHorizontal:19}:{backgroundColor:'transparent'}\n        ]}>\n        <CommonButton title={''} style={{height:40, paddingTop:8}} onPress={()=>toggleVideoMode('camera')}/>\n        {!isMobile && <CommonButton title={''} style={{height:40, paddingTop:8}} onPress={()=>toggleVideoMode('display')}/>}\n        <CommonButton title={''} style={{height:40, paddingTop:8}} onPress={()=>setDisable(true)}>\n          <Ionicons size={20} name=\"arrow-back\" color={'deepskyblue'}/>\n        </CommonButton>\n      </ThemedView>\n    </ThemedView>:\n  <></>\n  }\n  \nexport default React.memo(({channel_id, disable, setDisable}:VideoCallProps)=>{\n  return <RtcProvider disable={disable}>\n    <VideoCallContainer channel_id={channel_id} disable={disable} setDisable={setDisable}/>\n  </RtcProvider>\n})\n","import React, {useState} from \"react\"\nimport {View, TouchableOpacity} from 'react-native'\nimport { Text } from \"../../../components/Themed\";\nimport useUploadContext from \"../../../hooks/useUploadContext\";\n\nconst UploadTag = (props:{data:{filename:string, progress?:number}, index:number, isExpand:boolean, setExpand:(index?:number)=>void})=>{\n    return <View style={{backgroundColor:'lightgray', borderRadius:20, overflow:'hidden', margin:5}}>\n        <View style={{backgroundColor:'darkgray', position:'absolute', width:`${(props.data.progress || 0)*100}%`, height:'100%'}}/>\n        <View style={{paddingVertical:5, paddingHorizontal:5, flexDirection:'row'}}>\n            <Text></Text>\n            <View style={{paddingHorizontal:5}}><Text>{props.data.filename}</Text></View>\n        </View>\n    </View>\n}\n\n\nexport default (props:{channel_id:number})=>{\n    const { upload } = useUploadContext()\n    const [expand, setExpand] = useState<number>()\n    const uploadData = upload[props.channel_id]\n    return <View style={{flexDirection:'row', paddingTop:5, paddingHorizontal:(uploadData?.length || 0)>0?20:0}}>\n        {uploadData?.map((f,i)=><UploadTag key={i} data={f} index={i} isExpand={i==expand} setExpand={setExpand}/>)}\n    </View>\n}","import React from 'react';\nimport { Editor } from '@tinymce/tinymce-react';\nimport { EditorProps } from '../../types';\nconst INIT = require('../../../web/editor-config')\nconst PATH = process.env.PUBLIC_URL + '/tinymce/tinymce.min.js'\n\nexport default (props:EditorProps) => {\n\treturn <Editor\n        tinymceScriptSrc={PATH}\n        onInit={(e, editor) => {props.onReady?.()}}\n        onEditorChange={props.setValue}\n        init={{\n          setup:INIT.setup,\n          plugins: INIT.plugins,\n          toolbar: INIT.toolbar,\n          height: '100%',\n          skin: props.theme=='light'?'oxide':'oxide-dark',\n          content_css: props.theme=='light'?'default':'dark',\n          menubar: false,\n          branding: false,\n          statusbar: false,\n          block_formats: '1=h2;2=h3;3=h4;=p;',\n          fontsize_formats: '11pt 14pt 18pt 24pt',\n        }}\n        value={props.value}\n    />\n};\n","import React, { useState, useEffect } from 'react';\nimport { View } from 'react-native';\nimport Editor from '../lib/tinymce/Editor';\n// import Editor from '../lib/tinymce/EditorView';\nimport { EditorProps } from '../types';\n\nexport default (props:EditorProps & {active:boolean, children?:React.ReactNode}) => {\n\tconst [ready, setReady] = useState<boolean>(false)\n  useEffect(()=>{\n    if(!props.active)\n      setReady(false)\n  }, [props.active])\n  return props.active?(\n        <View style={{flex:1, height:'100%'}}>\n        {!ready && props.children}\n    \t  <Editor\n          theme={props.theme}\n          value={props.value}\n          setValue={props.setValue}\n          onReady={()=>{\n            if(!ready){\n              setReady(true); props.onReady?.()\n            }\n          }}/>\n      </View>\n    ):<>{props.children}</>;\n};\n","import React from \"react\"\nimport CommonSection from \"../../../components/CommonSection\"\nimport Colors from \"../../../constants/Colors\"\nimport useColorScheme, { setColorScheme } from \"../../../hooks/useColorScheme\"\nimport { StyleSheet, Text, View} from 'react-native';\nimport useLangContext from \"../../../hooks/useLangContext\";\nimport { useColorScheme as useConfigColorScheme} from 'react-native-appearance';\nimport useFirebaseContext from \"../../../hooks/useFirebaseContext\";\nimport TextButton from \"../../../components/TextButton\";\nimport useModalsContext from \"../../../hooks/useModalsContext\";\nimport RegistrationModal from \"../../../modals/RegistrationModal\";\nimport useAuthContext from \"../../../hooks/useAuthContext\";\n\n\nconst ConfigSection = ({title, children}:{title:string, children?: React.ReactNode})=>{\n  const theme = useColorScheme()\n  const color = Colors[theme].text\n  return <CommonSection bodyStyle={{alignItems:'flex-start', backgroundColor:theme=='light'?'transparent':\"black\"}}>\n    <Text style={{fontSize:20, color, fontWeight:'600'}}>{title}</Text>\n    {children}\n  </CommonSection>\n}\n\nexport default ()=>{\n  const { lang, locale, setLocale } = useLangContext()\n  const { setModal } = useModalsContext()\n  const {auth} = useAuthContext()\n  const theme = useColorScheme()\n  const configTheme = useConfigColorScheme()\n  const {enable:noti, setEnable:setNoti} = useFirebaseContext()\n  const color = Colors[theme].text\n  return <>\n    <ConfigSection title={lang('* Notification Settings')}>\n      <View style={{flexDirection:'row'}}>\n        {[[lang('On'), true], [lang('Off'), false]].map(([title, n])=><TextButton\n          key={title} title={title || ''} textStyle={{fontSize:16, color, textDecorationLine:noti==n?'underline':'none'}} style={{borderRadius:20}} onPress={()=>{setNoti(n)}}/>)}\n      </View>\n    </ConfigSection>\n    <ConfigSection title={lang('* Language Settings')}>\n    <View style={{flexDirection:'row'}}>\n        {[[lang('Auto'), 'auto'], ['', 'ko'], ['English', 'en']].map(([title, l])=><TextButton \n          key={title} title={title || ''} textStyle={{fontSize:16, color, textDecorationLine:locale==l?'underline':'none'}} style={{borderRadius:20}} onPress={()=>setLocale(l)}/>)}\n      </View>\n    </ConfigSection>\n    <ConfigSection title={lang('* Skin Settings')}>\n      <View style={{flexDirection:'row'}}>\n        {[[lang('Auto'), 'no-preference'], [lang('Light'), 'light'], [lang('Dark'), 'dark']].map(([title, colorScheme])=><TextButton \n          key={title} title={title} textStyle={{fontSize:16, color, textDecorationLine:configTheme==colorScheme?'underline':'none'}} style={{borderRadius:20}} onPress={(\n            )=>setColorScheme(colorScheme)}/>)}\n      </View>\n    </ConfigSection>\n    {!auth.user?.is_guest && <CommonSection bodyStyle={{alignItems:'flex-start', backgroundColor:theme=='light'?'transparent':\"black\"}}>\n      <TextButton title={lang('> Account Settings')} textStyle={{fontSize:20, color}} style={{paddingLeft:0, borderRadius:20}} onPress={()=>setModal(RegistrationModal, {id:auth.user?.id})}/>\n    </CommonSection>}\n  </>\n}","import React, {useState, useEffect, useLayoutEffect, useMemo} from 'react';\nimport { StackScreenProps } from '@react-navigation/stack';\nimport { StyleSheet, View, ScrollView} from 'react-native';\nimport { Text as StyledText } from 'react-native-paper';\nimport { Text } from '../../../components/Themed'\nimport useResizeContext from '../../../hooks/useResizeContext';\nimport TabView from '../../../components/TabView';\nimport HeaderRight from '../../../components/HeaderRight';\nimport TextButton from '../../../components/TextButton';\nimport Colors from '../../../constants/Colors';\nimport useColorScheme  from '../../../hooks/useColorScheme';\nimport useModalsContext from '../../../hooks/useModalsContext';\nimport ChannelEditModal from '../../../modals/ChannelEditModal';\nimport useLangContext from '../../../hooks/useLangContext';\nimport ContractFooter from '../../../components/ContractFooter';\nimport { TabViewRecord } from '../../../types';\nimport useAuthContext from '../../../hooks/useAuthContext';\nimport useUserMembershipList from '../../../hooks/lists/useUserMembershipList';\nimport { FontAwesome, Ionicons, MaterialCommunityIcons, SimpleLineIcons } from '../../../lib/@expo/vector-icons';\nimport { useMessengerChannelSorted } from '../../../hooks/lists/useMessengerChannelList';\nimport CommonItem from '../../../components/CommonItem';\nimport MemberItem from '../../../components/MemberItem';\nimport ProfileModal from '../../../modals/ProfileModal';\nimport { navigate } from '../../../navigation';\nimport CommonSection from '../../../components/CommonSection';\nimport ConfigSections from './ConfigSections';\nimport Avatar, { avatarFromChannel } from '../../../components/Avatar';\nimport RegistrationModal from '../../../modals/RegistrationModal';\n\nconst MemberTabView = ()=>{\n  const {auth} = useAuthContext()\n  const theme = useColorScheme()\n  const { setModal } = useModalsContext()\n  const userList = useUserMembershipList(auth)\n  const memberItem = React.useMemo(\n      ()=>userList && userList.map((item, index)=><MemberItem key={index} member={item} onPress={()=>setModal(ProfileModal, {id:item.id})}/>), [userList])\n  return <ScrollView style={{flex:1, backgroundColor:Colors[theme].background}}>\n      {memberItem}\n  </ScrollView>\n}\n\nconst MessengerTabView = ()=>{\n  const {auth} = useAuthContext()\n  const channelList = useMessengerChannelSorted(auth)\n  const theme = useColorScheme()\n\n  const today = (new Date()).toISOString().slice(0, 10)\n  return <ScrollView style={{flex:1, backgroundColor:Colors[theme].background}}>\n      {channelList?.map((item, index)=>{\n          const {avatar, name} = avatarFromChannel(item, auth.user)\n          const date = item.last_message?.created.slice(0,10)\n          const content = item.last_message?.preview_content || item.last_message?.content || ''\n          return <CommonItem key={index} bodyStyle={{flexDirection:'row', justifyContent:'space-between'}} onPress={()=>navigate(\"ChatScreen\", {id:item.id})}>\n              <View style={{flexDirection:'row', flexShrink:1}}>\n                  {avatar?\n                    <View style={{ marginRight:20}}>\n                      <Avatar name={avatar.name} size={44} userId={avatar.id}/>\n                    </View>:\n                    <FontAwesome size={40} color={Colors[theme].iconColor} style={{ marginBottom: -3, marginRight:20 }} name='users'/>}\n                  <View>\n                      <View style={{flexDirection:'row'}}>\n                          <Text style={{fontSize:18}}>{name}</Text>\n                          <Text style={{fontSize:18, opacity: 0.4, paddingLeft:5}}>{item.member_count}</Text>\n                      </View>\n                      <Text style={{fontSize:16, opacity: 0.4}}>{content.replaceAll('\\n', ' ')}</Text>\n                  </View>\n              </View>\n              <View>\n                  <Text style={{fontSize:14, opacity: 0.4, textAlign:'right'}}>{date==today?item.last_message?.created.slice(11,16):date}</Text>\n                  <Text style={{fontSize:14, textAlign:'right'}}>{item.unread_count?item.unread_count:' '}</Text>\n              </View>\n          </CommonItem>\n      })}\n  </ScrollView>\n}\n\n\nconst ConfigTabView = ()=>{\n  const theme = useColorScheme()\n  return <ScrollView style={{flex:1, backgroundColor:Colors[theme].background}}>\n    <ConfigSections/>\n  </ScrollView>\n}\n\nconst getBottomTabs = (theme:'light'|'dark')=>{\n  const color = Colors[theme].iconColor\n  return {\n    OneTab:{\n        title:'member',\n        component:MemberTabView,\n        icon:<MaterialCommunityIcons size={32} color={color} style={{ marginBottom: -3 }} name='account'/>,\n    },\n    TwoTab:{\n        title:'chat',\n        component:MessengerTabView,\n        icon:<Ionicons size={30} color={color} style={{ marginBottom: -3 }} name='chatbox'/>\n    },\n    // ThreeTab:{\n    //     title:'board',\n    //     component:()=><></>,\n    //     icon:<></>\n    // },\n    FourTab:{\n        title:'config',\n        component:ConfigTabView,\n        icon:<SimpleLineIcons size={30} color={color} style={{ marginBottom: -3 }} name='options'/>\n    }\n  } as TabViewRecord\n}\n\n\nexport default function HomeScreen({navigation, route}: StackScreenProps<any, 'Home'>) {\n  const { lang, locale } = useLangContext()\n  const windowType = useResizeContext();\n  const theme = useColorScheme()\n  const { setModal } = useModalsContext()\n  const {auth} = useAuthContext()\n  const [ home, setHome ] = useState(windowType == 'landscape')\n  const color = Colors[theme].text\n  const options = [\n    {title:lang('member'), headerRight:()=><HeaderRight extra={[{title:lang('create'), onPress:()=>setModal(RegistrationModal, auth.user?.is_guest?{id:auth.user.id}:{})}]}/>},\n    {title:lang('chat'), headerRight:()=><HeaderRight extra={[{title:lang('create'), onPress:()=>setModal(ChannelEditModal, {type:'messenger'})}]}/>},\n    // {title:'board', headerRight:()=><HeaderRight extra={[{title:'create', onPress:()=>setModal(ChannelEditModal, props:{type:'board'}}) }]}/>},\n    {title:lang('config'), headerRight:()=><HeaderRight/>}\n  ]\n  \n  useLayoutEffect(() => {\n    const index = route?.params?.tab | 0\n    navigation.setOptions(windowType == 'portrait'?options[index]:{\n      title: lang('home'),\n      headerRight: ()=><HeaderRight/>\n    });\n  }, [navigation, route, windowType, locale]);\n  useEffect(()=>{\n    setHome(windowType == 'landscape')\n  }, [windowType])\n  return home?\n    <ScrollView contentContainerStyle={{flex:1, alignItems:'center'}}>\n      <View style={{flexGrow:1, width:'80%', marginTop:72}}>\n        <StyledText style={{fontSize:32, color}}>Tokki Tok</StyledText>\n        <View style={{backgroundColor:Colors.borderColor, height:1, width:'100%'}}/>\n        {/* <Text style={{fontSize:20, color:'gray'}}>Welcome! This is a messenger for teams.</Text>*/}\n        <View style={{height:24}}/>\n        <CommonSection bodyStyle={{alignItems:'flex-start', backgroundColor:theme=='light'?'transparent':\"black\"}}>\n          <TextButton title={lang('+ New chat')} textStyle={{fontSize:20, color}} style={{paddingLeft:0, borderRadius:20}} onPress={()=>setModal(ChannelEditModal, {type:'messenger'})}/>\n        </CommonSection>\n        <ConfigSections/>\n      </View>\n      <ContractFooter theme={theme}/>\n    </ScrollView>:\n    <TabView tabs={getBottomTabs(theme)} tabBarPosition=\"bottom\" index={parseInt(route.params?.['tab'] || 0)} onTab={(index)=>{navigation.setParams({tab:index})}}/>\n}\n\n","import LoginScreen from \"./main/LoginScreen\";\nimport ChatScreen from \"./main/ChatScreen\";\nimport HomeScreen from \"./main/HomeScreen\";\n// import BoardScreen from \"../lib/blacktokki-board/BoardScreen\";\n// import BoardEditScreen from \"../lib/blacktokki-board/BoardEditScreen\";\nimport { Screens } from \"../types\";\nimport DemoScreen from \"./main/DemoScreen\";\n\nexport const main = {\n    HomeScreen:{\n        title:'home',\n        component:HomeScreen,\n        path:'home',\n    },\n    ChatScreen:{\n        title:'chat',\n        component:ChatScreen,\n        path:'chat'\n    },\n    // BoardScreen:{\n    //     title:'board',\n    //     component:BoardScreen,\n    //     path:'board'\n    // },\n} as Screens\n\nexport const login = {\n    LoginScreen:{\n        path: 'login',\n        title: 'Sign in',\n        component:LoginScreen\n    },\n    DemoScreen:{\n        title:'',\n        component:DemoScreen,\n        path:'demo'\n    }\n} as Screens\n\nexport const modal = {\n    // BoardEditScreen:{\n    //     title:'board',\n    //     component:BoardEditScreen,\n    //     path:'modal/board'\n    // },\n} as Screens","import React, { useEffect, useLayoutEffect, useMemo, useRef, useState} from 'react';\nimport { StackScreenProps } from '@react-navigation/stack';\nimport { Platform, View } from 'react-native';\nimport { TextInput } from 'react-native-gesture-handler';\nimport CommonButton from '../../../components/CommonButton';\nimport { useMessengerContentMutation } from '../../../hooks/lists/useMessengerContentList';\nimport useAuthContext from '../../../hooks/useAuthContext';\nimport HeaderRight from '../../../components/HeaderRight';\nimport useMessengerMemberList from '../../../hooks/lists/useMessengerMemberList';\nimport Colors from '../../../constants/Colors';\nimport useColorScheme from '../../../hooks/useColorScheme';\nimport { View as ThemedView } from '../../../components/Themed' \nimport useMessengerChannelList from '../../../hooks/lists/useMessengerChannelList';\nimport useIsMobile from '../../../hooks/useIsMobile';\nimport { avatarFromChannel } from '../../../components/Avatar';\nimport VideoCallSection from './VideoCallSection';\nimport useResizeContext from '../../../hooks/useResizeContext';\nimport useModalsContext from '../../../hooks/useModalsContext';\nimport InviteModal from '../../../modals/InviteModal';\nimport DateTimePickerModal from '../../../modals/DateTimePickerModal'\nimport useLangContext from '../../../hooks/useLangContext';\nimport { Entypo } from '../../../lib/@expo/vector-icons';\nimport TimerTags, { timerFormat } from './TimerTags';\nimport ChannelEditModal from '../../../modals/ChannelEditModal';\nimport UploadTags from './UploadTags';\nimport Messages from './Messages';\nimport Editor from '../../../components/Editor';\n\n\nfunction uploadFile(){\n  return new Promise<Blob|undefined>((resolve, reject)=>{\n    if (Platform.OS == 'web'){\n      var input = document.createElement('input');\n      input.type = 'file';\n      input.onchange = e => { \n        resolve((e.target as any).files[0])\n      }\n      input.onabort = reject\n      input.onerror = reject\n      input.click();\n    }\n    else\n      resolve(undefined)\n  })\n}\n\nexport default function ChatScreen({navigation, route}: StackScreenProps<any, 'Chat'>) {\n  const { lang, locale } = useLangContext()\n  const isMobile = useIsMobile()\n  const channel_id = route?.params?.id\n  const inputRef = useRef<TextInput>(null)\n  const {auth} = useAuthContext()\n  const { setModal } = useModalsContext()\n  const channel = useMessengerChannelList(auth)?.find(v=>v.id==parseInt(channel_id))\n  const channelAvatar = channel?avatarFromChannel(channel, auth.user):undefined\n  const memberList = useMessengerMemberList(channel_id)\n  const member_id = useMemo(()=>memberList?.find(v=>v.user == auth.user?.id)?.id, [auth, memberList])\n  const windowType = useResizeContext()\n  const [value, setValue] = useState('')\n  const [editorValue, setEditorValue] = useState('')\n  const [timer, setTimer] = useState<string>()\n  const [autoFocus, setAutoFocus] = useState<boolean|null>(null)\n  const [videoMode, setVideoMode] = useState<boolean>(false)\n  const [bottomTab, setBottomTab] = useState<boolean>(false)\n  const [isEditor, setIsEditor] = useState<boolean>(false)\n  const [messageEvent, sendToScreen] = useState<{value:string, editorValue:string}>()\n  const valueLines = useMemo(()=>bottomTab?1:value.split(\"\\n\").length, [value, bottomTab])\n\n  const theme = useColorScheme()\n  const postValue = ()=>{\n    if (value.length>0){\n      if(isEditor){\n        contentMutation.create({channel:channel_id, user:auth.user?.id, content:'', timer, editor: {title:value, content:editorValue}})\n      }\n      else{\n        contentMutation.create({channel:channel_id, user:auth.user?.id, content:value, timer})\n      }\n      setTimer(undefined)\n      setBottomTab(false)\n      setValue('')\n      setAutoFocus(true)\n      if(isEditor){\n        setEditorValue('')\n        setIsEditor(false)\n      }\n    }\n  }\n  useEffect(()=>{\n    if(messageEvent){\n      setIsEditor(false)\n      setValue(value.concat(value.length>0?\"\\n\":\"\", messageEvent.value))\n      setEditorValue(editorValue.concat(\"\\r\\n\", messageEvent.editorValue))\n      sendToScreen(undefined)\n      setIsEditor(true)\n    }\n  }, [messageEvent, value, editorValue])\n  const contentMutation = useMessengerContentMutation()\n\n  useLayoutEffect(() => {\n    navigation.setOptions({\n      headerRight: ()=> <HeaderRight extra={[\n        {title:lang('invite'), onPress:()=>setModal(InviteModal, {id:channel_id})},\n        {title:lang('setting'), onPress:()=>setModal(ChannelEditModal, {id:channel_id, type:'messenger', member_id})}\n      ]}/>,\n      title: channelAvatar?.name,\n      headerShown:!(windowType=='portrait' && isEditor)\n    });\n  }, [navigation, route, member_id, locale, windowType, isEditor]);\n\n  const back = ()=>{\n    if(navigation.canGoBack())\n        navigation.goBack()\n      else{\n        navigation.navigate('HomeScreen', {tab:2})\n      }\n  }\n  const onKeyPress = (e:any) => {\n    if (!isMobile){\n      const event = e as KeyboardEvent;\n        if (!event.shiftKey && event.key === \"Enter\"){\n          postValue()\n          event.preventDefault()\n      }\n    }\n  }\n  useEffect(()=>{\n    setModal(null, null)\n    if (!channel_id)\n      back()\n  }, [route])\n  useEffect(()=>{\n    if (memberList===null || (memberList!=undefined && memberList.find(v=>v.user==auth.user?.id)==undefined))\n      back()\n  }, [memberList])\n  useEffect(()=>{\n    if(autoFocus){\n      (inputRef.current as any).focus?.()\n      setAutoFocus(false)\n    }\n  }, [autoFocus])\n  useEffect(()=>{\n    if (autoFocus==null && !isMobile){\n      const timeout = setTimeout(()=>setAutoFocus(true), 500)\n      return ()=>clearTimeout(timeout)\n    }\n  })\n  return <View style={[\n    {flex:1, alignItems:'center'},\n    windowType=='landscape'?{flexDirection:'row-reverse', minWidth:480}:{flexDirection:'column'}\n  ]}>\n    <VideoCallSection channel_id={channel_id} setDisable={(d)=>setVideoMode(!d)} disable={!videoMode}/>\n    <View style={[videoMode?{flexShrink:1}:{flex:1}, windowType=='landscape'?{minWidth:320, height:'100%'}:{width:'100%'}]}>\n      <Messages channel_id={channel_id} auth={auth} reverse sendToScreen={sendToScreen}/>\n      <View style={{position:'absolute', flexDirection:'row'}}>\n        <UploadTags channel_id={channel_id}/>\n        <TimerTags channel_id={channel_id}/>\n      </View>\n      <ThemedView style={[{bottom:0, width:'100%', paddingTop:15, paddingBottom:10, paddingHorizontal:19}, isEditor?{height:windowType=='landscape'?'50%':'100%'}:{}]}>\n        <View style={{alignItems:'center', width:'100%',flexDirection:'row'}}>\n          <CommonButton title={''} style={{height:'100%', paddingTop:8, borderTopRightRadius:0, borderBottomRightRadius:0, justifyContent:'center'}} onPress={()=>{isEditor?setIsEditor(false):setBottomTab(!bottomTab)}}>\n            <View style={{top:-2}}>\n              <Entypo name={isEditor || bottomTab?\"cross\":\"plus\"} size={24} color={Colors[theme].text}/>\n            </View>\n          </CommonButton>\n          {timer && <CommonButton style={{height:'100%', paddingTop:8, borderRadius:0}} title={`${timerFormat(timer)}`} onPress={()=>{setModal(DateTimePickerModal, {datetime:timer, callback:(datetime:string)=>setTimer(datetime)});setBottomTab(false)}}/>}\n          <TextInput\n              ref={inputRef}\n              value={value} \n              onChangeText={setValue}\n              onKeyPress={onKeyPress}\n              style={{flex:1, borderWidth:1, minHeight:41, borderColor:Colors.borderColor, backgroundColor:Colors[theme].background, color:Colors[theme].text, paddingVertical:1, paddingHorizontal:3}}\n              onFocus={()=>setBottomTab(false)}\n              multiline \n              numberOfLines={valueLines}/>\n          <CommonButton style={{height:'100%', paddingTop:8, borderTopLeftRadius:0, borderBottomLeftRadius:0, justifyContent:'center'}} title={''} onPress={postValue}/>\n        </View>\n        <Editor theme={theme} active={isEditor} value={editorValue} setValue={setEditorValue} onReady={()=>setBottomTab(false)}/>\n        {bottomTab && <View style={{alignItems:'center', width:'100%', flexDirection:'row', paddingTop:15, paddingBottom:5}}>\n          <CommonButton style={{height:80, flex:1, justifyContent:'center', marginRight:15}} title={`\\n ${lang('File')}`} onPress={()=>uploadFile().then(f=>{contentMutation.create({channel:channel_id, user:auth.user?.id, content:'', file:f});setBottomTab(false)})}/>\n          <CommonButton style={{height:80, flex:1, justifyContent:'center', marginRight:15}} title={`\\n ${lang('Editor')}`} onPress={()=>{setIsEditor(!isEditor); isEditor && setBottomTab(false)}}/>\n          <CommonButton style={{height:80, flex:1, justifyContent:'center', marginRight:15}} title={`\\n ${lang('Timer')}`} onPress={()=>{setModal(DateTimePickerModal, {datetime:timer, callback:(datetime:string)=>setTimer(datetime)});setBottomTab(false)}}/>\n          <CommonButton style={{height:80, flex:1, justifyContent:'center'}} title={`\\n ${lang('Video Call')}`} onPress={()=>{setVideoMode(!videoMode);setBottomTab(false)}} disabled={videoMode}/>\n        </View>}\n      </ThemedView>\n    </View>\n  </View>\n}","import React, { useLayoutEffect } from 'react';\n\nimport { StackScreenProps } from '@react-navigation/stack';\nimport useAuthContext from '../../hooks/useAuthContext';\n\nexport default function DemoScreen({navigation}: StackScreenProps<any, 'Demo'>) {\n    const {dispatch} = useAuthContext()\n    useLayoutEffect(() => {\n        navigation.setOptions({headerRight: undefined});\n        dispatch({type:\"LOGIN_GUEST\"})\n    }, []);\n  return <></>\n};","import React from 'react';\nimport useAuthContext from '../hooks/useAuthContext';\nimport CommonButton from '../components/CommonButton';\nimport useModalsContext from '../hooks/useModalsContext';\nimport { Text, View } from '../components/Themed';\nimport useLangContext from '../hooks/useLangContext';\nimport { BottomSheet } from '../components/ModalSection';\nimport useModalEffect from '../hooks/useModalEffect';\n\n\nexport default function AlertModal({type}:{type:string}) {\n  const { lang } = useLangContext()\n  const { setModal } = useModalsContext()\n  const {dispatch} = useAuthContext()\n  const back = ()=>{\n    setModal(AlertModal, null)\n  }\n  const messages = {\n    \"GUEST_LOGOUT\":{\n      message: 'Guest users cannot reconnect after logging out. Please create an account or log in.',\n      title: 'sign out',\n      onPress: ()=>dispatch({type:\"LOGOUT_REQUEST\"})\n    }\n  } as Record<string, {message:string, title:string, onPress:()=>void}>\n\n  useModalEffect(back, [])\n  return <BottomSheet>\n    <Text>{lang(messages[type].message)}</Text>\n    <View style={{width:'100%', flexDirection:'row', justifyContent:'flex-end'}}>\n      <CommonButton title={lang(messages[type].title)} onPress={messages[type].onPress}/>\n      <CommonButton title={lang('cancel')} onPress={()=>back()}/>\n    </View>\n  </BottomSheet>\n}\n","import { useQuery } from \"react-query\";\nimport { getExternalMembershipList } from \"../../services\";\n\nexport default function useExternalMembershipList(keyword?:string){\n  const { data } = useQuery([\"UserMembershipList\", keyword] , async()=>keyword?(await getExternalMembershipList(keyword)):[])\n  return data\n}","import React from 'react';\nimport { StyleProp, TextStyle } from 'react-native';\nimport { CustomTextInputProps } from '../types';\nimport CommonTextInput from './CommonTextInput';\nimport RowField from './RowField';\n\nexport default function TextField(props:CustomTextInputProps & {name: string, width?:any, textStyle?:StyleProp<TextStyle>}) {\n  return (\n    <RowField name={props.name} width={props.width} textStyle={props.textStyle}>\n      <CommonTextInput {...props} />\n   </RowField>\n  )\n}","import React, { useState } from 'react';\nimport { TextInput } from 'react-native';\nimport Colors from '../constants/Colors';\nimport useColorScheme from '../hooks/useColorScheme';\nimport { CustomTextInputProps } from '../types';\n\nexport default (props:CustomTextInputProps)=>{\n    const [contentHeight, setContentHeight] = useState<number>()\n    const minHeight = props.minHeight || 30\n    const theme = useColorScheme()\n    return <TextInput style={[{\n            borderColor:'#d0d7de', \n            fontSize:16, \n            borderWidth:1, \n            borderRadius:6, \n            paddingHorizontal:10, \n            paddingVertical:3, \n            backgroundColor:Colors[theme].background,\n            color:Colors[theme].text,\n            height:props.multiline?contentHeight:minHeight,\n        }, props.style]}\n        placeholder={props.placeholder}\n        editable={!props.disabled} \n        keyboardType={props.keyboardType}\n        secureTextEntry={props.secureTextEntry}\n        value={props.value}\n        onChangeText={props.setValue}\n        onContentSizeChange={props.multiline?(e) => setContentHeight(Math.max(e.nativeEvent.contentSize.height, minHeight) + 2):undefined}\n        onBlur={()=>props.onBlur?.(props.value)}\n        onEndEditing={()=>props.onEndEditing?.(props.value)}\n        multiline={props.multiline}\n    />\n}","import React from \"react\"\nimport CommonItem from \"./CommonItem\"\nimport { UserMembership } from \"../types\"\nimport Avatar from \"./Avatar\"\nimport { Text, View } from \"./Themed\"\n\nexport default ({member:item, onPress}:{member:UserMembership, onPress?:()=>void})=> {\n    return <CommonItem key={item.id} bodyStyle={{flexDirection:'row', justifyContent:'flex-start'}} onPress={onPress}>\n        <View style={{marginTop:4, marginRight:12}}><Avatar name={item.name} userId={item.id} size={44}/></View>\n        <Text style={{fontSize:20, fontWeight:'400'}}>{item.name}</Text>\n    </CommonItem>\n}","import React, { Suspense, useState } from 'react';\nimport CommonButton from '../components/CommonButton';\nimport useModalsContext from '../hooks/useModalsContext';\nimport { Text, View } from '../components/Themed';\nimport useLangContext from '../hooks/useLangContext';\nimport { Ionicons } from '../lib/@expo/vector-icons';\nimport { TouchableOpacity } from 'react-native-gesture-handler';\nimport Colors from '../constants/Colors';\nimport useColorScheme from '../hooks/useColorScheme';\nimport { BottomSheet } from '../components/ModalSection';\nimport dayjs from 'dayjs';\nimport useModalEffect from '../hooks/useModalEffect';\n\nconst dayTypes = ['AM', 'PM'].map(value=>({label:value, value}))\nconst hours = [...Array(12).keys()].map((value, index)=>(index + 1).toString().padStart(2, '0')).map(value=>({label:value, value}))\nconst minutes = [...Array(12).keys()].map((value, index)=>(index * 5).toString().padStart(2, '0')).map(value=>({label:value, value}))\n\n\nconst getDisableDays=(date:dayjs.Dayjs)=>{\n  let startDate = date.clone().startOf('month').add(-1, 'month')\n  const endDate = date.clone().endOf('month').add(1, 'month')\n  const today = dayjs().startOf('day')\n  const result = []\n  while(startDate<=endDate && startDate<today){\n    result.push(startDate.format('YYYY-MM-DD'))\n    startDate = startDate.add(1, 'day')\n  }\n  return result\n}\n\nconst defaultDayjs = ()=>{\n  const m = dayjs()\n  const restMinute = parseInt(m.format('mm')) % 5\n  return m.add(5-restMinute, 'minute')\n}\n\nconst Calendar = React.lazy(()=> import('../components/Calendar'))\nconst CommonPicker = React.lazy(()=>import('../components/CommonPicker'))\n\nexport default function DateTimePickerModal({datetime, callback}:{datetime?:string, callback:(datetime?:string)=>void}) {\n  const _dayjs = datetime?dayjs(datetime):defaultDayjs()\n  const { lang, locale } = useLangContext()\n  const theme = useColorScheme()\n  const [date, setDate] = useState(_dayjs.format('YYYY-MM-DD'));\n  const [dayType, setDayType] = useState(_dayjs.locale('en').format('A'))\n  const [hour, setHour] = useState(_dayjs.format('hh'))\n  const [minute, setMinute] = useState(_dayjs.format('mm'))\n  const [disableDays, setDisableDays] = useState<string[]>(getDisableDays(_dayjs))\n  const { setModal } = useModalsContext()\n  const back = ()=>{\n    setModal(DateTimePickerModal, null)\n  }\n  useModalEffect(back, [])\n  return <BottomSheet>\n    <View style={{flexDirection:'row', width:'100%'}}>\n      <View style={{flex:1, flexDirection:'row'}}>\n        <TouchableOpacity onPress={back}>\n          <Ionicons size={20} name=\"arrow-back\" color={Colors[theme].text}/>\n        </TouchableOpacity>\n      </View>\n      <View style={{flex:1}}>\n        <Text style={{fontSize:20, textAlign:'center'}}>{lang('Date & Time')}</Text>\n      </View>\n      <View style={{flex:1}}/>\n    </View>\n    <View style={{marginBottom: 20, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\n    <Suspense fallback={<></>}>\n      <Calendar\n        locale={locale}\n        style={undefined} \n        setDate={setDate}\n        disableAllTouchEventsForDisabledDays={true}\n        onMonthChange={(v)=>setDisableDays(getDisableDays(dayjs(v.dateString)))}\n        markedDates={{\n          ...disableDays.reduce((p, c)=>{p[c]={disabled:true};return p}, {} as Record<string, any>),\n          ...(date?[date]:[]).reduce((p, c)=>{p[c]={selected:true};return p}, {} as Record<string, any>)\n        }}\n      />\n      <View style={{flexDirection:'row', paddingVertical:10, width:400, height:50}}>\n        <CommonPicker value={dayType} setValue={setDayType} values={dayTypes}/>\n        <Text style={{fontSize:20}}> </Text>\n        <CommonPicker value={hour} setValue={setHour} values={hours}/>\n        <Text style={{fontSize:20}}> : </Text>\n        <CommonPicker value={minute} setValue={setMinute} values={minutes}/>\n      </View>\n    </Suspense>\n    <View style={{flexDirection:'row'}}>\n      <CommonButton title={lang('save')} onPress={()=>{\n        callback?.(dayjs(`${date} ${hour}:${minute} ${dayType}`).toISOString())\n        back()\n      }}/>\n      <CommonButton title={lang('cancel')} onPress={()=>{\n        callback?.(undefined)\n        back()\n      }}/>\n      \n    </View>\n  </BottomSheet>\n}\n","import React from 'react';\nimport {View} from 'react-native'\nimport {Text} from './Themed';\nimport { ProfileProps } from '../types';\nimport Avatar from './Avatar';\n\nexport default (props:ProfileProps)=>{\n    return <View style={{width:'100%', height:135, justifyContent:'space-evenly', alignItems:'center'}}>\n        <Avatar {...props} size={75}/>\n        <Text style={{fontWeight:'bold', fontSize:15}}>{props.name}</Text>\n        <Text style={{fontWeight:'normal', fontSize:14}}>{props.username}</Text>\n    </View>\n}","import React, { useState,  useEffect, createContext, useMemo, useRef, useContext } from \"react\"\nimport firebase from \"firebase/app\";\nimport \"firebase/messaging\";\nimport {FCM_PUBLIC_VAPID_KEY, FCM_API_KEY} from \"../constants/Envs\"\nimport { Notification as NotificationType, UserMembership } from \"../types\";\nimport { getNotification, postNotification, putNotification } from \"../services/notification\";\n\nconst firebaseConfig = require(\"../../web/firebase-config.js\")\n// Initialize Firebase\nconst key = firebaseConfig.messagingSenderId\nconst apiKeyEncrypted = (FCM_API_KEY as string).split('').map((v, i)=> (v.charCodeAt(0) ^ key.charCodeAt(i)).toString(16).padStart(2, '0')).join('')\nconst app = firebase.initializeApp({...firebaseConfig, apiKey:FCM_API_KEY});\n// const analytics = getAnalytics(app);\nconst messaging = firebase.messaging(app);\n\nmessaging.onMessage((payload) => {\n  if (!(\"Notification\" in window)) {\n    alert(\"This browser does not support desktop notification\");\n  }\n  else if (Notification.permission === \"granted\") {\n    const message_set = JSON.parse(payload.data['message_set'])[0]\n    new Notification(payload.data.channel_name, { body: `${payload.data.name}: ${message_set.content}` });\n  }\n});\n\nconst requestToken = async()=>{\n  const permission = await Notification.requestPermission();\n  if (permission === 'granted') {\n    const serviceWorkerRegistration = await navigator.serviceWorker.register(`${process.env.PUBLIC_URL}/firebase-messaging-sw.js?${apiKeyEncrypted}`)\n    console.log('[SW]: SCOPE: ', serviceWorkerRegistration.scope);\n    const currentToken = await messaging.getToken({serviceWorkerRegistration, vapidKey: FCM_PUBLIC_VAPID_KEY }).catch(\n      async()=>await messaging.getToken({serviceWorkerRegistration, vapidKey: FCM_PUBLIC_VAPID_KEY })\n    )\n    window.addEventListener('beforeunload', (event:any) => {\n      event.preventDefault();\n      serviceWorkerRegistration.unregister()\n    });\n    if (currentToken)\n      return currentToken\n  }\n  return null\n}\n\nconst FirebaseContext = createContext<{enable?:boolean, setEnable:(enable:boolean)=>void}>({setEnable:()=>{}});\n\nexport const FirebaseProvider = ({user, children}:{user?:UserMembership|null, children:React.ReactNode})=>{\n  const tokenRef = useRef<string|null>()\n  const [notification, setNotification] = useState<NotificationType|null>()\n  const enable = useMemo(()=>notification===undefined?undefined:(notification?.token?true:false), [notification])\n  const setEnable = (enable:boolean)=>{\n    if(user && notification){\n      putNotification({...notification, token:enable?(tokenRef.current==undefined?null:tokenRef.current):null}).then((noti)=>{\n        setNotification(noti)\n      })\n    }\n  }\n  useEffect(()=>{\n    let isMount = true;\n    if(user){\n      if (tokenRef.current ===undefined){\n        tokenRef.current = null\n        requestToken().then((t)=>{\n          tokenRef.current = t\n          if (notification){\n            putNotification({...notification, token:tokenRef.current}).then((noti)=>{\n              if(isMount)setNotification(noti)\n            })\n          }\n        });\n      }\n      if (notification===undefined){\n        getNotification(user.id).then((noti)=>{\n          if(isMount)setNotification(noti || null)\n        })\n      }\n      else if(notification===null){\n        postNotification({user:user.id, type:'WEB', token:null}).then((noti)=>{\n          if(isMount)setNotification(noti)\n        })\n      }\n      else if (notification.token && tokenRef.current && tokenRef.current != notification.token){\n        putNotification({...notification, token:tokenRef.current}).then((noti)=>{\n          if(isMount)setNotification(noti)\n        })\n      }\n    }\n    return ()=>{isMount=false}\n  }, [user, notification])\n  return <FirebaseContext.Provider value={{enable, setEnable}}>\n    {(enable!=undefined || user===null) && children}\n  </FirebaseContext.Provider>\n}\n\nexport default ()=>{\n  const {enable, setEnable} = useContext(FirebaseContext)\n  return {enable, setEnable}\n}\n","import { useMemo, useReducer } from \"react\"\n\ntype LocalSearchAction = {type:string, keyword?:string}\n\ntype LocalSearchState ={active:boolean, keyword:string}\n\n\n\nconst localSearchReducer =(initialState:LocalSearchState, action:LocalSearchAction)=>{\n    switch (action.type){\n        case 'SEARCH':\n          return {\n            ...initialState,\n            keyword: action.keyword\n          } as LocalSearchState\n        case 'ENABLE_SEARCH':\n          return {\n            ...initialState,\n            active:true,\n          }\n        case 'DISABLE_SEARCH':\n            return{\n                ...initialState,\n                active:false,\n                keyword: ''\n            }\n        default:\n            throw new Error( `Unhandled action type: ${action.type}`)\n    }\n  }\n\n\nexport default function useLocalSearch<T>(target:T[], compare:(value:T, keyword:string)=>boolean) {\n  const [searchState, dispatch] = useReducer(localSearchReducer, {active:false, keyword:''})\n  const data = useMemo(()=>searchState.active?target.filter(v=>compare(v, searchState.keyword)):target, [searchState, target])\n  return {searchState, dispatch, data}\n}","\nimport React, {useState} from 'react';\nimport { StyleProp, TextStyle, View } from 'react-native';\nimport Clipboard from '@react-native-clipboard/clipboard';\nimport useLangContext from '../hooks/useLangContext';\nimport { CustomTextInputProps } from '../types';\nimport CommonButton from './CommonButton';\nimport RowField from './RowField';\nimport { Text } from './Themed';\nimport useResizeContext from '../hooks/useResizeContext';\n\nexport default function CopyField(props:CustomTextInputProps & {name: string, width?:any, textStyle?:StyleProp<TextStyle>}) {\n  const { lang } = useLangContext()\n  const windowType = useResizeContext()\n  const [copied, setCopied] = useState(false)\n  return (\n    <RowField name={props.name} width={props.width} textStyle={props.textStyle}>\n      <View style={{flexDirection:windowType=='landscape'?'row':'column', justifyContent:'space-between'}}>\n        <View style={{justifyContent:'center'}}>\n          <Text style={{fontSize:16}}>{props.value}</Text>\n        </View>\n        <View>\n          <CommonButton title={lang('copy')} onPress={()=>{Clipboard.setString(props.value);setCopied(true)}}/>\n          {copied && <Text style={{fontSize:12, alignSelf:'center', color:'red'}}>{lang(\"copied\")}</Text>}\n        </View>\n      </View>\n   </RowField>\n  )\n}","import React, {useRef,MutableRefObject, useMemo, useState, useEffect } from 'react';\nimport { View, Text } from '../components/Themed';\nimport useAuthContext from '../hooks/useAuthContext';\nimport useUserMembershipList from '../hooks/lists/useUserMembershipList';\nimport { TabViewRecord, UserMembership } from '../types';\nimport CommonButton from '../components/CommonButton';\nimport useMessengerMemberList, { useMessengerMemberMutation } from '../hooks/lists/useMessengerMemberList';\nimport useModalsContext from '../hooks/useModalsContext';\nimport useExternalMembershipList from '../hooks/lists/useExternalMembershipList';\nimport TextField from '../components/TextField';\nimport useLocalSearch from '../hooks/useLocalSearch';\nimport TabView from '../components/TabView';\nimport { FlatList } from 'react-native-gesture-handler';\nimport useLangContext from '../hooks/useLangContext';\nimport MemberItem from '../components/MemberItem';\nimport ModalSection from '../components/ModalSection';\nimport useModalEffect from '../hooks/useModalEffect';\nimport CopyField from '../components/CopyField';\n\nconst InviteItem = (props:{item:UserMembership, selectedRef:MutableRefObject<Set<number>>})=>{\n  const [selected, setSelected] = useState(props.selectedRef.current.has(props.item.id))\n  return <View style={selected?{borderWidth:1, borderColor:'blue'}:{}}>\n    <MemberItem member={props.item} onPress={()=>{\n      if (selected){\n        setSelected(false)\n        props.selectedRef.current.delete(props.item.id)\n      }\n      else{\n        setSelected(true)\n        props.selectedRef.current.add(props.item.id)\n      }\n    }}/>\n  </View>\n\n}\ntype InviteTabViewProps = {\n  id:number,\n  selectedRef:MutableRefObject<Set<number>>\n}\n\nconst GroupTabView = ({id, selectedRef}:InviteTabViewProps)=>{\n  const { lang } = useLangContext()\n  const {auth} = useAuthContext()\n  const { setModal } = useModalsContext()\n  const userList = useUserMembershipList(auth)\n  const memberList = useMessengerMemberList(id)\n  const messengerMemberMutation = useMessengerMemberMutation()\n  const rawData = useMemo(()=>{\n    const memberSet = new Set(memberList?.map(v=>v.user))\n    return userList?.filter(v=>!memberSet.has(v.id)) || []\n  }, [userList, memberList])\n  const {data, dispatch:dispatchKeyword, searchState} = useLocalSearch(rawData, (v, keyword)=>(v.username.includes(keyword) || v.name.includes(keyword)))\n  const search = (k:string)=>{\n    if (k?.length>0){\n      dispatchKeyword({type:'ENABLE_SEARCH'})\n      dispatchKeyword({type:'SEARCH', keyword:k})\n    }\n    else{\n      dispatchKeyword({type:'DISABLE_SEARCH'})\n    }\n  }\n  const back = ()=>{\n    setModal(InviteModal, null)\n  }\n  useModalEffect(back, [])\n  return <View style={{alignItems:'center', flex:1}}>\n    <View style={{'width': '100%', flex:1}}>\n      <TextField name={`${lang('Username')} & ${lang('Name')}`} placeholder={auth.user?.name} value={searchState.keyword} setValue={search} width={'80%'}/>\n      {id && data && <FlatList contentContainerStyle={{flexGrow:1}} data={data} renderItem={({item})=><InviteItem item={item} selectedRef={selectedRef}/>}/>}\n    </View>\n    <View style={[{width:'100%', flexDirection:'row', padding:10,}, {justifyContent:'flex-end'}]}>\n      <CommonButton title={lang('invite')} onPress={()=>{\n        messengerMemberMutation.invite({\n          channel_id:id,\n          user_ids:[...selectedRef.current]\n        }).then(back)\n      }}/>\n      <CommonButton title={lang('cancel')} onPress={back}/>\n    </View>\n  </View>\n}\n\nconst DELAY = 500\n\nconst ExternalMembershipTabView = ({id, selectedRef}:InviteTabViewProps)=>{\n  const { lang } = useLangContext()\n  const [value, setValue] = useState('')\n  const [keyword, setKeyword] = useState('')\n  const timeoutRef = useRef<NodeJS.Timeout>()\n  const {auth} = useAuthContext()\n  const { setModal } = useModalsContext()\n  const memberList = useMessengerMemberList(id)\n  const externalMemberList = useExternalMembershipList(keyword)\n  const data = useMemo(()=>{\n    const memberSet = new Set(memberList?.map(v=>v.user))\n    return externalMemberList?.filter(v=>!memberSet.has(v.id)) || []\n  }, [externalMemberList, memberList])\n  const messengerMemberMutation = useMessengerMemberMutation()\n  useEffect(()=>{\n    timeoutRef.current = setTimeout(()=>{\n      setKeyword(value)\n    }, DELAY)\n    return ()=>{timeoutRef.current && clearTimeout(timeoutRef.current)}\n  }, [value])\n  const back = ()=>{\n    setModal(InviteModal, null)\n  }\n  const inviteLink = location.href.replace('chat', 'invitee')\n  return <View style={{alignItems:'center', flex:1}}>\n  <View style={{'width': '100%', flex:1, paddingVertical:10}}>\n    <CopyField name={lang('invite link')} width={'80%'} value={inviteLink}/>\n    <View style={{marginVertical: 10, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\n    <TextField name={lang('Username')} placeholder={auth.user?.username} value={value} setValue={setValue} width={'80%'}/>\n    {id && data && <FlatList contentContainerStyle={{flexGrow:1}} data={data} renderItem={({item})=><InviteItem item={item} selectedRef={selectedRef}/>}/>}\n  </View>\n  <View style={[{width:'100%', flexDirection:'row', padding:10,}, {justifyContent:'flex-end'}]}>\n    <CommonButton title={lang('invite')} onPress={()=>{\n      messengerMemberMutation.invite({\n        channel_id:id,\n        user_ids:[...selectedRef.current]\n      }).then(back)\n    }}/>\n    <CommonButton title={lang('cancel')} onPress={back}/>\n  </View>\n</View>\n}\n\nexport default function InviteModal({id}:{id:number}) {\n  const { lang } = useLangContext()\n  const selectedRef = useRef<Set<number>>(new Set())\n  const drawerTabs:TabViewRecord = {\n    group:{\n      title: 'Group',\n      component: ()=><GroupTabView id={id} selectedRef={selectedRef}/>,\n      icon: <></>\n    },\n    external:{\n      title: 'External members',\n      component: ()=><ExternalMembershipTabView id={id} selectedRef={selectedRef}/>,\n      icon: <></>\n    }\n  }\n  return <ModalSection>\n    <View style={{flex:1, width:'100%'}}>\n      <View style={{width:'100%'}}>\n        <Text style={{fontSize:20}}>{lang('invite')}</Text>\n        <View style={{marginBottom: 20, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\n      </View>\n      <TabView tabs={drawerTabs} tabBarPosition={\"top\"}/>\n    </View>\n  </ModalSection>\n}\n\n","import { useEffect } from \"react\"\nimport { navigate } from \"../navigation\"\nimport useMessengerChannelList from \"./lists/useMessengerChannelList\"\nimport { useMessengerMemberMutation } from \"./lists/useMessengerMemberList\"\nimport useAuthContext from \"./useAuthContext\"\n\nlet invitee_id:number|undefined\nlet invitee_state:0|1|2=0\n\nexport const replaceInviteeState = (l:Location)=>{\n    if(l !==undefined && l.pathname.endsWith('/invitee')){\n        var params = l.search.slice(1).split('&').filter(v=>v.startsWith('id='))\n        if (params.length>0)\n            invitee_id = parseInt(params[0].split('=')[1])\n        window.history.replaceState(null, '', l.href.split('invitee')[0]\n        );\n    }\n}\n\nexport default ()=>{\n    const {auth} = useAuthContext()\n    const channelList = useMessengerChannelList(auth)\n    const messengerMemberMutation = useMessengerMemberMutation()\n    useEffect(()=>{\n        if (auth.user){\n            if (invitee_id && channelList){\n                var id = invitee_id;\n                var redirect = ()=>navigate(\"Main\", {screen:\"ChatScreen\", params: {id}})\n                invitee_id = undefined;\n                invitee_state = 1;\n                if(channelList.find(v=>v.id==id) === undefined){\n                    console.log(`invite processing (channel:${id})`)\n                    messengerMemberMutation.invite({\n                        channel_id:id,\n                        user_ids:[auth.user.id]\n                    }).then(redirect)\n                }\n                else{\n                    console.log('already invite')\n                    redirect()\n                }\n            }\n        }\n        else{\n            if (invitee_state == 1){\n                invitee_state=2\n            }\n        }\n    }, [auth, channelList])\n    useEffect(()=>{\n        if(auth.user && invitee_state==2){\n            navigate(\"Main\", {screen:\"HomeScreen\"})\n        }\n    }, [auth.user])\n}"],"sourceRoot":""}