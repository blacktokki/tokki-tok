{"version":3,"sources":["src/navigation/index.tsx","src/components/TextButton.tsx","src/modals/ChannelEditModal.tsx","src/hooks/lists/useMessengerMemberList.ts","src/navigation/tabview/DrawerTabView.tsx","src/navigation/tabview/MessengerTabView.tsx","src/navigation/tabview/index.tsx","src/components/HeaderRight.tsx","src/screens/main/LoginScreen.tsx","src/hooks/lists/useMessengerContent.List.ts","src/components/LinkPreview.tsx","src/lib/react-native-webrtc/useWebsocketContext.tsx","src/lib/react-native-webrtc/webrtc/p2p.tsx","src/lib/react-native-webrtc/webrtc/index.ts","src/lib/react-native-webrtc/LocalCam.tsx","src/lib/react-native-webrtc/RemoteCam.tsx","src/screens/main/ChatScreen/VideoCallSection.tsx","src/components/FilePreview.tsx","src/screens/main/ChatScreen/index.tsx","src/screens/main/InviteeScreen.tsx","src/screens/index.ts","src/screens/main/HomeScreen.tsx","src/hooks/useWebsocketContext.tsx","src/apis/notification.ts","src/hooks/useIsMobile.ts","src/hooks/lists/useUserMembershipList.ts","src/components/CommonItem.tsx","src/lib/react-native-paper/Avatar.tsx","src/components/Avatar.tsx","src/components/RowField.tsx","src/components/TextField.tsx","src/navigation/tabview/MemberTabView.tsx","src/components/Themed.tsx","src/modals/GuestLogoutModal.tsx","src/modals/ProfileModal.tsx","src/components/Profile.tsx","src/components/CommonTextInput.tsx","src/hooks/useLocalSearch.ts","src/modals/InviteModal.tsx","src/hooks/lists/useExternalMembershipList.ts","src/apis/axios.ts","src/hooks/useAuthContext.tsx","src/navigation/LinkingConfiguration.ts","src/constants/Colors.ts","src/screens/NotFoundScreen.tsx","src/navigation/DrawerNavigator.tsx","src/hooks/useFirebaseContext.tsx","src/modals/index.ts","src/navigation/RootNavigator.tsx","src/components/MobileSafeAreaView.tsx","App.tsx","src/hooks/useCachedResources.ts","src/lang/index.ts","src/hooks/useLangContext.tsx","src/components/CommonButton.tsx","web/firebase-config.js","src/apis/account.ts","src/apis/messenger.ts","src/assets/fonts/SpaceMono-Regular.ttf","src/hooks/useModalsContext.tsx","src/hooks/useResizeContext.tsx","src/hooks/useColorScheme.ts","src/components/CommonSection.tsx","src/hooks/lists/useMessengerChannelList.ts"],"names":["navigationRef","React","navigate","name","params","_navigationRef$curren","_navigationRef$curren2","current","Navigation","defaultColorScheme","useDefaultColorScheme","userColorScheme","useColorScheme","colorScheme","NavigationContainer","ref","documentTitle","formatter","options","route","linking","process","versions","undefined","LinkingConfiguration","theme","DarkTheme","DefaultTheme","ResizeContextProvider","RootNavigator","l","search","decoded","slice","split","map","s","replace","join","window","history","replaceState","pathname","hash","location","ignoreWarnings","_console","_","clone","console","warn","message","Object","forEach","value","indexOf","props","createElement","CommonButton","_extends","style","styles","StyleSheet","create","borderRadius","backgroundColor","borderWidth","ChannelEditModal","_ref","id","type","lang","useLangContext","auth","useAuthContext","setModal","useModalsContext","channelList","useMessengerChannelList","channelMutation","useMessengerChannelMutation","channel","find","v","_useState","useState","_useState2","_slicedToArray","setName","_useState3","_useState4","description","setDescription","useEffect","CommonSection","outerContainerStyle","alignSelf","View","justifyContent","Text","fontSize","separator","lightColor","darkColor","width","TextField","setValue","multiline","flexDirection","title","onPress","_auth$user","user","groupId","_auth$user2","newChannel","owner","group","update","then","screen","marginHorizontal","field","padding","marginBottom","height","useMessengerMemberList","channel_id","useQuery","_regeneratorRuntime","async","_context","prev","next","awrap","getMessengerMemberList","abrupt","sent","stop","Promise","data","useMessengerMemberMutation","queryClient","useQueryClient","invite","useMutation","postBulkMessengerMember","onSuccess","invalidateQueries","leave","deleteMessengerMember","mutateAsync","DrawerTabView","flex","item","index","CommonItem","key","containerStyle","bodyStyle","alignItems","marginLeft","Messenger","useMessengerChannelSorted","_objectSpread","MessengerIcon","Ionicons","size","bottomTabs","OneTab","component","MemberTab","icon","MemberIcon","TwoTab","today","Date","toISOString","_item$last_message","_item$last_message2","_item$last_message3","date","last_message","created","FontAwesome","marginRight","opacity","paddingLeft","member_count","content","textAlign","unread_count","drawerTabs","DrawerTab","_React$useState","_React$useState2","setIndex","entries","tabs","onTab","icons","assign","apply","concat","_toConsumableArray","_ref2","k","_defineProperty","TabView","renderTabBar","TabBar","indicatorStyle","activeColor","inactiveColor","renderIcon","scene","onTabPress","findIndex","_ref4","_ref5","navigationState","routes","_ref6","_ref7","onIndexChange","renderScene","SceneMap","_ref8","_ref9","tabBarPosition","_useAuthContext","dispatch","windowType","useResizeContext","defaultButtonProps","username","endsWith","GuestLogoutModal","buttonProps","extra","filter","TextButton","textStyle","color","Styles","login_container","login_header","paddingTop","paddingBottom","login_header_logo","resizeMode","login_header_text","marginTop","login_header_text_bold","fontWeight","login_wrapper","paddingVertical","borderTopRightRadius","borderTopLeftRadius","form","maxWidth","form_error","form_error_text","textAlignVertical","form_input","paddingHorizontal","button","button_label","login_social","login_social_separator","login_social_separator_line","login_social_separator_text","login_social_buttons","login_social_button","borderColor","login_social_icon","login_social_facebook","login_footer_text","guest_footer_text","margin","login_footer_link","useMessengerContentList","_useInfiniteQuery","useInfiniteQuery","pageParam","getMessengerContentList","select","pages","length","getNextPageParam","lastPage","refetchOnReconnect","refetchOnWindowFocus","fetchNextPage","lastJsonMessage","useWebsocketContext","setQueryData","_data","pageParams","link","isMobile","TouchableOpacity","Linking","openURL","url","image","Image","source","uri","maxHeight","WebSocketContext","createContext","sendJsonMessage","WebSocketProvider","disable","children","Fragment","WebSocketInternalProvider","path","Context","useBackground","useContext","log","peerConstraints","iceServers","JSON","parse","sessionConstraints","mandatory","OfferToReceiveAudio","OfferToReceiveVideo","VoiceActivityDetection","mediaConstraints","audio","video","framerate","onICEcandidate","pc","_message","rtcMessage","candidate","RTCIceCandidate","addIceCandidate","sendICEcandidate","event","sendMessage","receiver","target","optimizeSdp","offerDescription","arr","sdp","str","i","test","RTCSessionDescription","createOffer","pcRefCurrent","stream","addStream","t0","t1","setLocalDescription","camStyle","container","cam","bottonContainer","position","bottom","buttonBar","label","_props$user","_useWebsocketContext","_useLocalCam","pcRef","useRef","sender","setSender","_stream","setStream","isPlay","useMemo","CustomRTCView","useCallback","memo","RTCView","videoProps","start","mode","newStream","_context2","mediaDevices","getUserMedia","getDisplayMedia","catch","e","_ref3","error","getTracks","track","websocketOnMessage","response","peerConnection","_peerConnection","answerDescription","_peerConnection2","_context3","channel_name","RTCPeerConnection","addEventListener","setRemoteDescription","useLocalCam","Button","setReceiver","_useRemoteCam","_useState5","_useState6","setUser","_useState7","_useState8","close","clearInterval","statsInterval","_pcRef$current","_pcRef$current2","_pcRef$current3","_pcRef$current4","streams","_peerConnection3","_answerDescription","_streams","_context5","iceConnectionState","activeStream","setInterval","stats","statsOutput","framePerSecond","_context4","getStats","report","kind","keys","statName","framesPerSecond","toTimeString","addTransceiver","direction","getRemoteStreams","createAnswer","localDescription","useRemoteCam","TextInput","onChangeText","VideoView","scale","Colors","flexGrow","focusGuest","setFocusGuest","VideoCallContainer","setDisable","videoMode","setVideoMode","guests","setGuests","_useRtcContext","useRtcContext","Math","max","ceil","sqrt","toggleVideoMode","ThemedView","aspectRatio","flexShrink","borderLeftWidth","borderBottomWidth","flexWrap","RemoteCam","LocalCam","RtcProvider","file","showBorder","filename","floor","pow","toFixed","humanFileSize","filesize","MessengerContentPageItem","_nextPage2","useIsMobile","nextPage","_nextPage","nextContent","index2","isSystem","isFirst","isSelf","ownerId","dayChanged","message_set","marginVertical","Avatar","userId","titleStyle","subtitle","Hyperlink","linkDefault","wordBreak","linkStyle","selectable","file_set","fileIndex","FilePreview","link_set","linkIndex","LinkPreview","InviteeScreen","_route$params","navigation","enterGuest","setEnterGuest","messengerMemberMutation","useLayoutEffect","setOptions","headerRight","user_ids","main","HomeScreen","_route$params2","_useLangContext","locale","setLocale","configTheme","useConfigColorScheme","home","setHome","text","HeaderRight","tab","StyledText","textDecorationLine","setColorScheme","TabViewNavigator","parseInt","setParams","ChatScreen","_useMessengerChannelL","inputRef","_useMessengerContentL","memberList","member_id","_memberList$find","autoFocus","setAutoFocus","postValue","contentMutation","postMessage","_delete","deleteMessengerContent","d","variables","mutate","delete","useMessengerContentMutation","InviteModal","back","renderItem","_auth$user3","canGoBack","goBack","focus","minWidth","VideoCallSection","FlatList","contentContainerStyle","onScroll","nativeEvent","contentOffset","y","contentSize","onLayout","p","layout","background","onSubmitEditing","blurOnSubmit","resolve","reject","Platform","OS","input","document","onchange","files","onabort","onerror","click","f","_auth$user4","login","LoginScreen","setUsername","password","setPassword","_login","placeholder","autoCapitalize","keyboardType","secureTextEntry","modal","defaultContext","_split","_split2","SCHEMA","DOMAIN","token","setToken","AppState","currentState","isActive","setIsActive","_useWebSocket","useWebSocket","shouldReconnect","closeEvent","protocols","onOpen","onClose","AsyncStorage","getItem","onChange","nextState","removeEventListener","Provider","getNotification","user_id","axios","get","postNotification","notification","post","putNotification","put","useMobileDetect","useUserMembershipList","getUserMembershipList","setHover","_React$useState3","_React$useState4","press","setPress","Pressable","outerContainer","onPressIn","onPressOut","onHoverIn","onHoverOut","bodyView","minHeight","normalizeHash","min","initHash","charCodeAt","abs","stringToHSL","toUpperCase","RowField","rowStyle","CommonTextInput","renderMemberItem","userList","memberItem","ProfileModal","MaterialCommunityIcons","useThemeColor","colorName","colorFromProps","otherProps","_objectWithoutProperties","_excluded","light","dark","DefaultText","_excluded2","DefaultView","Profile","counterpart","direct","patchUser","finally","disabled","onBlur","onEndEditing","contentHeight","setContentHeight","editable","onContentSizeChange","localSearchReducer","initialState","action","keyword","active","Error","InviteItem","selectedRef","has","selected","setSelected","add","GroupTabView","_useLocalSearch","compare","_useReducer","useReducer","_useReducer2","searchState","useLocalSearch","memberSet","Set","includes","dispatchKeyword","ExternalMembershipTabView","setKeyword","copied","setCopied","timeoutRef","externalMemberList","getExternalMembershipList","useExternalMembershipList","setTimeout","clearTimeout","inviteLink","href","Clipboard","setString","external","accountURL","defaultOption","baseURL","withCredentials","headers","_axios","interceptors","request","use","config","status","getToken","r","defaults","setItem","removeItem","AuthContext","authReducer","AuthProvider","authState","setError","_authState$user","_authState$user$membe","membership_set","g","root_group_id","checkLogin","_data$response","_data$response$data","noti","logout","values","ROOTPATH","prefixes","screens","Main","NotFound","tint","tabIconDefault","tabIconSelected","header","buttonColor","buttonBackgroundColor","NotFoundScreen","linkText","colors","useTheme","onAddList","tabBar","card","borderTopColor","border","pointerEvents","accessibilityRole","borderTopWidth","drawerTab","Tab","elevation","borderRightWidth","firebaseConfig","require","messagingSenderId","apiKeyEncrypted","toString","padStart","app","firebase","initializeApp","apiKey","messaging","onMessage","payload","Notification","permission","body","alert","requestToken","serviceWorkerRegistration","currentToken","requestPermission","navigator","serviceWorker","register","scope","vapidKey","preventDefault","unregister","setEnable","enable","context","FirebaseContext","Root","createStackNavigator","Navigator","headerMode","screenOptions","cardStyle","animationEnabled","cardStyleInterpolator","CardStyleInterpolators","forVerticalIOS","Screen","MainNavigator","headerShown","gestureDirection","modalValues","modals","useFirebaseContext","ModalsProvider","DrawerNavigator","headerStyle","headerTitleStyle","headerLeft","canGOBackScreen","headerLeftContainerStyle","forHorizontalIOS","innerHeight","setHeight","Dimensions","QueryClient","App","isLoadingComplete","setLoadingComplete","SplashScreen","Font","font","finish","useCachedResources","isAppearenceComplete","useInitColorScheme","SafeAreaProvider","MobileSafeAreaView","QueryClientProvider","client","IntlProvider","StatusBar","translations","ko","_RNLocalize$findBestL","RNLocalize","languageTag","isRTL","I18nManager","forceRTL","intl","createIntl","defaultLocale","messages","createIntlCache","IntlContext","complete","setComplete","_useContext","formatMessage","defaultMessage","DefaultButton","hover","_props","module","exports","guestLogin","checkLoginToken","_await$axios$get","isOffline","code","startsWith","getUserList","group_id","_context6","_context7","patch","ids","updated","_context8","_context9","getMessengerChannelList","postChannel","postDirectChannel","putChannel","deleteChannel","id_lt","id_lt_param","results","formData","_context10","FormData","append","content_id","_context11","ModalsContext","allModals","setModals","animationType","setAnimationType","ExactComponent","Component","newModals","m","Modal","visible","getWindowType","ResizeContextContext","detectMobile","_useWindowDimensions","useWindowDimensions","setWindowType","Appearance","set","withSeparator","titleView","sort","a","b","_data2$message_set$","_a$last_message","_b$last_message"],"mappings":"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","file":"static/js/app.bca740c7.chunk.js","sourcesContent":["/**\r\n * If you are not familiar with React Navigation, refer to the \"Fundamentals\" guide:\r\n * https://reactnavigation.org/docs/getting-started\r\n *\r\n */\r\nimport _ from 'lodash';\r\nimport { NavigationContainer, DefaultTheme, DarkTheme, NavigationContainerRef } from '@react-navigation/native';\r\nimport * as React from 'react';\r\n\r\nimport LinkingConfiguration from './LinkingConfiguration';\r\nimport RootNavigator from './RootNavigator';\r\n\r\nimport { useColorScheme as useDefaultColorScheme } from 'react-native';\r\nimport { useColorScheme as useColorScheme } from 'react-native-appearance';\r\nimport { ResizeContextProvider } from '../hooks/useResizeContext';\r\n\r\n\r\nconst navigationRef = React.createRef<NavigationContainerRef>();\r\n\r\nexport function navigate(name:string, params?:any) {\r\n  if (params)\r\n    navigationRef.current?.navigate(name, params);\r\n  navigationRef.current?.navigate(name);\r\n}\r\n\r\nexport default function Navigation() {\r\n  const defaultColorScheme = useDefaultColorScheme()\r\n  const userColorScheme = useColorScheme()\r\n  const colorScheme = userColorScheme =='no-preference'?defaultColorScheme:userColorScheme\r\n  return <NavigationContainer\r\n    ref={navigationRef}\r\n    documentTitle={{formatter: (options, route) => {return `TOKKI TOK`}}}\r\n    linking={(process.versions && process.versions['electron'])?undefined:LinkingConfiguration}\r\n    theme={colorScheme === 'dark' ? DarkTheme : DefaultTheme}>\r\n        <ResizeContextProvider>\r\n          <RootNavigator />\r\n        </ResizeContextProvider>\r\n  </NavigationContainer>\r\n}\r\n\r\n(function(l) {  // for github-page\r\n    if (l !== undefined && l.search[1] === '/' ) {\r\n        var decoded = l.search.slice(1).split('&').map(function(s) { \r\n        return s.replace(/~and~/g, '&')\r\n        }).join('?');\r\n        window.history.replaceState(null, '',\r\n            l.pathname.slice(0, -1) + decoded + l.hash\r\n        );\r\n    }\r\n}(window.location))\r\n    \r\nconst ignoreWarnings = ['ReactNativeFiberHostComponent'];\r\nconst _console = _.clone(console);\r\nconsole.warn = (message: string|Object) => {\r\n    var warn = true;\r\n    if (message instanceof Object)\r\n    warn = false;\r\n    else{\r\n    ignoreWarnings.forEach((value)=>{\r\n        if (message.indexOf && message.indexOf(value) <= -1) {\r\n            warn = false;\r\n        }\r\n    })\r\n    };\r\n    if (warn){\r\n        _console.warn(message);\r\n    }\r\n    else{\r\n        // console.log(message)\r\n    }\r\n};\r\n","import React, { useState } from 'react';\r\nimport { StyleSheet} from 'react-native';\r\nimport { CustomButtonProps } from '../types';\r\nimport CommonButton from './CommonButton';\r\n\r\nexport default (props:CustomButtonProps)=>{\r\n    return <CommonButton {...props} style={[styles.style, props.style]}/>\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n    style:{\r\n        borderRadius:6, \r\n        backgroundColor: 'transparent',\r\n        borderWidth:0\r\n    },\r\n});\r\n","import React, {useState, useEffect } from 'react';\r\nimport { StyleSheet } from 'react-native';\r\nimport CommonSection from '../components/CommonSection';\r\nimport { View, Text } from '../components/Themed';\r\nimport CommonButton from '../components/CommonButton';\r\n// import useBoardChannelList, { useBoardChannelMutation } from '../hooks/lists/useBoardChannelList';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport { navigate } from '../navigation';\r\nimport { Channel } from '../types';\r\nimport useMessengerChannelList, { useMessengerChannelMutation } from '../hooks/lists/useMessengerChannelList';\r\nimport TextField from '../components/TextField';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport useLangContext from '../hooks/useLangContext';\r\n\r\nexport default function ChannelEditModal({id, type}: {id?:number, type:string}) {\r\n  const { lang } = useLangContext()\r\n  const {auth} = useAuthContext()\r\n  const { setModal } = useModalsContext()\r\n  const channelList = useMessengerChannelList(auth)\r\n  const channelMutation = useMessengerChannelMutation()\r\n  const channel = channelList?.find(v=>v.id==id)\r\n  const [name, setName] = useState('')\r\n  const [description, setDescription] = useState('')\r\n  const back = ()=>{\r\n    setModal(ChannelEditModal, null)\r\n  }\r\n  useEffect(()=>{\r\n    if (channel){\r\n      setName(channel.name)\r\n      setDescription(channel?.description || '')\r\n    }\r\n  }, [channel])\r\n  return <CommonSection outerContainerStyle={{alignSelf:'center'}}>\r\n    <View style={{justifyContent:'space-around'}}>\r\n    <Text style={{fontSize:20}}>{lang('Channel')}</Text>\r\n    </View>\r\n    <View style={styles.separator} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n    <View style={{width:'100%'}}>\r\n      <TextField name={lang('Channel Name')} value={name} setValue={setName} width={'60%'}/>\r\n      <TextField name={lang('Description')} value={description} setValue={setDescription} multiline width={'60%'}/>\r\n    </View>\r\n    <View style={{width:'100%', flexDirection:'row', justifyContent:'flex-end'}}>\r\n      <CommonButton title={lang('save')} onPress={()=>{\r\n        if(auth?.user?.id && auth.groupId){\r\n          const newChannel:Channel = {id, name, description, type, owner:auth?.user?.id, group:auth.groupId};\r\n          (id?channelMutation.update(newChannel):channelMutation.create(newChannel)).then(v=>navigate(\"Main\", {\r\n            screen:v.type == 'messenger'?'ChatScreen':'BoardScreen',\r\n            params:{id:v.id}\r\n          }))\r\n        }\r\n      }}/>\r\n      <CommonButton title={lang('cancel')} style={{marginHorizontal:5}} onPress={back}/>\r\n    </View>\r\n  </CommonSection>\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  field:{\r\n    width:'50%',\r\n    flexDirection:'row',\r\n    padding:10,\r\n  },\r\n  separator: {\r\n    marginBottom: 20,\r\n    height: 1,\r\n    width: '100%',\r\n  },\r\n})","import { useMutation, useQuery, useQueryClient } from \"react-query\";\r\nimport { postBulkMessengerMember, deleteMessengerMember, getMessengerMemberList } from \"../../apis\";\r\n\r\nexport default function useMessengerMemberList(channel_id:number){\r\n  const { data } = useQuery([\"MessengerMemberList\", channel_id] , async()=>await getMessengerMemberList(channel_id))\r\n  return data\r\n}\r\n\r\n\r\nexport function useMessengerMemberMutation(){\r\n  const queryClient = useQueryClient()\r\n  const invite = useMutation(postBulkMessengerMember, {\r\n    onSuccess: ()=>{\r\n      queryClient.invalidateQueries(\"MessengerMemberList\")\r\n    }\r\n  })\r\n\r\n  const leave = useMutation(deleteMessengerMember, {\r\n    onSuccess: () => {\r\n      queryClient.invalidateQueries(\"MessengerChannelList\")\r\n      queryClient.invalidateQueries(\"MessengerMemberList\")\r\n    }\r\n  })\r\n  return {invite:invite.mutateAsync, leave:leave.mutateAsync}\r\n}","import React from \"react\"\r\nimport { View, Text } from \"../../components/Themed\"\r\nimport CommonItem from \"../../components/CommonItem\"\r\n// import useBoardChannelList from \"../lib/blacktokki-board/useBoardChannelList\"\r\nimport { useMessengerChannelSorted } from \"../../hooks/lists/useMessengerChannelList\"\r\nimport useAuthContext from \"../../hooks/useAuthContext\"\r\nimport { navigate } from \"..\"\r\n\r\nconst DrawerTabView = (props:{data:{name:string, onPress?:()=>void}[]})=><View style={{flex:1}}>\r\n    {props.data.map((item, index)=><CommonItem key={index} containerStyle={{marginHorizontal:0}} bodyStyle={{alignItems:'flex-start'}} onPress={item.onPress}>\r\n        <Text style={{marginLeft:20}}>{item.name}</Text>\r\n    </CommonItem>\r\n    )}\r\n</View>\r\n\r\nexport default {\r\n    Messenger:()=>{\r\n        const {auth} = useAuthContext()\r\n        const channelList = useMessengerChannelSorted(auth);\r\n        return <DrawerTabView data={(channelList || []).map(item=>({...item, onPress:()=>navigate(\"ChatScreen\", {id:item.id})}))}/>\r\n    },\r\n    // Board:()=>{\r\n    //     const {auth} = useAuthContext()\r\n    //     const channelList = useBoardChannelList(auth);\r\n    //     return <DrawerTab data={(channelList || []).map(item=>({...item, onPress:()=>navigate(\"BoardScreen\", {id:item.id})}))}/>\r\n    // },\r\n}","import { Ionicons, FontAwesome } from \"@expo/vector-icons\"\r\nimport React from \"react\"\r\nimport { Text, View } from \"react-native\"\r\nimport CommonItem from \"../../components/CommonItem\"\r\nimport useAuthContext from \"../../hooks/useAuthContext\"\r\nimport { useMessengerChannelSorted } from \"../../hooks/lists/useMessengerChannelList\"\r\nimport { navigate } from \"../../navigation\"\r\n\r\nexport default ()=>{\r\n    const {auth} = useAuthContext()\r\n    const channelList = useMessengerChannelSorted(auth)\r\n    const today = (new Date()).toISOString().slice(0, 10)\r\n    return <View style={{flex:1, backgroundColor:'white'}}>\r\n        {channelList?.map((item, index)=>{\r\n            const date = item.last_message?.created.slice(0,10)\r\n            return <CommonItem key={index} bodyStyle={{flexDirection:'row', justifyContent:'space-between'}} onPress={()=>navigate(\"ChatScreen\", {id:item.id})}>\r\n                <View style={{flexDirection:'row'}}>\r\n                    <FontAwesome size={36} style={{ marginBottom: -3, marginRight:20 }} name='users'/>\r\n                    <View>\r\n                        <View style={{flexDirection:'row'}}>\r\n                            <Text style={{fontSize:18}}>{item.name}</Text>\r\n                            <Text style={{fontSize:18, opacity: 0.4, paddingLeft:5}}>{item.member_count}</Text>\r\n                        </View>\r\n                        <Text style={{fontSize:16, opacity: 0.4}}>{item.last_message?.content}</Text>\r\n                    </View>\r\n                </View>\r\n                <View>\r\n                    <Text style={{fontSize:14, opacity: 0.4, textAlign:'right'}}>{date==today?item.last_message?.created.slice(11,16):date}</Text>\r\n                    <Text style={{fontSize:14, textAlign:'right'}}>{item.unread_count?item.unread_count:' '}</Text>\r\n                </View>\r\n            </CommonItem>\r\n        })}\r\n    </View>\r\n}\r\n\r\nexport const MessengerIcon = <Ionicons size={30} style={{ marginBottom: -3 }} name='chatbox'/>","import React from 'react';\r\nimport { TabView, SceneMap,NavigationState, SceneRendererProps, TabBar } from 'react-native-tab-view';\r\nimport MemberTab, {MemberIcon} from \"./MemberTabView\";\r\n// import OneTab, {ConfigIcon} from \"./OneTab\";\r\nimport DrawerTab  from './DrawerTabView';\r\nimport MessengerTab, {MessengerIcon} from \"./MessengerTabView\";\r\nimport useLangContext from '../../hooks/useLangContext';\r\n\r\nexport const bottomTabs = {\r\n    OneTab:{\r\n        title:'member',\r\n        component:MemberTab,\r\n        icon:MemberIcon,\r\n    },\r\n    TwoTab:{\r\n        title:'messenger',\r\n        component:MessengerTab,\r\n        icon:MessengerIcon\r\n    },\r\n    // ThreeTab:{\r\n    //     title:'board',\r\n    //     component:BoardTab,\r\n    //     icon:BoardIcon\r\n    // },\r\n    // FourTab:{\r\n    //     title:'config',\r\n    //     component:OneTab,\r\n    //     icon:ConfigIcon\r\n    // }\r\n} as Record<string, {title:string, component:React.ComponentType<any>, icon:JSX.Element}>\r\n\r\nexport const drawerTabs = {\r\n    TwoTab:{\r\n        title:'messenger',\r\n        component:DrawerTab.Messenger,\r\n        icon:MessengerIcon\r\n    },\r\n    // ThreeTab:{\r\n    //     title:'board',\r\n    //     component:DrawerTab.Board,\r\n    //     icon:BoardIcon\r\n    // }\r\n} as Record<string, {title:string, component:React.ComponentType<any>, icon:JSX.Element}>\r\n\r\n\r\nexport default (props:{tabs:typeof drawerTabs, tabBarPosition:\"top\"|\"bottom\", index?:number, onTab?:(index:number)=>void})=>{\r\n  const { lang } = useLangContext()\r\n  const [index, setIndex] = React.useState(props.index || 0);\r\n  const entries = Object.entries(props.tabs)\r\n  const onTab = props.onTab\r\n  const icons = Object.assign({}, ...entries.map(([k, v])=>({[k]:v.icon})))\r\n  return <TabView\r\n    renderTabBar={(props:SceneRendererProps & {navigationState: NavigationState<any>})=>{\r\n      return <TabBar\r\n        {...props}\r\n        indicatorStyle={{ backgroundColor: \"#2196F3\" }}\r\n        style={{ backgroundColor:'white' }}\r\n        activeColor={'black'}\r\n        inactiveColor={'black'}\r\n        renderIcon={(scene)=>icons[scene.route.key]}\r\n        onTabPress={(scene)=>onTab?.(entries.findIndex(([k, v])=>k == scene.route.key))}\r\n      />\r\n    }}\r\n    navigationState={{ index, routes: entries.map(([k, v])=>({key:k, title:lang(v.title)}))}}\r\n    onIndexChange={setIndex}\r\n    renderScene={SceneMap(Object.assign({}, ...entries.map(([k, v])=>({[k]:v.component}))))}\r\n    tabBarPosition={props.tabBarPosition}\r\n  />\r\n}\r\n\r\n","import React from 'react'\r\nimport TextButton from \"./TextButton\"\r\nimport useAuthContext from \"../hooks/useAuthContext\"\r\nimport useResizeContext from '../hooks/useResizeContext'\r\nimport { View } from 'react-native'\r\nimport useModalsContext from '../hooks/useModalsContext'\r\nimport GuestLogoutModal from '../modals/GuestLogoutModal'\r\nimport useLangContext from '../hooks/useLangContext'\r\n\r\ntype ButtonProps = {title:string, onPress:()=>void, windowType?:'landscape'|'portrait'}\r\n\r\nexport default (props:{extra?:ButtonProps[]})=>{\r\n    const { lang } = useLangContext()\r\n    const {auth, dispatch} = useAuthContext()\r\n    const { setModal } = useModalsContext()\r\n    const windowType = useResizeContext()\r\n    const defaultButtonProps:ButtonProps[] = [{title:lang('sign out'), onPress:()=>{\r\n        if (auth?.user?.username.endsWith(\".guest\")){\r\n            setModal(GuestLogoutModal, {})\r\n        }\r\n        else{\r\n            dispatch({type:\"LOGOUT_REQUEST\"})\r\n        }\r\n    }}]\r\n    const buttonProps = (props.extra?[...props.extra, ...defaultButtonProps]:defaultButtonProps).filter(v=>v.windowType==windowType || v.windowType == undefined)\r\n    return<View style={{flexDirection:'row'}}>\r\n        {buttonProps.map((v,k)=><TextButton key={k} {...v} textStyle={{color:'white'}} color='#gray'/>)}\r\n    </View>\r\n}\r\n  ","import React, {useLayoutEffect, useState} from 'react';\r\nimport {\r\n  Text,\r\n  TextInput,\r\n  TouchableOpacity,\r\n  View,\r\n  StyleSheet,\r\n} from 'react-native';\r\nimport { StackScreenProps } from '@react-navigation/stack';\r\nimport useAuthContext from '../../hooks/useAuthContext';\r\nimport useLangContext from '../../hooks/useLangContext';\r\n\r\nexport default function LoginScreen({\r\n  navigation, route\r\n}: StackScreenProps<any, 'Login'>) {\r\n  const { lang } = useLangContext()\r\n  const [username, setUsername] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const {error, dispatch} = useAuthContext()\r\n  const _login = ()=>dispatch({type:'LOGIN_REQUEST', username, password})\r\n  useLayoutEffect(() => {\r\n    navigation.setOptions({\r\n      headerRight: undefined\r\n    });\r\n  }, [navigation, route]);\r\n\r\n  return (\r\n    <View style={Styles.login_wrapper}>\r\n      <View style={Styles.form}>\r\n        {error && <View style={Styles.form_error}>\r\n          <Text style={Styles.form_error_text}>{lang(error)}</Text>\r\n        </View>}\r\n        <TextInput\r\n          style={Styles.form_input}\r\n          value={username}\r\n          placeholder={lang('Username')}\r\n          onChangeText={(text) => setUsername(text)}\r\n          autoCapitalize={'none'}\r\n          keyboardType={'email-address'}\r\n          onSubmitEditing={_login}\r\n        />\r\n        <TextInput\r\n          style={Styles.form_input}\r\n          value={password}\r\n          placeholder={lang('Password')}\r\n          secureTextEntry\r\n          onChangeText={(text) => setPassword(text)}\r\n          onSubmitEditing={_login}\r\n        />\r\n        <TouchableOpacity onPress={_login}>\r\n          <View style={Styles.button}>\r\n            <Text style={Styles.button_label}>{lang('Sign in')}</Text>\r\n          </View>\r\n        </TouchableOpacity>\r\n        <TouchableOpacity onPress={() => dispatch({type:\"LOGIN_GUEST\"})}>\r\n          <Text style={Styles.guest_footer_text}>\r\n            {lang(\"Sign in as guest\")}\r\n          </Text>\r\n        </TouchableOpacity>\r\n      </View>\r\n      <View style={Styles.login_social}>\r\n        <View style={Styles.login_social_separator}>\r\n          <View style={Styles.login_social_separator_line} />\r\n          <Text style={Styles.login_social_separator_text}>{'*'}</Text>\r\n          <View style={Styles.login_social_separator_line} />\r\n        </View>\r\n        <View style={Styles.login_social_buttons}>\r\n        </View>\r\n      </View>\r\n      {/* <>\r\n        <TouchableOpacity onPress={() => navigate(\"RegistrationScreen\")}>\r\n          <Text style={Styles.login_footer_text}>\r\n            {\"Don't have an account? \"}\r\n            <Text style={Styles.login_footer_link}>{'Sign up'}</Text>\r\n          </Text>\r\n        </TouchableOpacity>\r\n      </> */}\r\n    </View>\r\n  );\r\n};\r\n\r\nconst Styles = StyleSheet.create({\r\n    login_container: {\r\n      flex: 1,\r\n      backgroundColor: '#FFF',\r\n    },\r\n    login_header: {\r\n      alignItems: 'center',\r\n      paddingTop: 30,\r\n      paddingBottom: 50,\r\n      backgroundColor: '#208AEC',\r\n    },\r\n    login_header_logo: {\r\n      width: 220,\r\n      resizeMode: 'contain',\r\n    },\r\n    login_header_text: {\r\n      marginTop: 15,\r\n      color: '#f0f0f0',\r\n      fontSize: 16,\r\n    },\r\n    login_header_text_bold: {\r\n      color: '#fff',\r\n      fontWeight: 'bold',\r\n    },\r\n    login_wrapper: {\r\n      flex: 1,\r\n      justifyContent: 'space-between',\r\n      paddingVertical: 40,\r\n      borderTopRightRadius: 12,\r\n      borderTopLeftRadius: 12,\r\n      marginTop: -10,\r\n      backgroundColor: '#fff',\r\n      alignItems: 'center',\r\n    },\r\n    form: {\r\n      width: '100%',\r\n      maxWidth: 320,\r\n    },\r\n    form_error: {\r\n      height: 22,\r\n      width:'100%',\r\n    },\r\n    form_error_text:{\r\n      textAlignVertical:'center',\r\n      color:'red',\r\n      fontSize:13,\r\n    },\r\n    form_input: {\r\n      height: 44,\r\n      paddingHorizontal: 20,\r\n      marginBottom: 20,\r\n      backgroundColor: '#EDF0F7',\r\n      borderRadius: 50,\r\n    },\r\n    button: {\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      height: 44,\r\n      backgroundColor: '#0065A4',\r\n      borderRadius: 50,\r\n    },\r\n    button_label: {\r\n      color: '#fff',\r\n      fontSize: 16,\r\n    },\r\n    login_social: {\r\n      width: '100%',\r\n      maxWidth: 280,\r\n      marginTop: 20,\r\n    },\r\n    login_social_separator: {\r\n      flexDirection: 'row',\r\n      alignItems: 'center',\r\n    },\r\n    login_social_separator_line: {\r\n      flex: 1,\r\n      width: '100%',\r\n      height: 1,\r\n      backgroundColor: '#E0E0E0',\r\n    },\r\n    login_social_separator_text: {\r\n      marginHorizontal: 10,\r\n      color: '#808080',\r\n      fontSize: 16,\r\n    },\r\n    login_social_buttons: {\r\n      flexDirection: 'row',\r\n      justifyContent: 'center',\r\n      marginTop: 20,\r\n    },\r\n    login_social_button: {\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      width: 60,\r\n      height: 60,\r\n      marginHorizontal: 12,\r\n      borderWidth: 1,\r\n      borderColor: '#E7E7E7',\r\n      borderRadius: 60,\r\n    },\r\n    login_social_icon: {\r\n      width: 38,\r\n      height: 38,\r\n      resizeMode: 'contain',\r\n    },\r\n    login_social_facebook: {\r\n      backgroundColor: '#4267B2',\r\n      borderColor: '#4267B2',\r\n    },\r\n    login_footer_text: {\r\n      flexDirection: 'row',\r\n      alignItems: 'center',\r\n      color: '#808080',\r\n      fontSize: 14,\r\n    },\r\n    guest_footer_text: {\r\n      flexDirection: 'row',\r\n      alignSelf: 'center',\r\n      color: '#808080',\r\n      fontSize: 15,\r\n      margin: 15\r\n    },\r\n    login_footer_link: {\r\n      color: '#208AEC',\r\n      fontSize: 15,\r\n      fontWeight: 'bold',\r\n    },\r\n  });\r\n  ","import { useCallback, useEffect, useState } from \"react\"\r\nimport { InfiniteData, useInfiniteQuery, useMutation, useQueryClient } from \"react-query\"\r\nimport { getMessengerContentList, postMessage, deleteMessengerContent } from \"../../apis\"\r\nimport { MessengerContent } from \"../../types\"\r\nimport useWebsocketContext from \"../useWebsocketContext\"\r\n\r\nexport type MessengerContentPage = {\r\n  next?:MessengerContentPage\r\n  current:MessengerContent[]\r\n}\r\n\r\nexport default function useMessengerContentList(channel_id:number){  \r\n  const queryClient = useQueryClient()\r\n  const { data, fetchNextPage } = useInfiniteQuery<MessengerContentPage>(\r\n    [\"MessengerContentList\", channel_id], \r\n    async({pageParam})=>getMessengerContentList(channel_id, pageParam).then(current=>({current})), \r\n    {\r\n      select:data=>{\r\n        if(data.pages.length > 1)\r\n          data.pages[data.pages.length - 2].next = data.pages[data.pages.length - 1]\r\n        return data;\r\n      },\r\n      getNextPageParam:(lastPage)=>lastPage?.current.length?lastPage.current[lastPage.current.length - 1].id:undefined,\r\n      refetchOnReconnect:false,\r\n      refetchOnWindowFocus:false\r\n    }\r\n  )\r\n  const { lastJsonMessage } = useWebsocketContext()\r\n  useEffect(()=>{\r\n    if(lastJsonMessage !=null && lastJsonMessage['type']=='next_message' && lastJsonMessage['data']['channel'] == channel_id){\r\n      queryClient.setQueryData<InfiniteData<MessengerContentPage>>([\"MessengerContentList\", channel_id], (_data)=>{\r\n        if(_data?.pages[0].current && _data?.pages[0].current[0].id != lastJsonMessage['data'].id)\r\n          _data.pages[0].current = [lastJsonMessage['data'], ..._data?.pages[0].current]\r\n        return {...(_data || {pages:[], pageParams:[]})}\r\n      })\r\n    }\r\n  }, [lastJsonMessage])\r\n  return { data, fetchNextPage }\r\n}\r\n\r\nexport function useMessengerContentMutation(){\r\n  // const queryClient = useQueryClient()\r\n  const create = useMutation(postMessage, {\r\n    onSuccess: () => {\r\n      // queryClient.setQueryData(['MessengerContentList'], (data:any) => ({\r\n      //   pages: data.pages.slice(0, 1),\r\n      //   pageParams: data.pageParams.slice(0, 1),\r\n      // }))\r\n      // queryClient.invalidateQueries(\"MessengerContentList\")\r\n    }\r\n  });\r\n  const _delete = useMutation(deleteMessengerContent, {\r\n    onSuccess: (d, variables) => {\r\n      // queryClient.setQueryData(['MessengerContentList'], (data:any) => ({\r\n      //   pages: (data.pages as MessengerContent[][]).map(v=>v.filter(v2=>v2.id != variables)),\r\n      //   pageParams: data.pageParams,\r\n      // }))\r\n    }\r\n  })\r\n  return { create:create.mutate, delete:_delete.mutate }\r\n}","import React from 'react'\r\nimport { TouchableOpacity } from \"react-native-gesture-handler\"\r\nimport CommonSection from \"./CommonSection\"\r\nimport { Image, Linking, TextStyle } from \"react-native\"\r\nimport { View, Text } from \"./Themed\"\r\nimport { Link } from \"../types\"\r\n\r\n\r\n\r\nexport default ({link, isMobile}:{link:Link, isMobile:boolean})=>{\r\n    return <CommonSection containerStyle={{marginHorizontal:0}} bodyStyle={{padding:0}}>\r\n    <TouchableOpacity onPress={()=>Linking.openURL(link.url)} style={{flexDirection:'row'}} containerStyle={{width:'100%'}}>\r\n        {link.image && <Image source={{uri:link.image}} resizeMode=\"cover\" style={{ width:'100%', maxWidth:isMobile?120:150, maxHeight:isMobile?120:150, borderWidth:1}}/>}\r\n        <View style={{flex:1, marginHorizontal:20}}>\r\n        <Text style={{fontSize:18}}>{link.title}</Text>\r\n        <Text style={{fontSize:14}}>{link.description}</Text>\r\n        <Text style={{fontSize:12}}>{link.url}</Text>\r\n        </View>\r\n    </TouchableOpacity>\r\n    </CommonSection>\r\n}","import React, { createContext, useContext } from \"react\"\r\nimport { SendJsonMessage } from \"react-use-websocket/dist/lib/types\";\r\nimport { WebSocketInternalProvider } from \"../../hooks/useWebsocketContext\";\r\n\r\nconst WebSocketContext = createContext<{lastJsonMessage:any, sendJsonMessage:SendJsonMessage }>({lastJsonMessage:undefined, sendJsonMessage:()=>{}});\r\n\r\nexport const WebSocketProvider = ({disable, children}:{disable?:boolean, children:React.ReactNode})=>{\r\n  return disable?<></>:<WebSocketInternalProvider path={'messenger/ws/rtc/'} Context={WebSocketContext} useBackground>\r\n    {children}\r\n  </WebSocketInternalProvider>\r\n}\r\n\r\nexport default ()=>{\r\n  const webSocketContext = useContext(WebSocketContext)\r\n  return webSocketContext\r\n}\r\n\r\n","import React, { useCallback, useRef, useState, useMemo } from \"react\";\r\n//@ts-ignore\r\nimport { RTCView, mediaDevices, RTCPeerConnection, MediaStream, RTCSessionDescription, RTCIceCandidate } from \"react-native-webrtc-web-shim\";\r\n// @ts-ignore\r\nimport {TURN_SERVER} from \"@env\"\r\n\r\n\r\nconsole.log(TURN_SERVER?\"use turn server\": \"use stun server\")\r\n\r\nexport const peerConstraints = {\r\n\ticeServers: [TURN_SERVER?JSON.parse(TURN_SERVER):{urls: 'stun:stun.l.google.com:19302'}]\r\n};\r\n\r\nexport const sessionConstraints = {\r\n\tmandatory: {\r\n\t\tOfferToReceiveAudio: true,\r\n\t\tOfferToReceiveVideo: true,\r\n\t\tVoiceActivityDetection: true\r\n\t}\r\n};\r\n\r\nconst mediaConstraints = {audio:true, video:{framerate:30}}\r\n\r\n//@ts-ignore\r\nexport {MediaStream, RTCPeerConnection, RTCSessionDescription} from \"react-native-webrtc-web-shim\";\r\n\r\nconst onICEcandidate = (pc:typeof RTCPeerConnection, message:any)=>{\r\n\tconst _message = message.data.rtcMessage\r\n\t\tconst candidate = new RTCIceCandidate(_message);\r\n\t\tif (pc) {\r\n\t\t\tconsole.log(\"ICE candidate Added\");\r\n\t\t\tpc.addIceCandidate(candidate);\r\n\t\t}\r\n}\r\n\r\nconst sendICEcandidate = (event:any, sendMessage:(data:any)=>void, receiver:string, target:string) => {\r\n\t// When you find a null candidate then there are no more candidates.\r\n\t// Gathering of candidates has finished.\r\n\tif ( !event.candidate ) { return; };\r\n\t// Send the event.candidate onto the person you're calling.\r\n\t// Keeping to Trickle ICE Standards, you should send the candidates immediately.\r\n\tsendMessage({type:'ICEcandidate', receiver, data:{target, rtcMessage:event.candidate}})\r\n  }\r\n\r\nconst BAND_WIDTH = 8000\r\n\r\nconst optimizeSdp = (offerDescription:RTCSessionDescription)=>{\r\n\tvar arr = offerDescription.sdp.split('\\r\\n');\r\n\tarr.forEach((str:string, i:number) => {\r\n\t\tif (/^a=fmtp:\\d*/.test(str)) {\r\n\t\t\tarr[i] = str + `;x-google-max-bitrate=${BAND_WIDTH};x-google-min-bitrate=${BAND_WIDTH};x-google-start-bitrate=${BAND_WIDTH}`;\r\n\t\t} else if (/^a=mid:(0|video)/.test(str)) { // if with audio then 0=>1\r\n\t\t\tarr[i] += `\\r\\nb=AS:${BAND_WIDTH}`;\r\n\t\t}\r\n\t});\r\n  \treturn new RTCSessionDescription({\r\n    \ttype: offerDescription.type,\r\n    \tsdp: arr.join('\\r\\n'),\r\n  \t})\r\n}\r\n\r\nconst createOffer = async(pcRefCurrent:{pc?:typeof RTCPeerConnection, receiver:string}, sendMessage:(data:any)=>void, stream:typeof MediaStream, target:string, user?:{name:string})=>{\r\n\tstream && pcRefCurrent.pc.addStream( stream );\r\n\tconst offerDescription = optimizeSdp((await pcRefCurrent.pc.createOffer( sessionConstraints )));\r\n\tawait pcRefCurrent.pc.setLocalDescription( offerDescription );\r\n\tsendMessage({type:'call', receiver:pcRefCurrent.receiver, data:{target, name:user?.name, rtcMessage:offerDescription}})\r\n}\r\n\r\nexport const useLocalCam = (sendMessage:(data:any)=>void)=>{\r\n\tconst pcRef = useRef<Record<number,{pc:typeof RTCPeerConnection, receiver:string}>>({})\r\n\tconst [sender, setSender] = useState<string>()\r\n\tconst [_stream, setStream] = useState<MediaStream>()\r\n\tconst isPlay = useMemo(()=>_stream?true:false, [_stream])\r\n\tconst CustomRTCView = useCallback(React.memo(({style}:{style:any})=>(_stream?<RTCView stream={_stream} style={style} videoProps={{height:'100%'}} />:<></>)) , [_stream])\r\n\tconst start = useCallback(async(user:{name:string}, stream?:typeof MediaStream, mode?:'camera'|'display')=>{\r\n\t\tconsole.log(\"start\");\r\n\t\tif (!_stream || mode!==undefined) {\r\n\t\t\ttry {\r\n\t\t\t\tlet newStream:typeof MediaStream;\r\n\t\t\t\tif(mode == 'camera'){\r\n\t\t\t\t\tnewStream = await mediaDevices.getUserMedia(mediaConstraints)\r\n\t\t\t\t}\r\n\t\t\t\telse if (mode == 'display'){\r\n\t\t\t\t\tnewStream = await mediaDevices.getDisplayMedia(mediaConstraints)\r\n\t\t\t\t}\r\n\t\t\t\telse{\r\n\t\t\t\t\tnewStream = stream || await mediaDevices.getUserMedia(mediaConstraints).catch((e:any)=>mediaDevices.getDisplayMedia(mediaConstraints));\r\n\t\t\t\t}\r\n\t\t\t\tsetStream(newStream)\r\n\t\t\t\tObject.entries(pcRef.current).map(([k, v])=>{\r\n\t\t\t\t\tcreateOffer(v, sendMessage, newStream, 'guest', user)\r\n\t\t\t\t})\r\n\t\t\t} catch (e) {\r\n\t\t\t\tconsole.error(e);\r\n\t\t\t}\r\n\t\t}\r\n\t}, [_stream])\r\n\tconst stop = useCallback(()=>{\r\n\t\tconsole.log(\"stop\");\r\n\t\tif(_stream){\r\n\t\t\t_stream.getTracks().map((track:any) => track.stop());\r\n\t\t\tsetStream(undefined)\r\n\t\t}\r\n\t}, [_stream])\r\n\treturn {\r\n\t\tstart,\r\n\t\tstop,\r\n\t\twebsocketOnMessage: async(response:any, user:{name:string})=>{\r\n\t\t\tlet type = response.type;\r\n\t\t\tif (type == 'connection'){\r\n\t\t\t\tsetSender(response.data.channel_name)\r\n\t\t\t}\r\n\t\t\tif (type == 'start' && response.data.target=='host'){\r\n\t\t\t  console.log('1 start')\r\n\t\t\t  const peerConnection = new RTCPeerConnection( peerConstraints );\r\n\t\t\t  peerConnection.addEventListener( 'icecandidate', (event:any) => sendICEcandidate(event, sendMessage, response.sender, 'guest'));\r\n\t\t\t  pcRef.current[response.sender] = {pc:peerConnection, receiver: response.sender}\r\n\t\t\t  createOffer(pcRef.current[response.sender], sendMessage, _stream, 'guest', user)\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif (type == \"answer\" && response.data.target == 'host'){\r\n\t\t\t  console.log('3 answer')\r\n\t\t\t  const peerConnection = pcRef.current[response.sender].pc\r\n\t\t\t  const answerDescription = new RTCSessionDescription(response.data.rtcMessage);\r\n\t\t\t  await peerConnection.setRemoteDescription( answerDescription );\r\n\t\t\t  // const streams = pcRef.current.pc.getRemoteStreams()\r\n\t\t\t  // setMirrorStream(streams[streams.length - 1])\r\n\t\t\t}\r\n\t\t\tif (type == \"ICEcandidate\" && response.data.target=='host'){\r\n\t\t\t\tconst peerConnection = pcRef.current[response.sender].pc\r\n\t\t\t\tonICEcandidate(peerConnection, response)\r\n\t\t\t}\r\n\t\t},\r\n\t\tCustomRTCView,\r\n\t\tisPlay,\r\n\t\tsender,\r\n\t\t// renderMirrorView,\r\n\t}\r\n}\r\n\r\nexport const useRemoteCam = (sendMessage:(data:any)=>void)=>{\r\n\tconst pcRef = useRef<{pc?:RTCPeerConnection, receiver?:string, statsInterval?:any}>({})\r\n\tconst [user, setUser] = useState<{name:string}>()\r\n\tconst [_stream, setStream] = useState<MediaStream>()\r\n\tconst CustomRTCView = useCallback(React.memo((style:any)=>_stream?<RTCView stream={_stream} style={style} videoProps={{height:'100%'}} />:<></>), [_stream])\r\n\tconst isPlay = useMemo(()=>_stream?true:false, [_stream])\r\n\tconst start = useCallback((receiver:string)=>{\r\n\t\tconsole.log(\"start\");\r\n\t\tif (!pcRef.current.pc) {\r\n\t\t  pcRef.current.pc = new RTCPeerConnection( peerConstraints );\r\n\t\t  pcRef.current.receiver = receiver\r\n\t\t}\r\n\t\tif (!_stream){\r\n\t\t\tsendMessage({type:'start', receiver, data:{'target': 'host'}})\r\n\t\t}\r\n\t}, [_stream])\r\n\tconst stop = () => {\r\n\t\tconsole.log(\"stop\");\r\n\t\tif (pcRef.current.pc) {\r\n\t\t  // peerConnection._unregisterEvents();\r\n\t\t  setStream(undefined)\r\n\t\t  pcRef.current.pc.close();\r\n\t\t  pcRef.current.pc = undefined\r\n\t\t  pcRef.current.receiver = undefined\r\n\t\t  clearInterval(pcRef.current.statsInterval)\r\n\t\t}\r\n\t}\r\n\treturn {\r\n\t\tstart,\r\n\t\tstop,\r\n\t\twebsocketOnMessage: async(response:any)=>{\r\n\t\t\tlet type = response.type;\r\n\t\t\tif (type == 'start' && response.data.target=='guest' && response.sender == pcRef.current?.receiver){\r\n\t\t\t\tconsole.log('(remote)1 start')\r\n\t\t\t\tconst peerConnection = pcRef.current.pc\r\n\t\t\t\tsetUser({name: response.data.name})\r\n\t\t\t\tpeerConnection.addEventListener('icecandidate', (event:any) => sendICEcandidate(event, sendMessage, response.sender, 'host'));\r\n\t\t\t\tpeerConnection.addEventListener('iceconnectionstatechange', (e:any)=>{\r\n\t\t\t\t\tif (pcRef.current.pc.iceConnectionState == 'connected'){\r\n\t\t\t\t\t\tlet activeStream = false\r\n\t\t\t\t\t\tpcRef.current.statsInterval = setInterval(async()=>{\r\n\t\t\t\t\t\t\tconst stats = await pcRef.current.pc.getStats(null)\r\n\t\t\t\t\t\t\tlet statsOutput = \"\";\r\n\t\t\t\t\t\t\tlet framePerSecond = undefined\r\n\t\t\t\t\t\t\tstats.forEach((report:any) => {\r\n\t\t\t\t\t\t\t\tif (report.type === \"inbound-rtp\" && report.kind === \"video\") {\r\n\t\t\t\t\t\t\t\t\tObject.keys(report).forEach((statName) => {\r\n\t\t\t\t\t\t\t\t\t\tstatsOutput += `${statName}: ${report[statName]}\\n`;\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t\tframePerSecond = report.framesPerSecond\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\tconsole.log(activeStream, framePerSecond)\r\n\t\t\t\t\t\t\tif (framePerSecond != undefined){\r\n\t\t\t\t\t\t\t\tactiveStream = true\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\telse if (activeStream){\r\n\t\t\t\t\t\t\t\tstop()\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tconsole.log(new Date().toTimeString().split(' ')[0], statsOutput)\r\n\t\t\t\t\t\t}, 1000);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if (pcRef.current.pc.iceConnectionState == 'failed'){\r\n\t\t\t\t\t\tstop()\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t\t// peerConnection.addTransceiver('audio', {\r\n\t\t\t\t// \tdirection: 'recvonly'\r\n\t\t\t\t// });\r\n\t\t\t\tpeerConnection.addTransceiver('video', {\r\n\t\t\t\t\tdirection: 'recvonly'\r\n\t\t\t\t});\r\n\t\t\t\tawait createOffer({pc:pcRef.current.pc, receiver:response.sender}, sendMessage, _stream, 'host', user)\r\n\t\t\t}  \r\n\t\t\tif (type == \"answer\" && response.data.target=='guest' && response.sender == pcRef.current?.receiver){\r\n\t\t\t\tconsole.log('(remote)3 answer')\r\n\t\t\t\tconst answerDescription = new RTCSessionDescription(response.data.rtcMessage);\r\n\t\t\t\tawait pcRef.current.pc.setRemoteDescription( answerDescription );\r\n\t\t\t\tconst streams = pcRef.current.pc.getRemoteStreams()\r\n\t\t\t\tsetStream(streams[streams.length - 1])\r\n\t\t\t\tsendMessage({type:'end', receiver:pcRef.current.receiver, data:{}})\r\n\t\t\t}\r\n\t\t\tif (type == \"call\" && response.sender == pcRef.current?.receiver){\r\n\t\t\t  console.log('2 call')\r\n\t\t\t  const peerConnection = pcRef.current.pc\r\n\t\t\t  setUser({name:response.data.name})\r\n\t\t\t  if (!peerConnection)\r\n\t\t\t\treturn\r\n\t\t\t  peerConnection.addEventListener( 'icecandidate', (event:any) => sendICEcandidate(event, sendMessage, response.sender, 'host'));\r\n\t\t\t  const offerDescription = new RTCSessionDescription(response.data.rtcMessage);\r\n\t\t\t  await peerConnection.setRemoteDescription( offerDescription );\r\n\t\t\t  const answerDescription = await peerConnection.createAnswer( sessionConstraints );\r\n\t\t\t  await peerConnection.setLocalDescription( answerDescription );\r\n\t\t\t  sendMessage({type:'answer', receiver:pcRef.current.receiver, data:{target:'host', rtcMessage:peerConnection.localDescription}})\r\n\t\t\t  // Here is a good place to process candidates.\r\n\t\t\t  const streams = pcRef.current.pc.getRemoteStreams()\r\n\t\t\t  setStream(streams[streams.length - 1])\r\n\t\t\t}\r\n\t\t\tif (type == \"ICEcandidate\" && response.data.target=='guest' && response.sender == pcRef.current?.receiver)\r\n\t\t\t  onICEcandidate(pcRef.current.pc, response)\r\n\t\t},\r\n\t\tCustomRTCView,\r\n\t\tuser,\r\n\t\tisPlay\r\n\t}\r\n}","import {StyleSheet} from \"react-native\";\r\nexport {useLocalCam, useRemoteCam} from \"./p2p\"\r\n\r\nexport const camStyle = StyleSheet.create({\r\n\tcontainer:{ flex: 1},\r\n\tcam:{ flex: 1, height:'100%'},\r\n\tbottonContainer: {position:\"absolute\", bottom:0, justifyContent:'flex-end'},\r\n\tbuttonBar: { flexDirection: \"row\", justifyContent: \"space-around\" },\r\n\tlabel: {backgroundColor:'#0008', color:'white', paddingHorizontal:5},\r\n})","import React, { useEffect } from \"react\";\r\nimport {Button, View, Text} from \"react-native\";\r\nimport useWebsocketContext from \"./useWebsocketContext\";\r\nimport { useLocalCam, camStyle} from \"./webrtc\";\r\n\r\n\r\nexport default (props:{user?:{name:string}|null, mode?:'camera'|'display'|null})=>{\r\n  const {lastJsonMessage, sendJsonMessage} = useWebsocketContext()\r\n  const {start, stop, websocketOnMessage, CustomRTCView, isPlay} = useLocalCam(sendJsonMessage)\r\n  useEffect(()=>{\r\n    props.user && lastJsonMessage && websocketOnMessage(lastJsonMessage, props.user)\r\n  }, [lastJsonMessage, props.user])\r\n  useEffect(()=>{\r\n    if(props.mode && !isPlay){\r\n      props.user && start(props.user, undefined, props.mode)\r\n    }\r\n    else if(props.mode===null && isPlay){\r\n      stop()\r\n    }\r\n    return ()=>{isPlay && stop()}\r\n  }, [isPlay, props.user, props.mode])\r\n  return (\r\n    <View style={camStyle.container}>\r\n      <CustomRTCView style={camStyle.cam}/>\r\n      <View style={camStyle.bottonContainer}>\r\n        <View style={camStyle.buttonBar}>  \r\n        </View>\r\n        <View style={{flexDirection:'row'}}><Text style={camStyle.label}>{props.user?.name}</Text></View>\r\n        <View style={camStyle.buttonBar}>\r\n          {props.mode === undefined && !isPlay && <Button title=\"Start\" onPress={()=>props.user && start(props.user)} />}\r\n          {props.mode === undefined && isPlay && <Button title=\"Stop\" onPress={stop} />}\r\n        </View>\r\n      </View>\r\n    </View>\r\n  );\r\n}\r\n","import React, { useState, useEffect, } from \"react\";\r\nimport {Button,Text, TextInput, View} from \"react-native\";\r\nimport useWebsocketContext from \"./useWebsocketContext\";\r\nimport { useRemoteCam, camStyle} from \"./webrtc\";\r\n\r\nexport default (props:{receiver?:string})=>{\r\n  const [receiver, setReceiver] = useState('')\r\n  const {lastJsonMessage, sendJsonMessage} = useWebsocketContext()\r\n  const {start, stop, websocketOnMessage, CustomRTCView, isPlay, user} = useRemoteCam(sendJsonMessage)\r\n  useEffect(()=>{\r\n    lastJsonMessage && websocketOnMessage(lastJsonMessage)\r\n  }, [lastJsonMessage])\r\n  useEffect(()=>{\r\n    if(props.receiver){\r\n      start(props.receiver)\r\n    }\r\n    return ()=>stop()\r\n  }, [props.receiver])\r\n  return (\r\n    <View style={camStyle.container}>\r\n      <CustomRTCView style={camStyle.cam}/>\r\n      <View style={camStyle.bottonContainer}>\r\n        <View style={camStyle.buttonBar}>\r\n        </View>\r\n        <View style={{flexDirection:'row'}}>{\r\n          (props.receiver || isPlay)?\r\n          <Text style={camStyle.label}>{user?.name || 'loading...'}</Text>:\r\n          <>\r\n            <Text style={{borderWidth:1}}>Receiver:&nbsp;</Text>\r\n            <TextInput style={{borderWidth:1, flex:1}} value={receiver} onChangeText={setReceiver}/>\r\n          </> \r\n        }</View>\r\n        <View style={camStyle.buttonBar}>\r\n          {props.receiver === undefined && !isPlay && <Button title=\"Start\" onPress={()=>start(receiver)} />}\r\n          {props.receiver === undefined && isPlay && <Button title=\"Stop\" onPress={stop} />}\r\n        </View>\r\n      </View>\r\n    </View>\r\n  );\r\n}\r\n\r\n","import React, {useEffect, useState} from 'react';\r\nimport { StyleSheet, View } from 'react-native';\r\nimport { View as ThemedView } from '../../../components/Themed' \r\nimport Colors from '../../../constants/Colors';\r\nimport {default as useRtcContext, WebSocketProvider as RtcProvider} from \"../../../lib/react-native-webrtc/useWebsocketContext\";\r\nimport LocalCam from '../../../lib/react-native-webrtc/LocalCam';\r\nimport RemoteCam from '../../../lib/react-native-webrtc/RemoteCam';\r\nimport useResizeContext from '../../../hooks/useResizeContext';\r\nimport useAuthContext from '../../../hooks/useAuthContext';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport CommonButton from '../../../components/CommonButton';\r\n\r\ntype VideoType = 'camera'|'display'|null\r\ntype VideoCallProps = {channel_id:number, setDisable:(disable:boolean)=>void, disable?:boolean}\r\n\r\n\r\nconst VideoView = (props:{\r\n  scale:string,\r\n  focusGuest?:string,\r\n  setFocusGuest:(focusGuest?:string)=>void\r\n  receiver?:string\r\n  children:React.ReactNode\r\n})=>{\r\n  return <View style={[{maxWidth:props.scale, maxHeight:props.scale, borderWidth:1, borderColor:Colors.borderColor, backgroundColor:'gray', flexDirection:'row', flexGrow:1}, (props.focusGuest == undefined || props.focusGuest == props.receiver)?{}:{width:0, height:0}]}>\r\n    <TouchableOpacity style={{flex:1}} containerStyle={{flex:1, justifyContent:'center'}} onPress={()=>props.setFocusGuest(props.focusGuest?undefined:props.receiver)}>\r\n    {props.children}\r\n    </TouchableOpacity>\r\n  </View>\r\n    \r\n  \r\n}\r\n\r\nconst VideoCallContainer = ({channel_id, disable, setDisable}:VideoCallProps)=>{\r\n  const {auth} = useAuthContext()\r\n  const [videoMode, setVideoMode] = useState<VideoType>(null)\r\n  const [guests, setGuests] = useState<string[]>([])\r\n  const [focusGuest, setFocusGuest] = useState<string>()\r\n  const windowType = useResizeContext()\r\n  const { lastJsonMessage, sendJsonMessage } = useRtcContext()\r\n  useEffect(()=>{\r\n    if(lastJsonMessage !=null){\r\n      if(lastJsonMessage['type']=='connection'){\r\n        sendJsonMessage({'type':'broadcast', 'data':{'channel_id':channel_id}})\r\n      }\r\n      if(lastJsonMessage['type']=='broadcast_guest' || lastJsonMessage['type']=='broadcast_host'){\r\n        setGuests([...guests, lastJsonMessage['sender']])\r\n      }\r\n      if(lastJsonMessage['type']=='broadcast_disconnect'){\r\n        const channel_name = lastJsonMessage['sender']\r\n        const exist = guests.find(v=>v == channel_name)\r\n        exist && setGuests(guests.filter(v=>v != channel_name))\r\n      }\r\n    }\r\n  }, [lastJsonMessage])\r\n  const scale = focusGuest?'100%':`${100 / Math.max(2, Math.ceil(Math.sqrt(guests.length + 1)))}%`\r\n  const toggleVideoMode = (mode:VideoType)=>{\r\n    setVideoMode(videoMode!=mode?mode:null)\r\n  }\r\n  return lastJsonMessage !==undefined ?\r\n    <ThemedView style={[\r\n      {aspectRatio:!disable?16/9:0, borderColor:Colors.borderColor, borderRadius:10},\r\n      windowType=='landscape'?{flexShrink:1, flexGrow:0, height:'100%', borderLeftWidth:1, paddingBottom:65}:{maxHeight:'36%', width:'100%', borderBottomWidth:1}\r\n    ]}>\r\n      <View style={{aspectRatio:16/9, backgroundColor:'white', flexWrap:'wrap', flexDirection:'row', width:'100%', height:'100%'}}>\r\n        {guests.map((receiver, i)=><VideoView scale={scale} focusGuest={focusGuest} setFocusGuest={setFocusGuest} receiver={receiver}>\r\n          <RemoteCam receiver={receiver}/>\r\n        </VideoView>\r\n        )}\r\n        <VideoView scale={scale} focusGuest={focusGuest} setFocusGuest={setFocusGuest} receiver={auth.user?.name}>\r\n          <LocalCam user={auth.user} mode={videoMode}/>\r\n        </VideoView>\r\n      </View>\r\n      <ThemedView style={[\r\n          {position:'absolute', alignItems:'center', justifyContent:'flex-end', width:'100%',flexDirection:'row'},\r\n          windowType=='landscape'?{bottom:0, paddingTop:15, paddingBottom:10, paddingHorizontal:19}:{backgroundColor:'transparent'}\r\n        ]}>\r\n        <CommonButton title={''} style={{height:40, paddingTop:8}} onPress={()=>toggleVideoMode('camera')}/>\r\n        <CommonButton title={''} style={{height:40, paddingTop:8}} onPress={()=>toggleVideoMode('display')}/>\r\n        <CommonButton title={''} style={{height:40, paddingTop:8}} onPress={()=>setDisable(true)}/>\r\n      </ThemedView>\r\n    </ThemedView>:\r\n  <></>\r\n  }\r\n  \r\nexport default React.memo(({channel_id, disable, setDisable}:VideoCallProps)=>{\r\n  return <RtcProvider disable={disable}>\r\n    <VideoCallContainer channel_id={channel_id} disable={disable} setDisable={setDisable}/>\r\n  </RtcProvider>\r\n})\r\n","import React from 'react'\r\nimport { TouchableOpacity } from \"react-native-gesture-handler\"\r\nimport CommonSection from \"./CommonSection\"\r\nimport { Linking, TextStyle } from \"react-native\"\r\nimport { FontAwesome } from '@expo/vector-icons'; \r\nimport { View, Text } from \"./Themed\"\r\nimport { File } from \"../types\"\r\nimport useColorScheme from '../hooks/useColorScheme';\r\n\r\nfunction humanFileSize(size:number) {\r\n    var i = size == 0 ? 0 : Math.floor(Math.log(size) / Math.log(1024));\r\n    return (size / Math.pow(1024, i)).toFixed(2) + ' ' + ['B', 'kB', 'MB', 'GB', 'TB'][i];\r\n  }\r\n  \r\n\r\nexport default ({file, isMobile, showBorder}:{file:File, isMobile:boolean, showBorder:boolean})=>{\r\n    const theme = useColorScheme()\r\n    return <CommonSection containerStyle={{marginHorizontal:0}} bodyStyle={showBorder?{padding:10}:{borderWidth:0, padding:0}}>\r\n    <TouchableOpacity onPress={()=>Linking.openURL(file.file)} style={{flexDirection:'row', alignItems:'flex-start'}} containerStyle={{width:'100%'}}>\r\n        <FontAwesome name=\"file-o\" size={20} color={theme=='light'?'black':'white'} />\r\n        <View style={{flex:1, marginHorizontal:10}}>\r\n            <Text style={{fontSize:18}}>{file.filename}</Text>\r\n            <Text style={{fontSize:14}}>{humanFileSize(file.filesize)}</Text>\r\n        </View>\r\n    </TouchableOpacity>\r\n    </CommonSection>\r\n}","import React, {useCallback, useEffect, useLayoutEffect, useMemo, useRef, useState} from 'react';\r\nimport { StackScreenProps } from '@react-navigation/stack';\r\nimport { Platform, StyleSheet, View } from 'react-native';\r\nimport CommonSection from '../../../components/CommonSection';\r\nimport { FlatList, TextInput } from 'react-native-gesture-handler';\r\nimport CommonButton from '../../../components/CommonButton';\r\nimport useMessengerContentList, { MessengerContentPage, useMessengerContentMutation } from '../../../hooks/lists/useMessengerContent.List';\r\nimport useAuthContext from '../../../hooks/useAuthContext';\r\nimport HeaderRight from '../../../components/HeaderRight';\r\nimport useMessengerMemberList, { useMessengerMemberMutation } from '../../../hooks/lists/useMessengerMemberList';\r\nimport { navigate } from '../../../navigation';\r\nimport Colors from '../../../constants/Colors';\r\nimport useColorScheme from '../../../hooks/useColorScheme';\r\nimport { Text, View as ThemedView } from '../../../components/Themed' \r\nimport Hyperlink from 'react-native-hyperlink'\r\nimport useMessengerChannelList from '../../../hooks/lists/useMessengerChannelList';\r\nimport useIsMobile from '../../../hooks/useIsMobile';\r\nimport LinkPreview from '../../../components/LinkPreview';\r\nimport Avatar from '../../../components/Avatar';\r\nimport VideoCallSection from './VideoCallSection';\r\nimport useResizeContext from '../../../hooks/useResizeContext';\r\nimport FilePreview from '../../../components/FilePreview';\r\nimport useModalsContext from '../../../hooks/useModalsContext';\r\nimport InviteModal from '../../../modals/InviteModal';\r\nimport useLangContext from '../../../hooks/useLangContext';\r\nimport ChannelEditModal from '../../../modals/ChannelEditModal';\r\n\r\n\r\nfunction uploadFile(){\r\n  return new Promise<Blob|undefined>((resolve, reject)=>{\r\n    if (Platform.OS == 'web'){\r\n      var input = document.createElement('input');\r\n      input.type = 'file';\r\n      input.onchange = e => { \r\n        resolve((e.target as any).files[0])\r\n      }\r\n      input.onabort = reject\r\n      input.onerror = reject\r\n      input.click();\r\n    }\r\n    else\r\n      resolve(undefined)\r\n  })\r\n}\r\n\r\nconst MessengerContentPageItem = React.memo((props:MessengerContentPage & {ownerId?:number})=>{\r\n  const isMobile = useIsMobile()\r\n  let nextPage = props.next;\r\n    while(nextPage?.next && nextPage.current.length==0){\r\n      nextPage = nextPage.next\r\n    }\r\n    const nextContent = nextPage?.current[0]\r\n    return <View style={{flexDirection: 'column-reverse'}}>\r\n      \r\n      {props.current.map((content, index2)=>{\r\n        const next = index2 + 1 < props.current.length?props.current[index2+1]:nextContent\r\n        const created:string = content.created.slice(0, 16)\r\n        const date = created.slice(0, 10)\r\n        const isSystem = content.user == null\r\n        const isFirst = next==undefined || (content.user != next.user || created != next.created.slice(0, 16))\r\n        const isSelf = props.ownerId == content.user\r\n        const dayChanged = next==undefined || date != next.created.slice(0, 10)\r\n        const message = content.message_set[0]\r\n        if (isSystem)\r\n          return <View key={content.id} style={{flexDirection:'row', justifyContent:'center', width:'100%', marginVertical:5}}>\r\n            <Text>{message.content}</Text>\r\n          </View>\r\n        return <View key={content.id}>\r\n          {dayChanged?<View style={{flexDirection:'row', justifyContent:'center', width:'100%'}}><Text>{date}</Text></View>:undefined}\r\n          <View key={content.id} style={{flexDirection:'row', justifyContent:isSelf?'space-between':'flex-start', width:'100%'}}>\r\n            {isFirst && !isSelf? <View style={{marginTop:3, marginLeft:12}}><Avatar name={content.name} userId={content.user} size={36}/></View>:<View style={{width:48}}/>}\r\n            <CommonSection outerContainerStyle={{width:undefined, maxWidth:'90%'}} title={isFirst?content.name:undefined} titleStyle={{flex:undefined}} bodyStyle={{padding:10}} subtitle={`${created.slice(11)}`}>\r\n              {/* @ts-ignore */}\r\n              <Hyperlink linkDefault={ true } style={{wordBreak:\"break-word\"}} linkStyle={{color: '#12b886'}}>\r\n                <Text selectable>{message.content}</Text>\r\n              </Hyperlink>\r\n              {content.file_set.map((file, fileIndex)=><FilePreview key={fileIndex} file={file} isMobile={isMobile} showBorder={content.file_set.length>1 || message.content.length>0}/>)}\r\n              {content.link_set.map((link, linkIndex)=><LinkPreview key={linkIndex} link={link} isMobile={isMobile}/>)}              \r\n            </CommonSection>\r\n          </View>\r\n        </View>\r\n      })}\r\n    </View>\r\n\r\n})\r\n\r\nexport default function ChatScreen({navigation, route}: StackScreenProps<any, 'Chat'>) {\r\n  const { lang, locale } = useLangContext()\r\n  const channel_id = route?.params?.id\r\n  const height = useRef(0)\r\n  const inputRef = useRef<TextInput>(null)\r\n  const {auth} = useAuthContext()\r\n  const { setModal } = useModalsContext()\r\n  const channel = useMessengerChannelList(auth)?.find(v=>v.id==parseInt(channel_id))\r\n  const {data, fetchNextPage } = useMessengerContentList(channel_id)\r\n  const memberList = useMessengerMemberList(channel_id)\r\n  const member_id = useMemo(()=>memberList?.find(v=>v.user == auth.user?.id)?.id, [auth, memberList])\r\n  const windowType = useResizeContext()\r\n  const messengerMemberMutation = useMessengerMemberMutation()\r\n  const [value, setValue] = useState('')\r\n  const [autoFocus, setAutoFocus] = useState(true)\r\n  const [videoMode, setVideoMode] = useState<boolean>(false)\r\n  const theme = useColorScheme()\r\n  const postValue = ()=>{\r\n    if (value.length>0){\r\n      contentMutation.create({channel:channel_id, user:auth.user?.id, content:value})\r\n      setValue('')\r\n      setAutoFocus(true)\r\n    }\r\n  }\r\n  const contentMutation = useMessengerContentMutation()\r\n\r\n  useLayoutEffect(() => {\r\n    navigation.setOptions({\r\n      headerRight: ()=> <HeaderRight extra={[\r\n        {title:lang('invite'), onPress:()=>setModal(InviteModal, {id:channel_id})},\r\n        {title:lang('leave'), onPress:()=>{member_id && messengerMemberMutation.leave(member_id).then(back)}}\r\n      ]}/>,\r\n      title: channel?.name\r\n    });\r\n  }, [navigation, route, member_id, locale]);\r\n\r\n  const renderItem = useCallback(({item, index}:{item:MessengerContentPage, index:number})=><MessengerContentPageItem {...item} ownerId={auth.user?.id}/>, [auth])\r\n  \r\n  const back = ()=>{\r\n    if(navigation.canGoBack())\r\n        navigation.goBack()\r\n      else{\r\n        navigation.navigate('HomeScreen', {tab:2})\r\n      }\r\n  }\r\n  useEffect(()=>{\r\n    setModal(ChannelEditModal, null)\r\n    if (!(channel_id))\r\n      back()\r\n  }, [route])\r\n  useEffect(()=>{\r\n    if(autoFocus){\r\n      (inputRef.current as any).focus()\r\n      setAutoFocus(false)\r\n    }\r\n  }, [autoFocus])\r\n\r\n  return <View style={[\r\n    {flex:1, alignItems:'center'},\r\n    windowType=='landscape'?{flexDirection:'row-reverse', minWidth:480}:{flexDirection:'column'}\r\n  ]}>\r\n    <VideoCallSection channel_id={channel_id} setDisable={(d)=>setVideoMode(!d)} disable={!videoMode}/>\r\n    <View style={[{flex:videoMode?undefined:1, flexShrink:1}, windowType=='landscape'?{minWidth:320, height:'100%'}:{width:'100%'}]}>\r\n      <FlatList\r\n        style={{flexDirection: 'column-reverse'}}\r\n        contentContainerStyle={{padding:10, flexGrow:1, flexDirection: 'column-reverse'}}\r\n        data={data?.pages}\r\n        renderItem={renderItem}\r\n        onScroll={(e)=>{\r\n          if (e.nativeEvent.contentOffset.y + e.nativeEvent.contentSize.height - height.current < 1)\r\n            fetchNextPage()\r\n        }}\r\n        onLayout={(p)=>{height.current = p.nativeEvent.layout.height}}\r\n      />\r\n      <ThemedView style={{bottom:0, alignItems:'center', width:'100%',flexDirection:'row', paddingTop:15, paddingBottom:10, paddingHorizontal:19}}>\r\n        <TextInput ref={inputRef} value={value} onChangeText={setValue} style={{\r\n          flex:1, borderWidth:1, height:40, borderRadius:6, borderColor:Colors.borderColor, backgroundColor:Colors[theme].background, color:Colors[theme].text\r\n        }} onSubmitEditing={postValue} blurOnSubmit={true}/>\r\n        <CommonButton style={{height:40, paddingTop:8}} title={''} onPress={postValue}/>\r\n        <CommonButton style={{height:40, paddingTop:8}} title={''} onPress={()=>uploadFile().then(f=>{\r\n          contentMutation.create({channel:channel_id, user:auth.user?.id, content:'', file:f})\r\n        })}/>\r\n        {!videoMode && <CommonButton style={{height:40, paddingTop:8}} title={''} onPress={()=>setVideoMode(!videoMode)}/>}\r\n      </ThemedView>\r\n    </View>\r\n  </View>\r\n}","import React, {useEffect, useLayoutEffect, useState} from 'react';\r\n\r\nimport { StackScreenProps } from '@react-navigation/stack';\r\nimport useAuthContext from '../../hooks/useAuthContext';\r\nimport useMessengerChannelList from '../../hooks/lists/useMessengerChannelList';\r\nimport { Text } from '../../components/Themed';\r\nimport { useMessengerMemberMutation } from '../../hooks/lists/useMessengerMemberList';\r\n\r\nexport default function InviteeScreen({navigation, route}: StackScreenProps<any, 'Invitee'>) {\r\n    const id = route?.params?.id\r\n    const {auth, dispatch} = useAuthContext()\r\n    const [enterGuest, setEnterGuest] = useState(false)\r\n    const channelList = useMessengerChannelList(auth)\r\n    const messengerMemberMutation = useMessengerMemberMutation()\r\n    useLayoutEffect(() => {\r\n        navigation.setOptions({headerRight: undefined});\r\n    }, []);\r\n    useEffect(()=>{\r\n        if(auth.user==null && enterGuest==false){\r\n            dispatch({type:\"LOGIN_GUEST\"})\r\n            setEnterGuest(true)\r\n        }\r\n        else if(auth.user && channelList!==undefined){\r\n            if(channelList.find(v=>v.id==id) === undefined){\r\n                console.log(`invite processing (channel:${id})`)\r\n                messengerMemberMutation.invite({\r\n                    channel_id:id,\r\n                    user_ids:[auth.user.id]\r\n                }).then(()=>navigation.replace(\"ChatScreen\", {id}))\r\n            }\r\n            else{\r\n                console.log('already invite')\r\n                navigation.replace(\"ChatScreen\", {id})\r\n            }\r\n        }\r\n    }, [auth, channelList, enterGuest])\r\n  return <Text>{''}</Text>\r\n};\r\n","import LoginScreen from \"./main/LoginScreen\";\r\nimport ChatScreen from \"./main/ChatScreen\";\r\nimport HomeScreen from \"./main/HomeScreen\";\r\nimport TabOneScreen from \"./main/TabOneScreen\";\r\nimport InviteeScreen from \"./main/InviteeScreen\";\r\n// import BoardScreen from \"../lib/blacktokki-board/BoardScreen\";\r\n// import BoardEditScreen from \"../lib/blacktokki-board/BoardEditScreen\";\r\nimport { Screens } from \"../types\";\r\n\r\nexport const main = {\r\n    HomeScreen:{\r\n        title:'home',\r\n        component:HomeScreen,\r\n        path:'home',\r\n    },\r\n    ChatScreen:{\r\n        title:'chat',\r\n        component:ChatScreen,\r\n        path:'chat'\r\n    },\r\n    // BoardScreen:{\r\n    //     title:'board',\r\n    //     component:BoardScreen,\r\n    //     path:'board'\r\n    // },\r\n    // TabOneScreen:{\r\n    //     title:'tab one',\r\n    //     component:TabOneScreen,\r\n    //     path:'one'\r\n    // },\r\n    InviteeScreen:{\r\n        title: '',        \r\n        component:InviteeScreen,\r\n        path:'invitee'\r\n    }\r\n} as Screens\r\n\r\nexport const login = {\r\n    LoginScreen:{\r\n        path: 'login',\r\n        title: 'Sign in',\r\n        component:LoginScreen\r\n    },\r\n    InviteeScreen:{\r\n        path:'invitee',\r\n        title: '',\r\n        component:InviteeScreen\r\n    }\r\n} as Screens\r\n\r\nexport const modal = {\r\n    // BoardEditScreen:{\r\n    //     title:'board',\r\n    //     component:BoardEditScreen,\r\n    //     path:'modal/board'\r\n    // },\r\n} as Screens","import React, {useState, useEffect, useLayoutEffect} from 'react';\r\nimport { StackScreenProps } from '@react-navigation/stack';\r\nimport { StyleSheet, Text, View} from 'react-native';\r\nimport { Text as StyledText } from 'react-native-paper';\r\nimport { useColorScheme as useConfigColorScheme} from 'react-native-appearance';\r\nimport useResizeContext from '../../hooks/useResizeContext';\r\nimport TabViewNavigator, { bottomTabs } from '../../navigation/tabview';\r\nimport HeaderRight from '../../components/HeaderRight';\r\nimport TextButton from '../../components/TextButton';\r\nimport Colors from '../../constants/Colors';\r\nimport useColorScheme, { setColorScheme } from '../../hooks/useColorScheme';\r\nimport useModalsContext from '../../hooks/useModalsContext';\r\nimport ChannelEditModal from '../../modals/ChannelEditModal';\r\nimport useLangContext from '../../hooks/useLangContext';\r\n\r\n// navigate(\"BoardEditScreen\", {channel_id:item.channel, id:item.id})\r\n// deleteBoardContent(item.id).then(()=>navigate('BoardScreen', {id:item.channel}))\r\n\r\nexport default function HomeScreen({navigation, route}: StackScreenProps<any, 'Home'>) {\r\n  const { lang, locale, setLocale } = useLangContext()\r\n  const windowType = useResizeContext();\r\n  const theme = useColorScheme()\r\n  const configTheme = useConfigColorScheme()\r\n  const { setModal } = useModalsContext()\r\n  const [ home, setHome ] = useState(windowType == 'landscape')\r\n  const color = Colors[theme].text\r\n  const options = [\r\n    {title:lang('member'), headerRight:()=><HeaderRight/>},\r\n    {title:lang('messenger'), headerRight:()=><HeaderRight extra={[{title:lang('create'), onPress:()=>setModal(ChannelEditModal, {type:'messenger'})}]}/>},\r\n    // {title:'board', headerRight:()=><HeaderRight extra={[{title:'create', onPress:()=>setModal(ChannelEditModal, props:{type:'board'}}) }]}/>},\r\n    {title:'config', headerRight:()=><HeaderRight/>}\r\n  ]\r\n  \r\n  useLayoutEffect(() => {\r\n    const index = route?.params?.tab | 0\r\n    navigation.setOptions(windowType == 'portrait'?options[index]:{\r\n      title: lang('home'),\r\n      headerRight: ()=><HeaderRight/>\r\n    });\r\n  }, [navigation, route, windowType, locale]);\r\n  useEffect(()=>{\r\n    setHome(windowType == 'landscape')\r\n  }, [windowType])\r\n  return home?\r\n    <View style={{flex:1, justifyContent:'center', alignItems:'center'}}>\r\n      <View style={{width:'80%', height:'80%'}}>\r\n        <StyledText style={{fontSize:32, color}}>Tokki Tok</StyledText>\r\n        <View style={{backgroundColor:Colors.borderColor, height:1, width:'100%'}}/>\r\n        <View style={{flex:1, alignItems:'flex-start'}}>\r\n          {/* <Text style={{fontSize:20, color:'gray'}}>Welcome! This is a messenger for teams.</Text>*/}\r\n          <Text style={{fontSize:24}}> </Text>\r\n          <Text style={{fontSize:24, fontWeight:'500', color}}>{lang('Quick Start')}</Text>\r\n          <TextButton title={lang('+ New Messenger')} textStyle={{fontSize:20, color}} style={{paddingLeft:0, borderRadius:20}} onPress={()=>setModal(ChannelEditModal, {type:'messenger'})}/>\r\n          <Text style={{fontSize:20, fontWeight:'500', color}}>{lang('* Language Settings')}</Text>\r\n          <View style={{flexDirection:'row'}}>\r\n            {[[lang('Auto'), 'auto'], ['', 'ko'], ['English', 'en']].map(([title, l])=><TextButton \r\n              key={title} title={title || ''} textStyle={{fontSize:16, color, textDecorationLine:locale==l?'underline':'none'}} style={{borderRadius:20}} onPress={()=>setLocale(l)}/>)}\r\n          </View>\r\n          <Text style={{fontSize:20, fontWeight:'500', color}}>{lang('* Skin Settings')}</Text>\r\n          <View style={{flexDirection:'row'}}>\r\n            {[[lang('Auto'), 'no-preference'], [lang('Light'), 'light'], [lang('Dark'), 'dark']].map(([title, colorScheme])=><TextButton \r\n              key={title} title={title} textStyle={{fontSize:16, color, textDecorationLine:configTheme==colorScheme?'underline':'none'}} style={{borderRadius:20}} onPress={(\r\n                )=>setColorScheme(colorScheme)}/>)}\r\n          </View>\r\n        </View>\r\n      </View>\r\n    </View>:\r\n    <TabViewNavigator tabs={bottomTabs} tabBarPosition=\"bottom\" index={parseInt(route.params?.['tab'] || 0)} onTab={(index)=>{navigation.setParams({tab:index})}}/>\r\n}\r\n\r\n","import React, { Context, createContext,  useContext, useEffect, useState } from \"react\"\r\nimport useWebSocket from \"react-use-websocket\"\r\nimport { SendJsonMessage } from \"react-use-websocket/dist/lib/types\"\r\n// @ts-ignore\r\nimport {API_URL} from \"@env\"\r\nimport AsyncStorage from \"@react-native-async-storage/async-storage\";\r\nimport { AppState, AppStateStatus } from \"react-native\";\r\n\r\ntype WebsocketContextType = {lastJsonMessage:any, sendJsonMessage:SendJsonMessage }\r\nconst defaultContext = {lastJsonMessage:undefined, sendJsonMessage:()=>{}}\r\nconst WebSocketContext = createContext<WebsocketContextType>(defaultContext);\r\nconst [SCHEMA, DOMAIN] = `${API_URL}`.split('://')\r\n\r\nexport const WebSocketInternalProvider = ({children, path, Context, useBackground}:{children:React.ReactNode, path:string, Context:Context<WebsocketContextType>, useBackground?:boolean})=>{\r\n  const [token, setToken] = useState<string|null>(null)\r\n  const [isActive, setIsActive] = useState<boolean>(useBackground || AppState.currentState == 'active')\r\n  const { lastJsonMessage, sendJsonMessage } = useWebSocket(`${SCHEMA=='https'?'wss':'ws'}://${DOMAIN}/${path}`,{\r\n    shouldReconnect: (closeEvent) => true,\r\n    protocols: token?['Authorization',  token]:undefined,\r\n    onOpen: (e)=>{console.log(`success websocket connection(${path})`)},\r\n    onClose: (e)=> {console.log(`closed websocket connection(${path})`)},\r\n  }, isActive && token!=null)\r\n  useEffect(()=>{\r\n    AsyncStorage.getItem('Authorization').then(setToken)\r\n    const onChange = (nextState:AppStateStatus)=>setIsActive(useBackground || nextState == 'active')\r\n    AppState.addEventListener(\"change\", onChange)\r\n    return ()=>AppState.removeEventListener(\"change\", onChange)\r\n  }, [])\r\n  return <Context.Provider value={token!=null?{lastJsonMessage, sendJsonMessage}:defaultContext}>\r\n      {children}\r\n    </Context.Provider>\r\n}\r\n\r\nexport const WebSocketProvider = ({disable, children}:{disable?:boolean, children:React.ReactNode})=>{\r\n  return disable?<>{children}</>:<WebSocketInternalProvider path={'messenger/ws/'} Context={WebSocketContext}>\r\n    {children}\r\n  </WebSocketInternalProvider>\r\n}\r\n\r\nexport default ()=>{\r\n  const webSocketContext = useContext(WebSocketContext)\r\n  return webSocketContext\r\n}\r\n\r\n","import { Notification } from '../types';\r\nimport axios from './axios';\r\n\r\nexport const getNotification = async (user_id:number)=>{\r\n    const data = (await axios.get(`/api/v1/notifications/?type=WEB&user=${user_id}`) ).data as Notification[]\r\n    return data.length?data[0]:undefined\r\n}\r\n\r\nexport const postNotification = async(notification:Notification)=>{\r\n    return (await axios.post(`/api/v1/notifications/`, notification)).data as Notification\r\n}\r\n\r\nexport const putNotification = async(notification:Notification)=>{\r\n    return (await axios.put(`/api/v1/notifications/${notification.id}/`, notification)).data as Notification\r\n}","import { Platform } from 'react-native';\r\n//@ts-ignore\r\nimport useMobileDetect from 'use-mobile-detect-hook';\r\n\r\nexport default ()=>{\r\n    const detectMobile = useMobileDetect();\r\n    return (detectMobile.isMobile() || Platform.OS == 'android' || Platform.OS == 'ios') as boolean\r\n}","import { useQuery } from \"react-query\";\r\nimport { getUserMembershipList } from \"../../apis\";\r\nimport { Auth } from \"../useAuthContext\";\r\n\r\nexport default function useUserMembershipList(auth?:Auth){\r\n  const { data } = useQuery([\"UserMembershipList\", auth?.groupId] , async()=>auth?.groupId?(await getUserMembershipList(auth?.groupId)):[])\r\n  return data\r\n}","import * as React from 'react';\r\nimport { View } from './Themed';\r\nimport { StyleSheet, StyleProp, ViewStyle, TextStyle, Pressable } from 'react-native';\r\nimport Colors from '../constants/Colors';\r\n\r\nexport type ItemParamList = {\r\n    outerContainerStyle?:StyleProp<TextStyle>\r\n    containerStyle?:StyleProp<ViewStyle>\r\n    bodyStyle?:StyleProp<ViewStyle>\r\n    children?: React.ReactNode\r\n    onPress?: ()=>void\r\n}\r\n\r\nexport default function CommonItem(props:ItemParamList){\r\n  const [hover, setHover] = React.useState(false)\r\n  const [press, setPress] = React.useState(false)\r\n  return (\r\n    <Pressable\r\n      style={[styles.outerContainer ,props.outerContainerStyle, (press)?{backgroundColor:'rgb(242,242,242)'}:{}]}\r\n      onPressIn={()=>{setPress(true)}}\r\n      onPressOut={()=>{setPress(false);props.onPress?.()}}\r\n       //@ts-ignore\r\n       onHoverIn={()=>setHover(true)}\r\n       onHoverOut={()=>setHover(false)}\r\n    >\r\n        <View style={[styles.container ,props.containerStyle]}>\r\n            <View style={[styles.bodyView, props.bodyStyle]}>\r\n                <>{props.children}</>\r\n            </View>\r\n      </View>\r\n    </Pressable>\r\n    )\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  outerContainer:{\r\n    width:'100%',\r\n    maxWidth:1080,\r\n    alignItems:'stretch',\r\n  },  \r\n  container: {\r\n      marginHorizontal:20,\r\n      backgroundColor:'transparent'\r\n    },\r\n    bodyView:{\r\n      width: '100%',\r\n      padding: 10,\r\n      minHeight: 40,\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      borderBottomWidth:1,\r\n      borderColor:Colors.borderColor,\r\n      backgroundColor:'transparent'\r\n    }\r\n  });\r\n  ","import * as React from 'react';\r\nimport { Avatar } from 'react-native-paper';\r\nimport { AvatarProps } from '../../types';\r\n\r\nconst normalizeHash = (hash: number, min: number, max: number) => {\r\n    return Math.floor((hash % (max - min)) + min);\r\n};\r\n\r\nconst stringToHSL = (str: string, initHash?:number) => {\r\n    let hash = initHash || 0;\r\n    for (let i = 0; i < str.length; i++) {\r\n      hash = str.charCodeAt(i) + ((hash << 5) - hash);\r\n    }\r\n    hash = Math.abs(hash);\r\n    return `hsl(${normalizeHash(hash, 0, 360)}, ${normalizeHash(hash, 0, 100)}%, ${normalizeHash(hash, 25, 75)}%)`;\r\n};\r\n\r\nexport default (props:AvatarProps) => {\r\n    const backgroundColor = stringToHSL(props.name, props.userId)\r\n    return <Avatar.Text style={{backgroundColor}} size={props.size} label={props.name.split(' ').map(v=>v[0]).join().toUpperCase()} />\r\n};","import React from 'react';\r\n// import { MaterialIcons } from \"@expo/vector-icons\"\r\nimport Avatar from '../lib/react-native-paper/Avatar';\r\nimport { AvatarProps } from '../types';\r\n\r\nexport default (props:AvatarProps)=>{\r\n    // return <MaterialIcons size={38} style={{ marginBottom: -3, marginRight:10 }} name='account-circle'/>\r\n    return <Avatar {...props}/>\r\n}\r\n\r\n","import React, { useMemo } from 'react';\r\n\r\nimport { TextProps, StyleProp } from 'react-native';\r\nimport {View, Text } from './Themed'\r\nimport useResizeContext from '../hooks/useResizeContext';\r\n\r\ntype Props = {\r\n  name: string,\r\n  width?:number,\r\n  children: React.ReactNode\r\n  textStyle?: StyleProp<TextProps>\r\n}\r\n\r\nexport default function RowField(props:Props) {\r\n  const windowType = useResizeContext()\r\n  const rowStyle = useMemo(()=>windowType=='landscape'?\r\n    {flexDirection:'row', alignItems: 'center', justifyContent:'space-between'}:\r\n    {flexDirection:'column', alignItems:'flex-start'} as any\r\n  , [windowType])\r\n  return (\r\n    <View style={[{paddingVertical:5, width:'100%'}, rowStyle]}>\r\n        <Text style={[windowType=='landscape'?{flex:1}:{width:'100%'},{paddingHorizontal: 15, fontSize:16}, props.textStyle]}>{props.name}</Text>\r\n        <View style={[windowType=='landscape'?{flex:6}:{width:'100%'},{paddingHorizontal: 15}]}>\r\n          <View style={{width:props.width}}>\r\n            {props.children}\r\n          </View>\r\n        </View>\r\n    </View>\r\n  )\r\n}","import React from 'react';\r\nimport { StyleProp, TextStyle } from 'react-native';\r\nimport { CustomTextInputProps } from '../types';\r\nimport CommonTextInput from './CommonTextInput';\r\nimport RowField from './RowField';\r\n\r\nexport default function TextField(props:CustomTextInputProps & {name: string, width?:any, textStyle?:StyleProp<TextStyle>}) {\r\n  return (\r\n    <RowField name={props.name} width={props.width} textStyle={props.textStyle}>\r\n      <CommonTextInput {...props} />\r\n   </RowField>\r\n  )\r\n}","import { MaterialCommunityIcons } from \"@expo/vector-icons\"\r\nimport React from \"react\"\r\nimport { Text, View } from \"react-native\"\r\nimport CommonItem from \"../../components/CommonItem\"\r\nimport useAuthContext from \"../../hooks/useAuthContext\"\r\nimport useUserMembershipList from \"../../hooks/lists/useUserMembershipList\"\r\nimport { UserMembership } from \"../../types\"\r\nimport Avatar from \"../../components/Avatar\"\r\nimport useModalsContext from \"../../hooks/useModalsContext\"\r\nimport ProfileModal from \"../../modals/ProfileModal\"\r\n\r\nexport const renderMemberItem = (item:UserMembership, onPress?:()=>void)=> {\r\n    return <CommonItem key={item.id} bodyStyle={{backgroundColor:'white', flexDirection:'row', justifyContent:'flex-start'}} onPress={onPress}>\r\n        <View style={{marginTop:4, marginRight:12}}><Avatar name={item.name} userId={item.id} size={44}/></View>\r\n        <Text style={{fontSize:20, fontWeight:'400'}}>{item.name}</Text>\r\n    </CommonItem>\r\n}\r\n\r\nexport default ()=>{\r\n    const {auth} = useAuthContext()\r\n    const { setModal } = useModalsContext()\r\n    const userList = useUserMembershipList(auth)\r\n    const memberItem = React.useMemo(\r\n        ()=>userList && userList.map(item=>renderMemberItem(item, ()=>setModal(ProfileModal, {id:item.id}))), [userList])\r\n    return <View style={{flex:1, backgroundColor:'white'}}>\r\n        {memberItem}\r\n    </View>\r\n}\r\n\r\nexport const MemberIcon = <MaterialCommunityIcons size={32} style={{ marginBottom: -3 }} name='account'/>","/**\r\n * Learn more about Light and Dark modes:\r\n * https://docs.expo.io/guides/color-schemes/\r\n */\r\n\r\nimport * as React from 'react';\r\nimport { Text as DefaultText, View as DefaultView } from 'react-native';\r\n\r\nimport Colors from '../constants/Colors'\r\nimport useColorScheme from '../hooks/useColorScheme';\r\n\r\nexport function useThemeColor(\r\n  props: { light?: string; dark?: string },\r\n  colorName: keyof typeof Colors.light & keyof typeof Colors.dark\r\n) {\r\n  const theme = useColorScheme();\r\n  const colorFromProps = props[theme];\r\n\r\n  if (colorFromProps) {\r\n    return colorFromProps;\r\n  } else {\r\n    return Colors[theme][colorName];\r\n  }\r\n}\r\n\r\ntype ThemeProps = {\r\n  lightColor?: string;\r\n  darkColor?: string;\r\n};\r\n\r\nexport type TextProps = ThemeProps & DefaultText['props'];\r\nexport type ViewProps = ThemeProps & DefaultView['props'];\r\n\r\nexport function Text(props: TextProps) {\r\n  const { style, lightColor, darkColor, ...otherProps } = props;\r\n  const color = useThemeColor({ light: lightColor, dark: darkColor }, 'text');\r\n\r\n  return <DefaultText style={[{ color }, style]} {...otherProps} />;\r\n}\r\n\r\nexport function View(props: ViewProps) {\r\n  const { style, lightColor, darkColor, ...otherProps } = props;\r\n  const backgroundColor = useThemeColor({ light: lightColor, dark: darkColor }, 'background');\r\n\r\n  return <DefaultView style={[{ backgroundColor }, style]} {...otherProps} />;\r\n}\r\n","import React from 'react';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport CommonButton from '../components/CommonButton';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport CommonSection from '../components/CommonSection';\r\nimport { Text, View } from '../components/Themed';\r\nimport useLangContext from '../hooks/useLangContext';\r\n\r\nexport default function GuestLogoutModal({id}:{id:number}) {\r\n  const { lang } = useLangContext()\r\n  const { setModal } = useModalsContext()\r\n  const {dispatch} = useAuthContext()\r\n  const back = ()=>{\r\n    setModal(GuestLogoutModal, null)\r\n  }\r\n  return <CommonSection outerContainerStyle={{alignSelf:'center'}}>\r\n    <Text>{lang('Guest users cannot reconnect after logging out. Please create an account or log in.')}</Text>\r\n    <View style={{width:'100%', flexDirection:'row', justifyContent:'flex-end'}}>\r\n      <CommonButton title={lang('sign out')} onPress={()=>dispatch({type:\"LOGOUT_REQUEST\"})}/>\r\n      <CommonButton title={lang('cancel')} onPress={()=>back()}/>\r\n    </View>\r\n  </CommonSection>\r\n}\r\n","import React, { useEffect } from 'react';\r\nimport Profile from '../components/Profile';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport useUserMembershipList from '../hooks/lists/useUserMembershipList';\r\nimport { useMessengerChannelMutation } from '../hooks/lists/useMessengerChannelList';\r\nimport CommonButton from '../components/CommonButton';\r\nimport { DirectChannel } from '../types';\r\nimport { navigate } from '../navigation';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport CommonSection from '../components/CommonSection';\r\nimport { Text, View } from '../components/Themed';\r\nimport useLangContext from '../hooks/useLangContext';\r\n\r\nexport default function ProfileModal({id}:{id:number}) {\r\n  const { lang } = useLangContext()\r\n  const {auth} = useAuthContext()\r\n  const { setModal } = useModalsContext()\r\n  const userList = useUserMembershipList(auth)\r\n  const user = userList?.find(v=>v.id==id)\r\n  const channelMutation = useMessengerChannelMutation()\r\n  const back = ()=>{\r\n    setModal(ProfileModal, null)\r\n  }\r\n  useEffect(()=>{\r\n    if (!(id && user) && userList)\r\n      back()\r\n  }, [userList])\r\n  return user?<CommonSection outerContainerStyle={{alignSelf:'center'}}>\r\n    <View style={{flexDirection:'row', width:'100%'}}>\r\n      <View style={{flex:1}}>\r\n        <CommonButton style={{width:60}} title={''} onPress={back}/>\r\n      </View>\r\n      <View style={{flex:1}}>\r\n        <Text style={{fontSize:20, textAlign:'center'}}>{lang('profile')}</Text>\r\n      </View>\r\n      <View style={{flex:1}}/>\r\n    </View>\r\n    <View style={{marginBottom: 20, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n    \r\n    <Profile username={user.username} name={user.name} userId={user.id} />\r\n    <CommonButton title={lang('create messenger')} onPress={()=>{\r\n      if(auth?.user?.id && auth.groupId){\r\n        const newChannel:DirectChannel = {name:auth.user.id!=user.id?`${auth.user.name}, ${user.name}`:auth.user.name, type:'messenger', owner:auth?.user?.id, group:auth.groupId, counterpart:user.id};\r\n        channelMutation.direct(newChannel).then(v=>navigate(\"Main\", {screen:\"ChatScreen\", params: {id:v.id}}))\r\n      }\r\n    }}/>\r\n  </CommonSection>:<></>\r\n}\r\n","import React from 'react';\r\nimport {View} from 'react-native'\r\nimport {Text} from './Themed';\r\nimport { ProfileProps } from '../types';\r\nimport Avatar from './Avatar';\r\nimport TextButton from './TextButton';\r\nimport CommonTextInput from './CommonTextInput';\r\nimport { patchUser } from '../apis';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\n\r\nexport default (props:ProfileProps)=>{\r\n    const [name, setName] = React.useState<string>()\r\n    const { auth, dispatch } = useAuthContext()\r\n    const isSelf = auth.user?.id == props.userId\r\n    const onChange = ()=>{\r\n        isSelf && patchUser({id:props.userId, name:name || ''}).finally(()=>{\r\n            setName(undefined)\r\n            dispatch({type:\"REFRESH\"})\r\n        })\r\n    }\r\n    return <View style={{width:'100%', height:135, justifyContent:'space-evenly', alignItems:'center'}}>\r\n        <Avatar {...props} size={75}/>\r\n        {name===undefined?\r\n            <TextButton textStyle={{fontWeight:'bold', fontSize:15}} onPress={()=>isSelf && setName(props.name)} title={props.name} disabled={!isSelf}/>:\r\n            <CommonTextInput value={name} style={{textAlign:'center'}} setValue={setName} onBlur={onChange} onEndEditing={onChange} />}\r\n        <Text style={{fontWeight:'normal', fontSize:14}}>{props.username}</Text>\r\n    </View>\r\n}","import React, { useState } from 'react';\r\nimport { TextInput } from 'react-native';\r\nimport Colors from '../constants/Colors';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { CustomTextInputProps } from '../types';\r\n\r\nexport default (props:CustomTextInputProps)=>{\r\n    const [contentHeight, setContentHeight] = useState<number>()\r\n    const minHeight = props.minHeight || 30\r\n    const theme = useColorScheme()\r\n    return <TextInput style={[{\r\n            borderColor:'#d0d7de', \r\n            fontSize:16, \r\n            borderWidth:1, \r\n            borderRadius:6, \r\n            paddingHorizontal:10, \r\n            paddingVertical:3, \r\n            backgroundColor:Colors[theme].background,\r\n            color:Colors[theme].text,\r\n            height:props.multiline?contentHeight:minHeight,\r\n        }, props.style]} \r\n        editable={!props.disabled} \r\n        value={props.value} \r\n        onChangeText={props.setValue}\r\n        onContentSizeChange={props.multiline?(e) => setContentHeight(Math.max(e.nativeEvent.contentSize.height, minHeight) + 2):undefined}\r\n        onBlur={()=>props.onBlur?.(props.value)}\r\n        onEndEditing={()=>props.onEndEditing?.(props.value)}\r\n        multiline={props.multiline}\r\n    />\r\n}","import { useMemo, useReducer } from \"react\"\r\n\r\ntype LocalSearchAction = {type:string, keyword?:string}\r\n\r\ntype LocalSearchState ={active:boolean, keyword:string}\r\n\r\n\r\n\r\nconst localSearchReducer =(initialState:LocalSearchState, action:LocalSearchAction)=>{\r\n    switch (action.type){\r\n        case 'SEARCH':\r\n          return {\r\n            ...initialState,\r\n            keyword: action.keyword\r\n          } as LocalSearchState\r\n        case 'ENABLE_SEARCH':\r\n          return {\r\n            ...initialState,\r\n            active:true,\r\n          }\r\n        case 'DISABLE_SEARCH':\r\n            return{\r\n                ...initialState,\r\n                active:false,\r\n                keyword: ''\r\n            }\r\n        default:\r\n            throw new Error( `Unhandled action type: ${action.type}`)\r\n    }\r\n  }\r\n\r\n\r\nexport default function useLocalSearch<T>(target:T[], compare:(value:T, keyword:string)=>boolean) {\r\n  const [searchState, dispatch] = useReducer(localSearchReducer, {active:false, keyword:''})\r\n  const data = useMemo(()=>searchState.active?target.filter(v=>compare(v, searchState.keyword)):target, [searchState, target])\r\n  return {searchState, dispatch, data}\r\n}","import React, {useRef,MutableRefObject, useMemo, useState, useEffect } from 'react';\r\nimport Clipboard from '@react-native-clipboard/clipboard/dist';\r\nimport { View, Text } from '../components/Themed';\r\nimport CommonSection from '../components/CommonSection';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport useUserMembershipList from '../hooks/lists/useUserMembershipList';\r\nimport { UserMembership } from '../types';\r\nimport CommonButton from '../components/CommonButton';\r\nimport useMessengerMemberList, { useMessengerMemberMutation } from '../hooks/lists/useMessengerMemberList';\r\nimport { renderMemberItem } from '../navigation/tabview/MemberTabView';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport useExternalMembershipList from '../hooks/lists/useExternalMembershipList';\r\nimport TextField from '../components/TextField';\r\nimport useLocalSearch from '../hooks/useLocalSearch';\r\nimport TabViewNavigator from '../navigation/tabview';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport useLangContext from '../hooks/useLangContext';\r\n\r\nconst InviteItem = (props:{item:UserMembership, selectedRef:MutableRefObject<Set<number>>})=>{\r\n  const [selected, setSelected] = useState(props.selectedRef.current.has(props.item.id))\r\n  return <View style={selected?{borderWidth:1, borderColor:'blue'}:{}}>\r\n    {renderMemberItem(props.item, ()=>{\r\n      if (selected){\r\n        setSelected(false)\r\n        props.selectedRef.current.delete(props.item.id)\r\n      }\r\n      else{\r\n        setSelected(true)\r\n        props.selectedRef.current.add(props.item.id)\r\n      }\r\n    })}\r\n  </View>\r\n\r\n}\r\ntype InviteTabViewProps = {\r\n  id:number,\r\n  selectedRef:MutableRefObject<Set<number>>\r\n}\r\n\r\nconst GroupTabView = ({id, selectedRef}:InviteTabViewProps)=>{\r\n  const { lang } = useLangContext()\r\n  const {auth} = useAuthContext()\r\n  const { setModal } = useModalsContext()\r\n  const userList = useUserMembershipList(auth)\r\n  const memberList = useMessengerMemberList(id)\r\n  const messengerMemberMutation = useMessengerMemberMutation()\r\n  const rawData = useMemo(()=>{\r\n    const memberSet = new Set(memberList?.map(v=>v.user))\r\n    return userList?.filter(v=>!memberSet.has(v.id)) || []\r\n  }, [userList, memberList])\r\n  const {data, dispatch:dispatchKeyword, searchState} = useLocalSearch(rawData, (v, keyword)=>(v.username.includes(keyword) || v.name.includes(keyword)))\r\n  const search = (k:string)=>{\r\n    if (k?.length>0){\r\n      dispatchKeyword({type:'ENABLE_SEARCH'})\r\n      dispatchKeyword({type:'SEARCH', keyword:k})\r\n    }\r\n    else{\r\n      dispatchKeyword({type:'DISABLE_SEARCH'})\r\n    }\r\n  }\r\n  const back = ()=>{\r\n    setModal(InviteModal, null)\r\n  }\r\n  return <View style={{alignItems:'center'}}>\r\n    <View style={{backgroundColor:'white', 'width': '50%'}}>\r\n      <TextField name={`${lang('Username')} & ${lang('Name')}`} value={searchState.keyword} setValue={search} width={'80%'}/>\r\n      {id && data?.map((item, index)=><InviteItem key={index} item={item} selectedRef={selectedRef}/>)}\r\n    </View>\r\n    <View style={[{width:'50%', flexDirection:'row', padding:10,}, {justifyContent:'flex-end'}]}>\r\n      <CommonButton title={lang('invite')} onPress={()=>{\r\n        messengerMemberMutation.invite({\r\n          channel_id:id,\r\n          user_ids:[...selectedRef.current]\r\n        }).then(back)\r\n      }}/>\r\n      <CommonButton title={lang('cancel')} onPress={back}/>\r\n    </View>\r\n  </View>\r\n}\r\n\r\nconst DELAY = 500\r\n\r\nconst ExternalMembershipTabView = ({id, selectedRef}:InviteTabViewProps)=>{\r\n  const { lang } = useLangContext()\r\n  const [value, setValue] = useState('')\r\n  const [keyword, setKeyword] = useState('')\r\n  const [copied, setCopied] = useState(false)\r\n  const timeoutRef = useRef<NodeJS.Timeout>()\r\n  const { setModal } = useModalsContext()\r\n  const memberList = useMessengerMemberList(id)\r\n  const externalMemberList = useExternalMembershipList(keyword)\r\n  const data = useMemo(()=>{\r\n    const memberSet = new Set(memberList?.map(v=>v.user))\r\n    return externalMemberList?.filter(v=>!memberSet.has(v.id)) || []\r\n  }, [externalMemberList, memberList])\r\n  const messengerMemberMutation = useMessengerMemberMutation()\r\n  useEffect(()=>{\r\n    timeoutRef.current = setTimeout(()=>{\r\n      setKeyword(value)\r\n    }, DELAY)\r\n    return ()=>{timeoutRef.current && clearTimeout(timeoutRef.current)}\r\n  }, [value])\r\n  const back = ()=>{\r\n    setModal(InviteModal, null)\r\n  }\r\n  const inviteLink = location.href.replace('chat', 'invitee')\r\n  return <View style={{alignItems:'center'}}>\r\n  <TouchableOpacity style={{paddingVertical:10, flexDirection:\"row\"}} onPress={()=>{Clipboard.setString(inviteLink);setCopied(true)}}>\r\n    <Text style={{fontSize:14}}>{lang('invite link')}{\": \"}</Text>\r\n    <Text style={{fontSize:14, color:'#12b886'}}>{inviteLink}{\" \"}</Text>\r\n    {copied && <Text style={{fontSize:12, color:'red'}}>{lang(\"copied\")}</Text>}\r\n  </TouchableOpacity>\r\n  <View style={{backgroundColor:'white', 'width': '50%'}}>\r\n    <TextField name={lang('Username')} value={value} setValue={setValue} width={'80%'}/>\r\n    {id && data?.map((item, index)=><InviteItem key={index} item={item} selectedRef={selectedRef}/>)}\r\n  </View>\r\n  <View style={[{width:'50%', flexDirection:'row', padding:10,}, {justifyContent:'flex-end'}]}>\r\n    <CommonButton title={lang('invite')} onPress={()=>{\r\n      messengerMemberMutation.invite({\r\n        channel_id:id,\r\n        user_ids:[...selectedRef.current]\r\n      }).then(back)\r\n    }}/>\r\n    <CommonButton title={lang('cancel')} onPress={back}/>\r\n  </View>\r\n</View>\r\n}\r\n\r\nexport default function InviteModal({id}:{id:number}) {\r\n  const { lang } = useLangContext()\r\n  const selectedRef = useRef<Set<number>>(new Set())\r\n  const drawerTabs:Record<string, {title:string, component:React.ComponentType<any>, icon:JSX.Element}> = {\r\n    group:{\r\n      title: lang('Group'),\r\n      component: ()=><GroupTabView id={id} selectedRef={selectedRef}/>,\r\n      icon: <></>\r\n    },\r\n    external:{\r\n      title: lang('External members'),\r\n      component: ()=><ExternalMembershipTabView id={id} selectedRef={selectedRef}/>,\r\n      icon: <></>\r\n    }\r\n  }\r\n  return <CommonSection outerContainerStyle={{alignSelf:'center'}}>\r\n    <View style={{justifyContent:'space-around'}}>\r\n      <Text style={{fontSize:20}}>{lang('invite')}</Text>\r\n    </View>\r\n    <View style={{marginBottom: 20, height: 1, width: '100%'}} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />\r\n    <View style={{width:'100%'}}>\r\n      <TabViewNavigator tabs={drawerTabs} tabBarPosition={\"top\"}/>\r\n    </View>\r\n  </CommonSection>\r\n}\r\n\r\n","import { useQuery } from \"react-query\";\r\nimport { getExternalMembershipList } from \"../../apis\";\r\n\r\nexport default function useExternalMembershipList(keyword?:string){\r\n  const { data } = useQuery([\"UserMembershipList\", keyword] , async()=>keyword?(await getExternalMembershipList(keyword)):[])\r\n  return data\r\n}","import axios, { AxiosRequestConfig } from 'axios';\r\n// @ts-ignore\r\nimport {API_URL} from \"@env\"\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\nexport const accountURL =  `${API_URL}/account/`\r\nconst baseURL =  `${API_URL}/messenger/`\r\nconst defaultOption:AxiosRequestConfig = {\r\n    baseURL,\r\n    withCredentials: true,\r\n    headers: {}\r\n};\r\nconst _axios = axios.create(defaultOption);\r\n\r\n_axios.interceptors.request.use(\r\n    config => {\r\n        return config;\r\n    },\r\n    error => {\r\n        return Promise.reject(error);\r\n    }\r\n)\r\n\r\n_axios.interceptors.response.use(\r\n    response => {\r\n        // if((response.request.responseURL as string).indexOf('/task/login')>=0 && response.data.length != 0){\r\n        //     // redirect login\r\n        // }\r\n        return response;\r\n    },\r\n    error => {\r\n        if (error.response.status === 401) {\r\n            return getToken().then(async(token)=>{\r\n                if (token){\r\n                    const r = await _axios.post(\"/api/v1/user/sso/refresh/\", {token}, {headers:{'Authorization':''}, baseURL: accountURL})\r\n                    if (r.status == 200 && r.data !== ''){\r\n                        setToken(r.data)\r\n                    }\r\n                }\r\n            }).finally(()=>{\r\n                return Promise.reject(error)\r\n            })\r\n        }\r\n        return Promise.reject(error)\r\n    }\r\n)\r\n\r\nexport const setToken = async (token:string|null)=>{\r\n    _axios.defaults.headers['Authorization'] = `JWT ${token}`\r\n    if (token)\r\n        await AsyncStorage.setItem(\"Authorization\", token)\r\n    else\r\n        AsyncStorage.removeItem(\"Authorization\")\r\n}\r\nexport const getToken = async ()=>{\r\n    const token = await AsyncStorage.getItem(\"Authorization\")\r\n    _axios.defaults.headers['Authorization'] = token?`JWT ${token}`:null\r\n    return token\r\n}\r\n\r\nexport default _axios\r\n","import React, { createContext, useContext, useEffect, useReducer, useMemo, Dispatch, useState } from \"react\"\r\nimport { checkLogin, login, logout } from \"../apis\"\r\nimport { getNotification, putNotification } from \"../apis/notification\"\r\nimport { UserMembership } from \"../types\"\r\n\r\ntype AuthAction = {type:string, username?:string, password?:string, user?:UserMembership|null}\r\n\r\nexport type Auth = {user?:UserMembership|null, groupId?:number}\r\n\r\ntype AuthState ={user?:UserMembership|null, request?:{username:string, password:string}|null}\r\n\r\nconst AuthContext = createContext<{auth:Auth, error?:string, dispatch:Dispatch<AuthAction>}>({auth:{}, dispatch:()=>{}});\r\n\r\nconst authReducer =(initialState:AuthState, action:AuthAction)=>{\r\n  switch (action.type){\r\n      case 'LOGIN_REQUEST':\r\n        return {\r\n          ...initialState,\r\n          request:{username:action.username, password:action.password},\r\n        } as AuthState\r\n      case 'LOGIN_GUEST':\r\n        return {\r\n          ...initialState,\r\n          request:{username:'guest', password:'guest'},\r\n        } as AuthState\r\n      case 'LOGIN_SUCCESS':\r\n          return{\r\n              ...initialState,\r\n              user:action.user,\r\n              request:undefined\r\n          }\r\n      case 'LOGIN_FAILED':\r\n          return{\r\n              ...initialState,\r\n              request:undefined\r\n          }\r\n      case 'LOGOUT_REQUEST':\r\n          return{\r\n              ...initialState,\r\n              request:null\r\n          }\r\n      case 'LOGOUT_SUCCESS':\r\n          return {\r\n            ...initialState,\r\n            user:null,\r\n            request:undefined\r\n          }\r\n      case 'REFRESH':\r\n        return {\r\n          ...initialState,\r\n          user:undefined\r\n        }\r\n      default:\r\n          throw new Error( `Unhandled action type: ${action.type}`)\r\n  }\r\n}\r\n\r\n\r\nexport const AuthProvider = ({children}:{children:React.ReactNode})=>{\r\n  const [authState, dispatch] = useReducer(authReducer, {} as Auth)\r\n  const [error, setError] = useState<string>()\r\n  const auth = useMemo(()=>({\r\n    user:authState.user,\r\n    groupId: authState.user?.membership_set.find(g=>g.root_group_id==null)?.group\r\n  }), [authState])\r\n  useEffect(()=>{\r\n    if(authState.user===undefined){\r\n      checkLogin().then((user)=>{\r\n        dispatch({type:\"LOGIN_SUCCESS\", user})\r\n      }).catch((e)=>{\r\n        console.log(e)\r\n        dispatch({type:\"LOGOUT_SUCCESS\"})\r\n      })\r\n    }\r\n    else if(authState.user===null && authState.request){\r\n      login(authState.request.username, authState.request.password).then(user=>{\r\n        dispatch({type:\"LOGIN_SUCCESS\", user})\r\n      }).catch((data)=>{\r\n        dispatch({type:\"LOGIN_FAILED\"})\r\n        setError(data.response?.data?.message)\r\n      })\r\n    }\r\n    else if(authState.user && authState.request===null){\r\n      getNotification(authState.user.id).then(noti=>{\r\n        noti && putNotification({...noti, token:''}).then(()=>{\r\n          logout().then(()=>dispatch({type:\"LOGOUT_SUCCESS\"}))\r\n        })\r\n      })\r\n    }\r\n  }, [authState])\r\n  return <AuthContext.Provider value={{auth, error, dispatch}}>\r\n    {children}\r\n  </AuthContext.Provider>\r\n}\r\n\r\nexport default ()=>{\r\n  const authContext = useContext(AuthContext)\r\n  return authContext\r\n}\r\n","/**\r\n * Learn more about deep linking with React Navigation\r\n * https://reactnavigation.org/docs/deep-linking\r\n * https://reactnavigation.org/docs/configuring-links\r\n */\r\n\r\nimport { LinkingOptions } from '@react-navigation/native';\r\nimport * as Linking from 'expo-linking';\r\nimport {main, login, modal} from '../screens';\r\n\r\nconst ROOTPATH = 'tokki-tok'  // github repository name\r\n\r\nObject.values(modal).forEach(v=>v.path = ROOTPATH + '/' + v.path)\r\n\r\nexport default  {\r\n  prefixes: [Linking.makeUrl('/')],\r\n  config: {\r\n    screens: {\r\n      Main: {\r\n        screens:{\r\n          ...main,\r\n          ...login,\r\n          NotFound: '*',\r\n        },\r\n        path: ROOTPATH\r\n      },\r\n      ...modal\r\n    },\r\n  },\r\n} as LinkingOptions;\r\n","const tintColorLight = '#2f95dc';\r\nconst tintColorDark = '#fff';\r\n\r\nexport default {\r\n  light: {\r\n    text: '#000',\r\n    background: '#fff',\r\n    tint: tintColorLight,\r\n    tabIconDefault: '#ccc',\r\n    tabIconSelected: tintColorLight,\r\n    header:'#24292f',\r\n    buttonColor:'rgb(242,242,242)',\r\n    buttonBackgroundColor: '#f6f8fa', //'rgba(9,30,66,0.08)',//rgb(242,242,242)\r\n  },\r\n  dark: {\r\n    text: '#fff',\r\n    background: '#000',\r\n    tint: tintColorDark,\r\n    tabIconDefault: '#ccc',\r\n    tabIconSelected: tintColorDark,\r\n    header:'#dbd6d1',\r\n    buttonColor:'rgb(14,14,14)',\r\n    buttonBackgroundColor: '#080604',\r\n  },\r\n  button:{\r\n    borderColor:'rgba(27,31,36,0.15)',\r\n  },\r\n  borderColor:'#d0d7de',\r\n  \r\n  focus:'#0065A4',\r\n};\r\n","import { StackScreenProps } from '@react-navigation/stack';\r\nimport * as React from 'react';\r\nimport { StyleSheet, Text, TouchableOpacity, View } from 'react-native';\r\nimport useLangContext from '../hooks/useLangContext';\r\n\r\nexport default function NotFoundScreen({\r\n  navigation,\r\n}: StackScreenProps<any, 'NotFound'>) {\r\n  const { lang } = useLangContext()\r\n  return (\r\n    <View style={styles.container}>\r\n      <Text style={styles.title}>{lang(\"This screen doesn't exist.\")}</Text>\r\n      <TouchableOpacity onPress={() => navigation.replace('HomeScreen')} style={styles.link}>\r\n        <Text style={styles.linkText}>{lang(\"Go to home screen!\")}</Text>\r\n      </TouchableOpacity>\r\n    </View>\r\n  );\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  container: {\r\n    flex: 1,\r\n    backgroundColor: '#fff',\r\n    alignItems: 'center',\r\n    justifyContent: 'center',\r\n    padding: 20,\r\n  },\r\n  title: {\r\n    fontSize: 20,\r\n    fontWeight: 'bold',\r\n  },\r\n  link: {\r\n    marginTop: 15,\r\n    paddingVertical: 15,\r\n  },\r\n  linkText: {\r\n    fontSize: 14,\r\n    color: '#2e78b7',\r\n  },\r\n});\r\n","import { useTheme } from '@react-navigation/native';\r\nimport React, { useState } from 'react';\r\nimport { View, StyleSheet } from 'react-native';\r\nimport Profile from '../components/Profile';\r\nimport TextButton from '../components/TextButton';\r\nimport Colors from '../constants/Colors';\r\nimport useResizeContext from '../hooks/useResizeContext';\r\nimport TabViewNavigator, { drawerTabs } from './tabview';\r\nimport { UserMembership } from '../types';\r\nimport useModalsContext from '../hooks/useModalsContext';\r\nimport ChannelEditModal from '../modals/ChannelEditModal';\r\n\r\nexport default ({user}:{user:UserMembership})=> {\r\n  const { colors } = useTheme();\r\n  const windowType = useResizeContext();\r\n  const [index, setIndex] = useState(0);\r\n  const { setModal } = useModalsContext()\r\n  const onAddList = [\r\n    ()=>setModal(ChannelEditModal, {type:'messenger'}),\r\n    ()=>setModal(ChannelEditModal, {type:'board'})\r\n  ]\r\n  return <View style={windowType=='landscape'?[\r\n      styles.tabBar,\r\n      {\r\n        backgroundColor: colors.card,\r\n        borderTopColor: colors.border,\r\n      },\r\n      // tabBarStyle,\r\n    ]:{width:0}}\r\n    pointerEvents={false ? 'none' : 'auto'}\r\n  >\r\n    <Profile userId={user.id} username={user.username} name={user.name}/>\r\n    {windowType=='landscape' && <>\r\n      <View style={{flexDirection:'row-reverse'}}>\r\n          <TextButton title='+' textStyle={{fontSize:20}} style={{borderRadius:20}} onPress={onAddList[index]}/>\r\n      </View>\r\n      <View accessibilityRole=\"tablist\" style={styles.content}>\r\n        {Object.keys(drawerTabs).length>1 ? \r\n          <TabViewNavigator tabs={drawerTabs} tabBarPosition={\"top\"} onTab={setIndex}/>: \r\n          <View style={{borderTopWidth:1, flex:1, borderColor:colors.border}}>            \r\n            {Object.values(drawerTabs).map(drawerTab=>{const Tab = drawerTab.component; return <Tab key={drawerTab.title}/>})}\r\n          </View>\r\n        }\r\n      </View>\r\n    </>}\r\n  </View>\r\n}\r\n\r\n{/*<Text style={[styles.label, { color: d.isFocused ? colors.primary : '#222' }]}></Text> */}\r\n\r\nconst styles = StyleSheet.create({\r\n    tabBar: {\r\n      width:240,\r\n      elevation: 8,\r\n      borderRightWidth:1,\r\n      borderColor:Colors.borderColor\r\n    },\r\n    content: {\r\n      flex: 1,\r\n      flexDirection: 'row',\r\n    },\r\n    tab: {\r\n        flex: 1,\r\n        alignItems: 'center',\r\n    },\r\n    label: {\r\n        textAlign: 'center',\r\n        backgroundColor: 'transparent',\r\n      },\r\n  });","import React, { createContext, useContext, useEffect } from \"react\"\r\nimport firebase from \"firebase/app\";\r\nimport \"firebase/messaging\";\r\n//@ts-ignore\r\nimport {FCM_PUBLIC_VAPID_KEY, FCM_API_KEY} from \"@env\"\r\nimport { Notification as NotificationType, UserMembership } from \"../types\";\r\nimport { getNotification, postNotification, putNotification } from \"../apis/notification\";\r\nimport { Auth } from \"./useAuthContext\";\r\nconst firebaseConfig = require(\"../../web/firebase-config.js\")\r\n// Initialize Firebase\r\nconst key = firebaseConfig.messagingSenderId\r\nconst apiKeyEncrypted = (FCM_API_KEY as string).split('').map((v, i)=> (v.charCodeAt(0) ^ key.charCodeAt(i)).toString(16).padStart(2, '0')).join('')\r\nconst app = firebase.initializeApp({...firebaseConfig, apiKey:FCM_API_KEY});\r\n// const analytics = getAnalytics(app);\r\nconst messaging = firebase.messaging(app);\r\n\r\nmessaging.onMessage((payload) => {\r\n  if (!(\"Notification\" in window)) {\r\n    alert(\"This browser does not support desktop notification\");\r\n  }\r\n  else if (Notification.permission === \"granted\") {\r\n    const message_set = JSON.parse(payload.data['message_set'])[0]\r\n    new Notification(payload.data.channel_name, { body: `${payload.data.name}: ${message_set.content}` });\r\n  }\r\n});\r\n\r\nconst requestToken = async()=>{\r\n  const permission = await Notification.requestPermission();\r\n  if (permission === 'granted') {\r\n    const serviceWorkerRegistration = await navigator.serviceWorker.register(`${process.env.PUBLIC_URL}/firebase-messaging-sw.js?${apiKeyEncrypted}`)\r\n    console.log('[SW]: SCOPE: ', serviceWorkerRegistration.scope);\r\n    const currentToken = await messaging.getToken({serviceWorkerRegistration, vapidKey: FCM_PUBLIC_VAPID_KEY })\r\n    window.addEventListener('beforeunload', (event:any) => {\r\n      event.preventDefault();\r\n      serviceWorkerRegistration.unregister()\r\n    });\r\n    if (currentToken)\r\n      return currentToken\r\n  }\r\n  return undefined\r\n}\r\n\r\n\r\nlet noti:NotificationType|undefined\r\n\r\nconst setEnable = async(enable:boolean, user?:UserMembership|null)=>{\r\n  context.enable = enable\r\n  if(user && enable){\r\n    const token = await requestToken() || null\r\n    noti = await getNotification(user.id)\r\n    if (noti == undefined)\r\n      noti = await postNotification({user:user.id, type:'WEB', token})\r\n    else\r\n      noti = await putNotification({...noti, token})\r\n  }\r\n  else if (noti){\r\n    await putNotification({...noti, token:null})\r\n  }\r\n}\r\n\r\nconst context:{enable:boolean, setEnable:(enable:boolean, user?:UserMembership|null)=>void} = {enable:false, setEnable}\r\nconst FirebaseContext = createContext(context);\r\n\r\nexport default (auth:Auth)=>{\r\n  useEffect(()=>{\r\n    setEnable(true, auth.user)\r\n  }, [auth.user])\r\n  const firebaseContext = useContext(FirebaseContext)\r\n  return firebaseContext\r\n}\r\n","import InviteModal from \"./InviteModal\";\r\nimport ProfileModal from \"./ProfileModal\";\r\nimport ChannelEditModal from \"./ChannelEditModal\"\r\nimport GuestLogoutModal from \"./GuestLogoutModal\";\r\n\r\nexport default [\r\n    InviteModal,\r\n    ProfileModal,\r\n    ChannelEditModal,\r\n    GuestLogoutModal\r\n]","import { CardStyleInterpolators, createStackNavigator } from '@react-navigation/stack';\r\nimport React, {useMemo} from 'react';\r\nimport { View } from 'react-native';\r\nimport { Ionicons } from '@expo/vector-icons';\r\nimport useResizeContext from '../hooks/useResizeContext';\r\nimport NotFoundScreen from '../screens/NotFoundScreen';\r\nimport {main, login, modal} from '../screens';\r\nimport DrawerNavigator from './DrawerNavigator';\r\nimport useAuthContext from '../hooks/useAuthContext';\r\nimport { WebSocketProvider } from '../hooks/useWebsocketContext';\r\nimport HeaderRight from '../components/HeaderRight'\r\nimport Colors from '../constants/Colors';\r\nimport { TouchableOpacity } from 'react-native-gesture-handler';\r\nimport useFirebaseContext from '../hooks/useFirebaseContext';\r\nimport useIsMobile from '../hooks/useIsMobile';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { ModalsProvider } from '../hooks/useModalsContext';\r\nimport modals from '../modals';\r\nimport useLangContext from '../hooks/useLangContext';\r\n\r\nconst Root = createStackNavigator();\r\n\r\nexport default function RootNavigator() {\r\n    const windowType = useResizeContext();\r\n    return <Root.Navigator\r\n        mode= 'modal'\r\n        headerMode= 'screen'\r\n        screenOptions={{\r\n            cardStyle:{backgroundColor:\"white\"},\r\n            animationEnabled: true,\r\n            cardStyleInterpolator: CardStyleInterpolators.forVerticalIOS,\r\n        }}\r\n    >\r\n        <Root.Screen name=\"Main\" component={MainNavigator} options={{headerShown:false}}/>\r\n        {Object.entries(modal).map(([key, screen])=><Root.Screen key={key} name={key} component={screen.component} options={{\r\n            title: screen.title,\r\n            gestureDirection: windowType == 'landscape'?'vertical-inverted':'vertical'\r\n        }} />)}\r\n    </Root.Navigator>\r\n}\r\n\r\nconst Main = createStackNavigator();\r\n\r\nfunction headerLeft(navigation:any, route:any, windowType:string, isMobile:boolean){\r\n    const canGOBackScreen = ['HomeScreen', 'LoginScreen'].findIndex(v=>v == route.name) == -1\r\n    const goBack = ()=>{\r\n        if (navigation.canGoBack())\r\n            navigation.goBack()\r\n        else if (canGOBackScreen)\r\n            navigation.replace('HomeScreen')\r\n    }\r\n    if (windowType=='portrait' && canGOBackScreen)\r\n        return <TouchableOpacity onPress={goBack}><Ionicons size={isMobile?20:24} style={{marginHorizontal:isMobile?16:20 }} name=\"arrow-back\"/></TouchableOpacity>\r\n    return null\r\n}\r\n\r\nconst MainNavigator = ()=>{\r\n    const windowType = useResizeContext();\r\n    const isMobile = useIsMobile()\r\n    const {auth} = useAuthContext()\r\n    const theme = useColorScheme()\r\n    const {lang, locale} = useLangContext()\r\n    const entries = useMemo(()=>{\r\n        if (auth.user === undefined)\r\n            return []\r\n        console.log('current user: ', auth.user)\r\n        return Object.entries(auth.user === null?login:main)\r\n    }, [auth, locale])\r\n    const modalValues = useMemo(()=>{\r\n        if (auth.user === undefined)\r\n            return []\r\n        return auth.user === null?[]:modals\r\n    }, [auth])\r\n\r\n    useFirebaseContext(auth)\r\n    return (auth.user!==undefined?<View style={{flexDirection:'row', flex:1}}>\r\n        <ModalsProvider modals={modalValues}>\r\n            {auth.user?<DrawerNavigator user={auth.user}/>:undefined}\r\n            <View style={{flex:1}}>\r\n                <WebSocketProvider disable={auth.user === null || auth.user === undefined}>\r\n                        <Main.Navigator\r\n                            screenOptions={({navigation, route})=>({\r\n                                headerStyle:{backgroundColor:Colors[theme].header, height:isMobile?50:undefined},\r\n                                headerTitleStyle:{color:'white'},\r\n                                headerLeft:()=>headerLeft(navigation, route, windowType, isMobile),\r\n                                headerRight:()=><HeaderRight/>,\r\n                                headerLeftContainerStyle:{backgroundColor:'white', borderBottomWidth:1, borderColor:Colors.borderColor},\r\n                                cardStyle:{flexShrink:1},\r\n                                animationEnabled:windowType=='portrait',\r\n                                cardStyleInterpolator: CardStyleInterpolators.forHorizontalIOS\r\n                            })}\r\n                        >\r\n                            {entries.map(([key, screen])=><Main.Screen key={key} name={key} component={screen.component} options={{ title: lang(screen.title) }} />)}\r\n                            <Main.Screen name=\"NotFound\" component={NotFoundScreen} options={{ title: 'Oops!' }} />\r\n                        </Main.Navigator>\r\n                </WebSocketProvider>\r\n            </View>\r\n        </ModalsProvider>\r\n    </View>:<></>);\r\n}","import React, { useEffect, useState } from 'react'\r\nimport { Dimensions, Platform, View } from 'react-native'\r\nimport useIsMobile from '../hooks/useIsMobile'\r\n\r\n\r\nexport default (props:{children:React.ReactNode})=>{\r\n    const isMobile = useIsMobile()\r\n    const [height, setHeight] = useState(window.innerHeight + 1)\r\n    useEffect(()=>{\r\n        if(isMobile && Platform.OS == 'web'){\r\n            const onChange = (e:any)=>{\r\n                setHeight(window.innerHeight + 1)\r\n            }\r\n            Dimensions.addEventListener(\"change\",onChange)\r\n            return () => Dimensions.removeEventListener(\"change\", onChange)\r\n            \r\n        }\r\n    },[ isMobile])\r\n    return <View style={{height:isMobile&&Platform.OS == 'web'?height:'100%'}}>\r\n        {props.children}\r\n    </View>\r\n\r\n}\r\n  ","import React from 'react';\r\nimport { StatusBar } from 'expo-status-bar';\r\nimport { SafeAreaProvider } from 'react-native-safe-area-context';\r\nimport Navigation from './src/navigation';\r\nimport useCachedResources from './src/hooks/useCachedResources';\r\nimport { useInitColorScheme } from './src/hooks/useColorScheme';\r\nimport MobileSafeAreaView from './src/components/MobileSafeAreaView';\r\nimport { AuthProvider } from './src/hooks/useAuthContext';\r\nimport { QueryClient, QueryClientProvider } from 'react-query';\r\nimport { IntlProvider } from './src/hooks/useLangContext';\r\n\r\nconst queryClient = new QueryClient();\r\n\r\nexport default function App() {\r\n  const isLoadingComplete = useCachedResources();\r\n  const isAppearenceComplete = useInitColorScheme()\r\n  if (!isLoadingComplete || !isAppearenceComplete) {\r\n    return null;\r\n  } else {\r\n    return (\r\n      <SafeAreaProvider>\r\n        <MobileSafeAreaView>\r\n          <AuthProvider>\r\n            <QueryClientProvider client={queryClient}>\r\n              <IntlProvider>\r\n                {/* devtools */}\r\n                {/* <ReactQueryDevtools initialIsOpen={true} /> */}\r\n                <Navigation/>\r\n                <StatusBar />\r\n              </IntlProvider>\r\n            </QueryClientProvider>\r\n          </AuthProvider>\r\n        </MobileSafeAreaView>\r\n      </SafeAreaProvider>\r\n    );\r\n  }\r\n}\r\n","import { Ionicons } from '@expo/vector-icons';\r\nimport * as Font from 'expo-font';\r\nimport * as SplashScreen from 'expo-splash-screen';\r\nimport * as React from 'react';\r\n\r\nexport default function useCachedResources() {\r\n  const [isLoadingComplete, setLoadingComplete] = React.useState(false);\r\n\r\n  // Load any resources or data that we need prior to rendering the app\r\n  React.useEffect(() => {\r\n    async function loadResourcesAndDataAsync() {\r\n      try {\r\n        SplashScreen.preventAutoHideAsync();\r\n\r\n        // Load fonts\r\n        await Font.loadAsync({\r\n          ...Ionicons.font,\r\n          'space-mono': require('../assets/fonts/SpaceMono-Regular.ttf'),\r\n        });\r\n      } catch (e) {\r\n        // We might want to provide this error information to an error reporting service\r\n        console.warn(e);\r\n      } finally {\r\n        setLoadingComplete(true);\r\n        SplashScreen.hideAsync();\r\n      }\r\n    }\r\n\r\n    loadResourcesAndDataAsync();\r\n  }, []);\r\n\r\n  return isLoadingComplete;\r\n}\r\n","import { createIntl, createIntlCache } from \"@formatjs/intl\";\r\nimport {I18nManager} from \"react-native\";\r\nimport * as RNLocalize from \"react-native-localize\";\r\n\r\nexport const translations = {\r\n  ko: require(\"./ko.json\"),\r\n} as const;\r\n\r\ntype Translation = keyof typeof translations;\r\n\r\n// fallback if no available language fits\r\nconst fallback = { languageTag: \"en\", isRTL: false };\r\n\r\nconst { languageTag, isRTL } =\r\n  RNLocalize.findBestLanguageTag(Object.keys(translations)) ?? fallback;\r\n\r\n// update layout direction\r\nI18nManager.forceRTL(isRTL);\r\n\r\n// console.log(languageTag)\r\nconst intl = createIntl(\r\n  {\r\n    defaultLocale: \"en\",\r\n    locale: languageTag,\r\n    messages: translations[languageTag as Translation],\r\n  },\r\n  createIntlCache(),\r\n);\r\n\r\nexport default intl","import React, { createContext, useContext, useState, useEffect } from \"react\";\r\nimport { IntlShape } from \"@formatjs/intl\";\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport intl, { translations } from \"../lang\";\r\n\r\nconst IntlContext = createContext<{locale?:string, setLocale:(locale:string|undefined)=>void}>({setLocale:()=>{}});\r\n\r\nexport const IntlProvider = ({children}:{children:React.ReactNode})=>{\r\n  const [complete, setComplete] = useState(false)\r\n  const [locale, setLocale] = useState<string>()\r\n  useEffect(()=>{\r\n    AsyncStorage.getItem(\"locale\").then(v=>{\r\n      setLocale(v || undefined)\r\n      setComplete(true)\r\n    })\r\n  }, [])\r\n  return complete?<IntlContext.Provider value={{locale, setLocale}}>\r\n      {children}\r\n    </IntlContext.Provider>:<></>\r\n}\r\n\r\n\r\n\r\ntype TranslationParams = Parameters<IntlShape<string>[\"formatMessage\"]>[1];\r\n\r\nexport default ()=>{\r\n  const { locale, setLocale } = useContext(IntlContext)\r\n  return {\r\n    lang:(key: string, params?: TranslationParams) => {\r\n      if (locale == 'en' || key.length==0)\r\n        return key\r\n      if (locale != undefined && locale !='auto')\r\n        return translations[locale as 'ko'][key]\r\n      return intl\r\n        .formatMessage({ id: key, defaultMessage: key }, params)\r\n        .toString()\r\n    },\r\n    locale,\r\n    setLocale: (locale:string)=>{AsyncStorage.setItem('locale', locale).then(()=>setLocale(locale))}\r\n  }\r\n}\r\n","import React, { useState } from 'react';\r\nimport { Text, StyleSheet, Pressable, StyleProp, ViewStyle} from 'react-native';\r\nimport Colors from '../constants/Colors';\r\nimport useColorScheme from '../hooks/useColorScheme';\r\nimport { CustomButtonProps } from '../types';\r\n\r\nconst DefaultButton = (props:CustomButtonProps)=>{\r\n    const [hover, setHover] = useState(false)\r\n    return <Pressable\r\n        onPress={()=>props.onPress()}\r\n        //@ts-ignore\r\n        onHoverIn={()=>setHover(true)}\r\n        onHoverOut={()=>setHover(false)}\r\n        style={[\r\n            {\r\n                paddingVertical:5, \r\n                paddingHorizontal:16\r\n            },\r\n            props.style,\r\n            hover?{backgroundColor:props.color}:{}\r\n        ]}>\r\n            <Text selectable={false} style={[{fontSize:14}, props.textStyle]}>{props.title}</Text>\r\n        </Pressable>\r\n}\r\n\r\nexport default (props:CustomButtonProps)=>{\r\n    const theme = useColorScheme()\r\n    const _props = {\r\n        color:Colors[theme].buttonColor,\r\n        ...props,\r\n        style:[\r\n            styles.style,\r\n            {\r\n                backgroundColor:Colors[theme].buttonBackgroundColor\r\n            },\r\n            props.style,\r\n        ] as StyleProp<ViewStyle>,\r\n        textStyle:[\r\n            styles.text, \r\n            {color:Colors[theme].text},\r\n            props.textStyle\r\n        ]\r\n    }\r\n    return <DefaultButton {..._props}/>\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n    style:{\r\n        borderRadius:6, \r\n        borderColor:Colors.button.borderColor, \r\n        borderWidth:1, \r\n    },\r\n    text:{\r\n        textAlign:'center', \r\n        fontWeight:'600'\r\n    }\r\n});\r\n","firebaseConfig = {\n    \"authDomain\": \"virtual-metrics-355712.firebaseapp.com\",\n    \"projectId\": \"virtual-metrics-355712\",\n    \"storageBucket\": \"virtual-metrics-355712.appspot.com\",\n    \"messagingSenderId\": \"76003576924\",\n    \"appId\": \"1:76003576924:web:c8c8a006d07918bbc02a99\",\n    \"measurementId\": \"G-SEL35L4N5R\"\n}\nif (typeof module !== 'undefined') {\n    module.exports = firebaseConfig\n}\n","\r\nimport { User, UserMembership } from '../types';\r\nimport axios, { getToken, setToken, accountURL as baseURL } from './axios';\r\n\r\nexport const login = async(username:string, password:string) => {\r\n    if(username.endsWith('.guest') && password.length == 0)\r\n        password = 'guest'\r\n    const r = await axios.post(\"/api-token-auth/\", {username, password});\r\n    if(r.status == 200){\r\n        await setToken(r.data)\r\n        return await checkLogin()\r\n    }\r\n}\r\n\r\nexport const logout = async() => {\r\n    await setToken(null)\r\n    return await axios.get(\"/api-auth/logout/\")\r\n}\r\n\r\nexport const guestLogin =  async() => {\r\n    return await login('guest', 'guest')\r\n}\r\n\r\nconst checkLoginToken = async ()=>{\r\n    const value = (await axios.get(\"/api/v1/users/memberships/?_self=true\"))?.data\r\n    if (value && value.length){\r\n        return value[0] as UserMembership\r\n    }\r\n    return null\r\n}\r\n\r\nexport const checkLogin = async() => {\r\n    const token = await getToken()\r\n    if (token === null)\r\n        return null\r\n    try{\r\n       return await checkLoginToken()\r\n    }\r\n    catch(e:any){\r\n        let error = e\r\n        if(e.response !== undefined && e.response.status==401){\r\n            try{\r\n                return await checkLoginToken()\r\n            }\r\n            catch(e2){\r\n                error = e2\r\n            }\r\n        }\r\n        const isOffline = ((error as any).code == \"ERR_NETWORK\" || (error as any).message && ((error as any).message as string).startsWith(\"Cannot read\"))\r\n        throw {error, isOffline}\r\n    }\r\n}\r\n\r\nexport const getUserList = async (group_id:number)=>{\r\n    return (await axios.get(`/api/v1/users/?group_id=${group_id}`) ).data as User[]\r\n}\r\n\r\nexport const patchUser = async (user:{id:number, name:string})=>{\r\n    await axios.patch(`/api/v1/user/`, {ids:[user.id], updated: {name:user.name}}, {baseURL})\r\n}\r\n\r\nexport const getUserMembershipList = async (group_id:number)=>{\r\n    return (await axios.get(`/api/v1/users/memberships/?group_id=${group_id}`) ).data as UserMembership[]\r\n}\r\n\r\nexport const getExternalMembershipList = async (username:string)=>{\r\n    return (await axios.get(`/api/v1/users/memberships/?username=${username}`) ).data as UserMembership[]\r\n}","import { Channel, MessengerMember, MessengerContent, EditMessage, MessengerChannel, DirectChannel } from '../types';\r\nimport axios from './axios';\r\n\r\nexport const getMessengerChannelList = async (user_id:number)=>{\r\n    return (await axios.get(`/api/v1/channels/messenger/?type=messenger&messenger_user_id=${user_id}`) ).data as MessengerChannel[]\r\n}\r\n\r\nexport const postChannel = async(channel:Channel)=>{\r\n    return (await axios.post(`/api/v1/channels/`, channel)).data as Channel\r\n}\r\n\r\nexport const postDirectChannel = async(channel:DirectChannel)=>{\r\n    return (await axios.post(`/api/v1/channels/direct/`, channel)).data as Channel\r\n}\r\n\r\nexport const putChannel = async(channel:Channel)=>{\r\n    return (await axios.put(`/api/v1/channels/${channel.id}/`, channel)).data as Channel\r\n}\r\n\r\nexport const deleteChannel = async(channel_id:number)=>{\r\n    await axios.delete(`/api/v1/channels/${channel_id}/`)\r\n}\r\n\r\nexport const getMessengerMemberList = async(channel_id:number)=>{\r\n    return (await axios.get(`/api/v1/messengermembers/?channel=${channel_id}`) ).data as MessengerMember[]\r\n}\r\n\r\nexport const postBulkMessengerMember = async(data:{channel_id:number, user_ids:number[]})=>{\r\n    await axios.post(`/api/v1/messengermembers/bulk/`, {channel:data.channel_id, user_ids:data.user_ids})\r\n}\r\n\r\nexport const deleteMessengerMember = async(member_id:number)=>{\r\n    await axios.delete(`/api/v1/messengermembers/${member_id}/`)\r\n}\r\n\r\nexport const getMessengerContentList = async (channel_id:number, id_lt?:number)=>{\r\n    const id_lt_param = id_lt?`&id_lt=${id_lt}`:''\r\n    return (await axios.get(`/api/v1/messengercontents/?limit=30&channel=${channel_id}${id_lt_param}`)).data.results as MessengerContent[]\r\n}\r\n\r\nexport const postMessage = async (message:EditMessage)=>{\r\n    if (message.file){\r\n        const formData = new FormData(); // formData  .\r\n        formData.append(\"file\", message.file)\r\n        Object.entries(message).forEach(value=>{\r\n            formData.append(value[0], `${value[1]}`)\r\n        })\r\n        await axios.post(`/api/v1/messengercontents/messages/`, formData, {headers:{\r\n            ...(axios.defaults.headers as any), \"Content-Type\": \"multipart/form-data\",\r\n        }})\r\n    }\r\n    else{\r\n        await axios.post(`/api/v1/messengercontents/messages/`, message)\r\n    }\r\n}\r\n\r\nexport const deleteMessengerContent = async (content_id:number)=>{\r\n    await axios.delete(`/api/v1/messengercontents/${content_id}/`)\r\n}","module.exports = __webpack_public_path__ + \"./fonts/SpaceMono-Regular.ttf\";","import React, { useState, createContext, useContext, useEffect } from \"react\";\r\nimport { Modal } from \"react-native\";\r\nimport useResizeContext from \"./useResizeContext\";\r\n\r\ntype ModalProps = any\r\n\r\ntype ModalState = {\r\n  Component:React.ComponentType<ModalProps>,\r\n  ExactComponent?:React.ComponentType<ModalProps>\r\n}\r\ntype SetModal = (Component:ModalState[\"Component\"], props:ModalProps|null)=>void\r\n\r\nconst ModalsContext = createContext<{setModal: SetModal}>({\r\n    setModal: () => {}\r\n});\r\n\r\nexport const ModalsProvider = ({children, modals:allModals}:{children:React.ReactNode, modals:React.ComponentType<ModalProps>[]}) => {\r\n    const [modals, setModals] = useState<ModalState[]>([]);\r\n    const windowType = useResizeContext();\r\n    const [animationType, setAnimationType] = useState('none')\r\n    const setModal:SetModal = (Component, props) => {\r\n        const newModals = modals.map(m=>{\r\n            if(m.Component == Component){\r\n                return {\r\n                    Component, \r\n                    ExactComponent:props != null?React.memo(()=><Component {...props}/>):undefined\r\n                }\r\n            }\r\n            return m        \r\n        })\r\n        setModals(newModals);\r\n    }\r\n    useEffect(()=>{\r\n        modals.filter(v=>v.ExactComponent!==undefined).length == 0 && setAnimationType(windowType == 'landscape'?'fade':'slide')\r\n    }, [windowType, modals])\r\n    useEffect(()=>{\r\n        setModals(allModals.map((Component)=>({Component})))\r\n    }, [allModals])\r\n    return <ModalsContext.Provider value={{setModal}}>\r\n        {children}\r\n        {modals.map((modal, index)=>{\r\n            const { ExactComponent } = modal;\r\n            return <Modal key={index} animationType={animationType as any} visible={ExactComponent!==undefined}>\r\n                {ExactComponent?<ExactComponent/>:<></>}\r\n            </Modal>\r\n        })}\r\n    </ModalsContext.Provider>\r\n}\r\n\r\nexport default ()=>{\r\n    const modalsContext = useContext(ModalsContext)\r\n    return modalsContext\r\n}\r\n\r\n","import React, { useState, useEffect, createContext, useContext, useMemo } from 'react';\r\nimport { Dimensions, ScaledSize, useWindowDimensions } from 'react-native';\r\n//@ts-ignore\r\nimport useMobileDetect from 'use-mobile-detect-hook';\r\n\r\ntype WindowType = 'portrait' | 'landscape'\r\n\r\nconst getWindowType = (window:{width:number, height:number})=> window.height >= window.width?'portrait':'landscape' as WindowType;\r\n\r\nconst ResizeContextContext = createContext<WindowType>(getWindowType(Dimensions.get('window')));\r\n\r\nexport const ResizeContextProvider = ({children}:{children:React.ReactNode})=>{\r\n  const detectMobile = useMobileDetect();\r\n  const {width, height} = useWindowDimensions()\r\n  const [windowType, setWindowType] = useState(getWindowType({width, height}))\r\n  useEffect(()=>{\r\n    setWindowType(getWindowType({width, height}))\r\n  }, [width, height])\r\n  return <ResizeContextContext.Provider value={detectMobile.isMobile()?'portrait':windowType}>\r\n    {children}\r\n  </ResizeContextContext.Provider>\r\n}\r\n\r\nexport default function useResizeContext() {\r\n  const windowType = useContext(ResizeContextContext)\r\n  return windowType\r\n}","import AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport { useTheme } from '@react-navigation/native';\r\nimport { useMemo, useEffect, useState } from 'react';\r\nimport { ColorSchemeName } from 'react-native';\r\nimport { Appearance, ColorSchemeName as UserColorSchemeName } from 'react-native-appearance';\r\n\r\n// The useColorScheme value is always either light or dark, but the built-in\r\n// type suggests that it can be null. This will not happen in practice, so this\r\n// makes it a bit easier to work with.\r\n\r\nexport function useInitColorScheme(){\r\n  const [complete, setComplete] = useState(false)\r\n  useEffect(()=>{\r\n    if (!complete){\r\n      AsyncStorage.getItem(\"color\").then(v=>{\r\n        Appearance.set({colorScheme:(v==null)?'no-preference':(v as any)})\r\n        setComplete(true)\r\n      })\r\n    }\r\n  }, [complete])\r\n  return complete\r\n}\r\n\r\nexport function setColorScheme(colorScheme:UserColorSchemeName){\r\n  AsyncStorage.setItem('color',colorScheme as string).then(()=>Appearance.set({colorScheme}))\r\n}\r\n\r\nexport default function useColorScheme(): NonNullable<ColorSchemeName> {\r\n  const { dark } = useTheme()\r\n  const colorScheme = useMemo(()=> dark?'dark':'light', [dark]) as NonNullable<ColorSchemeName>;\r\n  return colorScheme\r\n}\r\n","import * as React from 'react';\r\nimport { View, Text } from './Themed';\r\nimport { StyleSheet, StyleProp, ViewStyle, TextStyle } from 'react-native';\r\nimport Colors from '../constants/Colors';\r\n\r\nexport type SectionParamList = {\r\n    title?: string,\r\n    titleStyle?:StyleProp<TextStyle>\r\n    outerContainerStyle?:StyleProp<TextStyle>\r\n    containerStyle?:StyleProp<ViewStyle>\r\n    bodyStyle?:StyleProp<ViewStyle>\r\n    subtitle?: string\r\n    withSeparator?: boolean\r\n    children?: React.ReactNode\r\n}\r\n\r\nexport default function CommonSection(props:SectionParamList){\r\n  return (\r\n    <View style={[styles.outerContainer, props.outerContainerStyle]}>\r\n        <View style={[styles.container, props.containerStyle]}>\r\n            {props.withSeparator?<View style={styles.separator} lightColor=\"#ddd\" darkColor=\"rgba(255,255,255, 0.3)\" />:undefined}\r\n            {props.title?<View style={styles.titleView}>\r\n              <Text style={[styles.title, props.titleStyle]}>{props.title}</Text>\r\n              <Text style={styles.subtitle}>{props.subtitle}</Text>\r\n            </View>:undefined}\r\n            <View style={[styles.bodyView, props.bodyStyle]}>\r\n            {props.children}\r\n            </View>\r\n          </View>\r\n        </View>\r\n    )\r\n}\r\n\r\nconst styles = StyleSheet.create({\r\n  outerContainer:{\r\n    width:'100%',\r\n    maxWidth:1080,\r\n    alignItems:'stretch',\r\n    backgroundColor:'transparent'\r\n  },  \r\n  container: {\r\n      marginHorizontal:20,\r\n      marginVertical: 10,\r\n      backgroundColor:'transparent',\r\n    },\r\n    titleView:{\r\n      width: '100%',\r\n      flexDirection:'row',\r\n      backgroundColor:'transparent',\r\n      marginBottom:5,\r\n    },\r\n    title: {\r\n      flex:1,\r\n      fontSize: 16,\r\n    },\r\n    subtitle: {\r\n      flex:1,\r\n      fontSize: 12,\r\n      textAlign: 'right',\r\n      marginTop:4\r\n    },\r\n    separator: {\r\n      marginBottom: 20,\r\n      height: 1,\r\n      width: '100%',\r\n    },\r\n    bodyView:{\r\n      width: '100%',\r\n      padding: 20,\r\n      alignItems: 'center',\r\n      justifyContent: 'center',\r\n      borderWidth:1,\r\n      borderColor:Colors.borderColor,\r\n      borderRadius:6\r\n    }\r\n  });\r\n  ","import { useEffect } from \"react\";\r\nimport { useMutation, useQuery, useQueryClient } from \"react-query\";\r\nimport { getMessengerChannelList, postChannel, postDirectChannel, putChannel } from \"../../apis\";\r\nimport { MessengerChannel, MessengerContent } from \"../../types\";\r\nimport { Auth } from \"../useAuthContext\";\r\nimport useWebsocketContext from \"../useWebsocketContext\";\r\n\r\nexport default function useMessengerChannelList(auth?:Auth){\r\n  const queryClient = useQueryClient()\r\n  const {lastJsonMessage} = useWebsocketContext()\r\n  const { data } = useQuery(\"MessengerChannelList\" , async()=>auth?.user?.id?(await getMessengerChannelList(auth.user.id)):[])\r\n\r\n  useEffect(()=>{\r\n    if(lastJsonMessage !=null){\r\n      if(lastJsonMessage['type']=='enter'){\r\n        queryClient.setQueryData<MessengerChannel[]>(\"MessengerChannelList\", (_data)=>{\r\n          return (_data?.find(v=>v.id==lastJsonMessage['data']['id'])?_data:[lastJsonMessage['data'] , ...(_data|| [])]).sort((a, b)=>a.id - b.id)\r\n        })\r\n      }\r\n      if (lastJsonMessage['type']=='next_message'){\r\n        const data:MessengerContent = lastJsonMessage['data']\r\n        queryClient.setQueryData<MessengerChannel[]>(\"MessengerChannelList\", (_data)=>(_data || []).map(v=>{\r\n          if (v.id == data.channel){\r\n            return {...v, last_message:{content:data.message_set[0]?.content, created:data.created}}\r\n          }\r\n          return v\r\n        }))\r\n      }\r\n      // if(lastJsonMessage['type']=='leave'){\r\n      //   queryClient.setQueryData<Channel[]>(\"MessengerChannelList\", (_data)=>_data?.filter(v=>v.id!=lastJsonMessage['data']['channel_id']) || [])\r\n      // }\r\n    }\r\n  }, [lastJsonMessage])\r\n  return data\r\n}\r\n\r\nexport function useMessengerChannelSorted(auth?:Auth){\r\n  const channelList = useMessengerChannelList(auth);\r\n  return channelList?.sort((a, b)=>(a.last_message?.created || '') < (b.last_message?.created || '')?1:-1)\r\n}\r\nexport function useMessengerChannelMutation(){\r\n  const queryClient = useQueryClient()\r\n\r\n  const create = useMutation(postChannel, {\r\n    onSuccess: ()=>queryClient.invalidateQueries(\"MessengerChannelList\")\r\n  });\r\n\r\n  const update = useMutation(putChannel, {\r\n    onSuccess: () => queryClient.invalidateQueries(\"MessengerChannelList\")\r\n  })\r\n\r\n  const direct = useMutation(postDirectChannel, {\r\n    onSuccess: () => queryClient.invalidateQueries(\"MessengerChannelList\")\r\n  })\r\n\r\n  return { create:create.mutateAsync, update:update.mutateAsync, direct:direct.mutateAsync}\r\n}"],"sourceRoot":""}